### T1007 - System Service Discovery

Description:

Adversaries may try to gather information about registered local system services. Adversaries may obtain information about services using tools as well as OS utility commands such as <code>sc query</code>, <code>tasklist /svc</code>, <code>systemctl --type=service</code>, and <code>net start</code>.

Adversaries may use the information from [System Service Discovery](https://attack.mitre.org/techniques/T1007) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Procedures:

- [S0386] Ursnif: [Ursnif](https://attack.mitre.org/software/S0386) has gathered information about running services.(Citation: TrendMicro Ursnif Mar 2015)
- [G0060] BRONZE BUTLER: [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) has used TROJ_GETVERSION to discover system services.(Citation: Trend Micro Tick November 2019)
- [S0018] Sykipot: [Sykipot](https://attack.mitre.org/software/S0018) may use <code>net start</code> to display running services.(Citation: AlienVault Sykipot 2011)
- [S0244] Comnie: [Comnie](https://attack.mitre.org/software/S0244) runs the command: <code>net start >> %TEMP%\info.dat</code> on a victim.(Citation: Palo Alto Comnie)
- [S0663] SysUpdate: [SysUpdate](https://attack.mitre.org/software/S0663) can collect a list of services on a victim machine.(Citation: Lunghi Iron Tiger Linux)
- [S0039] Net: The <code>net start</code> command can be used in [Net](https://attack.mitre.org/software/S0039) to find information about Windows services.(Citation: Savill 1999)
- [G0139] TeamTNT: [TeamTNT](https://attack.mitre.org/groups/G0139) has searched for services such as Alibaba Cloud Security's aliyun service and BMC Helix Cloud Security's bmc-agent service in order to disable them.(Citation: Cisco Talos Intelligence Group)
- [S0081] Elise: [Elise](https://attack.mitre.org/software/S0081) executes <code>net start</code> after initial communication is made to the remote server.(Citation: Lotus Blossom Jun 2015)
- [S0378] PoshC2: [PoshC2](https://attack.mitre.org/software/S0378) can enumerate service and service permission information.(Citation: GitHub PoshC2)
- [G0119] Indrik Spider: [Indrik Spider](https://attack.mitre.org/groups/G0119) has used the win32_service WMI class to retrieve a list of services from the system.(Citation: Symantec WastedLocker June 2020)
- [S0533] SLOTHFULMEDIA: [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) has the capability to enumerate services.(Citation: CISA MAR SLOTHFULMEDIA October 2020)
- [S0236] Kwampirs: [Kwampirs](https://attack.mitre.org/software/S0236) collects a list of running services with the command <code>tasklist /svc</code>.(Citation: Symantec Orangeworm April 2018)
- [S0057] Tasklist: [Tasklist](https://attack.mitre.org/software/S0057) can be used to discover services running on a system.(Citation: Microsoft Tasklist)
- [S0283] jRAT: [jRAT](https://attack.mitre.org/software/S0283) can list local services.(Citation: Kaspersky Adwind Feb 2016)
- [S0241] RATANKBA: [RATANKBA](https://attack.mitre.org/software/S0241) uses <code>tasklist /svc</code> to display running tasks.(Citation: RATANKBA)
- [G0049] OilRig: [OilRig](https://attack.mitre.org/groups/G0049) has used <code>sc query</code> on a victim to gather information about services.(Citation: Palo Alto OilRig May 2016)
- [G0010] Turla: [Turla](https://attack.mitre.org/groups/G0010) surveys a system upon check-in to discover running services and associated processes using the <code>tasklist /svc</code> command.(Citation: Kaspersky Turla)
- [S0127] BBSRAT: [BBSRAT](https://attack.mitre.org/software/S0127) can query service configuration information.(Citation: Palo Alto Networks BBSRAT)
- [S0629] RainyDay: [RainyDay](https://attack.mitre.org/software/S0629) can create and register a service for execution.(Citation: Bitdefender Naikon April 2021)
- [S0154] Cobalt Strike: [Cobalt Strike](https://attack.mitre.org/software/S0154) can enumerate services on compromised hosts.(Citation: Cobalt Strike Manual 4.3 November 2020)
- [S0180] Volgmer: [Volgmer](https://attack.mitre.org/software/S0180) queries the system to identify existing services.(Citation: US-CERT Volgmer Nov 2017)
- [S0582] LookBack: [LookBack](https://attack.mitre.org/software/S0582) can enumerate services on the victim machine.(Citation: Proofpoint LookBack Malware Aug 2019)
- [S1027] Heyoka Backdoor: [Heyoka Backdoor](https://attack.mitre.org/software/S1027) can check if it is running as a service on a compromised host.(Citation: SentinelOne Aoqin Dragon June 2022)
- [G0143] Aquatic Panda: [Aquatic Panda](https://attack.mitre.org/groups/G0143) has attempted to discover services for third party EDR products.(Citation: CrowdStrike AQUATIC PANDA December 2021)
- [G0033] Poseidon Group: After compromising a victim, [Poseidon Group](https://attack.mitre.org/groups/G0033) discovers all running services.(Citation: Kaspersky Poseidon Group)
- [G0094] Kimsuky: [Kimsuky](https://attack.mitre.org/groups/G0094) has used an instrumentor script to gather the names of all services running on a victim's system.(Citation: Talos Kimsuky Nov 2021)
- [S0572] Caterpillar WebShell: [Caterpillar WebShell](https://attack.mitre.org/software/S0572) can obtain a list of the services from a system.(Citation: ClearSky Lebanese Cedar Jan 2021)
- [G0114] Chimera: [Chimera](https://attack.mitre.org/groups/G0114) has used <code>net start</code> and <code>net use</code> for system service discovery.(Citation: NCC Group Chimera January 2021)
- [G0004] Ke3chang: [Ke3chang](https://attack.mitre.org/groups/G0004) performs service discovery using <code>net start</code> commands.(Citation: Mandiant Operation Ke3chang November 2014)
- [S0260] InvisiMole: [InvisiMole](https://attack.mitre.org/software/S0260) can obtain running services on the victim.(Citation: ESET InvisiMole June 2018)
- [S0342] GreyEnergy: [GreyEnergy](https://attack.mitre.org/software/S0342) enumerates all Windows services.(Citation: ESET GreyEnergy Oct 2018)
- [S0559] SUNBURST: [SUNBURST](https://attack.mitre.org/software/S0559) collected a list of service names that were hashed using a FNV-1a + XOR algorithm to check against similarly-hashed hardcoded blocklists.(Citation: FireEye SUNBURST Backdoor December 2020)
- [S0398] HyperBro: [HyperBro](https://attack.mitre.org/software/S0398) can list all services and their configurations.(Citation: Unit42 Emissary Panda May 2019)
- [S1070] Black Basta: [Black Basta](https://attack.mitre.org/software/S1070) can check whether the service name `FAX` is present.(Citation: Cyble Black Basta May 2022)
- [S0203] Hydraq: [Hydraq](https://attack.mitre.org/software/S0203) creates a backdoor through which remote attackers can monitor services.(Citation: Symantec Trojan.Hydraq Jan 2010)(Citation: Symantec Hydraq Jan 2010)
- [S0237] GravityRAT: [GravityRAT](https://attack.mitre.org/software/S0237) has a feature to list the available services on the system.(Citation: Talos GravityRAT)
- [S0496] REvil: [REvil](https://attack.mitre.org/software/S0496) can enumerate active services.(Citation: Intel 471 REvil March 2020)
- [S0625] Cuba: [Cuba](https://attack.mitre.org/software/S0625) can query service status using <code>QueryServiceStatusEx</code> function.(Citation: McAfee Cuba April 2021)
- [S0242] SynAck: [SynAck](https://attack.mitre.org/software/S0242) enumerates all running services.(Citation: SecureList SynAck Doppelgänging May 2018)(Citation: Kaspersky Lab SynAck May 2018)
- [S1085] Sardonic: [Sardonic](https://attack.mitre.org/software/S1085) has the ability to execute the `net start` command.(Citation: Bitdefender Sardonic Aug 2021)
- [S0431] HotCroissant: [HotCroissant](https://attack.mitre.org/software/S0431) has the ability to retrieve a list of services on the infected host.(Citation: Carbon Black HotCroissant April 2020)
- [G1006] Earth Lusca: [Earth Lusca](https://attack.mitre.org/groups/G1006) has used [Tasklist](https://attack.mitre.org/software/S0057) to obtain information from a compromised host.(Citation: TrendMicro EarthLusca 2022)
- [S0085] S-Type: [S-Type](https://attack.mitre.org/software/S0085) runs the command <code>net start</code> on a victim.(Citation: Cylance Dust Storm)
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has used `net start` to list running services.(Citation: CISA AA24-038A PRC Critical Infrastructure February 2024)
- [S0049] GeminiDuke: [GeminiDuke](https://attack.mitre.org/software/S0049) collects information on programs and services on the victim that are configured to automatically run at startup.(Citation: F-Secure The Dukes)
- [C0014] Operation Wocao: During [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors used the `tasklist` command to search for one of its backdoors.(Citation: FoxIT Wocao December 2019)
- [S0086] ZLib: [ZLib](https://attack.mitre.org/software/S0086) has the ability to discover and manipulate Windows services.(Citation: Cylance Dust Storm)
- [S1066] DarkTortilla: [DarkTortilla](https://attack.mitre.org/software/S1066) can retrieve information about a compromised system's running services.(Citation: Secureworks DarkTortilla Aug 2022)
- [S0082] Emissary: [Emissary](https://attack.mitre.org/software/S0082) has the capability to execute the command <code>net start</code> to interact with services.(Citation: Emissary Trojan Feb 2016)
- [S0638] Babuk: [Babuk](https://attack.mitre.org/software/S0638) can enumerate all services running on a compromised host.(Citation: McAfee Babuk February 2021)
- [S0015] Ixeshe: [Ixeshe](https://attack.mitre.org/software/S0015) can list running services.(Citation: Trend Micro IXESHE 2012)
- [S0615] SombRAT: [SombRAT](https://attack.mitre.org/software/S0615) can enumerate services on a victim machine.(Citation: BlackBerry CostaRicto November 2020)
- [S0219] WINERACK: [WINERACK](https://attack.mitre.org/software/S0219) can enumerate services.(Citation: FireEye APT37 Feb 2018)
- [S0091] Epic: [Epic](https://attack.mitre.org/software/S0091) uses the <code>tasklist /svc</code> command to list the services on the system.(Citation: Kaspersky Turla)
- [S0570] BitPaymer: [BitPaymer](https://attack.mitre.org/software/S0570) can enumerate existing Windows services on the host that are configured to run as LocalSystem.(Citation: Crowdstrike Indrik November 2018)
- [S0266] TrickBot: [TrickBot](https://attack.mitre.org/software/S0266) collects a list of install programs and services on the system’s machine.(Citation: S2 Grupo TrickBot June 2017)
- [S0201] JPIN: [JPIN](https://attack.mitre.org/software/S0201) can list running services.(Citation: Microsoft PLATINUM April 2016)
- [G0018] admin@338: [admin@338](https://attack.mitre.org/groups/G0018) actors used the following command following exploitation of a machine with [LOWBALL](https://attack.mitre.org/software/S0042) malware to obtain information about services: <code>net start >> %temp%\download</code>(Citation: FireEye admin@338)
- [C0012] Operation CuckooBees: During [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), the threat actors used the `net start` command as part of their initial reconnaissance.(Citation: Cybereason OperationCuckooBees May 2022)
- [S0024] Dyre: [Dyre](https://attack.mitre.org/software/S0024) has the ability to identify running services on a compromised host.(Citation: Malwarebytes Dyreza November 2015)
- [G0006] APT1: [APT1](https://attack.mitre.org/groups/G0006) used the commands <code>net start</code> and <code>tasklist</code> to get a listing of the services on the system.(Citation: Mandiant APT1)
- [S0412] ZxShell: [ZxShell](https://attack.mitre.org/software/S0412) can check the services on the system.(Citation: Talos ZxShell Oct 2014)
- [S0692] SILENTTRINITY: [SILENTTRINITY](https://attack.mitre.org/software/S0692) can search for modifiable services that could be used for privilege escalation.(Citation: GitHub SILENTTRINITY Modules July 2019)


### T1010 - Application Window Discovery

Description:

Adversaries may attempt to get a listing of open application windows. Window listings could convey information about how the system is used.(Citation: Prevailion DarkWatchman 2021) For example, information about application windows could be used identify potential data to collect as well as identifying security tooling ([Security Software Discovery](https://attack.mitre.org/techniques/T1518/001)) to evade.(Citation: ESET Grandoreiro April 2020)

Adversaries typically abuse system features for this type of enumeration. For example, they may gather information through native system features such as [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059) commands and [Native API](https://attack.mitre.org/techniques/T1106) functions.

Procedures:

- [S0438] Attor: [Attor](https://attack.mitre.org/software/S0438) can obtain application window titles and then determines which windows to perform Screen Capture on.(Citation: ESET Attor Oct 2019)
- [S0033] NetTraveler: [NetTraveler](https://attack.mitre.org/software/S0033) reports window names along with keylogger information to provide application context.(Citation: Kaspersky NetTraveler)
- [S0454] Cadelspy: [Cadelspy](https://attack.mitre.org/software/S0454) has the ability to identify open windows on the compromised host.(Citation: Symantec Chafer Dec 2015)
- [S0696] Flagpro: [Flagpro](https://attack.mitre.org/software/S0696) can check the name of the window displayed on the system.(Citation: NTT Security Flagpro new December 2021)
- [S0385] njRAT: [njRAT](https://attack.mitre.org/software/S0385) gathers information about opened windows during the initial infection.(Citation: Fidelis njRAT June 2013)
- [G0032] Lazarus Group: [Lazarus Group](https://attack.mitre.org/groups/G0032) malware IndiaIndia obtains and sends to its C2 server the title of the window for each running process. The KilaAlfa keylogger also reports the title of the window in the foreground.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: Novetta Blockbuster Tools)
- [S0094] Trojan.Karagany: [Trojan.Karagany](https://attack.mitre.org/software/S0094) can monitor the titles of open windows to identify specific keywords.(Citation: Secureworks Karagany July 2019)
- [S1111] DarkGate: [DarkGate](https://attack.mitre.org/software/S1111) will search for cryptocurrency wallets by examining application window names for specific strings.(Citation: Ensilo Darkgate 2018) [DarkGate](https://attack.mitre.org/software/S1111) extracts information collected via NirSoft tools from the hosting process's memory by first identifying the window through the <code>FindWindow</code> API function.(Citation: Ensilo Darkgate 2018)
- [S0673] DarkWatchman: [DarkWatchman](https://attack.mitre.org/software/S0673) reports window names along with keylogger information to provide application context.(Citation: Prevailion DarkWatchman 2021)
- [S0139] PowerDuke: [PowerDuke](https://attack.mitre.org/software/S0139) has a command to get text of the current foreground window.(Citation: Volexity PowerDuke November 2016)
- [S0260] InvisiMole: [InvisiMole](https://attack.mitre.org/software/S0260) can enumerate windows and child windows on a compromised host.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020)
- [S0456] Aria-body: [Aria-body](https://attack.mitre.org/software/S0456) has the ability to identify the titles of running windows on a compromised host.(Citation: CheckPoint Naikon May 2020)
- [S0531] Grandoreiro: [Grandoreiro](https://attack.mitre.org/software/S0531) can identify installed security tools based on window names.(Citation: ESET Grandoreiro April 2020)
- [S0219] WINERACK: [WINERACK](https://attack.mitre.org/software/S0219) can enumerate active windows.(Citation: FireEye APT37 Feb 2018)
- [S0409] Machete: [Machete](https://attack.mitre.org/software/S0409) saves the window names.(Citation: ESET Machete July 2019)
- [S1090] NightClub: [NightClub](https://attack.mitre.org/software/S1090) can use `GetForegroundWindow` to enumerate the active window.(Citation: MoustachedBouncer ESET August 2023)
- [S0198] NETWIRE: [NETWIRE](https://attack.mitre.org/software/S0198) can discover and close windows on controlled systems.(Citation: Red Canary NETWIRE January 2020)
- [S0265] Kazuar: [Kazuar](https://attack.mitre.org/software/S0265) gathers information about opened windows.(Citation: Unit 42 Kazuar May 2017)
- [S0375] Remexi: [Remexi](https://attack.mitre.org/software/S0375) has a command to capture active windows on the machine and retrieve window titles.(Citation: Securelist Remexi Jan 2019)
- [S1159] DUSTTRAP: [DUSTTRAP](https://attack.mitre.org/software/S1159) can enumerate running application windows.(Citation: Google Cloud APT41 2024)
- [S0157] SOUNDBITE: [SOUNDBITE](https://attack.mitre.org/software/S0157) is capable of enumerating application windows.(Citation: FireEye APT32 May 2017)
- [S0038] Duqu: The discovery modules used with [Duqu](https://attack.mitre.org/software/S0038) can collect information on open windows.(Citation: Symantec W32.Duqu)
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has collected window title information from compromised systems.(Citation: CISA AA24-038A PRC Critical Infrastructure February 2024)
- [S0431] HotCroissant: [HotCroissant](https://attack.mitre.org/software/S0431) has the ability to list the names of all open windows on the infected host.(Citation: Carbon Black HotCroissant April 2020)
- [S0455] Metamorfo: [Metamorfo](https://attack.mitre.org/software/S0455) can enumerate all windows on the victim’s machine.(Citation: FireEye Metamorfo Apr 2018)(Citation: Fortinet Metamorfo Feb 2020)
- [S0240] ROKRAT: [ROKRAT](https://attack.mitre.org/software/S0240) can use  the `GetForegroundWindow` and `GetWindowText` APIs to discover where the user is typing.(Citation: Talos ROKRAT)
- [S0692] SILENTTRINITY: [SILENTTRINITY](https://attack.mitre.org/software/S0692) can enumerate the active Window during keylogging through execution of `GetActiveWindowTitle`.(Citation: GitHub SILENTTRINITY Modules July 2019)
- [S0261] Catchamas: [Catchamas](https://attack.mitre.org/software/S0261) obtains application windows titles and then determines which windows to perform [Screen Capture](https://attack.mitre.org/techniques/T1113) on.(Citation: Symantec Catchamas April 2018)
- [S0650] QakBot: [QakBot](https://attack.mitre.org/software/S0650) has the ability to enumerate windows on a compromised host.(Citation: ATT QakBot April 2021)
- [G1001] HEXANE: [HEXANE](https://attack.mitre.org/groups/G1001) has used a PowerShell-based keylogging tool to capture the window title.(Citation: SecureWorks August 2019)
- [S0435] PLEAD: [PLEAD](https://attack.mitre.org/software/S0435) has the ability to list open windows on the compromised host.(Citation: TrendMicro BlackTech June 2017)(Citation: TrendMicro BlackTech June 2017)
- [S0012] PoisonIvy: [PoisonIvy](https://attack.mitre.org/software/S0012) captures window titles.(Citation: Symantec Darkmoon Aug 2005)
- [S1044] FunnyDream: [FunnyDream](https://attack.mitre.org/software/S1044) has the ability to discover application windows via execution of `EnumWindows`.(Citation: Bitdefender FunnyDream Campaign November 2020)


### T1012 - Query Registry

Description:

Adversaries may interact with the Windows Registry to gather information about the system, configuration, and installed software.

The Registry contains a significant amount of information about the operating system, configuration, software, and security.(Citation: Wikipedia Windows Registry) Information can easily be queried using the [Reg](https://attack.mitre.org/software/S0075) utility, though other means to access the Registry exist. Some of the information may help adversaries to further their operation within a network. Adversaries may use the information from [Query Registry](https://attack.mitre.org/techniques/T1012) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Procedures:

- [C0014] Operation Wocao: During [Operation Wocao](https://attack.mitre.org/campaigns/C0014), the threat actors executed `/c cd /d c:\windows\temp\ & reg query HKEY_CURRENT_USER\Software\<username>\PuTTY\Sessions\` to detect recent PuTTY sessions, likely to further lateral movement.(Citation: FoxIT Wocao December 2019)
- [S0091] Epic: [Epic](https://attack.mitre.org/software/S0091) uses the <code>rem reg query</code> command to obtain values from Registry keys.(Citation: Kaspersky Turla)
- [S1159] DUSTTRAP: [DUSTTRAP](https://attack.mitre.org/software/S1159) can enumerate Registry items.(Citation: Google Cloud APT41 2024)
- [S0589] Sibot: [Sibot](https://attack.mitre.org/software/S0589) has queried the registry for proxy server information.(Citation: MSTIC NOBELIUM Mar 2021)
- [S0512] FatDuke: [FatDuke](https://attack.mitre.org/software/S0512) can get user agent strings for the default browser from <code>HKCU\Software\Classes\http\shell\open\command</code>.(Citation: ESET Dukes October 2019)
- [S0203] Hydraq: [Hydraq](https://attack.mitre.org/software/S0203) creates a backdoor through which remote attackers can retrieve system information, such as CPU speed, from Registry keys.(Citation: Symantec Trojan.Hydraq Jan 2010)(Citation: Symantec Hydraq Jan 2010)
- [S1064] SVCReady: [SVCReady](https://attack.mitre.org/software/S1064) can search for the `HKEY_LOCAL_MACHINE\HARDWARE\DESCRIPTION\System` Registry key to gather system information.(Citation: HP SVCReady Jun 2022)
- [G0128] ZIRCONIUM: [ZIRCONIUM](https://attack.mitre.org/groups/G0128) has used a tool to query the Registry for proxy settings.(Citation: Zscaler APT31 Covid-19 October 2020)
- [S0560] TEARDROP: [TEARDROP](https://attack.mitre.org/software/S0560) checked that <code>HKU\SOFTWARE\Microsoft\CTF</code> existed before decoding its embedded payload.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: Microsoft Deep Dive Solorigate January 2021)
- [S0376] HOPLIGHT: A variant of [HOPLIGHT](https://attack.mitre.org/software/S0376) hooks lsass.exe, and lsass.exe then checks the Registry for the data value 'rdpproto' under the key <code>SYSTEM\CurrentControlSet\Control\Lsa Name</code>.(Citation: US-CERT HOPLIGHT Apr 2019)
- [S1019] Shark: [Shark](https://attack.mitre.org/software/S1019) can query `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography MachineGuid` to retrieve the machine GUID.(Citation: Accenture Lyceum Targets November 2021)
- [S1180] BlackByte Ransomware: [BlackByte Ransomware](https://attack.mitre.org/software/S1180) enumerates the Registry, specifically the `HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options` key.(Citation: Trustwave BlackByte 2021)
- [S0344] Azorult: [Azorult](https://attack.mitre.org/software/S0344) can check for installed software on the system under the Registry key <code>Software\Microsoft\Windows\CurrentVersion\Uninstall</code>.(Citation: Unit42 Azorult Nov 2018)
- [S0660] Clambling: [Clambling](https://attack.mitre.org/software/S0660) has the ability to enumerate Registry keys, including <code>KEY_CURRENT_USER\Software\Bitcoin\Bitcoin-Qt\strDataDir</code> to search for a bitcoin wallet.(Citation: Trend Micro DRBControl February 2020)(Citation: Talent-Jump Clambling February 2020)
- [S0180] Volgmer: [Volgmer](https://attack.mitre.org/software/S0180) checks the system for certain Registry keys.(Citation: US-CERT Volgmer 2 Nov 2017)
- [S0385] njRAT: [njRAT](https://attack.mitre.org/software/S0385) can read specific registry values.(Citation: Trend Micro njRAT 2018)
- [S0240] ROKRAT: [ROKRAT](https://attack.mitre.org/software/S0240) can access the <code>HKLM\System\CurrentControlSet\Services\mssmbios\Data\SMBiosData</code> Registry key to obtain the System manufacturer value to identify the machine type.(Citation: Talos Group123)
- [S0140] Shamoon: [Shamoon](https://attack.mitre.org/software/S0140) queries several Registry keys to identify hard disk partitions to overwrite.(Citation: Palo Alto Shamoon Nov 2016)
- [S0414] BabyShark: [BabyShark](https://attack.mitre.org/software/S0414) has executed the <code>reg query</code> command for <code>HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Default</code>.(Citation: Unit42 BabyShark Feb 2019)
- [S0354] Denis: [Denis](https://attack.mitre.org/software/S0354) queries the Registry for keys and values.(Citation: Cybereason Cobalt Kitty 2017)
- [S0194] PowerSploit: [PowerSploit](https://attack.mitre.org/software/S0194) contains a collection of Privesc-PowerUp modules that can query Registry keys for potential opportunities.(Citation: GitHub PowerSploit May 2012)(Citation: PowerSploit Documentation)
- [S0517] Pillowmint: [Pillowmint](https://attack.mitre.org/software/S0517) has used shellcode which reads code stored in the registry keys <code>\REGISTRY\SOFTWARE\Microsoft\DRM</code> using the native Windows API as well as read <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Tcpip\Parameters\Interfaces</code> as part of its C2.(Citation: Trustwave Pillowmint June 2020)
- [G0027] Threat Group-3390: A [Threat Group-3390](https://attack.mitre.org/groups/G0027) tool can read and decrypt stored Registry values.(Citation: Nccgroup Emissary Panda May 2018)
- [S0335] Carbon: [Carbon](https://attack.mitre.org/software/S0335) enumerates values in the Registry.(Citation: ESET Carbon Mar 2017)
- [G0032] Lazarus Group: [Lazarus Group](https://attack.mitre.org/groups/G0032) malware IndiaIndia checks Registry keys within HKCU and HKLM to determine if certain applications are present, including SecureCRT, Terminal Services, RealVNC, TightVNC, UltraVNC, Radmin, mRemote, TeamViewer, FileZilla, pcAnyware, and Remote Desktop. Another [Lazarus Group](https://attack.mitre.org/groups/G0032) malware sample checks for the presence of the following Registry key:<code>HKEY_CURRENT_USER\Software\Bitcoin\Bitcoin-Qt</code>.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: McAfee Lazarus Resurfaces Feb 2018)
- [S0030] Carbanak: [Carbanak](https://attack.mitre.org/software/S0030) checks the Registry key <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings</code> for proxy configurations information.(Citation: FireEye CARBANAK June 2017)
- [S0496] REvil: [REvil](https://attack.mitre.org/software/S0496) can query the Registry to get random file extensions to append to encrypted files.(Citation: Secureworks REvil September 2019)
- [S0680] LitePower: [LitePower](https://attack.mitre.org/software/S0680) can query the Registry for keys added to execute COM hijacking.(Citation: Kaspersky WIRTE November 2021)
- [S0201] JPIN: [JPIN](https://attack.mitre.org/software/S0201) can enumerate Registry keys.(Citation: Microsoft PLATINUM April 2016)
- [G0050] APT32: [APT32](https://attack.mitre.org/groups/G0050)'s backdoor can query the Windows Registry to gather system information. (Citation: ESET OceanLotus Mar 2019)
- [S0155] WINDSHIELD: [WINDSHIELD](https://attack.mitre.org/software/S0155) can gather Registry values.(Citation: FireEye APT32 May 2017)
- [S0013] PlugX: [PlugX](https://attack.mitre.org/software/S0013) can enumerate and query for information contained within the Windows Registry.(Citation: Lastline PlugX Analysis)(Citation: CIRCL PlugX March 2013)
- [G0035] Dragonfly: [Dragonfly](https://attack.mitre.org/groups/G0035) has queried the Registry to identify victim information.(Citation: US-CERT TA18-074A)
- [S1013] ZxxZ: [ZxxZ](https://attack.mitre.org/software/S1013) can search the registry of a compromised host.(Citation: Cisco Talos Bitter Bangladesh May 2022)
- [S0267] FELIXROOT: [FELIXROOT](https://attack.mitre.org/software/S0267) queries the Registry for specific keys for potential privilege escalation and proxy information. [FELIXROOT](https://attack.mitre.org/software/S0267) has also used WMI to query the Windows Registry.(Citation: FireEye FELIXROOT July 2018)(Citation: ESET GreyEnergy Oct 2018)
- [G0010] Turla: [Turla](https://attack.mitre.org/groups/G0010) surveys a system upon check-in to discover information in the Windows Registry with the <code>reg query</code> command.(Citation: Kaspersky Turla) [Turla](https://attack.mitre.org/groups/G0010) has also retrieved PowerShell payloads hidden in Registry keys as well as checking keys associated with null session named pipes .(Citation: ESET Turla PowerShell May 2019)
- [S0186] DownPaper: [DownPaper](https://attack.mitre.org/software/S0186) searches and reads the value of the Windows Update Registry Run key.(Citation: ClearSky Charming Kitten Dec 2017)
- [S0075] Reg: [Reg](https://attack.mitre.org/software/S0075) may be used to gather details from the Windows Registry of a local or remote system at the command-line interface.(Citation: Microsoft Reg)
- [S0031] BACKSPACE: [BACKSPACE](https://attack.mitre.org/software/S0031) is capable of enumerating and making modifications to an infected system's Registry.(Citation: FireEye APT30)
- [S0513] LiteDuke: [LiteDuke](https://attack.mitre.org/software/S0513) can query the Registry to check for the presence of <code>HKCU\Software\KasperskyLab</code>.(Citation: ESET Dukes October 2019)
- [S0412] ZxShell: [ZxShell](https://attack.mitre.org/software/S0412) can query the netsvc group value data located in the svchost group Registry key.(Citation: Talos ZxShell Oct 2014)
- [S0011] Taidoor: [Taidoor](https://attack.mitre.org/software/S0011) can query the Registry on compromised hosts using <code>RegQueryValueExA</code>.(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021)
- [S1018] Saint Bot: [Saint Bot](https://attack.mitre.org/software/S1018) has used `check_registry_keys` as part of its environmental checks.(Citation: Malwarebytes Saint Bot April 2021)
- [S0165] OSInfo: [OSInfo](https://attack.mitre.org/software/S0165) queries the registry to look for information about Terminal Services.(Citation: Symantec Buckeye)
- [G0094] Kimsuky: [Kimsuky](https://attack.mitre.org/groups/G0094) has obtained specific Registry keys and values on a compromised host.(Citation: Talos Kimsuky Nov 2021)
- [S0242] SynAck: [SynAck](https://attack.mitre.org/software/S0242) enumerates Registry keys associated with event logs.(Citation: SecureList SynAck Doppelgänging May 2018)
- [S0022] Uroburos: [Uroburos](https://attack.mitre.org/software/S0022) can query the Registry, typically `HKLM:\SOFTWARE\Classes\.wav\OpenWithProgIds`, to find the key and path to decrypt and load its kernel driver and kernel driver loader.(Citation: Joint Cybersecurity Advisory AA23-129A Snake Malware May 2023)
- [S0567] Dtrack: [Dtrack](https://attack.mitre.org/software/S0567) can collect the RegisteredOwner, RegisteredOrganization, and InstallDate registry values.(Citation: CyberBit Dtrack)
- [S1015] Milan: [Milan](https://attack.mitre.org/software/S1015) can query `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography MachineGuid` to retrieve the machine GUID.(Citation: Accenture Lyceum Targets November 2021)
- [G0038] Stealth Falcon: [Stealth Falcon](https://attack.mitre.org/groups/G0038) malware attempts to determine the installed version of .NET by querying the Registry.(Citation: Citizen Lab Stealth Falcon May 2016)
- [S0534] Bazar: [Bazar](https://attack.mitre.org/software/S0534) can query <code>Windows\CurrentVersion\Uninstall</code> for installed applications.(Citation: Cybereason Bazar July 2020)(Citation: NCC Group Team9 June 2020)
- [S0692] SILENTTRINITY: [SILENTTRINITY](https://attack.mitre.org/software/S0692) can use the `GetRegValue` function to check Registry keys within `HKCU\Software\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated` and `HKLM\Software\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated`. It also contains additional modules that can check software AutoRun values and use the Win32 namespace to get values from HKCU, HKLM, HKCR, and HKCC hives.(Citation: GitHub SILENTTRINITY Modules July 2019)
- [S0239] Bankshot: [Bankshot](https://attack.mitre.org/software/S0239) searches for certain Registry keys to be configured before executing the payload.(Citation: US-CERT Bankshot Dec 2017)
- [S0673] DarkWatchman: [DarkWatchman](https://attack.mitre.org/software/S0673) can query the Registry to determine if it has already been installed on the system.(Citation: Prevailion DarkWatchman 2021)
- [S0182] FinFisher: [FinFisher](https://attack.mitre.org/software/S0182) queries Registry values as part of its anti-sandbox checks.(Citation: FinFisher Citation)(Citation: Microsoft FinFisher March 2018)
- [S1060] Mafalda: [Mafalda](https://attack.mitre.org/software/S1060) can enumerate Registry keys with all subkeys and values.(Citation: SentinelLabs Metador Technical Appendix Sept 2022)
- [S0570] BitPaymer: [BitPaymer](https://attack.mitre.org/software/S0570) can use the RegEnumKeyW to iterate through Registry keys.(Citation: Crowdstrike Indrik November 2018)
- [S0032] gh0st RAT: [gh0st RAT](https://attack.mitre.org/software/S0032) has checked for the existence of a Service key to determine if it has already been installed on the system.(Citation: Gh0stRAT ATT March 2019)
- [S0348] Cardinal RAT: [Cardinal RAT](https://attack.mitre.org/software/S0348) contains watchdog functionality that periodically ensures <code>HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows\Load</code> is set to point to its executable.(Citation: PaloAlto CardinalRat Apr 2017)
- [S1044] FunnyDream: [FunnyDream](https://attack.mitre.org/software/S1044) can check `Software\Microsoft\Windows\CurrentVersion\Internet Settings` to extract the `ProxyServer` string.(Citation: Bitdefender FunnyDream Campaign November 2020)
- [S0484] Carberp: [Carberp](https://attack.mitre.org/software/S0484) has searched the Image File Execution Options registry key for "Debugger" within every subkey.(Citation: Prevx Carberp March 2011)
- [S0154] Cobalt Strike: [Cobalt Strike](https://attack.mitre.org/software/S0154) can query <code>HKEY_CURRENT_USER\Software\Microsoft\Office\<Excel Version>\Excel\Security\AccessVBOM\</code>  to determine if the security setting for restricting default programmatic access is enabled.(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020)
- [S0579] Waterbear: [Waterbear](https://attack.mitre.org/software/S0579) can query the Registry key <code>"HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSDTC\MTxOCI"</code> to see if the value `OracleOcilib` exists.(Citation: Trend Micro Waterbear December 2019)
- [S0612] WastedLocker: [WastedLocker](https://attack.mitre.org/software/S0612) checks for specific registry keys related to the <code>UCOMIEnumConnections</code> and <code>IActiveScriptParseProcedure32</code> interfaces.(Citation: NCC Group WastedLocker June 2020)
- [S0574] BendyBear: [BendyBear](https://attack.mitre.org/software/S0574) can query the host's Registry key at <code>HKEY_CURRENT_USER\Console\QuickEdit</code> to retrieve data.(Citation: Unit42 BendyBear Feb 2021)
- [G1043] BlackByte: [BlackByte](https://attack.mitre.org/groups/G1043) queried registry values to determine system language settings.(Citation: Picus BlackByte 2022)
- [S1047] Mori: [Mori](https://attack.mitre.org/software/S1047) can read data from the Registry including from `HKLM\Software\NFC\IPA` and
`HKLM\Software\NFC\`.(Citation: DHS CISA AA22-055A MuddyWater February 2022)
- [S0145] POWERSOURCE: [POWERSOURCE](https://attack.mitre.org/software/S0145) queries Registry keys in preparation for setting Run keys to achieve persistence.(Citation: Cisco DNSMessenger March 2017)
- [S1190] Kapeka: [Kapeka](https://attack.mitre.org/software/S1190) queries registry values for stored configuration information.(Citation: WithSecure Kapeka 2024)
- [S0045] ADVSTORESHELL: [ADVSTORESHELL](https://attack.mitre.org/software/S0045) can enumerate registry keys.(Citation: ESET Sednit Part 2)(Citation: Bitdefender APT28 Dec 2015)
- [S1050] PcShare: [PcShare](https://attack.mitre.org/software/S1050) can search the registry files of a compromised host.(Citation: Bitdefender FunnyDream Campaign November 2020)
- [S0386] Ursnif: [Ursnif](https://attack.mitre.org/software/S0386) has used [Reg](https://attack.mitre.org/software/S0075) to query the Registry for installed programs.(Citation: TrendMicro Ursnif Mar 2015)(Citation: TrendMicro BKDR_URSNIF.SM)
- [S0268] Bisonal: [Bisonal](https://attack.mitre.org/software/S0268) has used the RegQueryValueExA function to retrieve proxy information in the Registry.(Citation: Talos Bisonal Mar 2020)
- [S0252] Brave Prince: [Brave Prince](https://attack.mitre.org/software/S0252) gathers information about the Registry.(Citation: McAfee Gold Dragon)
- [S1039] Bumblebee: [Bumblebee](https://attack.mitre.org/software/S1039) can check the Registry for specific keys.(Citation: Medium Ali Salem Bumblebee April 2022)
- [S0476] Valak: [Valak](https://attack.mitre.org/software/S0476) can use the Registry for code updates and to collect credentials.(Citation: Unit 42 Valak July 2020)
- [S0668] TinyTurla: [TinyTurla](https://attack.mitre.org/software/S0668) can query the Registry for its configuration information.(Citation: Talos TinyTurla September 2021)
- [S0126] ComRAT: [ComRAT](https://attack.mitre.org/software/S0126) can check the default browser by querying <code>HKCR\http\shell\open\command</code>.(Citation: ESET ComRAT May 2020)
- [S0380] StoneDrill: [StoneDrill](https://attack.mitre.org/software/S0380) has looked in the registry to find the default browser path.(Citation: Kaspersky StoneDrill 2017)
- [G0117] Fox Kitten: [Fox Kitten](https://attack.mitre.org/groups/G0117) has accessed Registry hives ntuser.dat and UserClass.dat.(Citation: CISA AA20-259A Iran-Based Actor September 2020)
- [S1148] Raccoon Stealer: [Raccoon Stealer](https://attack.mitre.org/software/S1148) queries the Windows Registry to fingerprint the infected host via the `HKLM:\SOFTWARE\Microsoft\Cryptography\MachineGuid` key.(Citation: Sekoia Raccoon1 2022)(Citation: Sekoia Raccoon2 2022)
- [S0241] RATANKBA: [RATANKBA](https://attack.mitre.org/software/S0241) uses the command <code>reg query “HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\InternetSettings”</code>.(Citation: RATANKBA)
- [S1201] TRANSLATEXT: [TRANSLATEXT](https://attack.mitre.org/software/S1201) has queried the following registry key to check for installed Chrome extensions: ` HKCU\Software\Policies\Google\Chrome\ExtensionInstallForcelist `.(Citation: Zscaler Kimsuky TRANSLATEXT)
- [S0269] QUADAGENT: [QUADAGENT](https://attack.mitre.org/software/S0269) checks if a value exists within a Registry key in the HKCU hive whose name is the same as the scheduled task it has created.(Citation: Unit 42 QUADAGENT July 2018)
- [G0087] APT39: [APT39](https://attack.mitre.org/groups/G0087) has used various strains of malware to query the Registry.(Citation: FBI FLASH APT39 September 2020)
- [S1099] Samurai: [Samurai](https://attack.mitre.org/software/S1099) can query `SOFTWARE\Microsoft\.NETFramework\policy\v2.0` for discovery.(Citation: Kaspersky ToddyCat June 2022)
- [G0114] Chimera: [Chimera](https://attack.mitre.org/groups/G0114) has queried Registry keys using <code>reg query \\<host>\HKU\<SID>\SOFTWARE\Microsoft\Terminal Server Client\Servers</code> and <code>reg query \\<host>\HKU\<SID>\Software\Microsoft\Windows\CurrentVersion\Internet Settings</code>.(Citation: NCC Group Chimera January 2021)
- [S0251] Zebrocy: [Zebrocy](https://attack.mitre.org/software/S0251) executes the <code>reg query</code> command to obtain information in the Registry.(Citation: ESET Zebrocy May 2019)
- [S0666] Gelsemium: [Gelsemium](https://attack.mitre.org/software/S0666) can open random files and Registry keys to obscure malware behavior from sandbox analysis.(Citation: ESET Gelsemium June 2021)
- [S0603] Stuxnet: [Stuxnet](https://attack.mitre.org/software/S0603) searches the Registry for indicators of security programs.(Citation: Nicolas Falliere, Liam O Murchu, Eric Chien February 2011)
- [S0238] Proxysvc: [Proxysvc](https://attack.mitre.org/software/S0238) gathers product names from the Registry key: <code>HKLM\Software\Microsoft\Windows NT\CurrentVersion ProductName</code> and the processor description from the Registry key <code>HKLM\HARDWARE\DESCRIPTION\System\CentralProcessor\0 ProcessorNameString</code>.(Citation: McAfee GhostSecret)
- [S0559] SUNBURST: [SUNBURST](https://attack.mitre.org/software/S0559) collected the registry value <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography\MachineGuid</code> from compromised hosts.(Citation: FireEye SUNBURST Backdoor December 2020)
- [S0184] POWRUNER: [POWRUNER](https://attack.mitre.org/software/S0184) may query the Registry by running <code>reg query</code> on a victim.(Citation: FireEye APT34 Dec 2017)
- [S0330] Zeus Panda: [Zeus Panda](https://attack.mitre.org/software/S0330) checks for the existence of a Registry key and if it contains certain values.(Citation: GDATA Zeus Panda June 2017)
- [G0096] APT41: [APT41](https://attack.mitre.org/groups/G0096) queried registry values to determine items such as configured RDP ports and network configurations.(Citation: Rostovcev APT41 2021)
- [G1034] Daggerfly: [Daggerfly](https://attack.mitre.org/groups/G1034) used [Reg](https://attack.mitre.org/software/S0075) to dump the Security Account Manager (SAM), System, and Security Windows registry hives from victim machines.(Citation: Symantec Daggerfly 2023)
- [S0448] Rising Sun: [Rising Sun](https://attack.mitre.org/software/S0448) has identified the OS product name from a compromised host by searching the registry for `SOFTWARE\MICROSOFT\Windows NT\ CurrentVersion | ProductName`.(Citation: McAfee Sharpshooter December 2018)
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has queried the Registry on compromised systems, `reg query hklm\software\`, for information on installed software including PuTTY.(Citation: Joint Cybersecurity Advisory Volt Typhoon June 2023)(Citation: CISA AA24-038A PRC Critical Infrastructure February 2024)
- [S0115] Crimson: [Crimson](https://attack.mitre.org/software/S0115) can check the Registry for the presence of <code>HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\last_edate</code> to determine how long it has been installed on a host.(Citation: Proofpoint Operation Transparent Tribe March 2016)
- [G0049] OilRig: [OilRig](https://attack.mitre.org/groups/G0049) has used <code>reg query “HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Default”</code> on a victim to query the Registry.(Citation: Palo Alto OilRig May 2016)
- [G0119] Indrik Spider: [Indrik Spider](https://attack.mitre.org/groups/G0119) has used a service account to extract copies of the `Security` Registry hive.(Citation: Mandiant_UNC2165)
- [S1065] Woody RAT: [Woody RAT](https://attack.mitre.org/software/S1065) can search registry keys to identify antivirus programs on an compromised host.(Citation: MalwareBytes WoodyRAT Aug 2022)
- [S1076] QUIETCANARY: [QUIETCANARY](https://attack.mitre.org/software/S1076) has the ability to retrieve information from the Registry.(Citation: Mandiant Suspected Turla Campaign February 2023)
- [S0627] SodaMaster: [SodaMaster](https://attack.mitre.org/software/S0627) has the ability to query the Registry to detect a key specific to VMware.(Citation: Securelist APT10 March 2021)
- [S0021] Derusbi: [Derusbi](https://attack.mitre.org/software/S0021) is capable of enumerating Registry keys and values.(Citation: FireEye Periscope March 2018)
- [S0674] CharmPower: [CharmPower](https://attack.mitre.org/software/S0674) has the ability to enumerate `Uninstall` registry values.(Citation: Check Point APT35 CharmPower January 2022)
- [S0172] Reaver: [Reaver](https://attack.mitre.org/software/S0172) queries the Registry to determine the correct Startup path to use for persistence.(Citation: Palo Alto Reaver Nov 2017)
- [S0023] CHOPSTICK: [CHOPSTICK](https://attack.mitre.org/software/S0023) provides access to the Windows Registry, which can be used to gather information.(Citation: FireEye APT28)
- [S0604] Industroyer: [Industroyer](https://attack.mitre.org/software/S0604) has a data wiper component that enumerates keys in the Registry <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services</code>.(Citation: ESET Industroyer)
- [S0249] Gold Dragon: [Gold Dragon](https://attack.mitre.org/software/S0249) enumerates registry keys with the command <code>regkeyenum</code> and obtains information for the Registry key <code>HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</code>.(Citation: McAfee Gold Dragon)
- [S0532] Lucifer: [Lucifer](https://attack.mitre.org/software/S0532) can check for existing stratum cryptomining information in <code>HKLM\Software\Microsoft\Windows\CurrentVersion\spreadCpuXmr – %stratum info%</code>.(Citation: Unit 42 Lucifer June 2020)
- [S0438] Attor: [Attor](https://attack.mitre.org/software/S0438) has opened the registry and performed query searches.(Citation: ESET Attor Oct 2019)
- [S0260] InvisiMole: [InvisiMole](https://attack.mitre.org/software/S0260) can enumerate Registry values, keys, and data.(Citation: ESET InvisiMole June 2018)
- [G0030] Lotus Blossom: [Lotus Blossom](https://attack.mitre.org/groups/G0030) has run commands such as `reg query HKLM\SYSTEM\CurrentControlSet\Services\[service name]\Parameters` to verify if installed implants are running as a service.(Citation: Cisco LotusBlossom 2025)


### T1016 - System Network Configuration Discovery

Description:

Adversaries may look for details about the network configuration and settings, such as IP and/or MAC addresses, of systems they access or through information discovery of remote systems. Several operating system administration utilities exist that can be used to gather this information. Examples include [Arp](https://attack.mitre.org/software/S0099), [ipconfig](https://attack.mitre.org/software/S0100)/[ifconfig](https://attack.mitre.org/software/S0101), [nbtstat](https://attack.mitre.org/software/S0102), and [route](https://attack.mitre.org/software/S0103).

Adversaries may also leverage a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) on network devices to gather information about configurations and settings, such as IP addresses of configured interfaces and static/dynamic routes (e.g. <code>show ip route</code>, <code>show ip interface</code>).(Citation: US-CERT-TA18-106A)(Citation: Mandiant APT41 Global Intrusion ) On ESXi, adversaries may leverage esxcli to gather network configuration information. For example, the command `esxcli network nic list` will retrieve the MAC address, while `esxcli network ip interface ipv4 get` will retrieve the local IPv4 address.(Citation: Trellix Rnasomhouse 2024)

Adversaries may use the information from [System Network Configuration Discovery](https://attack.mitre.org/techniques/T1016) during automated discovery to shape follow-on behaviors, including determining certain access within the target network and what actions to do next.

Procedures:

- [S0569] Explosive: [Explosive](https://attack.mitre.org/software/S0569) has collected the MAC address from the victim's machine.(Citation: CheckPoint Volatile Cedar March 2015)
- [S0667] Chrommme: [Chrommme](https://attack.mitre.org/software/S0667) can enumerate the IP address of a compromised host.(Citation: ESET Gelsemium June 2021)
- [S0101] ifconfig: [ifconfig](https://attack.mitre.org/software/S0101) can be used to display adapter configuration on Unix systems, including information for TCP/IP, DNS, and DHCP.
- [G1001] HEXANE: [HEXANE](https://attack.mitre.org/groups/G1001) has used [Ping](https://attack.mitre.org/software/S0097) and `tracert` for network discovery.(Citation: Kaspersky Lyceum October 2021)
- [S0603] Stuxnet: [Stuxnet](https://attack.mitre.org/software/S0603) collects the IP address of a compromised system.(Citation: Nicolas Falliere, Liam O Murchu, Eric Chien February 2011)
- [G0129] Mustang Panda: [Mustang Panda](https://attack.mitre.org/groups/G0129) has used <code>ipconfig</code> and <code>arp</code> to determine network configuration information.(Citation: Avira Mustang Panda January 2020)
- [S0024] Dyre: [Dyre](https://attack.mitre.org/software/S0024) has the ability to identify network settings on a compromised host.(Citation: Malwarebytes Dyreza November 2015)
- [S0365] Olympic Destroyer: [Olympic Destroyer](https://attack.mitre.org/software/S0365) uses API calls to enumerate the infected system's ARP table.(Citation: Talos Olympic Destroyer 2018)
- [S0250] Koadic: [Koadic](https://attack.mitre.org/software/S0250) can retrieve the contents of the IP routing table as well as information about the Windows domain.(Citation: Github Koadic)(Citation: MalwareBytes LazyScripter Feb 2021)
- [S1145] Pikabot: [Pikabot](https://attack.mitre.org/software/S1145) gathers victim network information through commands such as <code>ipconfig</code> and <code>ipconfig /all</code>.(Citation: Zscaler Pikabot 2023)
- [S0098] T9000: [T9000](https://attack.mitre.org/software/S0098) gathers and beacons the MAC and IP addresses during installation.(Citation: Palo Alto T9000 Feb 2016)
- [S0532] Lucifer: [Lucifer](https://attack.mitre.org/software/S0532) can collect the IP address of a compromised host.(Citation: Unit 42 Lucifer June 2020)
- [S1022] IceApple: The [IceApple](https://attack.mitre.org/software/S1022) [ifconfig](https://attack.mitre.org/software/S0101) module can iterate over all network interfaces on the host and retrieve the name, description, MAC address, DNS suffix, DNS servers, gateways, IPv4 addresses, and subnet masks.(Citation: CrowdStrike IceApple May 2022)
- [S0657] BLUELIGHT: [BLUELIGHT](https://attack.mitre.org/software/S0657) can collect IP information from the victim’s machine.(Citation: Volexity InkySquid BLUELIGHT August 2021)
- [S0363] Empire: [Empire](https://attack.mitre.org/software/S0363) can acquire network configuration information like DNS servers, public IP, and network proxies used by a host.(Citation: Github PowerShell Empire)(Citation: Talos Frankenstein June 2019)
- [S0257] VERMIN: [VERMIN](https://attack.mitre.org/software/S0257) gathers the local IP address.(Citation: Unit 42 VERMIN Jan 2018)
- [S0378] PoshC2: [PoshC2](https://attack.mitre.org/software/S0378) can enumerate network adapter information.(Citation: GitHub PoshC2)
- [S0387] KeyBoy: [KeyBoy](https://attack.mitre.org/software/S0387) can determine the public or WAN IP address for the system.(Citation: PWC KeyBoys Feb 2017)
- [S0184] POWRUNER: [POWRUNER](https://attack.mitre.org/software/S0184) may collect network configuration data by running <code>ipconfig /all</code> on a victim.(Citation: FireEye APT34 Dec 2017)
- [G1040] Play: [Play](https://attack.mitre.org/groups/G1040) has used the information-stealing tool Grixba to enumerate network information.(Citation: CISA Play Ransomware Advisory December 2023)
- [G1043] BlackByte: [BlackByte](https://attack.mitre.org/groups/G1043) used tools such as [Arp](https://attack.mitre.org/software/S0099) to pull system network information and identify connected devices.(Citation: FBI BlackByte 2022)(Citation: Microsoft BlackByte 2023)
- [S0139] PowerDuke: [PowerDuke](https://attack.mitre.org/software/S0139) has a command to get the victim's domain and NetBIOS name.(Citation: Volexity PowerDuke November 2016)
- [S1210] Sagerunex: [Sagerunex](https://attack.mitre.org/software/S1210) will gather system information such as MAC and IP addresses.(Citation: Cisco LotusBlossom 2025)
- [S0271] KEYMARBLE: [KEYMARBLE](https://attack.mitre.org/software/S0271) gathers the MAC address of the victim’s machine.(Citation: US-CERT KEYMARBLE Aug 2018)
- [S0154] Cobalt Strike: [Cobalt Strike](https://attack.mitre.org/software/S0154) can determine the NetBios name and  the IP addresses of targets machines including domain controllers.(Citation: Cyberreason Anchor December 2019)(Citation: Cobalt Strike Manual 4.3 November 2020)
- [S0336] NanoCore: [NanoCore](https://attack.mitre.org/software/S0336) gathers the IP address from the victim’s machine.(Citation: DigiTrust NanoCore Jan 2017)
- [S0583] Pysa: [Pysa](https://attack.mitre.org/software/S0583) can perform network reconnaissance using the Advanced IP Scanner tool.(Citation: CERT-FR PYSA April 2020)
- [S0458] Ramsay: [Ramsay](https://attack.mitre.org/software/S0458) can use [ipconfig](https://attack.mitre.org/software/S0100) and [Arp](https://attack.mitre.org/software/S0099) to collect network configuration information, including routing information and ARP tables.(Citation: Antiy CERT Ramsay April 2020)
- [S1085] Sardonic: [Sardonic](https://attack.mitre.org/software/S1085) has the ability to execute the `ipconfig` command.(Citation: Bitdefender Sardonic Aug 2021)
- [S0237] GravityRAT: [GravityRAT](https://attack.mitre.org/software/S0237) collects the victim IP address, MAC address, as well as the victim account domain name.(Citation: Talos GravityRAT)
- [S0044] JHUHUGIT: A [JHUHUGIT](https://attack.mitre.org/software/S0044) variant gathers network interface card information.(Citation: Unit 42 Playbook Dec 2017)
- [G0035] Dragonfly: [Dragonfly](https://attack.mitre.org/groups/G0035) has used batch scripts to enumerate network information, including information about trusts, zones, and the domain.(Citation: US-CERT TA18-074A)
- [G0018] admin@338: [admin@338](https://attack.mitre.org/groups/G0018) actors used the following command after exploiting a machine with [LOWBALL](https://attack.mitre.org/software/S0042) malware to acquire information about local networks: <code>ipconfig /all >> %temp%\download</code>(Citation: FireEye admin@338)
- [S1160] Latrodectus: [Latrodectus](https://attack.mitre.org/software/S1160) can discover the IP and MAC address of a targeted host.(Citation: Elastic Latrodectus May 2024)(Citation: Bitsight Latrodectus June 2024)
- [S0278] iKitten: [iKitten](https://attack.mitre.org/software/S0278) will look for the current IP address.(Citation: objsee mac malware 2017)
- [S0082] Emissary: [Emissary](https://attack.mitre.org/software/S0082) has the capability to execute the command <code>ipconfig /all</code>.(Citation: Emissary Trojan Feb 2016)
- [S0590] NBTscan: [NBTscan](https://attack.mitre.org/software/S0590) can be used to collect MAC addresses.(Citation: Debian nbtscan Nov 2019)(Citation: SecTools nbtscan June 2003)
- [S1020] Kevin: [Kevin](https://attack.mitre.org/software/S1020) can collect the MAC address and other information from a victim machine using `ipconfig/all`.(Citation: Kaspersky Lyceum October 2021)
- [G0030] Lotus Blossom: [Lotus Blossom](https://attack.mitre.org/groups/G0030) has used commands such as `ipconfig` and `netstat` to gather network information on compromised hosts.(Citation: Cisco LotusBlossom 2025)
- [G1009] Moses Staff: [Moses Staff](https://attack.mitre.org/groups/G1009) has collected the domain name of a compromised network.(Citation: Checkpoint MosesStaff Nov 2021)
- [S1018] Saint Bot: [Saint Bot](https://attack.mitre.org/software/S1018) can collect the IP address of a victim machine.(Citation: Malwarebytes Saint Bot April 2021)
- [S0352] OSX_OCEANLOTUS.D: [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) can collect the network interface MAC address on the infected host.(Citation: TrendMicro MacOS April 2018)(Citation: Trend Micro MacOS Backdoor November 2020)
- [S0356] KONNI: [KONNI](https://attack.mitre.org/software/S0356) can collect the IP address from the victim’s machine.(Citation: Talos Konni May 2017)
- [S0433] Rifdoor: [Rifdoor](https://attack.mitre.org/software/S0433) has the ability to identify the IP address of the compromised host.(Citation: Carbon Black HotCroissant April 2020)
- [S0201] JPIN: [JPIN](https://attack.mitre.org/software/S0201) can obtain network information, including DNS, IP, and proxies.(Citation: Microsoft PLATINUM April 2016)
- [S1050] PcShare: [PcShare](https://attack.mitre.org/software/S1050) can obtain the proxy settings of a compromised machine using `InternetQueryOptionA` and its IP address by running `nslookup myip.opendns.comresolver1.opendns.com\r\n`.(Citation: Bitdefender FunnyDream Campaign November 2020)
- [S1196] Troll Stealer: [Troll Stealer](https://attack.mitre.org/software/S1196) collects the MAC address of victim devices.(Citation: S2W Troll Stealer 2024)
- [S0346] OceanSalt: [OceanSalt](https://attack.mitre.org/software/S0346) can collect the victim’s IP address.(Citation: McAfee Oceansalt Oct 2018)
- [S1143] LunarLoader: [LunarLoader](https://attack.mitre.org/software/S1143) can verify the targeted host's DNS name which is then used in the creation of a decyrption key.(Citation: ESET Turla Lunar toolset May 2024)
- [S0622] AppleSeed: [AppleSeed](https://attack.mitre.org/software/S0622) can identify the IP of a targeted system.(Citation: Malwarebytes Kimsuky June 2021)
- [C0012] Operation CuckooBees: During [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), the threat actors used `ipconfig`, `nbtstat`, `tracert`, `route print`, and `cat /etc/hosts` commands.(Citation: Cybereason OperationCuckooBees May 2022)
- [S0331] Agent Tesla: [Agent Tesla](https://attack.mitre.org/software/S0331) can collect the IP address of the victim machine and spawn instances of netsh.exe to enumerate wireless settings.(Citation: DigiTrust Agent Tesla Jan 2017)(Citation: SentinelLabs Agent Tesla Aug 2020)
- [C0017] C0017: During [C0017](https://attack.mitre.org/campaigns/C0017), [APT41](https://attack.mitre.org/groups/G0096) used `cmd.exe /c ping %userdomain%` for discovery.(Citation: Mandiant APT41)
- [S1015] Milan: [Milan](https://attack.mitre.org/software/S1015) can run `C:\Windows\system32\cmd.exe /c cmd /c ipconfig /all 2>&1` to discover network settings.(Citation: ClearSky Siamesekitten August 2021)
- [G0073] APT19: [APT19](https://attack.mitre.org/groups/G0073) used an HTTP malware variant and a Port 22 malware variant to collect the MAC address and IP address from the victim’s machine.(Citation: Unit 42 C0d0so0 Jan 2016)
- [S0513] LiteDuke: [LiteDuke](https://attack.mitre.org/software/S0513) has the ability to discover the proxy configuration of Firefox and/or Opera.(Citation: ESET Dukes October 2019)
- [S0081] Elise: [Elise](https://attack.mitre.org/software/S0081) executes <code>ipconfig /all</code> after initial communication is made to the remote server.(Citation: Lotus Blossom Jun 2015)(Citation: Accenture Dragonfish Jan 2018)
- [G1016] FIN13: [FIN13](https://attack.mitre.org/groups/G1016) has used `nslookup` and `ipconfig` for network reconnaissance efforts. [FIN13](https://attack.mitre.org/groups/G1016) has also utilized a compromised Symantec Altiris console and LanDesk account to retrieve network information.(Citation: Mandiant FIN13 Aug 2022)(Citation: Sygnia Elephant Beetle Jan 2022)
- [S0274] Calisto: [Calisto](https://attack.mitre.org/software/S0274) runs the <code>ifconfig</code> command to obtain the IP address from the victim’s machine.(Citation: Securelist Calisto July 2018)
- [S0491] StrongPity: [StrongPity](https://attack.mitre.org/software/S0491) can identify the IP address of a compromised host.(Citation: Talos Promethium June 2020)
- [S0572] Caterpillar WebShell: [Caterpillar WebShell](https://attack.mitre.org/software/S0572) can gather the IP address from the victim's machine using the IP config command.(Citation: ClearSky Lebanese Cedar Jan 2021)
- [S0439] Okrum: [Okrum](https://attack.mitre.org/software/S0439) can collect network information, including the host IP address, DNS, and proxy information.(Citation: ESET Okrum July 2019)
- [S0084] Mis-Type: [Mis-Type](https://attack.mitre.org/software/S0084) may create a file containing the results of the command <code>cmd.exe /c ipconfig /all</code>.(Citation: Cylance Dust Storm)
- [S0456] Aria-body: [Aria-body](https://attack.mitre.org/software/S0456) has the ability to identify the location, public IP address, and domain name on a compromised host.(Citation: CheckPoint Naikon May 2020)
- [S1156] Manjusaka: [Manjusaka](https://attack.mitre.org/software/S1156) gathers information about current network connections, local and remote addresses associated with them, and associated processes.(Citation: Talos Manjusaka 2022)
- [S0270] RogueRobin: [RogueRobin](https://attack.mitre.org/software/S0270) gathers the IP address and domain from the victim’s machine.(Citation: Unit 42 DarkHydrus July 2018)
- [S0512] FatDuke: [FatDuke](https://attack.mitre.org/software/S0512) can identify the MAC address on the target computer.(Citation: ESET Dukes October 2019)
- [S1016] MacMa: [MacMa](https://attack.mitre.org/software/S1016) can collect IP addresses from a compromised host.(Citation: ESET DazzleSpy Jan 2022)
- [S0228] NanHaiShu: [NanHaiShu](https://attack.mitre.org/software/S0228) can gather information about the victim proxy server.(Citation: Proofpoint Leviathan Oct 2017)
- [S0203] Hydraq: [Hydraq](https://attack.mitre.org/software/S0203) creates a backdoor through which remote attackers can retrieve IP addresses of compromised machines.(Citation: Symantec Trojan.Hydraq Jan 2010)(Citation: Symantec Hydraq Jan 2010)
- [S0113] Prikormka: A module in [Prikormka](https://attack.mitre.org/software/S0113) collects information from the victim about its IP addresses and MAC addresses.(Citation: ESET Operation Groundbait)
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has executed multiple commands to enumerate network topology and settings including  `ipconfig`, `netsh interface firewall show all`, and `netsh interface portproxy show all`.(Citation: Joint Cybersecurity Advisory Volt Typhoon June 2023)
- [S0244] Comnie: [Comnie](https://attack.mitre.org/software/S0244) uses <code>ipconfig /all</code> and <code>route PRINT</code> to identify network adapter and interface information.(Citation: Palo Alto Comnie)
- [S1100] Ninja: [Ninja](https://attack.mitre.org/software/S1100) can enumerate the IP address on compromised systems.(Citation: Kaspersky ToddyCat June 2022)
- [G0032] Lazarus Group: [Lazarus Group](https://attack.mitre.org/groups/G0032) malware IndiaIndia obtains and sends to its C2 server information about the first network interface card’s configuration, including IP address, gateways, subnet mask, DHCP information, and whether WINS is available.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)
- [C0035] KV Botnet Activity: [KV Botnet Activity](https://attack.mitre.org/campaigns/C0035) gathers victim IP information during initial installation stages.(Citation: Lumen KVBotnet 2023)
- [S0205] Naid: [Naid](https://attack.mitre.org/software/S0205) collects the domain name from a compromised host.(Citation: Symantec Naid June 2012)
- [S0589] Sibot: [Sibot](https://attack.mitre.org/software/S0589) checked if the compromised system is configured to use proxies.(Citation: MSTIC NOBELIUM Mar 2021)
- [S0093] Backdoor.Oldrea: [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) collects information about the Internet adapter configuration.(Citation: Symantec Dragonfly)(Citation: Gigamon Berserk Bear October 2021)
- [S0335] Carbon: [Carbon](https://attack.mitre.org/software/S0335) can collect the IP address of the victims and other computers on the network using the commands: <code>ipconfig -all</code> <code>nbtstat -n</code>, and <code>nbtstat -s</code>.(Citation: ESET Carbon Mar 2017)(Citation: GovCERT Carbon May 2016)
- [S1203] J-magic: [J-magic](https://attack.mitre.org/software/S1203) can compare the host and remote IPs to check if a received packet is from the infected machine.(Citation: Lumen J-Magic JAN 2025)
- [G0022] APT3: A keylogging tool used by [APT3](https://attack.mitre.org/groups/G0022) gathers network information from the victim, including the MAC address, IP address, WINS, DHCP server, and gateway.(Citation: Symantec Buckeye)(Citation: evolution of pirpi)
- [S0587] Penquin: [Penquin](https://attack.mitre.org/software/S0587) can report the IP of the compromised host to attacker controlled infrastructure.(Citation: Leonardo Turla Penquin May 2020)
- [G0069] MuddyWater: [MuddyWater](https://attack.mitre.org/groups/G0069) has used malware to collect the victim’s IP address and domain name.(Citation: Securelist MuddyWater Oct 2018)
- [S0632] GrimAgent: [GrimAgent](https://attack.mitre.org/software/S0632) can enumerate the IP and domain of a target system.(Citation: Group IB GrimAgent July 2021)
- [S0354] Denis: [Denis](https://attack.mitre.org/software/S0354) uses <code>ipconfig</code> to gather the IP address from the system.(Citation: Cybereason Cobalt Kitty 2017)
- [G0045] menuPass: [menuPass](https://attack.mitre.org/groups/G0045) has used several tools to scan for open NetBIOS nameservers and enumerate NetBIOS sessions.(Citation: PWC Cloud Hopper Technical Annex April 2017)
- [S0192] Pupy: [Pupy](https://attack.mitre.org/software/S0192) has built in commands to identify a host’s IP address and find out other network configuration settings by viewing connected sessions.(Citation: GitHub Pupy)
- [G1008] SideCopy: [SideCopy](https://attack.mitre.org/groups/G1008) has identified the IP address of a compromised host.(Citation: MalwareBytes SideCopy Dec 2021)
- [S0011] Taidoor: [Taidoor](https://attack.mitre.org/software/S0011) has collected the MAC address of a compromised host; it can also use <code>GetAdaptersInfo</code> to identify network adapters.(Citation: TrendMicro Taidoor)(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021)
- [G0038] Stealth Falcon: [Stealth Falcon](https://attack.mitre.org/groups/G0038) malware gathers the Address Resolution Protocol (ARP) table from the victim.(Citation: Citizen Lab Stealth Falcon May 2016)
- [S0140] Shamoon: [Shamoon](https://attack.mitre.org/software/S0140) obtains the target's IP address and local network segment.(Citation: Palo Alto Shamoon Nov 2016)(Citation: McAfee Shamoon December 2018)
- [S0486] Bonadan: [Bonadan](https://attack.mitre.org/software/S0486) can find the external IP address of the infected host.(Citation: ESET ForSSHe December 2018)
- [S0124] Pisloader: [Pisloader](https://attack.mitre.org/software/S0124) has a command to collect the victim's IP address.(Citation: Palo Alto DNS Requests)
- [S0552] AdFind: [AdFind](https://attack.mitre.org/software/S0552) can extract subnet information from Active Directory.(Citation: Red Canary Hospital Thwarted Ryuk October 2020)(Citation: FireEye FIN6 Apr 2019)(Citation: FireEye Ryuk and Trickbot January 2019)
- [S0588] GoldMax: [GoldMax](https://attack.mitre.org/software/S0588) retrieved a list of the system's network interface after execution.(Citation: MSTIC NOBELIUM Mar 2021)
- [S0487] Kessel: [Kessel](https://attack.mitre.org/software/S0487) has collected the DNS address of the infected host.(Citation: ESET ForSSHe December 2018)
- [S1031] PingPull: [PingPull](https://attack.mitre.org/software/S1031) can retrieve the IP address of a compromised host.(Citation: Unit 42 PingPull Jun 2022)
- [S0230] ZeroT: [ZeroT](https://attack.mitre.org/software/S0230) gathers the victim's IP address and domain information, and then sends it to its C2 server.(Citation: Proofpoint ZeroT Feb 2017)
- [S0254] PLAINTEE: [PLAINTEE](https://attack.mitre.org/software/S0254) uses the <code>ipconfig /all</code> command to gather the victim’s IP address.(Citation: Rancor Unit42 June 2018)
- [S1141] LunarWeb: [LunarWeb](https://attack.mitre.org/software/S1141) can use shell commands to discover network adapters and configuration.(Citation: ESET Turla Lunar toolset May 2024)
- [S1028] Action RAT: [Action RAT](https://attack.mitre.org/software/S1028) has the ability to collect the MAC address of an infected host.(Citation: MalwareBytes SideCopy Dec 2021)
- [G0006] APT1: [APT1](https://attack.mitre.org/groups/G0006) used the <code>ipconfig /all</code> command to gather network configuration information.(Citation: Mandiant APT1)
- [G0081] Tropic Trooper: [Tropic Trooper](https://attack.mitre.org/groups/G0081) has used scripts to collect the host's network topology.(Citation: TrendMicro Tropic Trooper May 2020)
- [S1035] Small Sieve: [Small Sieve](https://attack.mitre.org/software/S1035) can obtain the IP address of a victim host.(Citation: NCSC GCHQ Small Sieve Jan 2022)
- [S0015] Ixeshe: [Ixeshe](https://attack.mitre.org/software/S0015) enumerates the IP address, network proxy settings, and domain name from a victim's system.(Citation: Trend Micro IXESHE 2012)
- [G0027] Threat Group-3390: [Threat Group-3390](https://attack.mitre.org/groups/G0027) actors use [NBTscan](https://attack.mitre.org/software/S0590) to discover vulnerable systems.(Citation: Dell TG-3390)
- [S0641] Kobalos: [Kobalos](https://attack.mitre.org/software/S0641) can record the IP address of the target machine.(Citation: ESET Kobalos Jan 2021)
- [S0409] Machete: [Machete](https://attack.mitre.org/software/S0409) collects the MAC address of the target computer and other network configuration information.(Citation: ESET Machete July 2019)(Citation: 360 Machete Sep 2020)
- [S0340] Octopus: [Octopus](https://attack.mitre.org/software/S0340) can collect the host IP address from the victim’s machine.(Citation: Securelist Octopus Oct 2018)
- [S0269] QUADAGENT: [QUADAGENT](https://attack.mitre.org/software/S0269) gathers the current domain the victim system belongs to.(Citation: Unit 42 QUADAGENT July 2018)
- [S0559] SUNBURST: [SUNBURST](https://attack.mitre.org/software/S0559) collected all network interface MAC addresses that are up and not loopback devices, as well as IP address, DHCP configuration, and domain information.(Citation: FireEye SUNBURST Backdoor December 2020)
- [G0004] Ke3chang: [Ke3chang](https://attack.mitre.org/groups/G0004) has performed local network configuration discovery using <code>ipconfig</code>.(Citation: Mandiant Operation Ke3chang November 2014)(Citation: NCC Group APT15 Alive and Strong)(Citation: Microsoft NICKEL December 2021)
- [G0019] Naikon: [Naikon](https://attack.mitre.org/groups/G0019) uses commands such as <code>netsh interface show</code> to discover network interface settings.(Citation: Baumgartner Naikon 2015)
- [S0374] SpeakUp: [SpeakUp](https://attack.mitre.org/software/S0374) uses the <code>ifconfig -a</code> command. (Citation: CheckPoint SpeakUp Feb 2019)
- [S0452] USBferry: [USBferry](https://attack.mitre.org/software/S0452) can detect the infected machine's network topology using <code>ipconfig</code> and <code>arp</code>.(Citation: TrendMicro Tropic Trooper May 2020)
- [S0650] QakBot: [QakBot](https://attack.mitre.org/software/S0650) can use <code>net config workstation</code>, <code>arp -a</code>, `nslookup`, and <code>ipconfig /all</code> to gather network configuration information.(Citation: Crowdstrike Qakbot October 2020)(Citation: Kaspersky QakBot September 2021)(Citation: Group IB Ransomware September 2020)(Citation: Trend Micro Black Basta October 2022)(Citation: Microsoft Ransomware as a Service)
- [S0350] zwShell: [zwShell](https://attack.mitre.org/software/S0350) can obtain the victim IP address.(Citation: McAfee Night Dragon)
- [S0267] FELIXROOT: [FELIXROOT](https://attack.mitre.org/software/S0267) collects information about the network including the IP address and DHCP server.(Citation: ESET GreyEnergy Oct 2018)
- [S0181] FALLCHILL: [FALLCHILL](https://attack.mitre.org/software/S0181) collects MAC address and local IP address information from the victim.(Citation: US-CERT FALLCHILL Nov 2017)
- [G1044] APT42: [APT42](https://attack.mitre.org/groups/G1044) has used malware, such as GHAMBAR and POWERPOST, to collect network information.(Citation: Mandiant APT42-charms)
- [S0575] Conti: [Conti](https://attack.mitre.org/software/S0575) can retrieve the ARP cache from the local system by using the <code>GetIpNetTable()</code> API call and check to ensure IP addresses it connects to are for local, non-Internet, systems.(Citation: CarbonBlack Conti July 2020)
- [S0605] EKANS: [EKANS](https://attack.mitre.org/software/S0605) can determine the domain of a compromised host.(Citation: IBM Ransomware Trends September 2020)
- [S1182] MagicRAT: [MagicRAT](https://attack.mitre.org/software/S1182) collects system network information using commands such as `ipconfig /all`.(Citation: Cisco MagicRAT 2022)
- [S0130] Unknown Logger: [Unknown Logger](https://attack.mitre.org/software/S0130) can obtain information about the victim's IP address.(Citation: Forcepoint Monsoon)
- [S0653] xCaon: [xCaon](https://attack.mitre.org/software/S0653) has used the GetAdaptersInfo() API call to get the victim's MAC address.(Citation: Checkpoint IndigoZebra July 2021)
- [S0625] Cuba: [Cuba](https://attack.mitre.org/software/S0625) can retrieve the ARP cache from the local system by using <code>GetIpNetTable</code>.(Citation: McAfee Cuba April 2021)
- [C0007] FunnyDream: During [FunnyDream](https://attack.mitre.org/campaigns/C0007), the threat actors used [ipconfig](https://attack.mitre.org/software/S0100) for discovery on remote systems.(Citation: Bitdefender FunnyDream Campaign November 2020)
- [S0251] Zebrocy: [Zebrocy](https://attack.mitre.org/software/S0251) runs the <code>ipconfig /all</code> command.(Citation: ESET Zebrocy May 2019)
- [S0450] SHARPSTATS: [SHARPSTATS](https://attack.mitre.org/software/S0450) has the ability to identify the domain of the compromised host.(Citation: TrendMicro POWERSTATS V3 June 2019)
- [S1044] FunnyDream: [FunnyDream](https://attack.mitre.org/software/S1044) can parse the `ProxyServer` string in the Registry to discover http proxies.(Citation: Bitdefender FunnyDream Campaign November 2020)
- [S0260] InvisiMole: [InvisiMole](https://attack.mitre.org/software/S0260) gathers information on the IP forwarding table, MAC address, configured proxy, and network SSID.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020)
- [S0473] Avenger: [Avenger](https://attack.mitre.org/software/S0473) can identify the domain of the compromised host.(Citation: Trend Micro Tick November 2019)
- [S0275] UPPERCUT: [UPPERCUT](https://attack.mitre.org/software/S0275) has the capability to gather the victim's proxy information.(Citation: FireEye APT10 Sept 2018)
- [S0604] Industroyer: [Industroyer](https://attack.mitre.org/software/S0604)’s 61850 payload component enumerates connected network adapters and their corresponding IP addresses.(Citation: ESET Industroyer)
- [G0114] Chimera: [Chimera](https://attack.mitre.org/groups/G0114) has used [ipconfig](https://attack.mitre.org/software/S0100), [Ping](https://attack.mitre.org/software/S0097), and <code>tracert</code> to enumerate the IP address and network environment and settings of the local host.(Citation: NCC Group Chimera January 2021)
- [S0515] WellMail: [WellMail](https://attack.mitre.org/software/S0515) can identify the IP address of the victim system.(Citation: CISA WellMail July 2020)
- [S0646] SpicyOmelette: [SpicyOmelette](https://attack.mitre.org/software/S0646) can identify the IP of a compromised system.(Citation: Secureworks GOLD KINGSWOOD September 2018)
- [S0049] GeminiDuke: [GeminiDuke](https://attack.mitre.org/software/S0049) collects information on network settings and Internet proxy settings from the victim.(Citation: F-Secure The Dukes)
- [S0520] BLINDINGCAN: [BLINDINGCAN](https://attack.mitre.org/software/S0520) has collected the victim machine's local IP address information and MAC address.(Citation: US-CERT BLINDINGCAN Aug 2020)
- [S1073] Royal: [Royal](https://attack.mitre.org/software/S1073) can enumerate IP addresses using `GetIpAddrTable`.(Citation: Cybereason Royal December 2022)
- [S1024] CreepySnail: [CreepySnail](https://attack.mitre.org/software/S1024) can use `getmac` and `Get-NetIPAddress` to enumerate network settings.(Citation: Microsoft POLONIUM June 2022)
- [S0373] Astaroth: [Astaroth](https://attack.mitre.org/software/S0373) collects the external IP address from the system. (Citation: Cofense Astaroth Sept 2018)
- [S1204] cd00r: [cd00r](https://attack.mitre.org/software/S1204) can discover the IP for the network interface on the compromised device.(Citation: Hartrell cd00r 2002)
- [S0596] ShadowPad: [ShadowPad](https://attack.mitre.org/software/S0596) has collected the domain name of the victim system.(Citation: Kaspersky ShadowPad Aug 2017)
- [G0059] Magic Hound: [Magic Hound](https://attack.mitre.org/groups/G0059) malware gathers the victim's local IP address, MAC address, and external IP address.(Citation: Unit 42 Magic Hound Feb 2017)(Citation: DFIR Report APT35 ProxyShell March 2022)(Citation: DFIR Phosphorus November 2021)
- [S0451] LoudMiner: [LoudMiner](https://attack.mitre.org/software/S0451) used a script to gather the IP address of the infected machine before sending to the C2.(Citation: ESET LoudMiner June 2019)
- [S0633] Sliver: [Sliver](https://attack.mitre.org/software/S0633) has the ability to gather network configuration information.(Citation: GitHub Sliver Ifconfig)
- [S0687] Cyclops Blink: [Cyclops Blink](https://attack.mitre.org/software/S0687) can use the Linux API `if_nameindex` to gather network interface names.(Citation: NCSC Cyclops Blink February 2022)(Citation: Trend Micro Cyclops Blink March 2022)
- [S1076] QUIETCANARY: [QUIETCANARY](https://attack.mitre.org/software/S1076) can identify the default proxy setting on a compromised host.(Citation: Mandiant Suspected Turla Campaign February 2023)
- [S0690] Green Lambert: [Green Lambert](https://attack.mitre.org/software/S0690) can obtain proxy information from a victim's machine using system environment variables.(Citation: Objective See Green Lambert for OSX Oct 2021)(Citation: Glitch-Cat Green Lambert ATTCK Oct 2021)
- [S0241] RATANKBA: [RATANKBA](https://attack.mitre.org/software/S0241) gathers the victim’s IP address via the <code>ipconfig -all</code> command.(Citation: Lazarus RATANKBA)(Citation: RATANKBA)
- [S0115] Crimson: [Crimson](https://attack.mitre.org/software/S0115) contains a command to collect the victim MAC address and LAN IP.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)
- [S0223] POWERSTATS: [POWERSTATS](https://attack.mitre.org/software/S0223) can retrieve IP, network adapter configuration information, and domain from compromised hosts.(Citation: FireEye MuddyWater Mar 2018)(Citation: TrendMicro POWERSTATS V3 June 2019)
- [S1075] KOPILUWAK: [KOPILUWAK](https://attack.mitre.org/software/S1075) can use [Arp](https://attack.mitre.org/software/S0099) to discover a target's network configuration setttings.(Citation: Mandiant Suspected Turla Campaign February 2023)
- [S0102] nbtstat: [nbtstat](https://attack.mitre.org/software/S0102) can be used to discover local NetBIOS domain names.
- [S0476] Valak: [Valak](https://attack.mitre.org/software/S0476) has the ability to identify the domain and the MAC and IP addresses of an infected machine.(Citation: Cybereason Valak May 2020)
- [S0379] Revenge RAT: [Revenge RAT](https://attack.mitre.org/software/S0379) collects the IP address and MAC address from the system.(Citation: Cylance Shaheen Nov 2018)
- [S0467] TajMahal: [TajMahal](https://attack.mitre.org/software/S0467) has the ability to identify the MAC address on an infected host.(Citation: Kaspersky TajMahal April 2019)
- [S0610] SideTwist: [SideTwist](https://attack.mitre.org/software/S0610) has the ability to collect the domain name on a compromised host.(Citation: Check Point APT34 April 2021)
- [S0395] LightNeuron: [LightNeuron](https://attack.mitre.org/software/S0395) gathers information about network adapters using the Win32 API call <code>GetAdaptersInfo</code>.(Citation: ESET LightNeuron May 2019)
- [S1184] BOLDMOVE: [BOLDMOVE](https://attack.mitre.org/software/S1184) enumerates network interfaces on the infected host.(Citation: Google Cloud BOLDMOVE 2023)
- [S0262] QuasarRAT: [QuasarRAT](https://attack.mitre.org/software/S0262) has the ability to enumerate the Wide Area Network (WAN) IP through requests to ip-api[.]com, freegeoip[.]net, or api[.]ipify[.]org observed with user-agent string `Mozilla/5.0 (Windows NT 6.3; rv:48.0) Gecko/20100101 Firefox/48.0`.(Citation: CISA AR18-352A Quasar RAT December 2018)
- [S0018] Sykipot: [Sykipot](https://attack.mitre.org/software/S0018) may use <code>ipconfig /all</code> to gather system network configuration details.(Citation: AlienVault Sykipot 2011)
- [S1159] DUSTTRAP: [DUSTTRAP](https://attack.mitre.org/software/S1159) can enumerate infected system network information.(Citation: Google Cloud APT41 2024)
- [S0153] RedLeaves: [RedLeaves](https://attack.mitre.org/software/S0153) can obtain information about network parameters.(Citation: PWC Cloud Hopper Technical Annex April 2017)
- [S1060] Mafalda: [Mafalda](https://attack.mitre.org/software/S1060) can use the `GetAdaptersInfo` function to retrieve information about network adapters and the `GetIpNetTable` function to retrieve the IPv4 to physical network address mapping table.(Citation: SentinelLabs Metador Sept 2022)
- [S0461] SDBbot: [SDBbot](https://attack.mitre.org/software/S0461) has the ability to determine the domain name and whether a proxy is configured on a compromised host.(Citation: Proofpoint TA505 October 2019)
- [S0516] SoreFang: [SoreFang](https://attack.mitre.org/software/S0516) can collect the TCP/IP, DNS, DHCP, and network adapter configuration on a compromised host via <code>ipconfig.exe /all</code>.(Citation: CISA SoreFang July 2016)
- [S0180] Volgmer: [Volgmer](https://attack.mitre.org/software/S0180) can gather the IP address from the victim's machine.(Citation: Symantec Volgmer Aug 2014)
- [S0534] Bazar: [Bazar](https://attack.mitre.org/software/S0534) can collect the IP address and NetBIOS name of an infected machine.(Citation: Cybereason Bazar July 2020)
- [G0121] Sidewinder: [Sidewinder](https://attack.mitre.org/groups/G0121) has used malware to collect information on network interfaces, including the MAC address.(Citation: ATT Sidewinder January 2021)
- [G0010] Turla: [Turla](https://attack.mitre.org/groups/G0010) surveys a system upon check-in to discover network configuration details using the <code>arp -a</code>, <code>nbtstat -n</code>, <code>net config</code>, <code>ipconfig /all</code>, and <code>route</code> commands, as well as [NBTscan](https://attack.mitre.org/software/S0590).(Citation: Kaspersky Turla)(Citation: Symantec Waterbug Jun 2019)(Citation: ESET ComRAT May 2020) [Turla](https://attack.mitre.org/groups/G0010) RPC backdoors have also retrieved registered RPC interface information from process memory.(Citation: ESET Turla PowerShell May 2019)
- [S0567] Dtrack: [Dtrack](https://attack.mitre.org/software/S0567) can collect the host's IP addresses using the <code>ipconfig</code> command.(Citation: Securelist Dtrack)(Citation: CyberBit Dtrack)
- [G0102] Wizard Spider: [Wizard Spider](https://attack.mitre.org/groups/G0102) has used [ipconfig](https://attack.mitre.org/software/S0100) to identify the network configuration of a victim machine. [Wizard Spider](https://attack.mitre.org/groups/G0102) has also used the PowerShell cmdlet `Get-ADComputer` to collect IP address data from Active Directory.(Citation: Sophos New Ryuk Attack October 2020)(Citation: Mandiant FIN12 Oct 2021)
- [S0647] Turian: [Turian](https://attack.mitre.org/software/S0647) can retrieve the internal IP address of a compromised host.(Citation: ESET BackdoorDiplomacy Jun 2021)
- [S0261] Catchamas: [Catchamas](https://attack.mitre.org/software/S0261) gathers the Mac address, IP address, and the network adapter information from the victim’s machine.(Citation: Symantec Catchamas April 2018)
- [S0659] Diavol: [Diavol](https://attack.mitre.org/software/S0659) can enumerate victims' local and external IPs when registering with C2.(Citation: Fortinet Diavol July 2021)
- [S0085] S-Type: [S-Type](https://attack.mitre.org/software/S0085) has used `ipconfig /all` on a compromised host.(Citation: Cylance Dust Storm)
- [S0284] More_eggs: [More_eggs](https://attack.mitre.org/software/S0284) has the capability to gather the IP address from the victim's machine.(Citation: Talos Cobalt Group July 2018)
- [G0139] TeamTNT: [TeamTNT](https://attack.mitre.org/groups/G0139) has enumerated the host machine’s IP address.(Citation: Trend Micro TeamTNT)
- [S0504] Anchor: [Anchor](https://attack.mitre.org/software/S0504) can determine the public IP and location of a compromised host.(Citation: Medium Anchor DNS July 2020)
- [S0256] Mosquito: [Mosquito](https://attack.mitre.org/software/S0256) uses the <code>ipconfig</code> command.(Citation: ESET Turla Mosquito Jan 2018)
- [S0441] PowerShower: [PowerShower](https://attack.mitre.org/software/S0441) has the ability to identify the current Windows domain of the infected host.(Citation: Kaspersky Cloud Atlas August 2019)
- [G0096] APT41: [APT41](https://attack.mitre.org/groups/G0096) collected MAC addresses from victim machines.(Citation: FireEye APT41 Aug 2019)(Citation: Group IB APT 41 June 2021)
- [S1138] Gootloader: [Gootloader](https://attack.mitre.org/software/S1138) can use an embedded script to check the IP address of potential victims visiting compromised websites.(Citation: SentinelOne Gootloader June 2021)
- [S0514] WellMess: [WellMess](https://attack.mitre.org/software/S0514) can identify the IP address and user domain on the target machine.(Citation: PWC WellMess July 2020)(Citation: CISA WellMess July 2020)
- [G0093] GALLIUM: [GALLIUM](https://attack.mitre.org/groups/G0093) used <code>ipconfig /all</code> to obtain information about the victim network configuration. The group also ran a modified version of [NBTscan](https://attack.mitre.org/software/S0590) to identify available NetBIOS name servers.(Citation: Cybereason Soft Cell June 2019)
- [S1052] DEADEYE: [DEADEYE](https://attack.mitre.org/software/S1052) can discover the DNS domain name of a targeted system.(Citation: Mandiant APT41)
- [S1147] Nightdoor: [Nightdoor](https://attack.mitre.org/software/S1147) gathers information on victim system network configuration such as MAC addresses.(Citation: ESET EvasivePanda 2024)
- [S0234] Bandook: [Bandook](https://attack.mitre.org/software/S0234) has a command to get the public IP address from a system.(Citation: CheckPoint Bandook Nov 2020)
- [G1036] Moonstone Sleet: [Moonstone Sleet](https://attack.mitre.org/groups/G1036) has gathered information on victim network configuration.(Citation: Microsoft Moonstone Sleet 2024)
- [G0094] Kimsuky: [Kimsuky](https://attack.mitre.org/groups/G0094) has used `ipconfig/all` and web beacons sent via email to gather network configuration information.(Citation: Talos Kimsuky Nov 2021)(Citation: Proofpoint TA427 April 2024)
- [S0366] WannaCry: [WannaCry](https://attack.mitre.org/software/S0366) will attempt to determine the local network segment it is a part of.(Citation: SecureWorks WannaCry Analysis)
- [S0483] IcedID: [IcedID](https://attack.mitre.org/software/S0483) used the `ipconfig /all` command and a batch script to gather network information.(Citation: DFIR_Quantum_Ransomware)
- [S1037] STARWHALE: [STARWHALE](https://attack.mitre.org/software/S1037) has the ability to collect the IP address of an infected host.(Citation: DHS CISA AA22-055A MuddyWater February 2022)
- [S0100] ipconfig: [ipconfig](https://attack.mitre.org/software/S0100) can be used to display adapter configuration on Windows systems, including information for TCP/IP, DNS, and DHCP.
- [S0696] Flagpro: [Flagpro](https://attack.mitre.org/software/S0696) has been used to execute the <code>ipconfig /all</code> command on a victim system.(Citation: NTT Security Flagpro new December 2021)
- [G0012] Darkhotel: [Darkhotel](https://attack.mitre.org/groups/G0012) has collected the IP address and network adapter information from the victim’s machine.(Citation: Securelist Darkhotel Aug 2015)(Citation: Microsoft DUBNIUM July 2016)
- [S0060] Sys10: [Sys10](https://attack.mitre.org/software/S0060) collects the local IP address of the victim and sends it to the C2.(Citation: Baumgartner Naikon 2015)
- [C0018] C0018: During [C0018](https://attack.mitre.org/campaigns/C0018), the threat actors ran `nslookup` and Advanced IP Scanner on the target network.(Citation: Costa AvosLocker May 2022)
- [S0642] BADFLICK: [BADFLICK](https://attack.mitre.org/software/S0642) has captured victim IP address details.(Citation: Accenture MUDCARP March 2019)
- [S0125] Remsec: [Remsec](https://attack.mitre.org/software/S0125) can obtain information about network configuration, including the routing table, ARP cache, and DNS cache.(Citation: Kaspersky ProjectSauron Technical Analysis)
- [G0125] HAFNIUM: [HAFNIUM](https://attack.mitre.org/groups/G0125) has collected IP information via IPInfo.(Citation: Rapid7 HAFNIUM Mar 2021)
- [S0691] Neoichor: [Neoichor](https://attack.mitre.org/software/S0691) can gather the IP address from an infected host.(Citation: Microsoft NICKEL December 2021)
- [S0252] Brave Prince: [Brave Prince](https://attack.mitre.org/software/S0252) gathers network configuration information as well as the ARP cache.(Citation: McAfee Gold Dragon)
- [S1178] ShrinkLocker: [ShrinkLocker](https://attack.mitre.org/software/S1178) captures the IP address of the victim system and sends this to the attacker following encryption.(Citation: Kaspersky ShrinkLocker 2024)
- [S0094] Trojan.Karagany: [Trojan.Karagany](https://attack.mitre.org/software/S0094) can gather information on the network configuration of a compromised host.(Citation: Secureworks Karagany July 2019)
- [S0445] ShimRatReporter: [ShimRatReporter](https://attack.mitre.org/software/S0445) gathered the local proxy, domain, IP, routing tables, mac address, gateway, DNS servers, and DHCP status information from an infected host.(Citation: FOX-IT May 2016 Mofang)
- [S0149] MoonWind: [MoonWind](https://attack.mitre.org/software/S0149) obtains the victim IP address.(Citation: Palo Alto MoonWind March 2017)
- [S1198] Gomir: [Gomir](https://attack.mitre.org/software/S1198) collects network information on infected systems such as listing interface names, MAC and IP addresses, and IPv6 addresses.(Citation: Symantec Troll Stealer 2024)
- [S0229] Orz: [Orz](https://attack.mitre.org/software/S0229) can gather victim proxy information.(Citation: Proofpoint Leviathan Oct 2017)
- [S0171] Felismus: [Felismus](https://attack.mitre.org/software/S0171) collects the victim LAN IP address and sends it to the C2 server.(Citation: Forcepoint Felismus Mar 2017)
- [S0674] CharmPower: [CharmPower](https://attack.mitre.org/software/S0674) has the ability to use <code>ipconfig</code> to enumerate system network settings.(Citation: Check Point APT35 CharmPower January 2022)
- [S0103] route: [route](https://attack.mitre.org/software/S0103) can be used to discover routing configuration information.
- [S1065] Woody RAT: [Woody RAT](https://attack.mitre.org/software/S1065) can retrieve network interface and proxy information.(Citation: MalwareBytes WoodyRAT Aug 2022)
- [S1106] NGLite: [NGLite](https://attack.mitre.org/software/S1106) identifies the victim system MAC and IPv4 addresses and uses these to establish a victim identifier.(Citation: NGLite Trojan)
- [S0651] BoxCaon: [BoxCaon](https://attack.mitre.org/software/S0651) can collect the victim's MAC address by using the <code>GetAdaptersInfo</code> API.(Citation: Checkpoint IndigoZebra July 2021)
- [G0050] APT32: [APT32](https://attack.mitre.org/groups/G0050) used the <code>ipconfig /all</code> command to gather the IP address from the system.(Citation: Cybereason Cobalt Kitty 2017)
- [S0091] Epic: [Epic](https://attack.mitre.org/software/S0091) uses the <code>nbtstat -n</code> and <code>nbtstat -s</code> commands on the victim’s machine.(Citation: Kaspersky Turla)
- [S0436] TSCookie: [TSCookie](https://attack.mitre.org/software/S0436) has the ability to identify the IP of the infected host.(Citation: JPCert TSCookie March 2018)
- [S0531] Grandoreiro: [Grandoreiro](https://attack.mitre.org/software/S0531) can determine the IP and physical location of the compromised host via IPinfo.(Citation: ESET Grandoreiro April 2020)
- [S0414] BabyShark: [BabyShark](https://attack.mitre.org/software/S0414) has executed the <code>ipconfig /all</code> command.(Citation: Unit42 BabyShark Feb 2019)
- [S0236] Kwampirs: [Kwampirs](https://attack.mitre.org/software/S0236) collects network adapter and interface information by using the commands <code>ipconfig /all</code>, <code>arp -a</code> and <code>route print</code>. It also collects the system's MAC address with <code>getmac</code> and domain configuration with <code>net config workstation</code>.(Citation: Symantec Orangeworm April 2018)
- [C0045] ShadowRay: During [ShadowRay](https://attack.mitre.org/campaigns/C0045), threat actors invoked DNS queries from targeted machines to identify their IP addresses.(Citation: Oligo ShadowRay Campaign MAR 2024)
- [S0198] NETWIRE: [NETWIRE](https://attack.mitre.org/software/S0198) can collect the IP address of a compromised host.(Citation: Red Canary NETWIRE January 2020)(Citation: Proofpoint NETWIRE December 2020)
- [S0447] Lokibot: [Lokibot](https://attack.mitre.org/software/S0447) has the ability to discover the domain name of the infected host.(Citation: FSecure Lokibot November 2019)
- [G0126] Higaisa: [Higaisa](https://attack.mitre.org/groups/G0126) used <code>ipconfig</code> to gather network configuration information.(Citation: Malwarebytes Higaisa 2020)(Citation: Zscaler Higaisa 2020)
- [S0238] Proxysvc: [Proxysvc](https://attack.mitre.org/software/S0238) collects the network adapter information and domain/username information based on current remote sessions.(Citation: McAfee GhostSecret)
- [S0099] Arp: [Arp](https://attack.mitre.org/software/S0099) can be used to display ARP configuration information on the host.(Citation: TechNet Arp)
- [C0001] Frankenstein: During [Frankenstein](https://attack.mitre.org/campaigns/C0001), the threat actors used [Empire](https://attack.mitre.org/software/S0363) to find the public IP address of a compromised system.(Citation: Talos Frankenstein June 2019)
- [S0165] OSInfo: [OSInfo](https://attack.mitre.org/software/S0165) discovers the current domain information.(Citation: Symantec Buckeye)
- [S0344] Azorult: [Azorult](https://attack.mitre.org/software/S0344) can collect host IP information from the victim’s machine.(Citation: Unit42 Azorult Nov 2018)
- [S0359] Nltest: [Nltest](https://attack.mitre.org/software/S0359) may be used to enumerate the parent domain of a local machine using <code>/parentdomain</code>.(Citation: Nltest Manual)
- [S0663] SysUpdate: [SysUpdate](https://attack.mitre.org/software/S0663) can collected the IP address and domain name of a compromised host.(Citation: Lunghi Iron Tiger Linux)
- [S0038] Duqu: The reconnaissance modules used with [Duqu](https://attack.mitre.org/software/S0038) can collect information on network configuration.(Citation: Symantec W32.Duqu)
- [S0092] Agent.btz: [Agent.btz](https://attack.mitre.org/software/S0092) collects the network adapter’s IP and MAC address as well as IP addresses of the network adapter’s default gateway, primary/secondary WINS, DHCP, and DNS servers, and saves them into a log file.(Citation: ThreatExpert Agent.btz)
- [S0472] down_new: [down_new](https://attack.mitre.org/software/S0472) has the ability to identify the MAC address of a compromised host.(Citation: Trend Micro Tick November 2019)
- [S0681] Lizar: [Lizar](https://attack.mitre.org/software/S0681) can retrieve network information from a compromised host.(Citation: BiZone Lizar May 2021)
- [S0089] BlackEnergy: [BlackEnergy](https://attack.mitre.org/software/S0089) has gathered information about network IP configurations using [ipconfig](https://attack.mitre.org/software/S0100).exe and about routing tables using [route](https://attack.mitre.org/software/S0103).exe.(Citation: F-Secure BlackEnergy 2014)(Citation: Securelist BlackEnergy Nov 2014)
- [S0488] CrackMapExec: [CrackMapExec](https://attack.mitre.org/software/S0488) can collect DNS information from the targeted system.(Citation: CME Github September 2018)
- [S0640] Avaddon: [Avaddon](https://attack.mitre.org/software/S0640) can collect the external IP address of the victim.(Citation: Awake Security Avaddon)
- [C0014] Operation Wocao: During [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors discovered the local network configuration with `ipconfig`.(Citation: FoxIT Wocao December 2019)
- [G0049] OilRig: [OilRig](https://attack.mitre.org/groups/G0049) has run <code>ipconfig /all</code> on a victim.(Citation: Palo Alto OilRig May 2016)(Citation: Palo Alto OilRig Oct 2016)
- [S0556] Pay2Key: [Pay2Key](https://attack.mitre.org/software/S0556) can identify the IP and MAC addresses of the compromised host.(Citation: Check Point Pay2Key November 2020)
- [G1006] Earth Lusca: [Earth Lusca](https://attack.mitre.org/groups/G1006) used the command <code>ipconfig</code> to obtain information about network configurations.(Citation: TrendMicro EarthLusca 2022)
- [S0353] NOKKI: [NOKKI](https://attack.mitre.org/software/S0353) can gather information on the victim IP address.(Citation: Unit 42 NOKKI Sept 2018)
- [S0268] Bisonal: [Bisonal](https://attack.mitre.org/software/S0268) can execute <code>ipconfig</code> on the victim’s machine.(Citation: Unit 42 Bisonal July 2018)(Citation: Kaspersky CactusPete Aug 2020)(Citation: Talos Bisonal Mar 2020)
- [S0265] Kazuar: [Kazuar](https://attack.mitre.org/software/S0265) gathers information about network adapters.(Citation: Unit 42 Kazuar May 2017)
- [S0660] Clambling: [Clambling](https://attack.mitre.org/software/S0660) can enumerate the IP address of a compromised machine.(Citation: Trend Micro DRBControl February 2020)(Citation: Talent-Jump Clambling February 2020)
- [C0015] C0015: During [C0015](https://attack.mitre.org/campaigns/C0015), the threat actors used code to obtain the external public-facing IPv4 address of the compromised host.(Citation: DFIR Conti Bazar Nov 2021)
- [S0501] PipeMon: [PipeMon](https://attack.mitre.org/software/S0501) can collect and send the local IP address, RDP information, and the network adapter physical address as a part of its C2 beacon.(Citation: ESET PipeMon May 2020)
- [S0446] Ryuk: [Ryuk](https://attack.mitre.org/software/S0446) has called <code>GetIpNetTable</code> in attempt to identify all mounted drives and hosts that have Address Resolution Protocol (ARP) entries.(Citation: CrowdStrike Ryuk January 2019)(Citation: Bleeping Computer - Ryuk WoL)
- [S0283] jRAT: [jRAT](https://attack.mitre.org/software/S0283) can gather victim internal and external IPs.(Citation: Kaspersky Adwind Feb 2016)
- [G0128] ZIRCONIUM: [ZIRCONIUM](https://attack.mitre.org/groups/G0128) has used a tool to enumerate proxy settings in the target environment.(Citation: Zscaler APT31 Covid-19 October 2020)
- [S0431] HotCroissant: [HotCroissant](https://attack.mitre.org/software/S0431) has the ability to identify the IP address of the compromised machine.(Citation: US-CERT HOTCROISSANT February 2020)
- [S0341] Xbash: [Xbash](https://attack.mitre.org/software/S0341) can collect IP addresses and local intranet information from a victim’s machine.(Citation: Unit42 Xbash Sept 2018)
- [S0678] Torisma: [Torisma](https://attack.mitre.org/software/S0678) can collect the local MAC address using `GetAdaptersInfo` as well as the system's IP address.(Citation: McAfee Lazarus Nov 2020)
- [S0172] Reaver: [Reaver](https://attack.mitre.org/software/S0172) collects the victim's IP address.(Citation: Palo Alto Reaver Nov 2017)
- [S0266] TrickBot: [TrickBot](https://attack.mitre.org/software/S0266) obtains the IP address, location, and other relevant network information from the victim’s machine.(Citation: S2 Grupo TrickBot June 2017)(Citation: Trend Micro Trickbot Nov 2018)(Citation: Cyberreason Anchor December 2019)
- [S0448] Rising Sun: [Rising Sun](https://attack.mitre.org/software/S0448) can detect network adapter and IP address information.(Citation: McAfee Sharpshooter December 2018)
- [S0245] BADCALL: [BADCALL](https://attack.mitre.org/software/S0245) collects the network adapter information.(Citation: US-CERT BADCALL)
- [S0248] yty: [yty](https://attack.mitre.org/software/S0248) runs <code>ipconfig /all</code> and collects the domain name.(Citation: ASERT Donot March 2018)
- [S1124] SocGholish: [SocGholish](https://attack.mitre.org/software/S1124) has the ability to enumerate the domain name of a victim, as well as if the host is a member of an Active Directory domain.(Citation: SocGholish-update)(Citation: Red Canary SocGholish March 2024)(Citation: Secureworks Gold Prelude Profile)
- [S1030] Squirrelwaffle: [Squirrelwaffle](https://attack.mitre.org/software/S1030) has collected the victim’s external IP address.(Citation: ZScaler Squirrelwaffle Sep 2021)
- [S1025] Amadey: [Amadey](https://attack.mitre.org/software/S1025) can identify the IP address of a victim machine.(Citation: BlackBerry Amadey 2020)

#### T1016.001 - Internet Connection Discovery

Description:

Adversaries may check for Internet connectivity on compromised systems. This may be performed during automated discovery and can be accomplished in numerous ways such as using [Ping](https://attack.mitre.org/software/S0097), <code>tracert</code>, and GET requests to websites.

Adversaries may use the results and responses from these requests to determine if the system is capable of communicating with their C2 servers before attempting to connect to them. The results may also be used to identify routes, redirectors, and proxy servers.

Procedures:

- [S0597] GoldFinder: [GoldFinder](https://attack.mitre.org/software/S0597) performed HTTP GET requests to check internet connectivity and identify HTTP proxy servers and other redirectors that an HTTP request traveled through.(Citation: MSTIC NOBELIUM Mar 2021)
- [S0284] More_eggs: [More_eggs](https://attack.mitre.org/software/S0284) has used HTTP GET requests to check internet connectivity.(Citation: Security Intelligence More Eggs Aug 2019)
- [S0691] Neoichor: [Neoichor](https://attack.mitre.org/software/S0691) can check for Internet connectivity by contacting bing[.]com with the request format `bing[.]com?id=<GetTickCount>`.(Citation: Microsoft NICKEL December 2021)
- [C0024] SolarWinds Compromise: During the [SolarWinds Compromise](https://attack.mitre.org/campaigns/C0024), [APT29](https://attack.mitre.org/groups/G0016) used [GoldFinder](https://attack.mitre.org/software/S0597) to perform HTTP GET requests to check internet connectivity and identify HTTP proxy servers and other redirectors that an HTTP request travels through.(Citation: MSTIC NOBELIUM Mar 2021)
- [G0059] Magic Hound: [Magic Hound](https://attack.mitre.org/groups/G0059) has conducted a network call out to a specific website as part of their initial discovery activity.(Citation: DFIR Phosphorus November 2021)
- [S1049] SUGARUSH: [SUGARUSH](https://attack.mitre.org/software/S1049) has checked for internet connectivity from an infected host before attempting to establish a new TCP connection.(Citation: Mandiant UNC3890 Aug 2022)
- [S1107] NKAbuse: [NKAbuse](https://attack.mitre.org/software/S1107) utilizes external services such as <code>ifconfig.me</code> to identify the victim machine's IP address.(Citation: NKAbuse SL)
- [G1001] HEXANE: [HEXANE](https://attack.mitre.org/groups/G1001) has used tools including [BITSAdmin](https://attack.mitre.org/software/S0190) to test internet connectivity from compromised hosts.(Citation: Kaspersky Lyceum October 2021)
- [S0650] QakBot: [QakBot](https://attack.mitre.org/software/S0650) can measure the download speed on a targeted host.(Citation: Kaspersky QakBot September 2021)
- [G0016] APT29: [APT29](https://attack.mitre.org/groups/G0016) has ensured web servers in a victim environment are Internet accessible before copying tools or malware to it.(Citation: Mandiant APT29 Eye Spy Email Nov 22)
- [S0686] QuietSieve: [QuietSieve](https://attack.mitre.org/software/S0686) can check C2 connectivity with a `ping` to 8.8.8.8 (Google public DNS).(Citation: Microsoft Actinium February 2022)
- [G0047] Gamaredon Group: [Gamaredon Group](https://attack.mitre.org/groups/G0047) has tested connectivity between a compromised machine and a C2 server using  [Ping](https://attack.mitre.org/software/S0097) with commands such as `CSIDL_SYSTEM\cmd.exe /c ping -n 1`.(Citation: Symantec Shuckworm January 2022)
- [S0663] SysUpdate: [SysUpdate](https://attack.mitre.org/software/S0663) can contact the DNS server operated by Google as part of its C2 establishment process.(Citation: Lunghi Iron Tiger Linux)
- [G1018] TA2541: [TA2541](https://attack.mitre.org/groups/G1018) has run scripts to check internet connectivity from compromised hosts. (Citation: Cisco Operation Layover September 2021)
- [C0014] Operation Wocao: During [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors used a Visual Basic script that checked for internet connectivity.(Citation: FoxIT Wocao December 2019)
- [G0030] Lotus Blossom: [Lotus Blossom](https://attack.mitre.org/groups/G0030) has performed checks to determine if a victim machine is able to access the Internet.(Citation: Cisco LotusBlossom 2025)
- [S1066] DarkTortilla: [DarkTortilla](https://attack.mitre.org/software/S1066) can check for internet connectivity by issuing HTTP GET requests.(Citation: Secureworks DarkTortilla Aug 2022)
- [S1065] Woody RAT: [Woody RAT](https://attack.mitre.org/software/S1065) can make `Ping` GET HTTP requests to its C2 server at regular intervals for network connectivity checks.(Citation: MalwareBytes WoodyRAT Aug 2022)
- [G1016] FIN13: [FIN13](https://attack.mitre.org/groups/G1016) has used `Ping` and `tracert` for network reconnaissance efforts.(Citation: Mandiant FIN13 Aug 2022)
- [S0448] Rising Sun: [Rising Sun](https://attack.mitre.org/software/S0448) can test a connection to a specified network IP address over a specified port number.(Citation: McAfee Sharpshooter December 2018)
- [G0125] HAFNIUM: [HAFNIUM](https://attack.mitre.org/groups/G0125) has checked for network connectivity from a compromised host using `ping`, including attempts to contact `google[.]com`.(Citation: Rapid7 HAFNIUM Mar 2021)
- [G0010] Turla: [Turla](https://attack.mitre.org/groups/G0010) has used <code>tracert</code> to check internet connectivity.(Citation: ESET ComRAT May 2020)
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has employed [Ping](https://attack.mitre.org/software/S0097) to check network connectivity.(Citation: CISA AA24-038A PRC Critical Infrastructure February 2024)
- [G0061] FIN8: [FIN8](https://attack.mitre.org/groups/G0061) has used the [Ping](https://attack.mitre.org/software/S0097) command to check connectivity to actor-controlled C2 servers.(Citation: Bitdefender Sardonic Aug 2021)

#### T1016.002 - Wi-Fi Discovery

Description:

Adversaries may search for information about Wi-Fi networks, such as network names and passwords, on compromised systems. Adversaries may use Wi-Fi information as part of [Account Discovery](https://attack.mitre.org/techniques/T1087), [Remote System Discovery](https://attack.mitre.org/techniques/T1018), and other discovery or [Credential Access](https://attack.mitre.org/tactics/TA0006) activity to support both ongoing and future campaigns.

Adversaries may collect various types of information about Wi-Fi networks from hosts. For example, on Windows names and passwords of all Wi-Fi networks a device has previously connected to may be available through `netsh wlan show profiles` to enumerate Wi-Fi names and then `netsh wlan show profile “Wi-Fi name” key=clear` to show a Wi-Fi network’s corresponding password.(Citation: BleepingComputer Agent Tesla steal wifi passwords)(Citation: Malware Bytes New AgentTesla variant steals WiFi credentials)(Citation: Check Point APT35 CharmPower January 2022) Additionally, names and other details of locally reachable Wi-Fi networks can be discovered using calls to `wlanAPI.dll` [Native API](https://attack.mitre.org/techniques/T1106) functions.(Citation: Binary Defense Emotes Wi-Fi Spreader)

On Linux, names and passwords of all Wi-Fi-networks a device has previously connected to may be available in files under ` /etc/NetworkManager/system-connections/`.(Citation: Wi-Fi Password of All Connected Networks in Windows/Linux) On macOS, the password of a known Wi-Fi may be identified with ` security find-generic-password -wa wifiname` (requires admin username/password).(Citation: Find Wi-Fi Password on Mac)

Procedures:

- [G0059] Magic Hound: [Magic Hound](https://attack.mitre.org/groups/G0059) has collected names and passwords of all Wi-Fi networks to which a device has previously connected.(Citation: Check Point APT35 CharmPower January 2022)
- [C0051] APT28 Nearest Neighbor Campaign: During [APT28 Nearest Neighbor Campaign](https://attack.mitre.org/campaigns/C0051), [APT28](https://attack.mitre.org/groups/G0007) collected information on wireless interfaces within range of a compromised system.(Citation: Nearest Neighbor Volexity)
- [S0331] Agent Tesla: [Agent Tesla](https://attack.mitre.org/software/S0331) can collect names and passwords of all Wi-Fi networks to which a device has previously connected.(Citation: Malwarebytes Agent Tesla April 2020)
- [S0367] Emotet: [Emotet](https://attack.mitre.org/software/S0367) can extract names of all locally reachable Wi-Fi networks and then perform a brute-force attack to spread to new networks.(Citation: Binary Defense Emotes Wi-Fi Spreader)


### T1018 - Remote System Discovery

Description:

Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. Functionality could exist within remote access tools to enable this, but utilities available on the operating system could also be used such as  [Ping](https://attack.mitre.org/software/S0097), <code>net view</code> using [Net](https://attack.mitre.org/software/S0039), or, on ESXi servers, `esxcli network diag ping`.

Adversaries may also analyze data from local host files (ex: <code>C:\Windows\System32\Drivers\etc\hosts</code> or <code>/etc/hosts</code>) or other passive means (such as local [Arp](https://attack.mitre.org/software/S0099) cache entries) in order to discover the presence of remote systems in an environment.

Adversaries may also target discovery of network infrastructure as well as leverage [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands on network devices to gather detailed information about systems within a network (e.g. <code>show cdp neighbors</code>, <code>show arp</code>).(Citation: US-CERT-TA18-106A)(Citation: CISA AR21-126A FIVEHANDS May 2021)

Procedures:

- [G1003] Ember Bear: [Ember Bear](https://attack.mitre.org/groups/G1003) has used tools such as Nmap and MASSCAN for remote service discovery.(Citation: CISA GRU29155 2024)
- [G0045] menuPass: [menuPass](https://attack.mitre.org/groups/G0045) uses scripts to enumerate IP ranges on the victim network. [menuPass](https://attack.mitre.org/groups/G0045) has also issued the command <code>net view /domain</code> to a [PlugX](https://attack.mitre.org/software/S0013) implant to gather information about remote systems on the network.(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: FireEye APT10 April 2017)
- [S0233] MURKYTOP: [MURKYTOP](https://attack.mitre.org/software/S0233) has the capability to identify remote hosts on connected networks.(Citation: FireEye Periscope March 2018)
- [S0586] TAINTEDSCRIBE: The [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) command and execution module can perform target system enumeration.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE MAY 2020)
- [S0684] ROADTools: [ROADTools](https://attack.mitre.org/software/S0684) can enumerate Azure AD systems and devices.(Citation: Roadtools)
- [S0570] BitPaymer: [BitPaymer](https://attack.mitre.org/software/S0570) can use <code>net view</code> to discover remote systems.(Citation: Crowdstrike Indrik November 2018)
- [S0650] QakBot: [QakBot](https://attack.mitre.org/software/S0650) can identify remote systems through the <code>net view</code> command.(Citation: Crowdstrike Qakbot October 2020)(Citation: Kaspersky QakBot September 2021)(Citation: Trend Micro Black Basta October 2022)
- [C0012] Operation CuckooBees: During [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), the threat actors used the `net view` and `ping` commands as part of their advanced reconnaissance.(Citation: Cybereason OperationCuckooBees May 2022)
- [C0014] Operation Wocao: During [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors used `nbtscan` and `ping` to discover remote systems, as well as `dsquery subnet` on a domain controller to retrieve all subnets in the Active Directory.(Citation: FoxIT Wocao December 2019)
- [G0117] Fox Kitten: [Fox Kitten](https://attack.mitre.org/groups/G0117) has used Angry IP Scanner to detect remote systems.(Citation: CISA AA20-259A Iran-Based Actor September 2020)
- [S0452] USBferry: [USBferry](https://attack.mitre.org/software/S0452) can use <code>net view</code> to gather information about remote systems.(Citation: TrendMicro Tropic Trooper May 2020)
- [S0534] Bazar: [Bazar](https://attack.mitre.org/software/S0534) can enumerate remote systems using <code> Net View</code>.(Citation: Cybereason Bazar July 2020)
- [S1081] BADHATCH: [BADHATCH](https://attack.mitre.org/software/S1081) can use a PowerShell object such as, `System.Net.NetworkInformation.Ping` to ping a computer.(Citation: BitDefender BADHATCH Mar 2021)
- [G1030] Agrius: [Agrius](https://attack.mitre.org/groups/G1030) used the tool [NBTscan](https://attack.mitre.org/software/S0590) to scan for remote, accessible hosts in victim environments.(Citation: Unit42 Agrius 2023)
- [S1068] BlackCat: [BlackCat](https://attack.mitre.org/software/S1068) can broadcasts NetBIOS Name Service (NBNC) messages to search for servers connected to compromised networks.(Citation: Microsoft BlackCat Jun 2022)
- [G0019] Naikon: [Naikon](https://attack.mitre.org/groups/G0019) has used a netbios scanner for remote machine identification.(Citation: Bitdefender Naikon April 2021)
- [G0009] Deep Panda: [Deep Panda](https://attack.mitre.org/groups/G0009) has used ping to identify other machines of interest.(Citation: Alperovitch 2014)
- [G1006] Earth Lusca: [Earth Lusca](https://attack.mitre.org/groups/G1006) used the command <code>powershell “Get-EventLog -LogName security -Newest 500 | where {$_.EventID -eq 4624} | format-list -
property * | findstr “Address””</code> to find the network information of successfully logged-in accounts to discovery addresses of other machines. [Earth Lusca](https://attack.mitre.org/groups/G1006) has also used multiple scanning tools to discover other machines within the same compromised network.(Citation: TrendMicro EarthLusca 2022)
- [G0096] APT41: [APT41](https://attack.mitre.org/groups/G0096) has used MiPing to discover active systems in the victim network.(Citation: apt41_dcsocytec_dec2022)
- [S0039] Net: Commands such as <code>net view</code> can be used in [Net](https://attack.mitre.org/software/S0039) to gather information about available remote systems.(Citation: Savill 1999)
- [S1070] Black Basta: [Black Basta](https://attack.mitre.org/software/S1070) can use LDAP queries to connect to AD and iterate over connected workstations.(Citation: Check Point Black Basta October 2022)
- [S0248] yty: [yty](https://attack.mitre.org/software/S0248) uses the <code>net view</code> command for discovery.(Citation: ASERT Donot March 2018)
- [C0007] FunnyDream: During [FunnyDream](https://attack.mitre.org/campaigns/C0007), the threat actors used several tools and batch files to map victims' internal networks.(Citation: Bitdefender FunnyDream Campaign November 2020)
- [G0053] FIN5: [FIN5](https://attack.mitre.org/groups/G0053) has used the open source tool Essential NetTools to map the network and build a list of targets.(Citation: Mandiant FIN5 GrrCON Oct 2016)
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has used multiple methods, including [Ping](https://attack.mitre.org/software/S0097), to enumerate systems on compromised networks.(Citation: Microsoft Volt Typhoon May 2023)(Citation: Secureworks BRONZE SILHOUETTE May 2023)
- [G0034] Sandworm Team: [Sandworm Team](https://attack.mitre.org/groups/G0034) has used a tool to query Active Directory using LDAP, discovering information about computers listed in AD.(Citation: ESET Telebots Dec 2016)(Citation: Dragos Crashoverride 2018)
- [G1040] Play: [Play](https://attack.mitre.org/groups/G1040) has used tools such as [AdFind](https://attack.mitre.org/software/S0552), [Nltest](https://attack.mitre.org/software/S0359), and [BloodHound](https://attack.mitre.org/software/S0521) to enumerate shares and hostnames on compromised networks.(Citation: Trend Micro Ransomware Spotlight Play July 2023)
- [S0385] njRAT: [njRAT](https://attack.mitre.org/software/S0385) can identify remote hosts on connected networks.(Citation: Fidelis njRAT June 2013)
- [S0604] Industroyer: [Industroyer](https://attack.mitre.org/software/S0604) can enumerate remote computers in the compromised network.(Citation: ESET Industroyer)
- [S0125] Remsec: [Remsec](https://attack.mitre.org/software/S0125) can ping or traceroute a remote host.(Citation: Kaspersky ProjectSauron Technical Analysis)
- [C0049] Leviathan Australian Intrusions: [Leviathan](https://attack.mitre.org/groups/G0065) performed extensive remote host enumeration to build their own map of victim networks during [Leviathan Australian Intrusions](https://attack.mitre.org/campaigns/C0049).(Citation: CISA Leviathan 2024)
- [G1024] Akira: [Akira](https://attack.mitre.org/groups/G1024) uses software such as Advanced IP Scanner and MASSCAN to identify remote hosts within victim networks.(Citation: Arctic Wolf Akira 2023)
- [S1198] Gomir: [Gomir](https://attack.mitre.org/software/S1198) probes arbitrary network endpoints for TCP connectivity.(Citation: Symantec Troll Stealer 2024)
- [C0028] 2015 Ukraine Electric Power Attack: During the [2015 Ukraine Electric Power Attack](https://attack.mitre.org/campaigns/C0028), [Sandworm Team](https://attack.mitre.org/groups/G0034) remotely discovered systems over LAN connections. OT systems were visible from the IT network   as well, giving adversaries the ability to discover operational assets. (Citation: Charles McLellan March 2016)
- [G0004] Ke3chang: [Ke3chang](https://attack.mitre.org/groups/G0004) has used network scanning and enumeration tools, including [Ping](https://attack.mitre.org/software/S0097).(Citation: NCC Group APT15 Alive and Strong)
- [S0488] CrackMapExec: [CrackMapExec](https://attack.mitre.org/software/S0488) can discover active IP addresses, along with the machine name, within a targeted network.(Citation: CME Github September 2018)
- [S0428] PoetRAT: [PoetRAT](https://attack.mitre.org/software/S0428) used Nmap for remote system discovery.(Citation: Talos PoetRAT April 2020)
- [G1001] HEXANE: [HEXANE](https://attack.mitre.org/groups/G1001) has used `net view` to enumerate domain machines.(Citation: Kaspersky Lyceum October 2021)
- [S1212] RansomHub: [RansomHub](https://attack.mitre.org/software/S1212) can enumerate all accessible machines from the infected system.(Citation: Group-IB RansomHub FEB 2025)
- [S0091] Epic: [Epic](https://attack.mitre.org/software/S0091) uses the <code>net view</code> command on the victim’s machine.(Citation: Kaspersky Turla)
- [S0236] Kwampirs: [Kwampirs](https://attack.mitre.org/software/S0236) collects a list of available servers with the command <code>net view</code>.(Citation: Symantec Orangeworm April 2018)
- [S1044] FunnyDream: [FunnyDream](https://attack.mitre.org/software/S1044) can collect information about hosts on the victim network.(Citation: Kaspersky APT Trends Q1 2020)
- [C0024] SolarWinds Compromise: During the [SolarWinds Compromise](https://attack.mitre.org/campaigns/C0024), [APT29](https://attack.mitre.org/groups/G0016) used [AdFind](https://attack.mitre.org/software/S0552) to enumerate remote systems.(Citation: Microsoft Deep Dive Solorigate January 2021)
- [S0244] Comnie: [Comnie](https://attack.mitre.org/software/S0244) runs the <code>net view</code> command
- [S0366] WannaCry: [WannaCry](https://attack.mitre.org/software/S0366) scans its local network segment for remote systems to try to exploit and copy itself to.(Citation: SecureWorks WannaCry Analysis)
- [G0027] Threat Group-3390: [Threat Group-3390](https://attack.mitre.org/groups/G0027) has used the <code>net view</code> command.(Citation: Nccgroup Emissary Panda May 2018)
- [S0018] Sykipot: [Sykipot](https://attack.mitre.org/software/S0018) may use <code>net view /domain</code> to display hostnames of available systems on a network.(Citation: AlienVault Sykipot 2011)
- [S0154] Cobalt Strike: [Cobalt Strike](https://attack.mitre.org/software/S0154) uses the native Windows Network Enumeration APIs to interrogate and discover targets in a Windows Active Directory network.(Citation: cobaltstrike manual)(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020)
- [S0692] SILENTTRINITY: [SILENTTRINITY](https://attack.mitre.org/software/S0692) can enumerate and collect the properties of domain computers.(Citation: GitHub SILENTTRINITY Modules July 2019)
- [S0521] BloodHound: [BloodHound](https://attack.mitre.org/software/S0521) can enumerate and collect the properties of domain computers, including domain controllers.(Citation: CrowdStrike BloodHound April 2018)
- [S0694] DRATzarus: [DRATzarus](https://attack.mitre.org/software/S0694) can search for other machines connected to compromised host and attempt to map the network.(Citation: ClearSky Lazarus Aug 2020)
- [S0165] OSInfo: [OSInfo](https://attack.mitre.org/software/S0165) performs a connection test to discover remote systems in the network(Citation: Symantec Buckeye)
- [S0696] Flagpro: [Flagpro](https://attack.mitre.org/software/S0696) has been used to execute <code>net view</code> on a targeted system.(Citation: NTT Security Flagpro new December 2021)
- [G1022] ToddyCat: [ToddyCat](https://attack.mitre.org/groups/G1022) has used `ping %REMOTE_HOST%` for post exploit discovery.(Citation: Kaspersky ToddyCat Check Logs October 2023)
- [S0698] HermeticWizard: [HermeticWizard](https://attack.mitre.org/software/S0698) can find machines on the local network by gathering known local IP addresses through `DNSGetCacheDataTable`, `GetIpNetTable`,`WNetOpenEnumW(RESOURCE_GLOBALNET, RESOURCETYPE_ANY)`,`NetServerEnum`,`GetTcpTable`, and `GetAdaptersAddresses.`(Citation: ESET Hermetic Wizard March 2022)
- [G0030] Lotus Blossom: [Lotus Blossom](https://attack.mitre.org/groups/G0030) has used [Ping](https://attack.mitre.org/software/S0097) to identify remote systems.(Citation: Symantec Bilbug 2022)
- [G0060] BRONZE BUTLER: [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) typically use <code>ping</code> and [Net](https://attack.mitre.org/software/S0039) to enumerate systems.(Citation: Secureworks BRONZE BUTLER Oct 2017)
- [G0087] APT39: [APT39](https://attack.mitre.org/groups/G0087) has used [NBTscan](https://attack.mitre.org/software/S0590) and custom tools to discover remote systems.(Citation: FireEye APT39 Jan 2019)(Citation: BitDefender Chafer May 2020)(Citation: Symantec Chafer February 2018)
- [S0097] Ping: [Ping](https://attack.mitre.org/software/S0097) can be used to identify remote systems within a network.(Citation: TechNet Ping)
- [S0575] Conti: [Conti](https://attack.mitre.org/software/S0575) has the ability to discover hosts on a target network.(Citation: CrowdStrike Wizard Spider October 2020)
- [S0241] RATANKBA: [RATANKBA](https://attack.mitre.org/software/S0241) runs the <code>net view /domain</code> and <code>net view</code> commands.(Citation: RATANKBA)
- [S0063] SHOTPUT: [SHOTPUT](https://attack.mitre.org/software/S0063) has a command to list all servers in the domain, as well as one to locate domain controllers on a domain.(Citation: Palo Alto CVE-2015-3113 July 2015)
- [S1146] MgBot: [MgBot](https://attack.mitre.org/software/S1146) includes modules for performing ARP scans of local connected systems.(Citation: Symantec Daggerfly 2023)
- [G0050] APT32: [APT32](https://attack.mitre.org/groups/G0050) has enumerated DC servers using the command <code>net group "Domain Controllers" /domain</code>. The group has also used the <code>ping</code> command.(Citation: Cybereason Cobalt Kitty 2017)
- [G0091] Silence: [Silence](https://attack.mitre.org/groups/G0091) has used Nmap to scan the corporate network, build a network topology, and identify vulnerable hosts.(Citation: Group IB Silence Sept 2018)
- [S0335] Carbon: [Carbon](https://attack.mitre.org/software/S0335) uses the <code>net view</code> command.(Citation: GovCERT Carbon May 2016)
- [S0599] Kinsing: [Kinsing](https://attack.mitre.org/software/S0599) has used a script to parse files like <code>/etc/hosts</code> and SSH <code>known_hosts</code> to discover remote systems.(Citation: Aqua Kinsing April 2020)
- [G0037] FIN6: [FIN6](https://attack.mitre.org/groups/G0037) used publicly available tools (including Microsoft's built-in SQL querying tool, osql.exe) to map the internal network and conduct reconnaissance against Active Directory, Structured Query Language (SQL) servers, and NetBIOS.(Citation: FireEye FIN6 April 2016)
- [S0659] Diavol: [Diavol](https://attack.mitre.org/software/S0659) can use the ARP table to find remote hosts to scan.(Citation: Fortinet Diavol July 2021)
- [S0266] TrickBot: [TrickBot](https://attack.mitre.org/software/S0266) can enumerate computers and network devices.(Citation: Cyberreason Anchor December 2019)
- [G0119] Indrik Spider: [Indrik Spider](https://attack.mitre.org/groups/G0119) has used PowerView to enumerate all Windows Server, Windows Server 2003, and Windows 7 instances in the Active Directory database.(Citation: Symantec WastedLocker June 2020)
- [S0646] SpicyOmelette: [SpicyOmelette](https://attack.mitre.org/software/S0646) can identify payment systems, payment gateways, and ATM systems in compromised environments.(Citation: Secureworks GOLD KINGSWOOD September 2018)
- [G0010] Turla: [Turla](https://attack.mitre.org/groups/G0010) surveys a system upon check-in to discover remote systems on a local network using the <code>net view</code> and <code>net view /DOMAIN</code> commands. [Turla](https://attack.mitre.org/groups/G0010) has also used <code>net group "Domain Computers" /domain</code>, <code>net group "Domain Controllers" /domain</code>, and <code>net group "Exchange Servers" /domain</code> to enumerate domain computers, including the organization's DC and Exchange Server.(Citation: Kaspersky Turla)(Citation: ESET ComRAT May 2020)
- [S0099] Arp: [Arp](https://attack.mitre.org/software/S0099) can be used to display a host's ARP cache, which may include address resolutions for remote systems.(Citation: TechNet Arp)(Citation: Palo Alto ARP)
- [S0590] NBTscan: [NBTscan](https://attack.mitre.org/software/S0590) can list NetBIOS computer names.(Citation: Debian nbtscan Nov 2019)(Citation: SecTools nbtscan June 2003)
- [G0106] Rocke: [Rocke](https://attack.mitre.org/groups/G0106) has looked for IP addresses in the known_hosts file on the infected system and attempted to SSH into them.(Citation: Talos Rocke August 2018)
- [G0077] Leafminer: [Leafminer](https://attack.mitre.org/groups/G0077) used Microsoft’s Sysinternals tools to gather detailed information about remote systems.(Citation: Symantec Leafminer July 2018)
- [S0365] Olympic Destroyer: [Olympic Destroyer](https://attack.mitre.org/software/S0365) uses [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) to enumerate all systems in the network.(Citation: Talos Olympic Destroyer 2018)
- [G0059] Magic Hound: [Magic Hound](https://attack.mitre.org/groups/G0059) has used [Ping](https://attack.mitre.org/software/S0097) for discovery on targeted networks.(Citation: DFIR Phosphorus November 2021)
- [S0359] Nltest: [Nltest](https://attack.mitre.org/software/S0359) may be used to enumerate remote domain controllers using options such as <code>/dclist</code> and <code>/dsgetdc</code>.(Citation: Nltest Manual)
- [G1015] Scattered Spider: [Scattered Spider](https://attack.mitre.org/groups/G1015) can enumerate remote systems, such as VMware vCenter infrastructure.(Citation: CISA Scattered Spider Advisory November 2023)
- [G0114] Chimera: [Chimera](https://attack.mitre.org/groups/G0114) has utilized various scans and queries to find domain controllers and remote services in the target environment.(Citation: NCC Group Chimera January 2021)
- [C0025] 2016 Ukraine Electric Power Attack: During the [2016 Ukraine Electric Power Attack](https://attack.mitre.org/campaigns/C0025), [Sandworm Team](https://attack.mitre.org/groups/G0034) checked for connectivity to resources within the network and used LDAP to query Active Directory, discovering information about computers listed in AD.(Citation: Dragos Crashoverride 2018)
- [G0125] HAFNIUM: [HAFNIUM](https://attack.mitre.org/groups/G0125) has enumerated domain controllers using `net group "Domain computers"` and `nltest /dclist`.(Citation: Rapid7 HAFNIUM Mar 2021)
- [G0102] Wizard Spider: [Wizard Spider](https://attack.mitre.org/groups/G0102) has used networkdll for network discovery and psfin specifically for financial and point of sale indicators. [Wizard Spider](https://attack.mitre.org/groups/G0102) has also used [AdFind](https://attack.mitre.org/software/S0552), <code>nltest/dclist</code>, and PowerShell script Get-DataInfo.ps1 to enumerate domain computers, including the domain controller.(Citation: FireEye Ryuk and Trickbot January 2019)(Citation: CrowdStrike Grim Spider May 2019)(Citation: FireEye KEGTAP SINGLEMALT October 2020)(Citation: Red Canary Hospital Thwarted Ryuk October 2020)(Citation: DFIR Ryuk's Return October 2020)(Citation: Mandiant FIN12 Oct 2021)
- [S0552] AdFind: [AdFind](https://attack.mitre.org/software/S0552) has the ability to query Active Directory for computers.(Citation: Red Canary Hospital Thwarted Ryuk October 2020)(Citation: FireEye FIN6 Apr 2019)(Citation: FireEye Ryuk and Trickbot January 2019)(Citation: Cybereason Bumblebee August 2022)
- [S0140] Shamoon: [Shamoon](https://attack.mitre.org/software/S0140) scans the C-class subnet of the IPs on the victim's interfaces.(Citation: FireEye Shamoon Nov 2016)
- [S1159] DUSTTRAP: [DUSTTRAP](https://attack.mitre.org/software/S1159) can use `ping` to identify remote hosts within the victim network.(Citation: Google Cloud APT41 2024)
- [G0022] APT3: [APT3](https://attack.mitre.org/groups/G0022) has a tool that can detect the existence of remote systems.(Citation: Symantec Buckeye)(Citation: FireEye Clandestine Fox)
- [C0015] C0015: During [C0015](https://attack.mitre.org/campaigns/C0015), the threat actors used the commands `net view /all /domain` and `ping` to discover remote systems. They also used PowerView's PowerShell Invoke-ShareFinder script for file share enumeration.(Citation: DFIR Conti Bazar Nov 2021)
- [G0093] GALLIUM: [GALLIUM](https://attack.mitre.org/groups/G0093) used a modified version of [NBTscan](https://attack.mitre.org/software/S0590) to identify available NetBIOS name servers over the network as well as <code>ping</code> to identify remote systems.(Citation: Cybereason Soft Cell June 2019)
- [G1043] BlackByte: [BlackByte](https://attack.mitre.org/groups/G1043) used tools such as [Arp](https://attack.mitre.org/software/S0099) to identify remotely-connected devices.(Citation: FBI BlackByte 2022)(Citation: Picus BlackByte 2022)
- [G0061] FIN8: [FIN8](https://attack.mitre.org/groups/G0061) has used [dsquery](https://attack.mitre.org/software/S0105) and other Active Directory utilities to enumerate hosts; they have also used <code>nltest.exe /dclist</code> to retrieve a list of domain controllers.(Citation: FireEye Know Your Enemy FIN8 Aug 2016)(Citation: Bitdefender FIN8 July 2021)
- [S0093] Backdoor.Oldrea: [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) can enumerate and map ICS-specific systems in victim environments.(Citation: Gigamon Berserk Bear October 2021)
- [G0035] Dragonfly: [Dragonfly](https://attack.mitre.org/groups/G0035) has likely obtained a list of hosts in the victim environment.(Citation: US-CERT TA18-074A)


### T1033 - System Owner/User Discovery

Description:

Adversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system. They may do this, for example, by retrieving account usernames or by using [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). The information may be collected in a number of different ways using other Discovery techniques, because user and username details are prevalent throughout a system and include running process ownership, file/directory ownership, session information, and system logs. Adversaries may use the information from [System Owner/User Discovery](https://attack.mitre.org/techniques/T1033) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Various utilities and commands may acquire this information, including <code>whoami</code>. In macOS and Linux, the currently logged in user can be identified with <code>w</code> and <code>who</code>. On macOS the <code>dscl . list /Users | grep -v '_'</code> command can also be used to enumerate user accounts. Environment variables, such as <code>%USERNAME%</code> and <code>$USER</code>, may also be used to access this information.

On network devices, [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as `show users` and `show ssh` can be used to display users currently logged into the device.(Citation: show_ssh_users_cmd_cisco)(Citation: US-CERT TA18-106A Network Infrastructure Devices 2018)

Procedures:

- [S0094] Trojan.Karagany: [Trojan.Karagany](https://attack.mitre.org/software/S0094) can gather information about the user on a compromised host.(Citation: Secureworks Karagany July 2019)
- [S0428] PoetRAT: [PoetRAT](https://attack.mitre.org/software/S0428) sent username, computer name, and the previously generated UUID in reply to a "who" command from C2.(Citation: Talos PoetRAT April 2020)
- [S0379] Revenge RAT: [Revenge RAT](https://attack.mitre.org/software/S0379) gathers the username from the system.(Citation: Cylance Shaheen Nov 2018)
- [S0694] DRATzarus: [DRATzarus](https://attack.mitre.org/software/S0694) can obtain a list of users from an infected machine.(Citation: ClearSky Lazarus Aug 2020)
- [S0266] TrickBot: [TrickBot](https://attack.mitre.org/software/S0266) can identify the user and groups the user belongs to on a compromised host.(Citation: Cyberreason Anchor December 2019)
- [S0596] ShadowPad: [ShadowPad](https://attack.mitre.org/software/S0596) has collected the username of the victim system.(Citation: Kaspersky ShadowPad Aug 2017)
- [S1030] Squirrelwaffle: [Squirrelwaffle](https://attack.mitre.org/software/S1030) can collect the user name from a compromised host.(Citation: ZScaler Squirrelwaffle Sep 2021)
- [S0367] Emotet: [Emotet](https://attack.mitre.org/software/S0367) has enumerated all users connected to network shares.
- [G0082] APT38: [APT38](https://attack.mitre.org/groups/G0082) has identified primary users, currently logged in users, sets of users that commonly use a system, or inactive users.(Citation: CISA AA20-239A BeagleBoyz August 2020)
- [S0590] NBTscan: [NBTscan](https://attack.mitre.org/software/S0590) can list active users on the system.(Citation: Debian nbtscan Nov 2019)(Citation: SecTools nbtscan June 2003)
- [S0272] NDiskMonitor: [NDiskMonitor](https://attack.mitre.org/software/S0272) obtains the victim username and encrypts the information to send over its C2 channel.(Citation: TrendMicro Patchwork Dec 2017)
- [S0414] BabyShark: [BabyShark](https://attack.mitre.org/software/S0414) has executed the <code>whoami</code> command.(Citation: Unit42 BabyShark Feb 2019)
- [S0514] WellMess: [WellMess](https://attack.mitre.org/software/S0514) can collect the username on the victim machine to send to C2.(Citation: CISA WellMess July 2020)
- [G1036] Moonstone Sleet: [Moonstone Sleet](https://attack.mitre.org/groups/G1036) deployed various malware such as YouieLoader that can perform system user discovery actions.(Citation: Microsoft Moonstone Sleet 2024)
- [S1016] MacMa: [MacMa](https://attack.mitre.org/software/S1016) can collect the username from the compromised machine.(Citation: ESET DazzleSpy Jan 2022)
- [S0058] SslMM: [SslMM](https://attack.mitre.org/software/S0058) sends the logged-on username to its hard-coded C2.(Citation: Baumgartner Naikon 2015)
- [S0657] BLUELIGHT: [BLUELIGHT](https://attack.mitre.org/software/S0657) can collect the username on a compromised host.(Citation: Volexity InkySquid BLUELIGHT August 2021)
- [S1146] MgBot: [MgBot](https://attack.mitre.org/software/S1146) includes modules for identifying local users and administrators on victim machines.(Citation: Symantec Daggerfly 2023)
- [S1034] StrifeWater: [StrifeWater](https://attack.mitre.org/software/S1034) can collect the user name from the victim's machine.(Citation: Cybereason StrifeWater Feb 2022)
- [S1039] Bumblebee: [Bumblebee](https://attack.mitre.org/software/S1039) has the ability to identify the user name.(Citation: Google EXOTIC LILY March 2022)
- [S1153] Cuckoo Stealer: [Cuckoo Stealer](https://attack.mitre.org/software/S1153) can discover and send the username from a compromised host to C2.(Citation: Kandji Cuckoo April 2024)
- [S0024] Dyre: [Dyre](https://attack.mitre.org/software/S0024) has the ability to identify the users on a compromised host.(Citation: Malwarebytes Dyreza November 2015)
- [S1065] Woody RAT: [Woody RAT](https://attack.mitre.org/software/S1065) can retrieve a list of user accounts and usernames from an infected machine.(Citation: MalwareBytes WoodyRAT Aug 2022)
- [S0659] Diavol: [Diavol](https://attack.mitre.org/software/S0659) can collect the username from a compromised host.(Citation: Fortinet Diavol July 2021)
- [S0091] Epic: [Epic](https://attack.mitre.org/software/S0091) collects the user name from the victim’s machine.(Citation: Kaspersky Turla Aug 2014)
- [S0223] POWERSTATS: [POWERSTATS](https://attack.mitre.org/software/S0223) has the ability to identify the username on the compromised host.(Citation: TrendMicro POWERSTATS V3 June 2019)
- [G0061] FIN8: [FIN8](https://attack.mitre.org/groups/G0061) has executed the command `quser` to display the session details of a compromised machine.(Citation: Symantec FIN8 Jul 2023)
- [S0085] S-Type: [S-Type](https://attack.mitre.org/software/S0085) has run tests to determine the privilege level of the compromised user.(Citation: Cylance Dust Storm)
- [S0652] MarkiRAT: [MarkiRAT](https://attack.mitre.org/software/S0652) can retrieve the victim’s username.(Citation: Kaspersky Ferocious Kitten Jun 2021)
- [G0004] Ke3chang: [Ke3chang](https://attack.mitre.org/groups/G0004) has used implants capable of collecting the signed-in username.(Citation: Microsoft NICKEL December 2021)
- [S0256] Mosquito: [Mosquito](https://attack.mitre.org/software/S0256) runs <code>whoami</code> on the victim’s machine.(Citation: ESET Turla Mosquito Jan 2018)
- [S0130] Unknown Logger: [Unknown Logger](https://attack.mitre.org/software/S0130) can obtain information about the victim usernames.(Citation: Forcepoint Monsoon)
- [S0344] Azorult: [Azorult](https://attack.mitre.org/software/S0344) can collect the username from the victim’s machine.(Citation: Unit42 Azorult Nov 2018)
- [S1148] Raccoon Stealer: [Raccoon Stealer](https://attack.mitre.org/software/S1148) gathers information on the infected system owner and user.(Citation: S2W Racoon 2022)(Citation: Sekoia Raccoon1 2022)(Citation: Sekoia Raccoon2 2022)
- [S1059] metaMain: [metaMain](https://attack.mitre.org/software/S1059) can collect the username from a compromised host.(Citation: SentinelLabs Metador Technical Appendix Sept 2022)
- [G0046] FIN7: [FIN7](https://attack.mitre.org/groups/G0046) has used the command `cmd.exe /C quser` to collect user session information.(Citation: Mandiant FIN7 Apr 2022)
- [S1029] AuTo Stealer: [AuTo Stealer](https://attack.mitre.org/software/S1029) has the ability to collect the username from an infected host.(Citation: MalwareBytes SideCopy Dec 2021)
- [G0125] HAFNIUM: [HAFNIUM](https://attack.mitre.org/groups/G0125) has used `whoami` to gather user information.(Citation: Rapid7 HAFNIUM Mar 2021)
- [C0017] C0017: During [C0017](https://attack.mitre.org/campaigns/C0017), [APT41](https://attack.mitre.org/groups/G0096) used `whoami` to gather information from victim machines.(Citation: Mandiant APT41)
- [S0401] Exaramel for Linux: [Exaramel for Linux](https://attack.mitre.org/software/S0401) can run <code>whoami</code> to identify the system owner.(Citation: ANSSI Sandworm January 2021)
- [S0663] SysUpdate: [SysUpdate](https://attack.mitre.org/software/S0663) can collect the username from a compromised host.(Citation: Lunghi Iron Tiger Linux)
- [G1035] Winter Vivern: [Winter Vivern](https://attack.mitre.org/groups/G1035) PowerShell scripts execute `whoami` to identify the executing user.(Citation: SentinelOne WinterVivern 2023)
- [S0241] RATANKBA: [RATANKBA](https://attack.mitre.org/software/S0241) runs the <code>whoami</code> and <code>query user</code> commands.(Citation: RATANKBA)
- [S0381] FlawedAmmyy: [FlawedAmmyy](https://attack.mitre.org/software/S0381) enumerates the current user during the initial infection.(Citation: Proofpoint TA505 Mar 2018)(Citation: Korean FSI TA505 2020)
- [S0448] Rising Sun: [Rising Sun](https://attack.mitre.org/software/S0448) can detect the username of the infected host.(Citation: McAfee Sharpshooter December 2018)
- [S0275] UPPERCUT: [UPPERCUT](https://attack.mitre.org/software/S0275) has the capability to collect the current logged on user’s username from a machine.(Citation: FireEye APT10 Sept 2018)
- [S0219] WINERACK: [WINERACK](https://attack.mitre.org/software/S0219) can gather information on the victim username.(Citation: FireEye APT37 Feb 2018)
- [S1160] Latrodectus: [Latrodectus](https://attack.mitre.org/software/S1160) can discover the username of an infected host.(Citation: Elastic Latrodectus May 2024)
- [S0242] SynAck: [SynAck](https://attack.mitre.org/software/S0242) gathers user names from infected hosts.(Citation: SecureList SynAck Doppelgänging May 2018)
- [S0161] XAgentOSX: [XAgentOSX](https://attack.mitre.org/software/S0161) contains the getInfoOSX function to return the OS X version as well as the current user.(Citation: XAgentOSX 2017)
- [S0155] WINDSHIELD: [WINDSHIELD](https://attack.mitre.org/software/S0155) can gather the victim user name.(Citation: FireEye APT32 May 2017)
- [S0250] Koadic: [Koadic](https://attack.mitre.org/software/S0250) can identify logged in users across the domain and views user sessions.(Citation: Github Koadic)(Citation: MalwareBytes LazyScripter Feb 2021)
- [S0680] LitePower: [LitePower](https://attack.mitre.org/software/S0680) can determine if the current user has admin privileges.(Citation: Kaspersky WIRTE November 2021)
- [G0073] APT19: [APT19](https://attack.mitre.org/groups/G0073) used an HTTP malware variant and a Port 22 malware variant to collect the victim’s username.(Citation: Unit 42 C0d0so0 Jan 2016)
- [S0340] Octopus: [Octopus](https://attack.mitre.org/software/S0340) can collect the username from the victim’s machine.(Citation: Securelist Octopus Oct 2018)
- [S0610] SideTwist: [SideTwist](https://attack.mitre.org/software/S0610) can collect the username on a targeted system.(Citation: Check Point APT34 April 2021)
- [S0374] SpeakUp: [SpeakUp](https://attack.mitre.org/software/S0374) uses the <code>whoami</code> command. (Citation: CheckPoint SpeakUp Feb 2019)
- [S0632] GrimAgent: [GrimAgent](https://attack.mitre.org/software/S0632) can identify the user id on a target machine.(Citation: Group IB GrimAgent July 2021)
- [S0348] Cardinal RAT: [Cardinal RAT](https://attack.mitre.org/software/S0348) can collect the username from a victim machine.(Citation: PaloAlto CardinalRat Apr 2017)
- [S0192] Pupy: [Pupy](https://attack.mitre.org/software/S0192) can enumerate local information for Linux hosts and find currently logged on users for Windows hosts.(Citation: GitHub Pupy)
- [S0447] Lokibot: [Lokibot](https://attack.mitre.org/software/S0447) has the ability to discover the username on the infected host.(Citation: FSecure Lokibot November 2019)
- [G0051] FIN10: [FIN10](https://attack.mitre.org/groups/G0051) has used Meterpreter to enumerate users on remote systems.(Citation: FireEye FIN10 June 2017)
- [S0331] Agent Tesla: [Agent Tesla](https://attack.mitre.org/software/S0331) can collect the username from the victim’s machine.(Citation: DigiTrust Agent Tesla Jan 2017)(Citation: Fortinet Agent Tesla April 2018)(Citation: Malwarebytes Agent Tesla April 2020)
- [S0459] MechaFlounder: [MechaFlounder](https://attack.mitre.org/software/S0459) has the ability to identify the username and hostname on a compromised host.(Citation: Unit 42 MechaFlounder March 2019)
- [G0050] APT32: [APT32](https://attack.mitre.org/groups/G0050) collected the victim's username and executed the <code>whoami</code> command on the victim's machine. [APT32](https://attack.mitre.org/groups/G0050) executed shellcode to collect the username on the victim's machine. (Citation: FireEye APT32 April 2020)(Citation: ESET OceanLotus)(Citation: Cybereason Cobalt Kitty 2017)
- [S0356] KONNI: [KONNI](https://attack.mitre.org/software/S0356) can collect the username from the victim’s machine.(Citation: Talos Konni May 2017)
- [S0249] Gold Dragon: [Gold Dragon](https://attack.mitre.org/software/S0249) collects the endpoint victim's username and uses it as a basis for downloading additional components from the C2 server.(Citation: McAfee Gold Dragon)
- [C0014] Operation Wocao: During [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors enumerated sessions and users on a remote host, and identified privileged users logged into a targeted system.(Citation: FoxIT Wocao December 2019)
- [S0532] Lucifer: [Lucifer](https://attack.mitre.org/software/S0532) has the ability to identify the username on a compromised host.(Citation: Unit 42 Lucifer June 2020)
- [S0171] Felismus: [Felismus](https://attack.mitre.org/software/S0171) collects the current username and sends it to the C2 server.(Citation: Forcepoint Felismus Mar 2017)
- [G0087] APT39: [APT39](https://attack.mitre.org/groups/G0087) used [Remexi](https://attack.mitre.org/software/S0375) to collect usernames from the system.(Citation: Symantec Chafer Dec 2015)
- [S1015] Milan: [Milan](https://attack.mitre.org/software/S1015) can identify users registered to a targeted machine.(Citation: ClearSky Siamesekitten August 2021)
- [S0251] Zebrocy: [Zebrocy](https://attack.mitre.org/software/S0251) gets the username from the system.(Citation: ESET Zebrocy Nov 2018)(Citation: CISA Zebrocy Oct 2020)
- [S0650] QakBot: [QakBot](https://attack.mitre.org/software/S0650) can identify the user name on a compromised system.(Citation: Kaspersky QakBot September 2021)(Citation: Trend Micro Black Basta October 2022)
- [S0351] Cannon: [Cannon](https://attack.mitre.org/software/S0351) can gather the username from the system.(Citation: Unit42 Cannon Nov 2018)
- [S0533] SLOTHFULMEDIA: [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) has collected the username from a victim machine.(Citation: CISA MAR SLOTHFULMEDIA October 2020)
- [S0647] Turian: [Turian](https://attack.mitre.org/software/S0647) can retrieve usernames.(Citation: ESET BackdoorDiplomacy Jun 2021)
- [S0627] SodaMaster: [SodaMaster](https://attack.mitre.org/software/S0627) can identify the username on a compromised host.(Citation: Securelist APT10 March 2021)
- [G0067] APT37: [APT37](https://attack.mitre.org/groups/G0067) identifies the victim username.(Citation: Talos Group123)
- [S1130] Raspberry Robin: [Raspberry Robin](https://attack.mitre.org/software/S1130) determines whether it is successfully running on a victim system by querying the running account information to determine if it is running in Session 0, indicating running with elevated privileges.(Citation: TrendMicro RaspberryRobin 2022)
- [G0032] Lazarus Group: Various [Lazarus Group](https://attack.mitre.org/groups/G0032) malware enumerates logged-on users.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: Novetta Blockbuster Loaders)(Citation: Novetta Blockbuster RATs)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: SentinelOne Lazarus macOS July 2020)(Citation: Lazarus APT January 2022)
- [C0002] Night Dragon: During [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors used password cracking and pass-the-hash tools to discover usernames and passwords.(Citation: McAfee Night Dragon)
- [S0184] POWRUNER: [POWRUNER](https://attack.mitre.org/software/S0184) may collect information about the currently logged in user by running <code>whoami</code> on a victim.(Citation: FireEye APT34 Dec 2017)
- [S0260] InvisiMole: [InvisiMole](https://attack.mitre.org/software/S0260) lists local users and session information.(Citation: ESET InvisiMole June 2018)
- [S0456] Aria-body: [Aria-body](https://attack.mitre.org/software/S0456) has the ability to identify the username on a compromised host.(Citation: CheckPoint Naikon May 2020)
- [S1087] AsyncRAT: [AsyncRAT](https://attack.mitre.org/software/S1087) can check if the current user of a compromised system is an administrator. (Citation: Telefonica Snip3 December 2021)
- [S0531] Grandoreiro: [Grandoreiro](https://attack.mitre.org/software/S0531) can collect the username from the victim's machine.(Citation: ESET Grandoreiro April 2020)
- [G0081] Tropic Trooper: [Tropic Trooper](https://attack.mitre.org/groups/G0081) used <code>letmein</code> to scan for saved usernames on the target system.(Citation: TrendMicro TropicTrooper 2015)
- [G0027] Threat Group-3390: [Threat Group-3390](https://attack.mitre.org/groups/G0027) has used `whoami` to collect system user information.(Citation: Trend Micro DRBControl February 2020)
- [S0631] Chaes: [Chaes](https://attack.mitre.org/software/S0631) has collected the username and UID from the infected machine.(Citation: Cybereason Chaes Nov 2020)
- [S0476] Valak: [Valak](https://attack.mitre.org/software/S0476) can gather information regarding the user.(Citation: Cybereason Valak May 2020)
- [C0018] C0018: During [C0018](https://attack.mitre.org/campaigns/C0018), the threat actors collected `whoami` information via PowerShell scripts.(Citation: Costa AvosLocker May 2022)
- [S1081] BADHATCH: [BADHATCH](https://attack.mitre.org/software/S1081) can obtain logged user information from a compromised machine and can execute the command `whoami.exe`.(Citation: BitDefender BADHATCH Mar 2021)
- [S0139] PowerDuke: [PowerDuke](https://attack.mitre.org/software/S0139) has commands to get the current user's name and SID.(Citation: Volexity PowerDuke November 2016)
- [G1006] Earth Lusca: [Earth Lusca](https://attack.mitre.org/groups/G1006) collected information on user accounts via the <code>whoami</code> command.(Citation: TrendMicro EarthLusca 2022)
- [S0262] QuasarRAT: [QuasarRAT](https://attack.mitre.org/software/S0262) can enumerate the username and account type.(Citation: CISA AR18-352A Quasar RAT December 2018)
- [S0270] RogueRobin: [RogueRobin](https://attack.mitre.org/software/S0270) collects the victim’s username and whether that user is an admin.(Citation: Unit 42 DarkHydrus July 2018)
- [S0391] HAWKBALL: [HAWKBALL](https://attack.mitre.org/software/S0391) can collect the user name of the system.(Citation: FireEye HAWKBALL Jun 2019)
- [S0236] Kwampirs: [Kwampirs](https://attack.mitre.org/software/S0236) collects registered owner details by using the commands <code>systeminfo</code> and <code>net config workstation</code>.(Citation: Symantec Orangeworm April 2018)
- [S0412] ZxShell: [ZxShell](https://attack.mitre.org/software/S0412) can collect the owner and organization information from the target workstation.(Citation: Talos ZxShell Oct 2014)
- [S0339] Micropsia: [Micropsia](https://attack.mitre.org/software/S0339) collects the username from the victim’s machine.(Citation: Talos Micropsia June 2017)
- [S0569] Explosive: [Explosive](https://attack.mitre.org/software/S0569) has collected the username from the infected host.(Citation: CheckPoint Volatile Cedar March 2015)
- [S0092] Agent.btz: [Agent.btz](https://attack.mitre.org/software/S0092) obtains the victim username and saves it to a file.(Citation: ThreatExpert Agent.btz)
- [S1064] SVCReady: [SVCReady](https://attack.mitre.org/software/S1064) can collect the username from an infected host.(Citation: HP SVCReady Jun 2022)
- [S0115] Crimson: [Crimson](https://attack.mitre.org/software/S0115) can identify the user on a targeted system.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022)
- [S0186] DownPaper: [DownPaper](https://attack.mitre.org/software/S0186) collects the victim username and sends it to the C2 server.(Citation: ClearSky Charming Kitten Dec 2017)
- [S0439] Okrum: [Okrum](https://attack.mitre.org/software/S0439) can collect the victim username.(Citation: ESET Okrum July 2019)
- [S0214] HAPPYWORK: can collect the victim user name.(Citation: FireEye APT37 Feb 2018)
- [S0681] Lizar: [Lizar](https://attack.mitre.org/software/S0681) can collect the username from the system.(Citation: BiZone Lizar May 2021)
- [S0162] Komplex: The OsInfo function in [Komplex](https://attack.mitre.org/software/S0162) collects the current running username.(Citation: Sofacy Komplex Trojan)
- [S0615] SombRAT: [SombRAT](https://attack.mitre.org/software/S0615) can execute <code>getinfo</code>  to identify the username on a compromised host.(Citation: BlackBerry CostaRicto November 2020)(Citation: CISA AR21-126A FIVEHANDS May 2021)
- [S0265] Kazuar: [Kazuar](https://attack.mitre.org/software/S0265) gathers information on users.(Citation: Unit 42 Kazuar May 2017)
- [C0012] Operation CuckooBees: During [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), the threat actors used the `query user` and `whoami` commands as part of their advanced reconnaissance.(Citation: Cybereason OperationCuckooBees May 2022)
- [S0515] WellMail: [WellMail](https://attack.mitre.org/software/S0515) can identify the current username on the victim system.(Citation: CISA WellMail July 2020)
- [S0521] BloodHound: [BloodHound](https://attack.mitre.org/software/S0521) can collect information on user sessions.(Citation: CrowdStrike BloodHound April 2018)
- [S0201] JPIN: [JPIN](https://attack.mitre.org/software/S0201) can obtain the victim user name.(Citation: Microsoft PLATINUM April 2016)
- [G0059] Magic Hound: [Magic Hound](https://attack.mitre.org/groups/G0059) malware has obtained the victim username and sent it to the C2 server.(Citation: Unit 42 Magic Hound Feb 2017)(Citation: DFIR Report APT35 ProxyShell March 2022)(Citation: DFIR Phosphorus November 2021)
- [G0128] ZIRCONIUM: [ZIRCONIUM](https://attack.mitre.org/groups/G0128) has used a tool to capture the username on a compromised host in order to register it with C2.(Citation: Zscaler APT31 Covid-19 October 2020)
- [S1037] STARWHALE: [STARWHALE](https://attack.mitre.org/software/S1037) can gather the username from an infected host.(Citation: Mandiant UNC3313 Feb 2022)(Citation: DHS CISA AA22-055A MuddyWater February 2022)
- [S0433] Rifdoor: [Rifdoor](https://attack.mitre.org/software/S0433) has the ability to identify the username on the compromised host.(Citation: Carbon Black HotCroissant April 2020)
- [S0691] Neoichor: [Neoichor](https://attack.mitre.org/software/S0691) can collect the user name from a victim's machine.(Citation: Microsoft NICKEL December 2021)
- [S0477] Goopy: [Goopy](https://attack.mitre.org/software/S0477) has the ability to enumerate the infected system's user name.(Citation: Cybereason Cobalt Kitty 2017)
- [S0149] MoonWind: [MoonWind](https://attack.mitre.org/software/S0149) obtains the victim username.(Citation: Palo Alto MoonWind March 2017)
- [S1149] CHIMNEYSWEEP: [CHIMNEYSWEEP](https://attack.mitre.org/software/S1149) has included the victim's computer name and username in C2 messages sent to actor-owned infrastructure.(Citation: Mandiant ROADSWEEP August 2022)
- [S1044] FunnyDream: [FunnyDream](https://attack.mitre.org/software/S1044) has the ability to gather user information from the targeted system using `whoami/upn&whoami/fqdn&whoami/logonid&whoami/all`.(Citation: Bitdefender FunnyDream Campaign November 2020)
- [S1035] Small Sieve: [Small Sieve](https://attack.mitre.org/software/S1035) can obtain the id of a logged in user.(Citation: NCSC GCHQ Small Sieve Jan 2022)
- [S0554] Egregor: [Egregor](https://attack.mitre.org/software/S0554) has used tools to gather information about users.(Citation: Intrinsec Egregor Nov 2020)
- [S0385] njRAT: [njRAT](https://attack.mitre.org/software/S0385) enumerates the current user during the initial infection.(Citation: Fidelis njRAT June 2013)
- [G0114] Chimera: [Chimera](https://attack.mitre.org/groups/G0114) has used the <code>quser</code> command to show currently logged on users.(Citation: NCC Group Chimera January 2021)
- [S0649] SMOKEDHAM: [SMOKEDHAM](https://attack.mitre.org/software/S0649) has used <code>whoami</code> commands to identify system owners.(Citation: FireEye SMOKEDHAM June 2021)
- [S0248] yty: [yty](https://attack.mitre.org/software/S0248) collects the victim’s username.(Citation: ASERT Donot March 2018)
- [S0662] RCSession: [RCSession](https://attack.mitre.org/software/S0662) can gather system owner information, including user and administrator privileges.(Citation: Profero APT27 December 2020)
- [S1106] NGLite: [NGLite](https://attack.mitre.org/software/S1106) will run the <code>whoami</code> command to gather system information and return this to the command and control server.(Citation: NGLite Trojan)
- [G0040] Patchwork: [Patchwork](https://attack.mitre.org/groups/G0040) collected the victim username and whether it was running as admin, then sent the information to its C2 server.(Citation: Cymmetria Patchwork)(Citation: TrendMicro Patchwork Dec 2017)
- [S1124] SocGholish: [SocGholish](https://attack.mitre.org/software/S1124) can use `whoami` to obtain the username from a compromised host.(Citation: SocGholish-update)(Citation: Red Canary SocGholish March 2024)(Citation: Secureworks Gold Prelude Profile)
- [G0038] Stealth Falcon: [Stealth Falcon](https://attack.mitre.org/groups/G0038) malware gathers the registered user and primary owner name via WMI.(Citation: Citizen Lab Stealth Falcon May 2016)
- [S1021] DnsSystem: [DnsSystem](https://attack.mitre.org/software/S1021) can use the Windows user name to create a unique identification for infected users and systems.(Citation: Zscaler Lyceum DnsSystem June 2022)
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has used public tools and executed the PowerShell command `Get-EventLog security -instanceid 4624` to identify associated user and computer account names.(Citation: Joint Cybersecurity Advisory Volt Typhoon June 2023)(Citation: Secureworks BRONZE SILHOUETTE May 2023)(Citation: CISA AA24-038A PRC Critical Infrastructure February 2024)
- [S0362] Linux Rabbit: [Linux Rabbit](https://attack.mitre.org/software/S0362) opens a socket on port 22 and if it receives a response it attempts to obtain the machine's hostname and Top-Level Domain. (Citation: Anomali Linux Rabbit 2018)
- [S0666] Gelsemium: [Gelsemium](https://attack.mitre.org/software/S0666) has the ability to distinguish between a standard user and an administrator on a compromised host.(Citation: ESET Gelsemium June 2021)
- [G1014] LuminousMoth: [LuminousMoth](https://attack.mitre.org/groups/G1014) has used a malicious DLL to collect the username from compromised hosts.(Citation: Bitdefender LuminousMoth July 2021)
- [G0143] Aquatic Panda: [Aquatic Panda](https://attack.mitre.org/groups/G0143) gathers information on recently logged-in users on victim devices.(Citation: Crowdstrike HuntReport 2022)
- [S0543] Spark: [Spark](https://attack.mitre.org/software/S0543) has run the whoami command and has a built-in command to identify the user logged in.(Citation: Unit42 Molerat Mar 2020)
- [S0353] NOKKI: [NOKKI](https://attack.mitre.org/software/S0353) can collect the username from the victim’s machine.(Citation: Unit 42 NOKKI Sept 2018)
- [S0461] SDBbot: [SDBbot](https://attack.mitre.org/software/S0461) has the ability to identify the user on a compromised host.(Citation: Proofpoint TA505 October 2019)
- [S0696] Flagpro: [Flagpro](https://attack.mitre.org/software/S0696) has been used to run the <code>whoami</code> command on the system.(Citation: NTT Security Flagpro new December 2021)
- [S0084] Mis-Type: [Mis-Type](https://attack.mitre.org/software/S0084) runs tests to determine the privilege level of the compromised user.(Citation: Cylance Dust Storm)
- [S1060] Mafalda: [Mafalda](https://attack.mitre.org/software/S1060) can collect the username from a compromised host.(Citation: SentinelLabs Metador Technical Appendix Sept 2022)
- [G0047] Gamaredon Group: A [Gamaredon Group](https://attack.mitre.org/groups/G0047) file stealer can gather the victim's username to send to a C2 server.(Citation: Palo Alto Gamaredon Feb 2017)
- [S0098] T9000: [T9000](https://attack.mitre.org/software/S0098) gathers and beacons the username of the logged in account during installation. It will also gather the username of running processes to determine if it is running as SYSTEM.(Citation: Palo Alto T9000 Feb 2016)
- [G0093] GALLIUM: [GALLIUM](https://attack.mitre.org/groups/G0093) used <code>whoami</code> and <code>query user</code> to obtain information about the victim user.(Citation: Cybereason Soft Cell June 2019)
- [S0148] RTM: [RTM](https://attack.mitre.org/software/S0148) can obtain the victim username and permissions.(Citation: ESET RTM Feb 2017)
- [S0382] ServHelper: [ServHelper](https://attack.mitre.org/software/S0382) will attempt to enumerate the username of the victim.(Citation: Proofpoint TA505 Jan 2019)
- [G0102] Wizard Spider: [Wizard Spider](https://attack.mitre.org/groups/G0102) has used "whoami" to identify the local user and their privileges.(Citation: Sophos New Ryuk Attack October 2020)
- [S0258] RGDoor: [RGDoor](https://attack.mitre.org/software/S0258) executes the <code>whoami</code> on the victim’s machine.(Citation: Unit 42 RGDoor Jan 2018)
- [G0096] APT41: [APT41](https://attack.mitre.org/groups/G0096) has executed <code>whoami</code> commands, including using the WMIEXEC utility to execute this on remote machines.(Citation: FireEye APT41 Aug 2019)(Citation: Rostovcev APT41 2021)
- [S1169] Mango: [Mango](https://attack.mitre.org/software/S1169) can collect the user name from a compromised system which is used to create a unique victim identifier.(Citation: ESET OilRig Campaigns Sep 2023)
- [S0021] Derusbi: A Linux version of [Derusbi](https://attack.mitre.org/software/S0021) checks if the victim user ID is anything other than zero (normally used for root), and the malware will not execute if it does not have root privileges. [Derusbi](https://attack.mitre.org/software/S0021) also gathers the username of the victim.(Citation: Fidelis Turbo)
- [S0059] WinMM: [WinMM](https://attack.mitre.org/software/S0059) uses NetUser-GetInfo to identify that it is running under an “Admin” account on the local system.(Citation: Baumgartner Naikon 2015)
- [G0049] OilRig: [OilRig](https://attack.mitre.org/groups/G0049) has run <code>whoami</code> on a victim.(Citation: Palo Alto OilRig May 2016)(Citation: Palo Alto OilRig Oct 2016)(Citation: Check Point APT34 April 2021)
- [S0354] Denis: [Denis](https://attack.mitre.org/software/S0354) enumerates and collects the username from the victim’s machine.(Citation: Securelist Denis April 2017)(Citation: Cybereason Cobalt Kitty 2017)
- [S0534] Bazar: [Bazar](https://attack.mitre.org/software/S0534) can identify the username of the infected user.(Citation: NCC Group Team9 June 2020)
- [S0568] EVILNUM: [EVILNUM](https://attack.mitre.org/software/S0568) can obtain the username from the victim's machine.(Citation: Prevailion EvilNum May 2020)
- [G1001] HEXANE: [HEXANE](https://attack.mitre.org/groups/G1001) has run `whoami` on compromised machines to identify the current user.(Citation: Kaspersky Lyceum October 2021)
- [S0350] zwShell: [zwShell](https://attack.mitre.org/software/S0350) can obtain the name of the logged-in user on the victim.(Citation: McAfee Night Dragon)
- [S0153] RedLeaves: [RedLeaves](https://attack.mitre.org/software/S0153) can obtain information about the logged on user both locally and for Remote Desktop sessions.(Citation: PWC Cloud Hopper Technical Annex April 2017)
- [S0237] GravityRAT: [GravityRAT](https://attack.mitre.org/software/S0237) collects the victim username along with other account information (account type, description, full name, SID and status).(Citation: Talos GravityRAT)
- [S0431] HotCroissant: [HotCroissant](https://attack.mitre.org/software/S0431) has the ability to collect the username on the infected host.(Citation: Carbon Black HotCroissant April 2020)
- [S0572] Caterpillar WebShell: [Caterpillar WebShell](https://attack.mitre.org/software/S0572) can obtain a list of user accounts from a victim's machine.(Citation: ClearSky Lebanese Cedar Jan 2021)
- [S1032] PyDCrypt: [PyDCrypt](https://attack.mitre.org/software/S1032) has probed victim machines with <code>whoami</code> and has collected the username from the machine.(Citation: Checkpoint MosesStaff Nov 2021)
- [S0441] PowerShower: [PowerShower](https://attack.mitre.org/software/S0441) has the ability to identify the current user on the infected host.(Citation: Kaspersky Cloud Atlas August 2019)
- [S0240] ROKRAT: [ROKRAT](https://attack.mitre.org/software/S0240) can collect the username from a compromised host.(Citation: Malwarebytes RokRAT VBA January 2021)
- [S0644] ObliqueRAT: [ObliqueRAT](https://attack.mitre.org/software/S0644) can check for blocklisted usernames on infected endpoints.(Citation: Talos Oblique RAT March 2021)
- [G0112] Windshift: [Windshift](https://attack.mitre.org/groups/G0112) has used malware to identify the username on a compromised host.(Citation: BlackBerry Bahamut)
- [S0280] MirageFox: [MirageFox](https://attack.mitre.org/software/S0280) can gather the username from the victim’s machine.(Citation: APT15 Intezer June 2018)
- [S1207] XLoader: [XLoader](https://attack.mitre.org/software/S1207) can identify the username from a victim machine.(Citation: Acronis XLoader 2021)
- [S0455] Metamorfo: [Metamorfo](https://attack.mitre.org/software/S0455) has collected the username from the victim's machine.(Citation: ESET Casbaneiro Oct 2019)
- [S0125] Remsec: [Remsec](https://attack.mitre.org/software/S0125) can obtain information about the current user.(Citation: Kaspersky ProjectSauron Technical Analysis)
- [G0069] MuddyWater: [MuddyWater](https://attack.mitre.org/groups/G0069) has used malware that can collect the victim’s username.(Citation: Securelist MuddyWater Oct 2018)(Citation: Trend Micro Muddy Water March 2021)
- [S0635] BoomBox: [BoomBox](https://attack.mitre.org/software/S0635) can enumerate the username on a compromised host.(Citation: MSTIC Nobelium Toolset May 2021)
- [S0168] Gazer: [Gazer](https://attack.mitre.org/software/S0168) obtains the current user's security identifier.(Citation: Securelist WhiteBear Aug 2017)
- [S0093] Backdoor.Oldrea: [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) collects the current username from the victim.(Citation: Symantec Dragonfly)
- [S0513] LiteDuke: [LiteDuke](https://attack.mitre.org/software/S0513) can enumerate the account name on a targeted system.(Citation: ESET Dukes October 2019)
- [S0460] Get2: [Get2](https://attack.mitre.org/software/S0460) has the ability to identify the current username of an infected host.(Citation: Proofpoint TA505 October 2019)
- [S1172] OilBooster: [OilBooster](https://attack.mitre.org/software/S1172) can identify the compromised system's username which is then used as part of a unique identifier.(Citation: ESET OilRig Downloaders DEC 2023)
- [S0559] SUNBURST: [SUNBURST](https://attack.mitre.org/software/S0559) collected the username from a compromised host.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: Microsoft Analyzing Solorigate Dec 2020)
- [S1013] ZxxZ: [ZxxZ](https://attack.mitre.org/software/S1013) can collect the username from a compromised host.(Citation: Cisco Talos Bitter Bangladesh May 2022)
- [S1025] Amadey: [Amadey](https://attack.mitre.org/software/S1025) has collected the user name from a compromised host using `GetUserNameA`.(Citation: BlackBerry Amadey 2020)
- [S0267] FELIXROOT: [FELIXROOT](https://attack.mitre.org/software/S0267) collects the username from the victim’s machine.(Citation: FireEye FELIXROOT July 2018)(Citation: ESET GreyEnergy Oct 2018)
- [S0486] Bonadan: [Bonadan](https://attack.mitre.org/software/S0486) has discovered the username of the user running the backdoor.(Citation: ESET ForSSHe December 2018)
- [S0660] Clambling: [Clambling](https://attack.mitre.org/software/S0660) can identify the username on a compromised host.(Citation: Trend Micro DRBControl February 2020)(Citation: Talent-Jump Clambling February 2020)
- [S1147] Nightdoor: [Nightdoor](https://attack.mitre.org/software/S1147) gathers information on victim system users and usernames.(Citation: ESET EvasivePanda 2024)
- [S0015] Ixeshe: [Ixeshe](https://attack.mitre.org/software/S0015) collects the username from the victim’s machine.(Citation: Trend Micro IXESHE 2012)
- [S1018] Saint Bot: [Saint Bot](https://attack.mitre.org/software/S1018) can collect the username from a compromised host.(Citation: Malwarebytes Saint Bot April 2021)
- [S0172] Reaver: [Reaver](https://attack.mitre.org/software/S0172) collects the victim's username.(Citation: Palo Alto Reaver Nov 2017)
- [S0257] VERMIN: [VERMIN](https://attack.mitre.org/software/S0257) gathers the username from the victim’s machine.(Citation: Unit 42 VERMIN Jan 2018)
- [G0035] Dragonfly: [Dragonfly](https://attack.mitre.org/groups/G0035) used the command <code>query user</code> on victim hosts.(Citation: US-CERT TA18-074A)
- [S0498] Cryptoistic: [Cryptoistic](https://attack.mitre.org/software/S0498) can gather data on the user of a compromised host.(Citation: SentinelOne Lazarus macOS July 2020)
- [S1028] Action RAT: [Action RAT](https://attack.mitre.org/software/S1028) has the ability to collect the username from an infected host.(Citation: MalwareBytes SideCopy Dec 2021)
- [S0667] Chrommme: [Chrommme](https://attack.mitre.org/software/S0667) can retrieve the username from a targeted system.(Citation: ESET Gelsemium June 2021)
- [S0334] DarkComet: [DarkComet](https://attack.mitre.org/software/S0334) gathers the username from the victim’s machine.(Citation: TrendMicro DarkComet Sept 2014)
- [S1141] LunarWeb: [LunarWeb](https://attack.mitre.org/software/S1141) can collect user information from the targeted host.(Citation: ESET Turla Lunar toolset May 2024)
- [S0017] BISCUIT: [BISCUIT](https://attack.mitre.org/software/S0017) has a command to gather the username from the system.(Citation: Mandiant APT1 Appendix)
- [S0692] SILENTTRINITY: [SILENTTRINITY](https://attack.mitre.org/software/S0692) can gather a list of logged on users.(Citation: GitHub SILENTTRINITY Modules July 2019)
- [G0034] Sandworm Team: [Sandworm Team](https://attack.mitre.org/groups/G0034) has collected the username from a compromised host.(Citation: US District Court Indictment GRU Unit 74455 October 2020)
- [G1046] Storm-1811: [Storm-1811](https://attack.mitre.org/groups/G1046) has used `whoami.exe` to determine if the active user on a compromised system is an administrator.(Citation: rapid7-email-bombing)
- [S1024] CreepySnail: [CreepySnail](https://attack.mitre.org/software/S1024) can execute `getUsername` on compromised systems.(Citation: Microsoft POLONIUM June 2022)
- [S0284] More_eggs: [More_eggs](https://attack.mitre.org/software/S0284) has the capability to gather the username from the victim's machine.(Citation: Talos Cobalt Group July 2018)(Citation: Security Intelligence More Eggs Aug 2019)
- [S0673] DarkWatchman: [DarkWatchman](https://attack.mitre.org/software/S0673) has collected the username from a victim machine.(Citation: Prevailion DarkWatchman 2021)
- [C0001] Frankenstein: During [Frankenstein](https://attack.mitre.org/campaigns/C0001), the threat actors used [Empire](https://attack.mitre.org/software/S0363) to enumerate hosts and gather username, machine name, and administrative permissions information.(Citation: Talos Frankenstein June 2019)
- [S0450] SHARPSTATS: [SHARPSTATS](https://attack.mitre.org/software/S0450) has the ability to identify the username on the compromised host.(Citation: TrendMicro POWERSTATS V3 June 2019)
- [S0228] NanHaiShu: [NanHaiShu](https://attack.mitre.org/software/S0228) collects the username from the victim.(Citation: fsecure NanHaiShu July 2016)
- [S0363] Empire: [Empire](https://attack.mitre.org/software/S0363) can enumerate the username on targeted hosts.(Citation: Talos Frankenstein June 2019)
- [S1075] KOPILUWAK: [KOPILUWAK](https://attack.mitre.org/software/S1075) can conduct basic network reconnaissance on the victim machine with `whoami`, to get user details.(Citation: Mandiant Suspected Turla Campaign February 2023)
- [S1068] BlackCat: [BlackCat](https://attack.mitre.org/software/S1068) can utilize `net use` commands to discover the user name on a compromised host.(Citation: Microsoft BlackCat Jun 2022)
- [G0121] Sidewinder: [Sidewinder](https://attack.mitre.org/groups/G0121) has used tools to identify the user of a compromised host.(Citation: ATT Sidewinder January 2021)
- [S0269] QUADAGENT: [QUADAGENT](https://attack.mitre.org/software/S0269) gathers the victim username.(Citation: Unit 42 QUADAGENT July 2018)
- [S0113] Prikormka: A module in [Prikormka](https://attack.mitre.org/software/S0113) collects information from the victim about the current user name.(Citation: ESET Operation Groundbait)
- [G0022] APT3: An [APT3](https://attack.mitre.org/groups/G0022) downloader uses the Windows command <code>"cmd.exe" /C whoami</code> to verify that it is running with the elevated privileges of “System.”(Citation: FireEye Operation Double Tap)
- [S0060] Sys10: [Sys10](https://attack.mitre.org/software/S0060) collects the account name of the logged-in user and sends it to the C2.(Citation: Baumgartner Naikon 2015)


### T1040 - Network Sniffing

Description:

Adversaries may passively sniff network traffic to capture information about an environment, including authentication material passed over the network. Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection. An adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data.

Data captured via this technique may include user credentials, especially those sent over an insecure, unencrypted protocol. Techniques for name service resolution poisoning, such as [LLMNR/NBT-NS Poisoning and SMB Relay](https://attack.mitre.org/techniques/T1557/001), can also be used to capture credentials to websites, proxies, and internal systems by redirecting traffic to an adversary.

Network sniffing may reveal configuration details, such as running services, version numbers, and other network characteristics (e.g. IP addresses, hostnames, VLAN IDs) necessary for subsequent [Lateral Movement](https://attack.mitre.org/tactics/TA0008) and/or [Defense Evasion](https://attack.mitre.org/tactics/TA0005) activities. Adversaries may likely also utilize network sniffing during [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) (AiTM) to passively gain additional knowledge about the environment.

In cloud-based environments, adversaries may still be able to use traffic mirroring services to sniff network traffic from virtual machines. For example, AWS Traffic Mirroring, GCP Packet Mirroring, and Azure vTap allow users to define specified instances to collect traffic from and specified targets to send collected traffic to.(Citation: AWS Traffic Mirroring)(Citation: GCP Packet Mirroring)(Citation: Azure Virtual Network TAP) Often, much of this traffic will be in cleartext due to the use of TLS termination at the load balancer level to reduce the strain of encrypting and decrypting traffic.(Citation: Rhino Security Labs AWS VPC Traffic Mirroring)(Citation: SpecterOps AWS Traffic Mirroring) The adversary can then use exfiltration techniques such as Transfer Data to Cloud Account in order to access the sniffed traffic.(Citation: Rhino Security Labs AWS VPC Traffic Mirroring)

On network devices, adversaries may perform network captures using [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as `monitor capture`.(Citation: US-CERT-TA18-106A)(Citation: capture_embedded_packet_on_software)

Procedures:

- [G0034] Sandworm Team: [Sandworm Team](https://attack.mitre.org/groups/G0034) has used intercepter-NG to sniff passwords in network traffic.(Citation: ESET Telebots Dec 2016)
- [G0094] Kimsuky: [Kimsuky](https://attack.mitre.org/groups/G0094) has used the Nirsoft SniffPass network sniffer to obtain passwords sent over non-secure protocols.(Citation: CISA AA20-301A Kimsuky)(Citation: Netscout Stolen Pencil Dec 2018)
- [S0357] Impacket: [Impacket](https://attack.mitre.org/software/S0357) can be used to sniff network traffic via an interface or raw socket.(Citation: Impacket Tools)
- [S0590] NBTscan: [NBTscan](https://attack.mitre.org/software/S0590) can dump and print whole packet content.(Citation: Debian nbtscan Nov 2019)(Citation: SecTools nbtscan June 2003)
- [S0443] MESSAGETAP: [MESSAGETAP](https://attack.mitre.org/software/S0443) uses the libpcap library to listen to all traffic and parses network protocols starting with Ethernet and IP layers. It continues parsing protocol layers including SCTP, SCCP, and TCAP and finally extracts SMS message data and routing metadata.  (Citation: FireEye MESSAGETAP October 2019)
- [S1206] JumbledPath: [JumbledPath](https://attack.mitre.org/software/S1206) has the ability to perform packet capture on remote devices via actor-defined jump-hosts.(Citation: Cisco Salt Typhoon FEB 2025)
- [G1047] Velvet Ant: [Velvet Ant](https://attack.mitre.org/groups/G1047) has used a custom tool, "VELVETTAP", to perform packet capture from compromised F5 BIG-IP devices.(Citation: Sygnia VelvetAnt 2024A)
- [G1045] Salt Typhoon: [Salt Typhoon](https://attack.mitre.org/groups/G1045) has used a variety of tools and techniques to capture packet data between network interfaces.(Citation: Cisco Salt Typhoon FEB 2025)
- [C0028] 2015 Ukraine Electric Power Attack: During the [2015 Ukraine Electric Power Attack](https://attack.mitre.org/campaigns/C0028), [Sandworm Team](https://attack.mitre.org/groups/G0034) used [BlackEnergy](https://attack.mitre.org/software/S0089)’s network sniffer module to discover user credentials being sent over the network between the local LAN and the power grid’s industrial control systems. (Citation: Charles McLellan March 2016)
- [S0587] Penquin: [Penquin](https://attack.mitre.org/software/S0587) can sniff network traffic to look for packets matching specific conditions.(Citation: Leonardo Turla Penquin May 2020)(Citation: Kaspersky Turla Penquin December 2014)
- [S0661] FoggyWeb: [FoggyWeb](https://attack.mitre.org/software/S0661) can configure custom listeners to passively monitor all incoming HTTP GET and POST requests sent to the AD FS server from the intranet/internet and intercept HTTP requests that match the custom URI patterns defined by the actor.(Citation: MSTIC FoggyWeb September 2021)
- [S0363] Empire: [Empire](https://attack.mitre.org/software/S0363) can be used to conduct packet captures on target hosts.(Citation: Github PowerShell Empire)
- [S0174] Responder: [Responder](https://attack.mitre.org/software/S0174) captures hashes and credentials that are sent to the system after the name services have been poisoned.(Citation: GitHub Responder)
- [S0367] Emotet: [Emotet](https://attack.mitre.org/software/S0367) has been observed to hook network APIs to monitor network traffic. (Citation: Trend Micro Banking Malware Jan 2019)
- [C0046] ArcaneDoor: [ArcaneDoor](https://attack.mitre.org/campaigns/C0046) included network packet capture and sniffing for data collection in victim environments.(Citation: Cisco ArcaneDoor 2024)(Citation: CCCS ArcaneDoor 2024)
- [G0064] APT33: [APT33](https://attack.mitre.org/groups/G0064) has used SniffPass to collect credentials by sniffing network traffic.(Citation: Symantec Elfin Mar 2019)
- [S1204] cd00r: [cd00r](https://attack.mitre.org/software/S1204) can use the libpcap library to monitor captured packets for specifc sequences.(Citation: Hartrell cd00r 2002)
- [S1186] Line Dancer: [Line Dancer](https://attack.mitre.org/software/S1186) can create and exfiltrate packet captures from compromised environments.(Citation: Cisco ArcaneDoor 2024)
- [G0105] DarkVishnya: [DarkVishnya](https://attack.mitre.org/groups/G0105) used network sniffing to obtain login data. (Citation: Securelist DarkVishnya Dec 2018)
- [G0007] APT28: [APT28](https://attack.mitre.org/groups/G0007) deployed the open source tool Responder to conduct NetBIOS Name Service poisoning, which captured usernames and hashed passwords that allowed access to legitimate credentials.(Citation: FireEye APT28)(Citation: FireEye APT28 Hospitality Aug 2017) [APT28](https://attack.mitre.org/groups/G0007) close-access teams have used Wi-Fi pineapples to intercept Wi-Fi signals and user credentials.(Citation: US District Court Indictment GRU Oct 2018)
- [S1203] J-magic: [J-magic](https://attack.mitre.org/software/S1203) has a pcap listener function that can create an Extended Berkley Packet Filter (eBPF) on designated interfaces and ports.(Citation: Lumen J-Magic JAN 2025)
- [S0378] PoshC2: [PoshC2](https://attack.mitre.org/software/S0378) contains a module for taking packet captures on compromised hosts.(Citation: GitHub PoshC2)
- [S1154] VersaMem: [VersaMem](https://attack.mitre.org/software/S1154) hooked the Catalina application filter chain `doFilter` on compromised systems to monitor all inbound requests to the local Tomcat web server, inspecting them for parameters like passwords and follow-on Java modules.(Citation: Lumen Versa 2024)
- [S0019] Regin: [Regin](https://attack.mitre.org/software/S0019) appears to have functionality to sniff for credentials passed over HTTP, SMTP, and SMB.(Citation: Kaspersky Regin)


### T1046 - Network Service Discovery

Description:

Adversaries may attempt to get a listing of services running on remote hosts and local network infrastructure devices, including those that may be vulnerable to remote software exploitation. Common methods to acquire this information include port, vulnerability, and/or wordlist scans using tools that are brought onto a system.(Citation: CISA AR21-126A FIVEHANDS May 2021)   

Within cloud environments, adversaries may attempt to discover services running on other cloud hosts. Additionally, if the cloud environment is connected to a on-premises environment, adversaries may be able to identify services running on non-cloud systems as well.

Within macOS environments, adversaries may use the native Bonjour application to discover services running on other macOS hosts within a network. The Bonjour mDNSResponder daemon automatically registers and advertises a host’s registered services on the network. For example, adversaries can use a mDNS query (such as <code>dns-sd -B _ssh._tcp .</code>) to find other systems broadcasting the ssh service.(Citation: apple doco bonjour description)(Citation: macOS APT Activity Bradley)

Procedures:

- [S0192] Pupy: [Pupy](https://attack.mitre.org/software/S0192) has a built-in module for port scanning.(Citation: GitHub Pupy)
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has used commercial tools, LOTL utilities, and appliances already present on the system for network service discovery.(Citation: CISA AA24-038A PRC Critical Infrastructure February 2024)
- [G0087] APT39: [APT39](https://attack.mitre.org/groups/G0087) has used [CrackMapExec](https://attack.mitre.org/software/S0488) and a custom port scanner known as BLUETORCH for network scanning.(Citation: FireEye APT39 Jan 2019)(Citation: BitDefender Chafer May 2020)
- [C0004] CostaRicto: During [CostaRicto](https://attack.mitre.org/campaigns/C0004), the threat actors employed nmap and pscan to scan target environments.(Citation: BlackBerry CostaRicto November 2020)
- [G0098] BlackTech: [BlackTech](https://attack.mitre.org/groups/G0098) has used the SNScan tool to find other potential targets on victim networks.(Citation: Symantec Palmerworm Sep 2020)
- [G1043] BlackByte: [BlackByte](https://attack.mitre.org/groups/G1043) has used tools such as NetScan to enumerate network services in victim environments.(Citation: Microsoft BlackByte 2023)
- [G0045] menuPass: [menuPass](https://attack.mitre.org/groups/G0045) has used tcping.exe, similar to [Ping](https://attack.mitre.org/software/S0097), to probe port status on systems of interest.(Citation: PWC Cloud Hopper Technical Annex April 2017)
- [S0093] Backdoor.Oldrea: [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) can use a network scanning module to identify ICS-related ports.(Citation: Gigamon Berserk Bear October 2021)
- [G0027] Threat Group-3390: [Threat Group-3390](https://attack.mitre.org/groups/G0027) actors use the Hunter tool to conduct network service discovery for vulnerable systems.(Citation: Dell TG-3390)(Citation: Unit42 Emissary Panda May 2019)
- [S0604] Industroyer: [Industroyer](https://attack.mitre.org/software/S0604) uses a custom port scanner to map out a network.(Citation: ESET Industroyer)
- [S0363] Empire: [Empire](https://attack.mitre.org/software/S0363) can perform port scans from an infected host.(Citation: Github PowerShell Empire)
- [G1030] Agrius: [Agrius](https://attack.mitre.org/groups/G1030) used the open-source port scanner <code>WinEggDrop</code> to perform detailed scans of hosts of interest in victim networks.(Citation: Unit42 Agrius 2023)
- [G1016] FIN13: [FIN13](https://attack.mitre.org/groups/G1016) has utilized `nmap` for reconnaissance efforts. [FIN13](https://attack.mitre.org/groups/G1016) has also scanned for internal MS-SQL servers in a compromised network.(Citation: Mandiant FIN13 Aug 2022)(Citation: Sygnia Elephant Beetle Jan 2022)
- [S0458] Ramsay: [Ramsay](https://attack.mitre.org/software/S0458) can scan for systems that are vulnerable to the EternalBlue exploit.(Citation: Eset Ramsay May 2020)(Citation: Antiy CERT Ramsay April 2020)
- [C0038] HomeLand Justice: During [HomeLand Justice](https://attack.mitre.org/campaigns/C0038), threat actors executed the Advanced Port Scanner tool on compromised systems.(Citation: CISA Iran Albanian Attacks September 2022)(Citation: Microsoft Albanian Government Attacks September 2022)
- [G0105] DarkVishnya: [DarkVishnya](https://attack.mitre.org/groups/G0105) performed port scanning to obtain the list of active services.(Citation: Securelist DarkVishnya Dec 2018)
- [G0049] OilRig: [OilRig](https://attack.mitre.org/groups/G0049) has used the publicly available tool SoftPerfect Network Scanner as well as a custom tool called GOLDIRONY to conduct network scanning.(Citation: FireEye APT34 Webinar Dec 2017)
- [G0032] Lazarus Group: [Lazarus Group](https://attack.mitre.org/groups/G0032) has used nmap from a router VM to scan ports on systems within the restricted segment of an enterprise network.(Citation: Kaspersky ThreatNeedle Feb 2021)
- [G0077] Leafminer: [Leafminer](https://attack.mitre.org/groups/G0077) scanned network services to search for vulnerabilities in the victim system.(Citation: Symantec Leafminer July 2018)
- [S1073] Royal: [Royal](https://attack.mitre.org/software/S1073) can scan the network interfaces of targeted systems.(Citation: Cybereason Royal December 2022)
- [S0374] SpeakUp: [SpeakUp](https://attack.mitre.org/software/S0374) checks for availability of specific ports on servers.(Citation: CheckPoint SpeakUp Feb 2019)
- [S0089] BlackEnergy: [BlackEnergy](https://attack.mitre.org/software/S0089) has conducted port scans on a host.(Citation: Securelist BlackEnergy Nov 2014)
- [S0601] Hildegard: [Hildegard](https://attack.mitre.org/software/S0601) has used masscan to look for kubelets in the internal Kubernetes network.(Citation: Unit 42 Hildegard Malware)
- [G0081] Tropic Trooper: [Tropic Trooper](https://attack.mitre.org/groups/G0081) used <code>pr</code> and an openly available tool to scan for open ports on target systems.(Citation: TrendMicro TropicTrooper 2015)(Citation: TrendMicro Tropic Trooper May 2020)
- [G0019] Naikon: [Naikon](https://attack.mitre.org/groups/G0019) has used the LadonGo scanner to scan target networks.(Citation: Bitdefender Naikon April 2021)
- [G0059] Magic Hound: [Magic Hound](https://attack.mitre.org/groups/G0059) has used KPortScan 3.0 to perform SMB, RDP, and LDAP scanning.(Citation: DFIR Phosphorus November 2021)
- [G0106] Rocke: [Rocke](https://attack.mitre.org/groups/G0106) conducted scanning for exposed TCP port 7001 as well as SSH and Redis servers.(Citation: Talos Rocke August 2018)(Citation: Anomali Rocke March 2019)
- [C0027] C0027: During [C0027](https://attack.mitre.org/campaigns/C0027), used RustScan to scan for open ports on targeted ESXi appliances.(Citation: Crowdstrike TELCO BPO Campaign December 2022)
- [S0590] NBTscan: [NBTscan](https://attack.mitre.org/software/S0590) can be used to scan IP networks.(Citation: Debian nbtscan Nov 2019)(Citation: SecTools nbtscan June 2003)
- [G0050] APT32: [APT32](https://attack.mitre.org/groups/G0050) performed network scanning on the network to search for open ports, services, OS finger-printing, and other vulnerabilities.(Citation: Cybereason Cobalt Kitty 2017)
- [G1032] INC Ransom: [INC Ransom](https://attack.mitre.org/groups/G1032) has used NETSCAN.EXE for internal reconnaissance.(Citation: SOCRadar INC Ransom January 2024)(Citation: SentinelOne INC Ransomware)
- [S0683] Peirates: [Peirates](https://attack.mitre.org/software/S0683) can initiate a port scan against a given IP address.(Citation: Peirates GitHub)
- [S1081] BADHATCH: [BADHATCH](https://attack.mitre.org/software/S1081) can check for open ports on a computer by establishing a TCP connection.(Citation: BitDefender BADHATCH Mar 2021)
- [S0412] ZxShell: [ZxShell](https://attack.mitre.org/software/S0412) can launch port scans.(Citation: FireEye APT41 Aug 2019)(Citation: Talos ZxShell Oct 2014)
- [S0250] Koadic: [Koadic](https://attack.mitre.org/software/S0250) can scan for open TCP ports on the target network.(Citation: Github Koadic)
- [S0020] China Chopper: [China Chopper](https://attack.mitre.org/software/S0020)'s server component can spider authentication portals.(Citation: FireEye Periscope March 2018)
- [C0018] C0018: During [C0018](https://attack.mitre.org/campaigns/C0018), the threat actors used the SoftPerfect Network Scanner for network scanning.(Citation: Cisco Talos Avos Jun 2022)
- [S1144] FRP: As part of load balancing [FRP](https://attack.mitre.org/software/S1144) can set `healthCheck.type = "tcp"` or `healthCheck.type = "http"` to check service status on specific hosts with TCPing or an HTTP request.(Citation: FRP GitHub)
- [G0114] Chimera: [Chimera](https://attack.mitre.org/groups/G0114) has used the <code>get -b <start ip> -e <end ip> -p</code> command for network scanning as well as a custom Python tool  packed into a Windows executable named Get.exe to scan IP ranges for HTTP.(Citation: NCC Group Chimera January 2021)
- [S0692] SILENTTRINITY: [SILENTTRINITY](https://attack.mitre.org/software/S0692) can scan for open ports on a compromised machine.(Citation: GitHub SILENTTRINITY Modules July 2019)
- [G0096] APT41: [APT41](https://attack.mitre.org/groups/G0096) used a malware variant called WIDETONE to conduct port scans on specified subnets.(Citation: FireEye APT41 Aug 2019)
- [S1180] BlackByte Ransomware: [BlackByte Ransomware](https://attack.mitre.org/software/S1180) identifies remote systems via active directory queries for hostnames prior to launching remote ransomware payloads.(Citation: Trustwave BlackByte 2021)
- [S0341] Xbash: [Xbash](https://attack.mitre.org/software/S0341) can perform port scanning of TCP and UDP ports.(Citation: Unit42 Xbash Sept 2018)
- [S0154] Cobalt Strike: [Cobalt Strike](https://attack.mitre.org/software/S0154) can perform port scans from an infected host.(Citation: cobaltstrike manual)(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020)
- [G0039] Suckfly: [Suckfly](https://attack.mitre.org/groups/G0039) the victim's internal network for hosts with ports 8080, 5900, and 40 open.(Citation: Symantec Suckfly May 2016)
- [S1063] Brute Ratel C4: [Brute Ratel C4](https://attack.mitre.org/software/S1063) can conduct port scanning against targeted systems.(Citation: Palo Alto Brute Ratel July 2022)
- [S0598] P.A.S. Webshell: [P.A.S. Webshell](https://attack.mitre.org/software/S0598) can scan networks for open ports and listening services.(Citation: ANSSI Sandworm January 2021)
- [S0117] XTunnel: [XTunnel](https://attack.mitre.org/software/S0117) is capable of probing the network for open ports.(Citation: Invincea XTunnel)
- [S0698] HermeticWizard: [HermeticWizard](https://attack.mitre.org/software/S0698) has the ability to scan ports on a compromised network.(Citation: ESET Hermetic Wizard March 2022)
- [G0037] FIN6: [FIN6](https://attack.mitre.org/groups/G0037) used publicly available tools (including Microsoft's built-in SQL querying tool, osql.exe) to map the internal network and conduct reconnaissance against Active Directory, Structured Query Language (SQL) servers, and NetBIOS.(Citation: FireEye FIN6 April 2016)
- [G0139] TeamTNT: [TeamTNT](https://attack.mitre.org/groups/G0139) has used masscan to search for open Docker API ports and Kubernetes clusters.(Citation: Cado Security TeamTNT Worm August 2020)(Citation: Unit 42 Hildegard Malware)(Citation: Cisco Talos Intelligence Group) [TeamTNT](https://attack.mitre.org/groups/G0139) has also used malware that utilizes zmap and zgrab to search for vulnerable services in cloud environments.(Citation: Palo Alto Black-T October 2020)
- [S1146] MgBot: [MgBot](https://attack.mitre.org/software/S1146) includes modules for performing HTTP and server service scans.(Citation: Symantec Daggerfly 2023)
- [C0014] Operation Wocao: During [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors scanned for open ports and used nbtscan to find NETBIOS nameservers.(Citation: FoxIT Wocao December 2019)
- [G0135] BackdoorDiplomacy: [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) has used SMBTouch, a vulnerability scanner, to determine whether a target is vulnerable to EternalBlue malware.(Citation: ESET BackdoorDiplomacy Jun 2021)
- [S1185] LightSpy: To collect data on the host's Wi-Fi connection history, [LightSpy](https://attack.mitre.org/software/S1185) reads the `/Library/Preferences/SystemConfiguration/com.apple.airport.preferences.plist file`.It also utilizes Apple's CWWiFiClient API to scan for nearby Wi-Fi networks and obtain data on the SSID, security type, and RSSI (signal strength) values.(Citation: Huntress LightSpy macOS 2024)
- [S0608] Conficker: [Conficker](https://attack.mitre.org/software/S0608) scans for other machines to infect.(Citation: SANS Conficker)
- [G0030] Lotus Blossom: [Lotus Blossom](https://attack.mitre.org/groups/G0030) has used port scanners to enumerate services on remote hosts.(Citation: Symantec Bilbug 2022)
- [S0061] HDoor: [HDoor](https://attack.mitre.org/software/S0061) scans to identify open ports on the victim.(Citation: Baumgartner Naikon 2015)
- [S0233] MURKYTOP: [MURKYTOP](https://attack.mitre.org/software/S0233) has the capability to scan for open ports on hosts in a connected network.(Citation: FireEye Periscope March 2018)
- [G0117] Fox Kitten: [Fox Kitten](https://attack.mitre.org/groups/G0117) has used tools including NMAP to conduct broad scanning to identify open ports.(Citation: CISA AA20-259A Iran-Based Actor September 2020)(Citation: ClearSky Pay2Kitten December 2020)
- [S0260] InvisiMole: [InvisiMole](https://attack.mitre.org/software/S0260) can scan the network for open ports and vulnerable instances of RDP and SMB protocols.(Citation: ESET InvisiMole June 2020)
- [S0378] PoshC2: [PoshC2](https://attack.mitre.org/software/S0378) can perform port scans from an infected host.(Citation: GitHub PoshC2)
- [S0125] Remsec: [Remsec](https://attack.mitre.org/software/S0125) has a plugin that can perform ARP scanning as well as port scanning.(Citation: Kaspersky ProjectSauron Technical Analysis)
- [S0532] Lucifer: [Lucifer](https://attack.mitre.org/software/S0532) can scan for open ports including TCP ports 135 and 1433.(Citation: Unit 42 Lucifer June 2020)
- [G0080] Cobalt Group: [Cobalt Group](https://attack.mitre.org/groups/G0080) leveraged an open-source tool called SoftPerfect Network Scanner to perform network scanning.(Citation: PTSecurity Cobalt Group Aug 2017)(Citation: PTSecurity Cobalt Dec 2016)(Citation: Group IB Cobalt Aug 2017)
- [S0572] Caterpillar WebShell: [Caterpillar WebShell](https://attack.mitre.org/software/S0572) has a module to use a port scanner on a system.(Citation: ClearSky Lebanese Cedar Jan 2021)
- [G1039] RedCurl: [RedCurl](https://attack.mitre.org/groups/G1039) has used netstat to check if port 4119 is open.(Citation: trendmicro_redcurl)
- [S0583] Pysa: [Pysa](https://attack.mitre.org/software/S0583) can perform network reconnaissance using the Advanced Port Scanner tool.(Citation: CERT-FR PYSA April 2020)
- [G1003] Ember Bear: [Ember Bear](https://attack.mitre.org/groups/G1003) has used tools such as NMAP for remote system discovery and enumeration in victim environments.(Citation: CISA GRU29155 2024)


### T1049 - System Network Connections Discovery

Description:

Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network. 

An adversary who gains access to a system that is part of a cloud-based environment may map out Virtual Private Clouds or Virtual Networks in order to determine what systems and services are connected. The actions performed are likely the same types of discovery techniques depending on the operating system, but the resulting information may include details about the networked cloud environment relevant to the adversary's goals. Cloud providers may have different ways in which their virtual networks operate.(Citation: Amazon AWS VPC Guide)(Citation: Microsoft Azure Virtual Network Overview)(Citation: Google VPC Overview) Similarly, adversaries who gain access to network devices may also perform similar discovery activities to gather information about connected systems and services.

Utilities and commands that acquire this information include [netstat](https://attack.mitre.org/software/S0104), "net use," and "net session" with [Net](https://attack.mitre.org/software/S0039). In Mac and Linux, [netstat](https://attack.mitre.org/software/S0104) and <code>lsof</code> can be used to list current connections. <code>who -a</code> and <code>w</code> can be used to show which users are currently logged in, similar to "net session". Additionally, built-in features native to network devices and [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) may be used (e.g. <code>show ip sockets</code>, <code>show tcp brief</code>).(Citation: US-CERT-TA18-106A) On ESXi servers, the command `esxi network ip connection list` can be used to list active network connections.(Citation: Sygnia ESXi Ransomware 2025)

Procedures:

- [S0532] Lucifer: [Lucifer](https://attack.mitre.org/software/S0532) can identify the IP and port numbers for all remote connections from the compromised host.(Citation: Unit 42 Lucifer June 2020)
- [S0094] Trojan.Karagany: [Trojan.Karagany](https://attack.mitre.org/software/S0094) can use [netstat](https://attack.mitre.org/software/S0104) to collect a list of network connections.(Citation: Secureworks Karagany July 2019)
- [S0638] Babuk: [Babuk](https://attack.mitre.org/software/S0638) can use “WNetOpenEnumW” and “WNetEnumResourceW” to enumerate files in network resources for encryption.(Citation: McAfee Babuk February 2021)
- [G0082] APT38: [APT38](https://attack.mitre.org/groups/G0082) installed a port monitoring tool, MAPMAKER, to print the active TCP connections on the local system.(Citation: FireEye APT38 Oct 2018)
- [G0045] menuPass: [menuPass](https://attack.mitre.org/groups/G0045) has used <code>net use</code> to conduct connectivity checks to machines.(Citation: PWC Cloud Hopper April 2017)
- [S0445] ShimRatReporter: [ShimRatReporter](https://attack.mitre.org/software/S0445) used the Windows function <code>GetExtendedUdpTable</code> to detect connected UDP endpoints.(Citation: FOX-IT May 2016 Mofang)
- [S0251] Zebrocy: [Zebrocy](https://attack.mitre.org/software/S0251) uses <code>netstat -aon</code> to gather network connection information.(Citation: ESET Zebrocy May 2019)
- [S0378] PoshC2: [PoshC2](https://attack.mitre.org/software/S0378) contains an implementation of [netstat](https://attack.mitre.org/software/S0104) to enumerate TCP and UDP connections.(Citation: GitHub PoshC2)
- [G0033] Poseidon Group: [Poseidon Group](https://attack.mitre.org/groups/G0033) obtains and saves information about victim network interfaces and addresses.(Citation: Kaspersky Poseidon Group)
- [S0125] Remsec: [Remsec](https://attack.mitre.org/software/S0125) can obtain a list of active connections and open ports.(Citation: Kaspersky ProjectSauron Technical Analysis)
- [C0014] Operation Wocao: During [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors collected a list of open connections on the infected system using `netstat` and checks whether it has an internet connection.(Citation: FoxIT Wocao December 2019)
- [S0237] GravityRAT: [GravityRAT](https://attack.mitre.org/software/S0237) uses the <code>netstat</code> command to find open ports on the victim’s machine.(Citation: Talos GravityRAT)
- [S0104] netstat: [netstat](https://attack.mitre.org/software/S0104) can be used to enumerate local network connections, including active TCP connections and other network statistics.(Citation: TechNet Netstat)
- [S0356] KONNI: [KONNI](https://attack.mitre.org/software/S0356) has used <code>net session</code> on the victim's machine.(Citation: Malwarebytes Konni Aug 2021)
- [G0139] TeamTNT: [TeamTNT](https://attack.mitre.org/groups/G0139) has run <code>netstat -anp</code> to search for rival malware connections.(Citation: Trend Micro TeamTNT) [TeamTNT](https://attack.mitre.org/groups/G0139) has also used `libprocesshider` to modify <code>/etc/ld.so.preload</code>.(Citation: ATT TeamTNT Chimaera September 2020)
- [G0138] Andariel: [Andariel](https://attack.mitre.org/groups/G0138) has used the <code>netstat -naop tcp</code> command to display TCP connections on a victim's machine.(Citation: Kaspersky Andariel Ransomware June 2021)
- [G0129] Mustang Panda: [Mustang Panda](https://attack.mitre.org/groups/G0129) has used <code>netstat -ano</code> to determine network connection information.(Citation: Avira Mustang Panda January 2020)
- [S0488] CrackMapExec: [CrackMapExec](https://attack.mitre.org/software/S0488) can discover active sessions for a targeted system.(Citation: CME Github September 2018)
- [S0449] Maze: [Maze](https://attack.mitre.org/software/S0449) has used the "WNetOpenEnumW", "WNetEnumResourceW”, “WNetCloseEnum” and “WNetAddConnection2W” functions to enumerate the network resources on the infected machine.(Citation: McAfee Maze March 2020)
- [S0241] RATANKBA: [RATANKBA](https://attack.mitre.org/software/S0241) uses <code>netstat -ano</code> to search for specific IP address ranges.(Citation: RATANKBA)
- [G0010] Turla: [Turla](https://attack.mitre.org/groups/G0010) surveys a system upon check-in to discover active local network connections using the <code>netstat -an</code>, <code>net use</code>, <code>net file</code>, and <code>net session</code> commands.(Citation: Kaspersky Turla)(Citation: ESET ComRAT May 2020) [Turla](https://attack.mitre.org/groups/G0010) RPC backdoors have also enumerated the IPv4 TCP connection table via the <code>GetTcpTable2</code> API call.(Citation: ESET Turla PowerShell May 2019)
- [S0335] Carbon: [Carbon](https://attack.mitre.org/software/S0335) uses the <code>netstat -r</code> and <code>netstat -an</code> commands.(Citation: GovCERT Carbon May 2016)
- [S0409] Machete: [Machete](https://attack.mitre.org/software/S0409) uses the <code>netsh wlan show networks mode=bssid</code> and <code>netsh wlan show interfaces</code> commands to list all nearby WiFi networks and connected interfaces.(Citation: ESET Machete July 2019)
- [S0678] Torisma: [Torisma](https://attack.mitre.org/software/S0678) can use `WTSEnumerateSessionsW` to monitor remote desktop connections.(Citation: McAfee Lazarus Nov 2020)
- [S0154] Cobalt Strike: [Cobalt Strike](https://attack.mitre.org/software/S0154) can produce a sessions report from compromised hosts.(Citation: Talos Cobalt Strike September 2020)
- [S0039] Net: Commands such as <code>net use</code> and <code>net session</code> can be used in [Net](https://attack.mitre.org/software/S0039) to gather information about network connections from a particular host.(Citation: Savill 1999)
- [G0022] APT3: [APT3](https://attack.mitre.org/groups/G0022) has a tool that can enumerate current network connections.(Citation: Symantec Buckeye)(Citation: FireEye Clandestine Fox)(Citation: evolution of pirpi)
- [S0089] BlackEnergy: [BlackEnergy](https://attack.mitre.org/software/S0089) has gathered information about local network connections using [netstat](https://attack.mitre.org/software/S0104).(Citation: F-Secure BlackEnergy 2014)(Citation: Securelist BlackEnergy Nov 2014)
- [G0030] Lotus Blossom: [Lotus Blossom](https://attack.mitre.org/groups/G0030) has used commands such as `netstat` to identify system network connections.(Citation: Cisco LotusBlossom 2025)
- [S0567] Dtrack: [Dtrack](https://attack.mitre.org/software/S0567) can collect network and active connection information.(Citation: Securelist Dtrack)
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has used `netstat -ano` on compromised hosts to enumerate network connections.(Citation: Joint Cybersecurity Advisory Volt Typhoon June 2023)(Citation: Secureworks BRONZE SILHOUETTE May 2023)
- [G0034] Sandworm Team: [Sandworm Team](https://attack.mitre.org/groups/G0034) had gathered user, IP address, and server data related to RDP sessions on a compromised host. It has also accessed network diagram files useful for understanding how a host's network was configured.(Citation: US District Court Indictment GRU Unit 74455 October 2020)(Citation: Dragos Crashoverride 2018)
- [G1047] Velvet Ant: [Velvet Ant](https://attack.mitre.org/groups/G1047) has enumerated existing network connections on victim devices.(Citation: Sygnia VelvetAnt 2024A)
- [S0091] Epic: [Epic](https://attack.mitre.org/software/S0091) uses the <code>net use</code>, <code>net session</code>, and <code>netstat</code> commands to gather information on network connections.(Citation: Kaspersky Turla)(Citation: Kaspersky Turla Aug 2014)
- [S0244] Comnie: [Comnie](https://attack.mitre.org/software/S0244) executes the <code>netstat -ano</code> command.(Citation: Palo Alto Comnie)
- [S1091] Pacu: Once inside a Virtual Private Cloud, [Pacu](https://attack.mitre.org/software/S1091) can attempt to identify DirectConnect, VPN, or VPC Peering.(Citation: GitHub Pacu)
- [S0554] Egregor: [Egregor](https://attack.mitre.org/software/S0554) can enumerate all connected drives.(Citation: NHS Digital Egregor Nov 2020)
- [S1141] LunarWeb: [LunarWeb](https://attack.mitre.org/software/S1141) can enumerate system network connections.(Citation: ESET Turla Lunar toolset May 2024)
- [S1060] Mafalda: [Mafalda](https://attack.mitre.org/software/S1060) can use the <code>GetExtendedTcpTable</code> function to retrieve information about established TCP connections.(Citation: SentinelLabs Metador Sept 2022)
- [S0625] Cuba: [Cuba](https://attack.mitre.org/software/S0625) can use the function <code>GetIpNetTable</code> to recover the last connections to the victim's machine.(Citation: McAfee Cuba April 2021)
- [S0198] NETWIRE: [NETWIRE](https://attack.mitre.org/software/S0198) can capture session logon details from a compromised host.(Citation: FireEye NETWIRE March 2019)
- [S0165] OSInfo: [OSInfo](https://attack.mitre.org/software/S0165) enumerates the current network connections similar to <code> net use </code>.(Citation: Symantec Buckeye)
- [S0018] Sykipot: [Sykipot](https://attack.mitre.org/software/S0018) may use <code>netstat -ano</code> to display active network connections.(Citation: AlienVault Sykipot 2011)
- [S1032] PyDCrypt: [PyDCrypt](https://attack.mitre.org/software/S1032) has used [netsh](https://attack.mitre.org/software/S0108) to find RPC connections on remote machines.(Citation: Checkpoint MosesStaff Nov 2021)
- [G0006] APT1: [APT1](https://attack.mitre.org/groups/G0006) used the <code>net use</code> command to get a listing on network connections.(Citation: Mandiant APT1)
- [S0579] Waterbear: [Waterbear](https://attack.mitre.org/software/S0579) can use API hooks on `GetExtendedTcpTable` to retrieve a table containing a list of TCP endpoints available to the application.(Citation: Trend Micro Waterbear December 2019)
- [S0013] PlugX: [PlugX](https://attack.mitre.org/software/S0013) has a module for enumerating TCP and UDP network connections and associated processes using the <code>netstat</code> command.(Citation: CIRCL PlugX March 2013)
- [S1144] FRP: [FRP](https://attack.mitre.org/software/S1144) can use a dashboard and U/I to display the status of connections from the FRP client and server.(Citation: FRP GitHub)
- [G0049] OilRig: [OilRig](https://attack.mitre.org/groups/G0049) has used <code>netstat -an</code> on a victim to get a listing of network connections.(Citation: Palo Alto OilRig May 2016)
- [G1022] ToddyCat: [ToddyCat](https://attack.mitre.org/groups/G1022) has used `netstat -anop tcp` to discover TCP connections to compromised hosts.(Citation: Kaspersky ToddyCat Check Logs October 2023)
- [S0038] Duqu: The discovery modules used with [Duqu](https://attack.mitre.org/software/S0038) can collect information on network connections.(Citation: Symantec W32.Duqu)
- [G0059] Magic Hound: [Magic Hound](https://attack.mitre.org/groups/G0059) has used quser.exe to identify existing RDP connections.(Citation: DFIR Report APT35 ProxyShell March 2022)
- [S0102] nbtstat: [nbtstat](https://attack.mitre.org/software/S0102) can be used to discover current NetBIOS sessions.
- [G0114] Chimera: [Chimera](https://attack.mitre.org/groups/G0114) has used <code>netstat -ano | findstr EST</code> to discover network connections.(Citation: NCC Group Chimera January 2021)
- [G0069] MuddyWater: [MuddyWater](https://attack.mitre.org/groups/G0069) has used a PowerShell backdoor to check for Skype connections on the target machine.(Citation: Trend Micro Muddy Water March 2021)
- [S0533] SLOTHFULMEDIA: [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) can enumerate open ports on a victim machine.(Citation: CISA MAR SLOTHFULMEDIA October 2020)
- [G0018] admin@338: [admin@338](https://attack.mitre.org/groups/G0018) actors used the following command following exploitation of a machine with [LOWBALL](https://attack.mitre.org/software/S0042) malware to display network connections: <code>netstat -ano >> %temp%\download</code>(Citation: FireEye admin@338)
- [G0093] GALLIUM: [GALLIUM](https://attack.mitre.org/groups/G0093) used <code>netstat -oan</code> to obtain information about the victim network connections.(Citation: Cybereason Soft Cell June 2019)
- [S0674] CharmPower: [CharmPower](https://attack.mitre.org/software/S0674) can use `netsh wlan show profiles` to list specific Wi-Fi profile details.(Citation: Check Point APT35 CharmPower January 2022)
- [S0063] SHOTPUT: [SHOTPUT](https://attack.mitre.org/software/S0063) uses [netstat](https://attack.mitre.org/software/S0104) to list TCP connection status.(Citation: Palo Alto CVE-2015-3113 July 2015)
- [G0096] APT41: [APT41](https://attack.mitre.org/groups/G0096) has enumerated IP addresses of network resources and used the <code>netstat</code> command as part of network reconnaissance. The group has also used a malware variant, HIGHNOON, to enumerate active RDP sessions.(Citation: FireEye APT41 Aug 2019)(Citation: Group IB APT 41 June 2021)
- [S0575] Conti: [Conti](https://attack.mitre.org/software/S0575) can enumerate routine network connections from a compromised host.(Citation: CarbonBlack Conti July 2020)
- [S0443] MESSAGETAP: After loading the keyword and phone data files, [MESSAGETAP](https://attack.mitre.org/software/S0443) begins monitoring all network connections to and from the victim server. (Citation: FireEye MESSAGETAP October 2019)
- [C0012] Operation CuckooBees: During [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), the threat actors used the `net session`, `net use`, and `netstat` commands as part of their advanced reconnaissance.(Citation: Cybereason OperationCuckooBees May 2022)
- [S0236] Kwampirs: [Kwampirs](https://attack.mitre.org/software/S0236) collects a list of active and listening connections by using the command <code>netstat -nao</code> as well as a list of available network mappings with <code>net use</code>.(Citation: Symantec Orangeworm April 2018)
- [S0363] Empire: [Empire](https://attack.mitre.org/software/S0363) can enumerate the current network connections of a host.(Citation: Github PowerShell Empire)
- [C0007] FunnyDream: During [FunnyDream](https://attack.mitre.org/campaigns/C0007), the threat actors used [netstat](https://attack.mitre.org/software/S0104) to discover network connections on remote systems.(Citation: Bitdefender FunnyDream Campaign November 2020)
- [S1075] KOPILUWAK: [KOPILUWAK](https://attack.mitre.org/software/S1075) can use [netstat](https://attack.mitre.org/software/S0104), [Arp](https://attack.mitre.org/software/S0099), and [Net](https://attack.mitre.org/software/S0039) to discover current TCP connections.(Citation: Mandiant Suspected Turla Campaign February 2023)
- [G1001] HEXANE: [HEXANE](https://attack.mitre.org/groups/G1001) has used [netstat](https://attack.mitre.org/software/S0104) to monitor connections to specific ports.(Citation: Kaspersky Lyceum October 2021)
- [S0589] Sibot: [Sibot](https://attack.mitre.org/software/S0589) has retrieved a GUID associated with a present LAN connection on a compromised machine.(Citation: MSTIC NOBELIUM Mar 2021)
- [S0374] SpeakUp: [SpeakUp](https://attack.mitre.org/software/S0374) uses the <code>arp -a</code> command. (Citation: CheckPoint SpeakUp Feb 2019)
- [G1023] APT5: [APT5](https://attack.mitre.org/groups/G1023) has used the BLOODMINE utility to collect data on web requests from Pulse Secure Connect logs.(Citation: Mandiant Pulse Secure Update May 2021)
- [G0135] BackdoorDiplomacy: [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) has used NetCat and PortQry  to enumerate network connections and display the status of related TCP and UDP ports.(Citation: ESET BackdoorDiplomacy Jun 2021)
- [S0439] Okrum: [Okrum](https://attack.mitre.org/software/S0439) was seen using NetSess to discover NetBIOS sessions.(Citation: ESET Okrum July 2019)
- [G0050] APT32: [APT32](https://attack.mitre.org/groups/G0050) used the <code>netstat -anpo tcp</code> command to display TCP connections on the victim's machine.(Citation: Cybereason Cobalt Kitty 2017)
- [G1006] Earth Lusca: [Earth Lusca](https://attack.mitre.org/groups/G1006) employed a PowerShell script called RDPConnectionParser to read and filter the Windows event log “Microsoft-Windows-TerminalServices-RDPClient/Operational”
(Event ID 1024) to obtain network information from RDP connections. [Earth Lusca](https://attack.mitre.org/groups/G1006) has also used [netstat](https://attack.mitre.org/software/S0104) from a compromised system to obtain network connection information.(Citation: TrendMicro EarthLusca 2022)
- [G0081] Tropic Trooper: [Tropic Trooper](https://attack.mitre.org/groups/G0081) has tested if the localhost network is available and other connection capability on an infected system using command scripts.(Citation: TrendMicro Tropic Trooper May 2020)
- [S0184] POWRUNER: [POWRUNER](https://attack.mitre.org/software/S0184) may collect active network connections by running <code>netstat -an</code> on a victim.(Citation: FireEye APT34 Dec 2017)
- [S0452] USBferry: [USBferry](https://attack.mitre.org/software/S0452) can use <code>netstat</code> and <code>nbtstat</code> to detect active network connections.(Citation: TrendMicro Tropic Trooper May 2020)
- [S0696] Flagpro: [Flagpro](https://attack.mitre.org/software/S0696) has been used to execute <code>netstat -ano</code> on a compromised host.(Citation: NTT Security Flagpro new December 2021)
- [S0650] QakBot: [QakBot](https://attack.mitre.org/software/S0650) can use <code>netstat</code> to enumerate current network connections.(Citation: Kaspersky QakBot September 2021)(Citation: Trend Micro Black Basta October 2022)
- [G0004] Ke3chang: [Ke3chang](https://attack.mitre.org/groups/G0004) performs local network connection discovery using <code>netstat</code>.(Citation: Mandiant Operation Ke3chang November 2014)(Citation: NCC Group APT15 Alive and Strong)
- [S1081] BADHATCH: [BADHATCH](https://attack.mitre.org/software/S1081) can execute `netstat.exe -f` on a compromised machine.(Citation: BitDefender BADHATCH Mar 2021)
- [S0192] Pupy: [Pupy](https://attack.mitre.org/software/S0192) has a built-in utility command for <code>netstat</code>, can do net session through PowerView, and has an interactive shell which can be used to discover additional information.(Citation: GitHub Pupy)
- [S0283] jRAT: [jRAT](https://attack.mitre.org/software/S0283) can list network connections.(Citation: Kaspersky Adwind Feb 2016)
- [S0458] Ramsay: [Ramsay](https://attack.mitre.org/software/S0458) can use <code>netstat</code> to enumerate network connections.(Citation: Antiy CERT Ramsay April 2020)
- [S0153] RedLeaves: [RedLeaves](https://attack.mitre.org/software/S0153) can enumerate drives and Remote Desktop sessions.(Citation: PWC Cloud Hopper Technical Annex April 2017)
- [S0180] Volgmer: [Volgmer](https://attack.mitre.org/software/S0180) can gather information about TCP connection state.(Citation: Symantec Volgmer Aug 2014)
- [S1085] Sardonic: [Sardonic](https://attack.mitre.org/software/S1085) has the ability to execute the `netstat` command.(Citation: Bitdefender Sardonic Aug 2021)
- [G0032] Lazarus Group: [Lazarus Group](https://attack.mitre.org/groups/G0032) has used <code>net use</code> to identify and establish a network connection with a remote host.(Citation: Kaspersky ThreatNeedle Feb 2021)
- [G1016] FIN13: [FIN13](https://attack.mitre.org/groups/G1016) has used `netstat` and other net  commands for network reconnaissance efforts.(Citation: Mandiant FIN13 Aug 2022)
- [S0633] Sliver: [Sliver](https://attack.mitre.org/software/S0633) can collect network connection information.(Citation: GitHub Sliver Netstat)
- [G1032] INC Ransom: [INC Ransom](https://attack.mitre.org/groups/G1032) has used RDP to test network connections.(Citation: SOCRadar INC Ransom January 2024)
- [G0027] Threat Group-3390: [Threat Group-3390](https://attack.mitre.org/groups/G0027) has used `net use` and `netstat` to conduct internal discovery of systems. The group has also used `quser.exe` to identify existing RDP sessions on a victim.(Citation: SecureWorks BRONZE UNION June 2017)
- [S0456] Aria-body: [Aria-body](https://attack.mitre.org/software/S0456) has the ability to gather TCP and UDP table status listings.(Citation: CheckPoint Naikon May 2020)
- [S0681] Lizar: [Lizar](https://attack.mitre.org/software/S0681) has a plugin to retrieve information about all active network sessions on the infected server.(Citation: BiZone Lizar May 2021)


### T1057 - Process Discovery

Description:

Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network. Administrator or otherwise elevated access may provide better process details. Adversaries may use the information from [Process Discovery](https://attack.mitre.org/techniques/T1057) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

In Windows environments, adversaries could obtain details on running processes using the [Tasklist](https://attack.mitre.org/software/S0057) utility via [cmd](https://attack.mitre.org/software/S0106) or <code>Get-Process</code> via [PowerShell](https://attack.mitre.org/techniques/T1059/001). Information about processes can also be extracted from the output of [Native API](https://attack.mitre.org/techniques/T1106) calls such as <code>CreateToolhelp32Snapshot</code>. In Mac and Linux, this is accomplished with the <code>ps</code> command. Adversaries may also opt to enumerate processes via `/proc`. ESXi also supports use of the `ps` command, as well as `esxcli system process list`.(Citation: Sygnia ESXi Ransomware 2025)(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021)

On network devices, [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as `show processes` can be used to display current running processes.(Citation: US-CERT-TA18-106A)(Citation: show_processes_cisco_cmd)

Procedures:

- [S0091] Epic: [Epic](https://attack.mitre.org/software/S0091) uses the <code>tasklist /v</code> command to obtain a list of processes.(Citation: Kaspersky Turla)(Citation: Kaspersky Turla Aug 2014)
- [S0670] WarzoneRAT: [WarzoneRAT](https://attack.mitre.org/software/S0670) can obtain a list of processes on a compromised host.(Citation: Check Point Warzone Feb 2020)
- [S0267] FELIXROOT: [FELIXROOT](https://attack.mitre.org/software/S0267) collects a list of running processes.(Citation: ESET GreyEnergy Oct 2018)
- [C0001] Frankenstein: During [Frankenstein](https://attack.mitre.org/campaigns/C0001), the threat actors used [Empire](https://attack.mitre.org/software/S0363) to obtain a list of all running processes.(Citation: Talos Frankenstein June 2019)
- [G0112] Windshift: [Windshift](https://attack.mitre.org/groups/G0112) has used malware to enumerate active processes.(Citation: BlackBerry Bahamut)
- [S0562] SUNSPOT: [SUNSPOT](https://attack.mitre.org/software/S0562) monitored running processes for instances of <code>MsBuild.exe</code> by hashing the name of each running process and comparing it to the corresponding value <code>0x53D525</code>. It also extracted command-line arguments and individual arguments from the running <code>MsBuild.exe</code> process to identify the directory path of the Orion software Visual Studio solution.(Citation: CrowdStrike SUNSPOT Implant January 2021)
- [S0142] StreamEx: [StreamEx](https://attack.mitre.org/software/S0142) has the ability to enumerate processes.(Citation: Cylance Shell Crew Feb 2017)
- [S0456] Aria-body: [Aria-body](https://attack.mitre.org/software/S0456) has the ability to enumerate loaded modules for a process.(Citation: CheckPoint Naikon May 2020).
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has enumerated running processes on targeted systems including through the use of [Tasklist](https://attack.mitre.org/software/S0057).(Citation: Microsoft Volt Typhoon May 2023)(Citation: Secureworks BRONZE SILHOUETTE May 2023)(Citation: CISA AA24-038A PRC Critical Infrastructure February 2024)
- [S0149] MoonWind: [MoonWind](https://attack.mitre.org/software/S0149) has a command to return a list of running processes.(Citation: Palo Alto MoonWind March 2017)
- [S0251] Zebrocy: [Zebrocy](https://attack.mitre.org/software/S0251) uses the <code>tasklist</code> and <code>wmic process get Capture, ExecutablePath</code> commands to gather the processes running on the system.(Citation: Unit42 Cannon Nov 2018)(Citation: ESET Zebrocy Nov 2018)(Citation: Unit42 Sofacy Dec 2018)(Citation: ESET Zebrocy May 2019)(Citation: Accenture SNAKEMACKEREL Nov 2018)
- [S0581] IronNetInjector: [IronNetInjector](https://attack.mitre.org/software/S0581) can identify processes via C# methods such as <code>GetProcessesByName</code> and running [Tasklist](https://attack.mitre.org/software/S0057) with the Python <code>os.popen</code> function.(Citation: Unit 42 IronNetInjector February 2021 )
- [S0277] FruitFly: [FruitFly](https://attack.mitre.org/software/S0277) has the ability to list processes on the system.(Citation: objsee mac malware 2017)
- [S0351] Cannon: [Cannon](https://attack.mitre.org/software/S0351) can obtain a list of processes running on the system.(Citation: Unit42 Cannon Nov 2018)(Citation: Unit42 Sofacy Dec 2018)
- [S0451] LoudMiner: [LoudMiner](https://attack.mitre.org/software/S0451) used the <code>ps</code> command to monitor the running processes on the system.(Citation: ESET LoudMiner June 2019)
- [S0059] WinMM: [WinMM](https://attack.mitre.org/software/S0059) sets a WH_CBT Windows hook to collect information on process creation.(Citation: Baumgartner Naikon 2015)
- [S1013] ZxxZ: [ZxxZ](https://attack.mitre.org/software/S1013) has created a snapshot of running processes using `CreateToolhelp32Snapshot`.(Citation: Cisco Talos Bitter Bangladesh May 2022)
- [S0531] Grandoreiro: [Grandoreiro](https://attack.mitre.org/software/S0531) can identify installed security tools based on process names.(Citation: ESET Grandoreiro April 2020)
- [S0271] KEYMARBLE: [KEYMARBLE](https://attack.mitre.org/software/S0271) can obtain a list of running processes on the system.(Citation: US-CERT KEYMARBLE Aug 2018)
- [S0219] WINERACK: [WINERACK](https://attack.mitre.org/software/S0219) can enumerate processes.(Citation: FireEye APT37 Feb 2018)
- [S0034] NETEAGLE: [NETEAGLE](https://attack.mitre.org/software/S0034) can send process listings over the C2 channel.(Citation: FireEye APT30)
- [G0081] Tropic Trooper: [Tropic Trooper](https://attack.mitre.org/groups/G0081) is capable of enumerating the running processes on the system using <code>pslist</code>.(Citation: Unit 42 Tropic Trooper Nov 2016)(Citation: TrendMicro Tropic Trooper May 2020)
- [S0615] SombRAT: [SombRAT](https://attack.mitre.org/software/S0615) can use the <code>getprocesslist</code> command to enumerate processes on a compromised host.(Citation: BlackBerry CostaRicto November 2020)(Citation: FireEye FiveHands April 2021)(Citation: CISA AR21-126A FIVEHANDS May 2021)
- [S0446] Ryuk: [Ryuk](https://attack.mitre.org/software/S0446) has called <code>CreateToolhelp32Snapshot</code> to enumerate all running processes.(Citation: CrowdStrike Ryuk January 2019)
- [S0044] JHUHUGIT: [JHUHUGIT](https://attack.mitre.org/software/S0044) obtains a list of running processes on the victim.(Citation: ESET Sednit Part 1)(Citation: Unit 42 Sofacy Feb 2018)
- [S1107] NKAbuse: [NKAbuse](https://attack.mitre.org/software/S1107) will check victim systems to ensure only one copy of the malware is running.(Citation: NKAbuse SL)
- [C0024] SolarWinds Compromise: During the [SolarWinds Compromise](https://attack.mitre.org/campaigns/C0024), [APT29](https://attack.mitre.org/groups/G0016) used multiple command-line utilities to enumerate running processes.(Citation: Volexity SolarWinds)(Citation: Microsoft Deep Dive Solorigate January 2021)(Citation: CrowdStrike StellarParticle January 2022)
- [S0268] Bisonal: [Bisonal](https://attack.mitre.org/software/S0268) can obtain a list of running processes on the victim’s machine.(Citation: Unit 42 Bisonal July 2018)(Citation: Kaspersky CactusPete Aug 2020)(Citation: Talos Bisonal Mar 2020)
- [S1114] ZIPLINE: [ZIPLINE](https://attack.mitre.org/software/S1114) can identify running processes and their names.(Citation: Mandiant Cutting Edge January 2024)
- [S0476] Valak: [Valak](https://attack.mitre.org/software/S0476) has the ability to enumerate running processes on a compromised host.(Citation: Cybereason Valak May 2020)
- [S0436] TSCookie: [TSCookie](https://attack.mitre.org/software/S0436) has the ability to list processes on the infected host.(Citation: JPCert TSCookie March 2018)
- [S1050] PcShare: [PcShare](https://attack.mitre.org/software/S1050) can obtain a list of running processes on a compromised host.(Citation: Bitdefender FunnyDream Campaign November 2020)
- [S0015] Ixeshe: [Ixeshe](https://attack.mitre.org/software/S0015) can list running processes.(Citation: Trend Micro IXESHE 2012)
- [S0482] Bundlore: [Bundlore](https://attack.mitre.org/software/S0482) has used the <code>ps</code> command to list processes.(Citation: MacKeeper Bundlore Apr 2019)
- [G0121] Sidewinder: [Sidewinder](https://attack.mitre.org/groups/G0121) has used tools to identify running processes on the victim's machine.(Citation: ATT Sidewinder January 2021)
- [S0516] SoreFang: [SoreFang](https://attack.mitre.org/software/S0516) can enumerate processes on a victim machine through use of [Tasklist](https://attack.mitre.org/software/S0057).(Citation: CISA SoreFang July 2016)
- [S0229] Orz: [Orz](https://attack.mitre.org/software/S0229) can gather a process list from the victim.(Citation: Proofpoint Leviathan Oct 2017)
- [G0009] Deep Panda: [Deep Panda](https://attack.mitre.org/groups/G0009) uses the Microsoft [Tasklist](https://attack.mitre.org/software/S0057) utility to list processes running on systems.(Citation: Alperovitch 2014)
- [S1160] Latrodectus: [Latrodectus](https://attack.mitre.org/software/S1160) can enumerate running processes including process grandchildren on targeted hosts.(Citation: Latrodectus APR 2024)(Citation: Elastic Latrodectus May 2024)(Citation: Bitsight Latrodectus June 2024)
- [S0532] Lucifer: [Lucifer](https://attack.mitre.org/software/S0532) can identify the process that owns remote connections.(Citation: Unit 42 Lucifer June 2020)
- [S1185] LightSpy: If sent the command `16002`, [LightSpy](https://attack.mitre.org/software/S1185) uses the `NSWorkspace runningApplications()` method to collect the process ID, path to the executable, bundle information, and the filename of the executable for all running applications.(Citation: Huntress LightSpy macOS 2024)
- [S1132] IPsec Helper: [IPsec Helper](https://attack.mitre.org/software/S1132) can identify the process it is currently running under and its number, and pass this back to a command and control node.(Citation: SentinelOne Agrius 2021)
- [S0409] Machete: [Machete](https://attack.mitre.org/software/S0409) has a component to check for running processes to look for web browsers.(Citation: ESET Machete July 2019)
- [S1133] Apostle: [Apostle](https://attack.mitre.org/software/S1133) retrieves a list of all running processes on a victim host, and stops all services containing the string "sql," likely to propagate ransomware activity to database files.(Citation: SentinelOne Agrius 2021)
- [S0201] JPIN: [JPIN](https://attack.mitre.org/software/S0201) can list running processes.(Citation: Microsoft PLATINUM April 2016)
- [S1081] BADHATCH: [BADHATCH](https://attack.mitre.org/software/S1081) can retrieve a list of running processes from a compromised machine.(Citation: BitDefender BADHATCH Mar 2021)
- [S1147] Nightdoor: [Nightdoor](https://attack.mitre.org/software/S1147) can collect information on installed applications via Windows registry keys, as well as collecting information on running processes.(Citation: ESET EvasivePanda 2024)
- [S0663] SysUpdate: [SysUpdate](https://attack.mitre.org/software/S0663) can collect information about running processes.(Citation: Lunghi Iron Tiger Linux)
- [S0662] RCSession: [RCSession](https://attack.mitre.org/software/S0662) can identify processes based on PID.(Citation: Profero APT27 December 2020)
- [S0605] EKANS: [EKANS](https://attack.mitre.org/software/S0605) looks for processes from a hard-coded list.(Citation: Dragos EKANS)(Citation: FireEye Ransomware Feb 2020)(Citation: IBM Ransomware Trends September 2020)
- [S0089] BlackEnergy: [BlackEnergy](https://attack.mitre.org/software/S0089) has gathered a process list by using [Tasklist](https://attack.mitre.org/software/S0057).exe.(Citation: F-Secure BlackEnergy 2014)(Citation: Securelist BlackEnergy Nov 2014)(Citation: ESET BlackEnergy Jan 2016)
- [S0252] Brave Prince: [Brave Prince](https://attack.mitre.org/software/S0252) lists the running processes.(Citation: McAfee Gold Dragon)
- [S0410] Fysbis: [Fysbis](https://attack.mitre.org/software/S0410) can collect information about running processes.(Citation: Fysbis Dr Web Analysis)
- [S0125] Remsec: [Remsec](https://attack.mitre.org/software/S0125) can obtain a process list from the victim.(Citation: Kaspersky ProjectSauron Technical Analysis)
- [S1105] COATHANGER: [COATHANGER](https://attack.mitre.org/software/S1105) will query running process information to determine subsequent program execution flow.(Citation: NCSC-NL COATHANGER Feb 2024)
- [S0659] Diavol: [Diavol](https://attack.mitre.org/software/S0659) has used `CreateToolhelp32Snapshot`, `Process32First`, and `Process32Next` API calls to enumerate the running processes in the system.(Citation: Fortinet Diavol July 2021)
- [S0057] Tasklist: [Tasklist](https://attack.mitre.org/software/S0057) can be used to discover processes running on a system.(Citation: Microsoft Tasklist)
- [S0572] Caterpillar WebShell: [Caterpillar WebShell](https://attack.mitre.org/software/S0572) can gather a list of processes running on the machine.(Citation: ClearSky Lebanese Cedar Jan 2021)
- [S0049] GeminiDuke: [GeminiDuke](https://attack.mitre.org/software/S0049) collects information on running processes and environment variables from the victim.(Citation: F-Secure The Dukes)
- [S0373] Astaroth: [Astaroth](https://attack.mitre.org/software/S0373) searches for different processes on the system.(Citation: Cybereason Astaroth Feb 2019)
- [S1065] Woody RAT: [Woody RAT](https://attack.mitre.org/software/S1065) can call `NtQuerySystemProcessInformation` with `SystemProcessInformation` to enumerate all running processes, including associated information such as PID, parent PID, image name, and owner.(Citation: MalwareBytes WoodyRAT Aug 2022)
- [S0239] Bankshot: [Bankshot](https://attack.mitre.org/software/S0239) identifies processes and collects the process ids.(Citation: McAfee Bankshot)
- [G0006] APT1: [APT1](https://attack.mitre.org/groups/G0006) gathered a list of running processes on the system using <code>tasklist /v</code>.(Citation: Mandiant APT1)
- [S1059] metaMain: [metaMain](https://attack.mitre.org/software/S1059) can enumerate the processes that run on the platform.(Citation: SentinelLabs Metador Sept 2022)(Citation: SentinelLabs Metador Technical Appendix Sept 2022)
- [S0330] Zeus Panda: [Zeus Panda](https://attack.mitre.org/software/S0330) checks for running processes on the victim’s machine.(Citation: GDATA Zeus Panda June 2017)
- [S0038] Duqu: The discovery modules used with [Duqu](https://attack.mitre.org/software/S0038) can collect information on process details.(Citation: Symantec W32.Duqu)
- [S0244] Comnie: [Comnie](https://attack.mitre.org/software/S0244) uses the <code>tasklist</code> to view running processes on the victim’s machine.(Citation: Palo Alto Comnie)
- [S0497] Dacls: [Dacls](https://attack.mitre.org/software/S0497) can collect data on running and parent processes.(Citation: TrendMicro macOS Dacls May 2020)
- [S0184] POWRUNER: [POWRUNER](https://attack.mitre.org/software/S0184) may collect process information by running <code>tasklist</code> on a victim.(Citation: FireEye APT34 Dec 2017)
- [S0586] TAINTEDSCRIBE: [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) can execute <code>ProcessList</code> for process discovery.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE MAY 2020)
- [S0386] Ursnif: [Ursnif](https://attack.mitre.org/software/S0386) has gathered information about running processes.(Citation: TrendMicro Ursnif Mar 2015)(Citation: TrendMicro BKDR_URSNIF.SM)
- [S0331] Agent Tesla: [Agent Tesla](https://attack.mitre.org/software/S0331) can list the current running processes on the system.(Citation: Fortinet Agent Tesla June 2017)
- [S0355] Final1stspy: [Final1stspy](https://attack.mitre.org/software/S0355) obtains a list of running processes.(Citation: Unit 42 Nokki Oct 2018)
- [S0018] Sykipot: [Sykipot](https://attack.mitre.org/software/S0018) may gather a list of running processes by running <code>tasklist /v</code>.(Citation: AlienVault Sykipot 2011)
- [S0434] Imminent Monitor: [Imminent Monitor](https://attack.mitre.org/software/S0434) has a "Process Watcher" feature to monitor processes in case the client ever crashes or gets closed.(Citation: Imminent Unit42 Dec2019)
- [S0441] PowerShower: [PowerShower](https://attack.mitre.org/software/S0441) has the ability to deploy a reconnaissance module to retrieve a list of the active processes.(Citation: Kaspersky Cloud Atlas August 2019)
- [G0125] HAFNIUM: [HAFNIUM](https://attack.mitre.org/groups/G0125) has used `tasklist` to enumerate processes.(Citation: Rapid7 HAFNIUM Mar 2021)
- [G0012] Darkhotel: [Darkhotel](https://attack.mitre.org/groups/G0012) malware can collect a list of running processes on a system.(Citation: Securelist Darkhotel Aug 2015)
- [C0035] KV Botnet Activity: Scripts associated with [KV Botnet Activity](https://attack.mitre.org/campaigns/C0035) initial deployment can identify processes related to security tools and other botnet families for follow-on disabling during installation.(Citation: Lumen KVBotnet 2023)
- [S0081] Elise: [Elise](https://attack.mitre.org/software/S0081) enumerates processes via the <code>tasklist</code> command.(Citation: Accenture Dragonfish Jan 2018)
- [S0622] AppleSeed: [AppleSeed](https://attack.mitre.org/software/S0622) can enumerate the current process on a compromised host.(Citation: Malwarebytes Kimsuky June 2021)
- [S0473] Avenger: [Avenger](https://attack.mitre.org/software/S0473) has the ability to use [Tasklist](https://attack.mitre.org/software/S0057) to identify running processes.(Citation: Trend Micro Tick November 2019)
- [G1040] Play: [Play](https://attack.mitre.org/groups/G1040) has used the information stealer Grixba to check for a list of security processes.(Citation: Trend Micro Ransomware Spotlight Play July 2023)
- [S0013] PlugX: [PlugX](https://attack.mitre.org/software/S0013) has a module to list the processes running on a machine.(Citation: CIRCL PlugX March 2013)
- [S1159] DUSTTRAP: [DUSTTRAP](https://attack.mitre.org/software/S1159) can enumerate running processes.(Citation: Google Cloud APT41 2024)
- [S0345] Seasalt: [Seasalt](https://attack.mitre.org/software/S0345) has a command to perform a process listing.(Citation: Mandiant APT1 Appendix)
- [S0088] Kasidet: [Kasidet](https://attack.mitre.org/software/S0088) has the ability to search for a given process name in processes currently running in the system.(Citation: Zscaler Kasidet)
- [G0038] Stealth Falcon: [Stealth Falcon](https://attack.mitre.org/groups/G0038) malware gathers a list of running processes.(Citation: Citizen Lab Stealth Falcon May 2016)
- [G0139] TeamTNT: [TeamTNT](https://attack.mitre.org/groups/G0139) has searched for rival malware and removes it if found.(Citation: Trend Micro TeamTNT) [TeamTNT](https://attack.mitre.org/groups/G0139) has also searched for running processes containing the strings aliyun or liyun to identify machines running Alibaba Cloud Security tools.(Citation: Cisco Talos Intelligence Group)
- [S0528] Javali: [Javali](https://attack.mitre.org/software/S0528) can monitor processes for open browsers and custom banking applications.(Citation: Securelist Brazilian Banking Malware July 2020)
- [S0094] Trojan.Karagany: [Trojan.Karagany](https://attack.mitre.org/software/S0094) can use [Tasklist](https://attack.mitre.org/software/S0057) to collect a list of running tasks.(Citation: Symantec Dragonfly)(Citation: Secureworks Karagany July 2019)
- [G0007] APT28: An [APT28](https://attack.mitre.org/groups/G0007) loader Trojan will enumerate the victim's processes searching for explorer.exe if its current process does not have necessary permissions.(Citation: Unit 42 Playbook Dec 2017)
- [S0240] ROKRAT: [ROKRAT](https://attack.mitre.org/software/S0240) can list the current running processes on the system.(Citation: Talos ROKRAT)(Citation: NCCGroup RokRat Nov 2018)
- [S0208] Pasam: [Pasam](https://attack.mitre.org/software/S0208) creates a backdoor through which remote attackers can retrieve lists of running processes.(Citation: Symantec Pasam May 2012)
- [S0414] BabyShark: [BabyShark](https://attack.mitre.org/software/S0414) has executed the <code>tasklist</code> command.(Citation: Unit42 BabyShark Feb 2019)
- [S0237] GravityRAT: [GravityRAT](https://attack.mitre.org/software/S0237) lists the running processes on the system.(Citation: Talos GravityRAT)
- [S0141] Winnti for Windows: [Winnti for Windows](https://attack.mitre.org/software/S0141) can check if the explorer.exe process is responsible for calling its install function.(Citation: Novetta Winnti April 2015)
- [S0278] iKitten: [iKitten](https://attack.mitre.org/software/S0278) lists the current processes running.(Citation: objsee mac malware 2017)
- [S0626] P8RAT: [P8RAT](https://attack.mitre.org/software/S0626) can check for specific processes associated with virtual environments.(Citation: Securelist APT10 March 2021)
- [S0472] down_new: [down_new](https://attack.mitre.org/software/S0472) has the ability to list running processes on a compromised host.(Citation: Trend Micro Tick November 2019)
- [G0114] Chimera: [Chimera](https://attack.mitre.org/groups/G0114) has used <code>tasklist</code> to enumerate processes.(Citation: NCC Group Chimera January 2021)
- [S1063] Brute Ratel C4: [Brute Ratel C4](https://attack.mitre.org/software/S1063) can enumerate all processes and locate specific process IDs (PIDs).(Citation: Palo Alto Brute Ratel July 2022)
- [S0695] Donut: [Donut](https://attack.mitre.org/software/S0695) includes subprojects that enumerate and identify information about [Process Injection](https://attack.mitre.org/techniques/T1055) candidates.(Citation: Donut Github)
- [S1153] Cuckoo Stealer: [Cuckoo Stealer](https://attack.mitre.org/software/S1153) can use `ps aux` to enumerate running processes.(Citation: Kandji Cuckoo April 2024)
- [S0069] BLACKCOFFEE: [BLACKCOFFEE](https://attack.mitre.org/software/S0069) has the capability to discover processes.(Citation: FireEye APT17)
- [C0015] C0015: During [C0015](https://attack.mitre.org/campaigns/C0015), the threat actors used the `tasklist /s` command as well as `taskmanager` to obtain a list of running processes.(Citation: DFIR Conti Bazar Nov 2021)
- [S0640] Avaddon: [Avaddon](https://attack.mitre.org/software/S0640) has collected information about running processes.(Citation: Arxiv Avaddon Feb 2021)
- [S0170] Helminth: [Helminth](https://attack.mitre.org/software/S0170) has used [Tasklist](https://attack.mitre.org/software/S0057) to get information on processes.(Citation: Unit 42 Playbook Dec 2017)
- [S0248] yty: [yty](https://attack.mitre.org/software/S0248) gets an output of running processes using the <code>tasklist</code> command.(Citation: ASERT Donot March 2018)
- [S1210] Sagerunex: [Sagerunex](https://attack.mitre.org/software/S1210) identifies the `explorer.exe` process on the executing system.(Citation: Symantec Bilbug 2022)
- [S0666] Gelsemium: [Gelsemium](https://attack.mitre.org/software/S0666) can enumerate running processes.(Citation: ESET Gelsemium June 2021)
- [S0265] Kazuar: [Kazuar](https://attack.mitre.org/software/S0265) obtains a list of running processes through WMI querying and the <code>ps</code> command.(Citation: Unit 42 Kazuar May 2017)
- [S1044] FunnyDream: [FunnyDream](https://attack.mitre.org/software/S1044) has the ability to discover processes, including `Bka.exe` and `BkavUtil.exe`.(Citation: Bitdefender FunnyDream Campaign November 2020)
- [S0460] Get2: [Get2](https://attack.mitre.org/software/S0460) has the ability to identify running processes on an infected host.(Citation: Proofpoint TA505 October 2019)
- [S0151] HALFBAKED: [HALFBAKED](https://attack.mitre.org/software/S0151) can obtain information about running processes on the victim.(Citation: FireEye FIN7 April 2017)
- [S0139] PowerDuke: [PowerDuke](https://attack.mitre.org/software/S0139) has a command to list the victim's processes.(Citation: Volexity PowerDuke November 2016)
- [S1075] KOPILUWAK: [KOPILUWAK](https://attack.mitre.org/software/S1075) can enumerate current running processes on the targeted machine.(Citation: Mandiant Suspected Turla Campaign February 2023)
- [G0138] Andariel: [Andariel](https://attack.mitre.org/groups/G0138) has used <code>tasklist</code> to enumerate processes and find a specific string.(Citation: Kaspersky Andariel Ransomware June 2021)
- [S0031] BACKSPACE: [BACKSPACE](https://attack.mitre.org/software/S0031) may collect information about running processes.(Citation: FireEye APT30)
- [S0582] LookBack: [LookBack](https://attack.mitre.org/software/S0582) can list running processes.(Citation: Proofpoint LookBack Malware Aug 2019)
- [S0045] ADVSTORESHELL: [ADVSTORESHELL](https://attack.mitre.org/software/S0045) can list running processes.(Citation: ESET Sednit Part 2)
- [S0629] RainyDay: [RainyDay](https://attack.mitre.org/software/S0629) can enumerate processes on a target system.(Citation: Bitdefender Naikon April 2021)
- [S0412] ZxShell: [ZxShell](https://attack.mitre.org/software/S0412) has a command, ps, to obtain a listing of processes on the system.(Citation: Talos ZxShell Oct 2014)
- [G0032] Lazarus Group: Several [Lazarus Group](https://attack.mitre.org/groups/G0032) malware families gather a list of running processes on a victim system and send it to their C2 server. A Destover-like variant used by [Lazarus Group](https://attack.mitre.org/groups/G0032) also gathers process times.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: McAfee GhostSecret)(Citation: TrendMicro macOS Dacls May 2020)(Citation: Lazarus APT January 2022)
- [S1060] Mafalda: [Mafalda](https://attack.mitre.org/software/S1060) can enumerate running processes on a machine.(Citation: SentinelLabs Metador Sept 2022)
- [S0030] Carbanak: [Carbanak](https://attack.mitre.org/software/S0030) lists running processes.(Citation: FireEye CARBANAK June 2017)
- [S0650] QakBot: [QakBot](https://attack.mitre.org/software/S0650) has the ability to check running processes.(Citation: ATT QakBot April 2021)
- [S0661] FoggyWeb: [FoggyWeb](https://attack.mitre.org/software/S0661)'s loader can enumerate all Common Language Runtimes (CLRs) and running Application Domains in the compromised AD FS server's <code>Microsoft.IdentityServer.ServiceHost.exe</code> process.(Citation: MSTIC FoggyWeb September 2021)
- [S0534] Bazar: [Bazar](https://attack.mitre.org/software/S0534) can identity the current process on a compromised host.(Citation: Cybereason Bazar July 2020)
- [G0021] Molerats: [Molerats](https://attack.mitre.org/groups/G0021) actors obtained a list of active processes on the victim and sent them to C2 servers.(Citation: DustySky)
- [S0630] Nebulae: [Nebulae](https://attack.mitre.org/software/S0630) can enumerate processes on a target system.(Citation: Bitdefender Naikon April 2021)
- [G1006] Earth Lusca: [Earth Lusca](https://attack.mitre.org/groups/G1006) has used [Tasklist](https://attack.mitre.org/software/S0057) to obtain information from a compromised host.(Citation: TrendMicro EarthLusca 2022)
- [S0079] MobileOrder: [MobileOrder](https://attack.mitre.org/software/S0079) has a command to upload information about all running processes to its C2 server.(Citation: Scarlet Mimic Jan 2016)
- [S0198] NETWIRE: [NETWIRE](https://attack.mitre.org/software/S0198) can discover processes on compromised hosts.(Citation: FireEye NETWIRE March 2019)
- [S0606] Bad Rabbit: [Bad Rabbit](https://attack.mitre.org/software/S0606) can enumerate all running processes to compare hashes.(Citation: Secure List Bad Rabbit)
- [S0065] 4H RAT: [4H RAT](https://attack.mitre.org/software/S0065) has the capability to obtain a listing of running processes (including loaded modules).(Citation: CrowdStrike Putter Panda)
- [S0356] KONNI: [KONNI](https://attack.mitre.org/software/S0356) has used the command <code>cmd /c tasklist</code> to get a snapshot of the current processes on the target machine.(Citation: Medium KONNI Jan 2020)(Citation: Malwarebytes Konni Aug 2021)
- [S0512] FatDuke: [FatDuke](https://attack.mitre.org/software/S0512) can list running processes on the localhost.(Citation: ESET Dukes October 2019)
- [S1027] Heyoka Backdoor: [Heyoka Backdoor](https://attack.mitre.org/software/S1027) can gather process information.(Citation: SentinelOne Aoqin Dragon June 2022)
- [S0607] KillDisk: [KillDisk](https://attack.mitre.org/software/S0607) has called <code>GetCurrentProcess</code>.(Citation: Trend Micro KillDisk 2)
- [S1199] LockBit 2.0: [LockBit 2.0](https://attack.mitre.org/software/S1199) can determine if a running process has administrative privileges and terminate processes that interfere with encryption or exfiltration.(Citation: FBI Lockbit 2.0 FEB 2022)(Citation: SentinelOne LockBit 2.0)
- [S0064] ELMER: [ELMER](https://attack.mitre.org/software/S0064) is capable of performing process listings.(Citation: FireEye EPS Awakens Part 2)
- [S0393] PowerStallion: [PowerStallion](https://attack.mitre.org/software/S0393) has been used to monitor process lists.(Citation: ESET Turla PowerShell May 2019)
- [S1130] Raspberry Robin: [Raspberry Robin](https://attack.mitre.org/software/S1130) can identify processes running on the victim machine, such as security software, during execution.(Citation: TrendMicro RaspberryRobin 2022)(Citation: HP RaspberryRobin 2024)
- [S0664] Pandora: [Pandora](https://attack.mitre.org/software/S0664) can monitor processes on a compromised host.(Citation: Trend Micro Iron Tiger April 2021)
- [S0283] jRAT: [jRAT](https://attack.mitre.org/software/S0283) can query and kill system processes.(Citation: Symantec Frutas Feb 2013)
- [S0334] DarkComet: [DarkComet](https://attack.mitre.org/software/S0334) can list active processes running on the victim’s machine.(Citation: Malwarebytes DarkComet March 2018)
- [S0467] TajMahal: [TajMahal](https://attack.mitre.org/software/S0467) has the ability to identify running processes and associated plugins on an infected host.(Citation: Kaspersky TajMahal April 2019)
- [S0611] Clop: [Clop](https://attack.mitre.org/software/S0611) can enumerate all processes on the victim's machine.(Citation: Mcafee Clop Aug 2019)
- [S1066] DarkTortilla: [DarkTortilla](https://attack.mitre.org/software/S1066) can enumerate a list of running processes on a compromised system.(Citation: Secureworks DarkTortilla Aug 2022)
- [S0180] Volgmer: [Volgmer](https://attack.mitre.org/software/S0180) can gather a list of processes.(Citation: Symantec Volgmer Aug 2014)
- [S0249] Gold Dragon: [Gold Dragon](https://attack.mitre.org/software/S0249) checks the running processes on the victim’s machine.(Citation: McAfee Gold Dragon)
- [S1072] Industroyer2: [Industroyer2](https://attack.mitre.org/software/S1072) has the ability to cyclically enumerate running processes such as PServiceControl.exe, PService_PDD.exe, and other targets supplied through a hardcoded configuration.(Citation: Industroyer2 Mandiant April 2022)
- [S0115] Crimson: [Crimson](https://attack.mitre.org/software/S0115) contains a command to list processes.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022)
- [S0241] RATANKBA: [RATANKBA](https://attack.mitre.org/software/S0241) lists the system’s processes.(Citation: Lazarus RATANKBA)(Citation: RATANKBA)
- [G0129] Mustang Panda: [Mustang Panda](https://attack.mitre.org/groups/G0129) has used <code>tasklist /v</code> to determine active process information.(Citation: Avira Mustang Panda January 2020)
- [S1149] CHIMNEYSWEEP: [CHIMNEYSWEEP](https://attack.mitre.org/software/S1149) can check if a process name contains “creensaver.”(Citation: Mandiant ROADSWEEP August 2022)
- [S0517] Pillowmint: [Pillowmint](https://attack.mitre.org/software/S0517) can iterate through running processes every six seconds collecting a list of processes to capture from later.(Citation: Trustwave Pillowmint June 2020)
- [S0448] Rising Sun: [Rising Sun](https://attack.mitre.org/software/S0448) can enumerate all running processes and process information on an infected machine.(Citation: McAfee Sharpshooter December 2018)
- [S0687] Cyclops Blink: [Cyclops Blink](https://attack.mitre.org/software/S0687) can enumerate the process it is currently running under.(Citation: NCSC Cyclops Blink February 2022)
- [S1111] DarkGate: [DarkGate](https://attack.mitre.org/software/S1111) performs various checks for running processes, including security software by looking for hard-coded process name values.(Citation: Ensilo Darkgate 2018)(Citation: Rapid7 BlackBasta 2024)
- [S0468] Skidmap: [Skidmap](https://attack.mitre.org/software/S0468) has monitored critical processes to ensure resiliency.(Citation: Trend Micro Skidmap)
- [S0458] Ramsay: [Ramsay](https://attack.mitre.org/software/S0458) can gather a list of running processes by using [Tasklist](https://attack.mitre.org/software/S0057).(Citation: Antiy CERT Ramsay April 2020)
- [G1022] ToddyCat: [ToddyCat](https://attack.mitre.org/groups/G1022) has run `cmd /c start /b tasklist` to enumerate processes.(Citation: Kaspersky ToddyCat Check Logs October 2023)
- [S1141] LunarWeb: [LunarWeb](https://attack.mitre.org/software/S1141) has used shell commands to list running processes.(Citation: ESET Turla Lunar toolset May 2024)
- [S0501] PipeMon: [PipeMon](https://attack.mitre.org/software/S0501) can iterate over the running processes to find a suitable injection target.(Citation: ESET PipeMon May 2020)
- [S1016] MacMa: [MacMa](https://attack.mitre.org/software/S1016) can enumerate running processes.(Citation: ESET DazzleSpy Jan 2022)
- [S0254] PLAINTEE: [PLAINTEE](https://attack.mitre.org/software/S0254) performs the <code>tasklist</code> command to list running processes.(Citation: Rancor Unit42 June 2018)
- [S0211] Linfo: [Linfo](https://attack.mitre.org/software/S0211) creates a backdoor through which remote attackers can retrieve a list of running processes.(Citation: Symantec Linfo May 2012)
- [S0596] ShadowPad: [ShadowPad](https://attack.mitre.org/software/S0596) has collected the PID of a malicious process.(Citation: Kaspersky ShadowPad Aug 2017)
- [S0017] BISCUIT: [BISCUIT](https://attack.mitre.org/software/S0017) has a command to enumerate running processes and identify their owners.(Citation: Mandiant APT1 Appendix)
- [S0256] Mosquito: [Mosquito](https://attack.mitre.org/software/S0256) runs <code>tasklist</code> to obtain running processes.(Citation: ESET Turla Mosquito Jan 2018)
- [S0559] SUNBURST: [SUNBURST](https://attack.mitre.org/software/S0559) collected a list of process names that were hashed using a FNV-1a + XOR algorithm to check against similarly-hashed hardcoded blocklists.(Citation: FireEye SUNBURST Backdoor December 2020)
- [S0162] Komplex: The OsInfo function in [Komplex](https://attack.mitre.org/software/S0162) collects a running process list.(Citation: Sofacy Komplex Trojan)
- [S0266] TrickBot: [TrickBot](https://attack.mitre.org/software/S0266) uses module networkDll for process list discovery.(Citation: ESET Trickbot Oct 2020)(Citation: Bitdefender Trickbot March 2020)
- [G1023] APT5: [APT5](https://attack.mitre.org/groups/G1023) has used Windows-based utilities to carry out tasks including tasklist.exe. (Citation: Mandiant Pulse Secure Update May 2021)
- [C0007] FunnyDream: During [FunnyDream](https://attack.mitre.org/campaigns/C0007), the threat actors used [Tasklist](https://attack.mitre.org/software/S0057) on targeted systems.(Citation: Bitdefender FunnyDream Campaign November 2020)
- [S0657] BLUELIGHT: [BLUELIGHT](https://attack.mitre.org/software/S0657) can collect process filenames and SID authority level.(Citation: Volexity InkySquid BLUELIGHT August 2021)
- [G0010] Turla: [Turla](https://attack.mitre.org/groups/G0010) surveys a system upon check-in to discover running processes using the <code>tasklist /v</code> command.(Citation: Kaspersky Turla) [Turla](https://attack.mitre.org/groups/G0010) RPC backdoors have also enumerated processes associated with specific open ports or named pipes.(Citation: ESET Turla PowerShell May 2019)
- [G0069] MuddyWater: [MuddyWater](https://attack.mitre.org/groups/G0069) has used malware to obtain a list of running processes on the system.(Citation: Securelist MuddyWater Oct 2018)(Citation: ClearSky MuddyWater June 2019)
- [S0346] OceanSalt: [OceanSalt](https://attack.mitre.org/software/S0346) can collect the name and ID for every process running on the system.(Citation: McAfee Oceansalt Oct 2018)
- [G0106] Rocke: [Rocke](https://attack.mitre.org/groups/G0106) can detect a running process's PID on the infected machine.(Citation: Anomali Rocke March 2019)
- [G0059] Magic Hound: [Magic Hound](https://attack.mitre.org/groups/G0059) malware can list running processes.(Citation: Unit 42 Magic Hound Feb 2017)
- [S0032] gh0st RAT: [gh0st RAT](https://attack.mitre.org/software/S0032) has the capability to list processes.(Citation: FireEye Hacking Team)
- [S1085] Sardonic: [Sardonic](https://attack.mitre.org/software/S1085) has the ability to execute the `tasklist` command.(Citation: Bitdefender Sardonic Aug 2021)
- [S0431] HotCroissant: [HotCroissant](https://attack.mitre.org/software/S0431) has the ability to list running processes on the infected host.(Citation: Carbon Black HotCroissant April 2020)
- [S0674] CharmPower: [CharmPower](https://attack.mitre.org/software/S0674) has the ability to list running processes through the use of `tasklist`.(Citation: Check Point APT35 CharmPower January 2022)
- [S0203] Hydraq: [Hydraq](https://attack.mitre.org/software/S0203) creates a backdoor through which remote attackers can monitor processes.(Citation: Symantec Trojan.Hydraq Jan 2010)(Citation: Symantec Hydraq Jan 2010)
- [S1212] RansomHub: [RansomHub](https://attack.mitre.org/software/S1212) can stop processes associated with files currently in use to maximize the impact of encryption.(Citation: CISA RansomHub AUG 2024)
- [S0617] HELLOKITTY: [HELLOKITTY](https://attack.mitre.org/software/S0617) can search for specific processes to terminate.(Citation: FireEye FiveHands April 2021)
- [G0067] APT37: [APT37](https://attack.mitre.org/groups/G0067)'s Freenki malware lists running processes using the Microsoft Windows API.(Citation: Talos Group123)
- [S0428] PoetRAT: [PoetRAT](https://attack.mitre.org/software/S0428) has the ability to list all running processes.(Citation: Talos PoetRAT April 2020)
- [S0694] DRATzarus: [DRATzarus](https://attack.mitre.org/software/S0694) can enumerate and examine running processes to determine if a debugger is present.(Citation: ClearSky Lazarus Aug 2020)
- [S0672] Zox: [Zox](https://attack.mitre.org/software/S0672) has the ability to list processes.(Citation: Novetta-Axiom)
- [S1122] Mispadu: [Mispadu](https://attack.mitre.org/software/S1122) can enumerate the running processes on a compromised host.(Citation: ESET Security Mispadu Facebook Ads 2019)
- [S0652] MarkiRAT: [MarkiRAT](https://attack.mitre.org/software/S0652) can search for different processes on a system.(Citation: Kaspersky Ferocious Kitten Jun 2021)
- [S0477] Goopy: [Goopy](https://attack.mitre.org/software/S0477) has checked for the Google Updater process to ensure [Goopy](https://attack.mitre.org/software/S0477) was loaded properly.(Citation: Cybereason Cobalt Kitty 2017)
- [S0660] Clambling: [Clambling](https://attack.mitre.org/software/S0660) can enumerate processes on a targeted system.(Citation: Trend Micro DRBControl February 2020)
- [S1146] MgBot: [MgBot](https://attack.mitre.org/software/S1146) includes a module for establishing a process watchdog for itself, identifying if the [MgBot](https://attack.mitre.org/software/S1146) process is still running.(Citation: Symantec Daggerfly 2023)
- [S1191] Megazord: [Megazord](https://attack.mitre.org/software/S1191) can terminate a list of specified services and processes.(Citation: Palo Alto Howling Scorpius DEC 2024)
- [S0464] SYSCON: [SYSCON](https://attack.mitre.org/software/S0464) has the ability to use [Tasklist](https://attack.mitre.org/software/S0057) to list running processes.(Citation: Unit 42 CARROTBAT January 2020)
- [S0093] Backdoor.Oldrea: [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) collects information about running processes.(Citation: Symantec Dragonfly)
- [S0503] FrameworkPOS: [FrameworkPOS](https://attack.mitre.org/software/S0503) can enumerate and exclude selected processes on a compromised host to speed execution of memory scraping.(Citation: SentinelOne FrameworkPOS September 2019)
- [S0127] BBSRAT: [BBSRAT](https://attack.mitre.org/software/S0127) can list running processes.(Citation: Palo Alto Networks BBSRAT)
- [S0247] NavRAT: [NavRAT](https://attack.mitre.org/software/S0247) uses <code>tasklist /v</code> to check running processes.(Citation: Talos NavRAT May 2018)
- [G0094] Kimsuky: [Kimsuky](https://attack.mitre.org/groups/G0094) can gather a list of all processes running on a victim's machine.(Citation: Talos Kimsuky Nov 2021)
- [S0161] XAgentOSX: [XAgentOSX](https://attack.mitre.org/software/S0161) contains the getProcessList function to run <code>ps aux</code> to get running processes.(Citation: XAgentOSX 2017)
- [S1018] Saint Bot: [Saint Bot](https://attack.mitre.org/software/S1018) has enumerated running processes on a compromised host to determine if it is running under the process name `dfrgui.exe`.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 )
- [S0567] Dtrack: [Dtrack](https://attack.mitre.org/software/S0567)’s dropper can list all running processes.(Citation: Securelist Dtrack)(Citation: CyberBit Dtrack)
- [S1100] Ninja: [Ninja](https://attack.mitre.org/software/S1100) can enumerate processes on a targeted host.(Citation: Kaspersky ToddyCat June 2022)(Citation: Kaspersky ToddyCat Check Logs October 2023)
- [S0452] USBferry: [USBferry](https://attack.mitre.org/software/S0452) can use <code>tasklist</code> to gather information about the process running on the infected system.(Citation: TrendMicro Tropic Trooper May 2020)
- [S1124] SocGholish: [SocGholish](https://attack.mitre.org/software/S1124) can list processes on targeted hosts.(Citation: Secureworks Gold Prelude Profile)
- [S0236] Kwampirs: [Kwampirs](https://attack.mitre.org/software/S0236) collects a list of running services with the command <code>tasklist /v</code>.(Citation: Symantec Orangeworm April 2018)
- [S1039] Bumblebee: [Bumblebee](https://attack.mitre.org/software/S1039) can identify processes associated with analytical tools.(Citation: Proofpoint Bumblebee April 2022)(Citation: Symantec Bumblebee June 2022)(Citation: Medium Ali Salem Bumblebee April 2022)
- [S0194] PowerSploit: [PowerSploit](https://attack.mitre.org/software/S0194)'s <code>Get-ProcessTokenPrivilege</code> Privesc-PowerUp module can enumerate privileges for a given process.(Citation: GitHub PowerSploit May 2012)(Citation: PowerSploit Documentation)
- [S0625] Cuba: [Cuba](https://attack.mitre.org/software/S0625) can enumerate processes running on a victim's machine.(Citation: McAfee Cuba April 2021)
- [S0270] RogueRobin: [RogueRobin](https://attack.mitre.org/software/S0270) checks the running processes for evidence it may be running in a sandbox environment. It specifically enumerates processes for Wireshark and Sysinternals.(Citation: Unit 42 DarkHydrus July 2018)
- [S1202] LockBit 3.0: [LockBit 3.0](https://attack.mitre.org/software/S1202) can identify and terminate specific services.(Citation: Sentinel Labs LockBit 3.0 JUL 2022)(Citation: Joint Cybersecurity Advisory LockBit JUN 2023)
- [S0238] Proxysvc: [Proxysvc](https://attack.mitre.org/software/S0238) lists processes running on the system.(Citation: McAfee GhostSecret)
- [S1090] NightClub: [NightClub](https://attack.mitre.org/software/S1090) has the ability to use `GetWindowThreadProcessId` to identify the process behind a specified window.(Citation: MoustachedBouncer ESET August 2023)
- [S0449] Maze: [Maze](https://attack.mitre.org/software/S0449) has gathered all of the running system processes.(Citation: McAfee Maze March 2020)
- [S0644] ObliqueRAT: [ObliqueRAT](https://attack.mitre.org/software/S0644) can check for blocklisted process names on a compromised host.(Citation: Talos Oblique RAT March 2021)
- [S1064] SVCReady: [SVCReady](https://attack.mitre.org/software/S1064) can collect a list of running processes from an infected host.(Citation: HP SVCReady Jun 2022)
- [G0126] Higaisa: [Higaisa](https://attack.mitre.org/groups/G0126)’s shellcode attempted to find the process ID of the current process.(Citation: Zscaler Higaisa 2020)
- [G0033] Poseidon Group: After compromising a victim, [Poseidon Group](https://attack.mitre.org/groups/G0033) lists all running processes.(Citation: Kaspersky Poseidon Group)
- [S1164] UPSTYLE: [UPSTYLE](https://attack.mitre.org/software/S1164) has the ability to read `/proc/self/cmdline` to see if it is running as a monitored process.(Citation: Palo Alto MidnightEclipse APR 2024)
- [G0004] Ke3chang: [Ke3chang](https://attack.mitre.org/groups/G0004) performs process discovery using <code>tasklist</code> commands.(Citation: Mandiant Operation Ke3chang November 2014)(Citation: NCC Group APT15 Alive and Strong)
- [S0595] ThiefQuest: [ThiefQuest](https://attack.mitre.org/software/S0595) obtains a list of running processes using the function <code>kill_unwanted</code>.(Citation: wardle evilquest parti)
- [S0063] SHOTPUT: [SHOTPUT](https://attack.mitre.org/software/S0063) has a command to obtain a process listing.(Citation: Palo Alto CVE-2015-3113 July 2015)
- [S0627] SodaMaster: [SodaMaster](https://attack.mitre.org/software/S0627) can search a list of running processes.(Citation: Securelist APT10 March 2021)
- [G1001] HEXANE: [HEXANE](https://attack.mitre.org/groups/G1001) has enumerated processes on targeted systems.(Citation: Kaspersky Lyceum October 2021)
- [S0533] SLOTHFULMEDIA: [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) has enumerated processes by ID, name, or privileges.(Citation: CISA MAR SLOTHFULMEDIA October 2020)
- [S0638] Babuk: [Babuk](https://attack.mitre.org/software/S0638) has the ability to check running processes on a targeted system.(Citation: Sogeti CERT ESEC Babuk March 2021)(Citation: McAfee Babuk February 2021)(Citation: Trend Micro Ransomware February 2021)
- [G0100] Inception: [Inception](https://attack.mitre.org/groups/G0100) has used a reconnaissance module to identify active processes and other associated loaded modules.(Citation: Symantec Inception Framework March 2018)
- [S0011] Taidoor: [Taidoor](https://attack.mitre.org/software/S0011) can use <code>GetCurrentProcessId</code> for process discovery.(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021)
- [S0461] SDBbot: [SDBbot](https://attack.mitre.org/software/S0461) can enumerate a list of running processes on a compromised machine.(Citation: Korean FSI TA505 2020)
- [S0216] POORAIM: [POORAIM](https://attack.mitre.org/software/S0216) can enumerate processes.(Citation: FireEye APT37 Feb 2018)
- [S1129] Akira: [Akira](https://attack.mitre.org/software/S1129) verifies the deletion of volume shadow copies by checking for the existence of the process ID related to the process created to delete these items.(Citation: Kersten Akira 2023)
- [S0385] njRAT: [njRAT](https://attack.mitre.org/software/S0385) can search a list of running processes for Tr.exe.(Citation: Trend Micro njRAT 2018)
- [S1087] AsyncRAT: [AsyncRAT](https://attack.mitre.org/software/S1087) can examine running processes to determine if a debugger is present.(Citation: Telefonica Snip3 December 2021)
- [S0182] FinFisher: [FinFisher](https://attack.mitre.org/software/S0182) checks its parent process for indications that it is running in a sandbox setup.(Citation: FinFisher Citation)(Citation: Microsoft FinFisher March 2018)
- [G0049] OilRig: [OilRig](https://attack.mitre.org/groups/G0049) has run <code>tasklist</code> on a victim's machine and used infostealers to capture processes.(Citation: Palo Alto OilRig May 2016)(Citation: Symantec Crambus OCT 2023)
- [S0579] Waterbear: [Waterbear](https://attack.mitre.org/software/S0579) can identify the process for a specific security product.(Citation: Trend Micro Waterbear December 2019)
- [S0242] SynAck: [SynAck](https://attack.mitre.org/software/S0242) enumerates all running processes.(Citation: SecureList SynAck Doppelgänging May 2018)(Citation: Kaspersky Lab SynAck May 2018)
- [G0022] APT3: [APT3](https://attack.mitre.org/groups/G0022) has a tool that can list out currently running processes.(Citation: FireEye Clandestine Fox)(Citation: evolution of pirpi)
- [S1078] RotaJakiro: [RotaJakiro](https://attack.mitre.org/software/S1078) can monitor the `/proc/[PID]` directory of known [RotaJakiro](https://attack.mitre.org/software/S1078) processes as a part of its persistence when executing with non-root permissions. If the process is found dead, it resurrects the process. [RotaJakiro](https://attack.mitre.org/software/S1078) processes can be matched to an associated Advisory Lock, in the `/proc/locks` folder, to ensure it doesn't spawn more than one process.(Citation: RotaJakiro 2021 netlab360 analysis)
- [S0022] Uroburos: [Uroburos](https://attack.mitre.org/software/S0022) can use its `Process List` command to enumerate processes on compromised hosts.(Citation: Joint Cybersecurity Advisory AA23-129A Snake Malware May 2023)
- [S0435] PLEAD: [PLEAD](https://attack.mitre.org/software/S0435) has the ability to list processes on the compromised host.(Citation: TrendMicro BlackTech June 2017)
- [S0491] StrongPity: [StrongPity](https://attack.mitre.org/software/S0491) can determine if a user is logged in by checking to see if explorer.exe is running.(Citation: Talos Promethium June 2020)
- [S0599] Kinsing: [Kinsing](https://attack.mitre.org/software/S0599) has used ps to list processes.(Citation: Aqua Kinsing April 2020)
- [G0047] Gamaredon Group: [Gamaredon Group](https://attack.mitre.org/groups/G0047) has used tools to enumerate processes on target hosts including Process Explorer.(Citation: Symantec Shuckworm January 2022)(Citation: Unit 42 Gamaredon February 2022)
- [S0692] SILENTTRINITY: [SILENTTRINITY](https://attack.mitre.org/software/S0692) can enumerate processes, including properties to determine if they have the Common Language Runtime (CLR) loaded.(Citation: GitHub SILENTTRINITY Modules July 2019)
- [C0006] Operation Honeybee: During [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), the threat actors obtained a list of running processes on a victim machine using `cmd /c tasklist > %temp%\temp.ini`.(Citation: McAfee Honeybee)
- [S0396] EvilBunny: [EvilBunny](https://attack.mitre.org/software/S0396) has used EnumProcesses() to identify how many process are running in the environment.(Citation: Cyphort EvilBunny Dec 2014)
- [S0333] UBoatRAT: [UBoatRAT](https://attack.mitre.org/software/S0333) can list running processes on the system.(Citation: PaloAlto UBoatRAT Nov 2017)
- [S0367] Emotet: [Emotet](https://attack.mitre.org/software/S0367) has been observed enumerating local processes.(Citation: ASEC Emotet 2017)
- [C0012] Operation CuckooBees: During [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), the threat actors used the `tasklist` command as part of their advanced reconnaissance.(Citation: Cybereason OperationCuckooBees May 2022)
- [S0335] Carbon: [Carbon](https://attack.mitre.org/software/S0335) can list the processes on the victim’s machine.(Citation: ESET Carbon Mar 2017)
- [S0144] ChChes: [ChChes](https://attack.mitre.org/software/S0144) collects its process identifier (PID) on the victim.(Citation: Palo Alto menuPass Feb 2017)
- [S1017] OutSteel: [OutSteel](https://attack.mitre.org/software/S1017) can identify running processes on a compromised host.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 )
- [G0044] Winnti Group: [Winnti Group](https://attack.mitre.org/groups/G0044) looked for a specific process running on infected servers.(Citation: Kaspersky Winnti April 2013)
- [S0681] Lizar: [Lizar](https://attack.mitre.org/software/S0681) has a plugin designed to obtain a list of processes.(Citation: Threatpost Lizar May 2021)(Citation: BiZone Lizar May 2021)
- [S0455] Metamorfo: [Metamorfo](https://attack.mitre.org/software/S0455) has performed process name checks and has monitored applications.(Citation: Medium Metamorfo Apr 2020)
- [S0575] Conti: [Conti](https://attack.mitre.org/software/S0575) can enumerate through all open processes to search for any that have the string “sql” in their process name.(Citation: CarbonBlack Conti July 2020)
- [S0260] InvisiMole: [InvisiMole](https://attack.mitre.org/software/S0260) can obtain a list of running processes.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020)
- [S0273] Socksbot: [Socksbot](https://attack.mitre.org/software/S0273) can list all running processes.(Citation: TrendMicro Patchwork Dec 2017)
- [S0154] Cobalt Strike: [Cobalt Strike](https://attack.mitre.org/software/S0154)'s Beacon payload can collect information on process details.(Citation: cobaltstrike manual)(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020)
- [S0348] Cardinal RAT: [Cardinal RAT](https://attack.mitre.org/software/S0348) contains watchdog functionality that ensures its process is always running, else spawns a new instance.(Citation: PaloAlto CardinalRat Apr 2017)
- [S0363] Empire: [Empire](https://attack.mitre.org/software/S0363) can find information about processes running on local and remote systems.(Citation: Github PowerShell Empire)(Citation: Talos Frankenstein June 2019)
- [S0693] CaddyWiper: [CaddyWiper](https://attack.mitre.org/software/S0693) can obtain a list of current processes.(Citation: Malwarebytes IssacWiper CaddyWiper March 2022 )
- [S0021] Derusbi: [Derusbi](https://attack.mitre.org/software/S0021) collects current and parent process IDs.(Citation: Fidelis Turbo)(Citation: FireEye Periscope March 2018)
- [S0688] Meteor: [Meteor](https://attack.mitre.org/software/S0688) can check if a specific process is running, such as Kaspersky's `avp.exe`.(Citation: Check Point Meteor Aug 2021)
- [S1073] Royal: [Royal](https://attack.mitre.org/software/S1073) can use `GetCurrentProcess` to enumerate processes.(Citation: Cybereason Royal December 2022)
- [S0148] RTM: [RTM](https://attack.mitre.org/software/S0148) can obtain information about process integrity levels.(Citation: ESET RTM Feb 2017)
- [S0696] Flagpro: [Flagpro](https://attack.mitre.org/software/S0696) has been used to run the <code>tasklist</code> command on a compromised system.(Citation: NTT Security Flagpro new December 2021)
- [S1048] macOS.OSAMiner: [macOS.OSAMiner](https://attack.mitre.org/software/S1048) has used `ps ax | grep <name> | grep -v grep | ...` and `ps ax | grep -E...` to conduct process discovery.(Citation: SentinelLabs reversing run-only applescripts 2021)
- [S1139] INC Ransomware: [INC Ransomware](https://attack.mitre.org/software/S1139) can use the Microsoft Win32 Restart Manager to kill processes with a specific handle or that are accessing resources it wants to encrypt.(Citation: Cybereason INC Ransomware November 2023)
- [S0062] DustySky: [DustySky](https://attack.mitre.org/software/S0062) collects information about running processes from victims.(Citation: DustySky)(Citation: Kaspersky MoleRATs April 2019)
- [G0082] APT38: [APT38](https://attack.mitre.org/groups/G0082) leveraged Sysmon to understand the processes, services in the organization.(Citation: FireEye APT38 Oct 2018)
- [S0344] Azorult: [Azorult](https://attack.mitre.org/software/S0344) can collect a list of running processes by calling CreateToolhelp32Snapshot.(Citation: Unit42 Azorult Nov 2018)(Citation: Proofpoint Azorult July 2018)
- [S0486] Bonadan: [Bonadan](https://attack.mitre.org/software/S0486) can use the <code>ps</code> command to discover other cryptocurrency miners active on the system.(Citation: ESET ForSSHe December 2018)
- [S0257] VERMIN: [VERMIN](https://attack.mitre.org/software/S0257) can get a list of the processes and running tasks on the system.(Citation: Unit 42 VERMIN Jan 2018)
- [S1178] ShrinkLocker: [ShrinkLocker](https://attack.mitre.org/software/S1178) checks whether the Bitlocker Drive Encryption Tools service is running.(Citation: Splunk ShrinkLocker 2024)
- [S0445] ShimRatReporter: [ShimRatReporter](https://attack.mitre.org/software/S0445) listed all running processes on the machine.(Citation: FOX-IT May 2016 Mofang)
- [S0484] Carberp: [Carberp](https://attack.mitre.org/software/S0484) has collected a list of running processes.(Citation: Trusteer Carberp October 2010)
- [S1053] AvosLocker: [AvosLocker](https://attack.mitre.org/software/S1053) has discovered system processes by calling `RmGetList`.(Citation: Malwarebytes AvosLocker Jul 2021)
- [S0192] Pupy: [Pupy](https://attack.mitre.org/software/S0192) can list the running processes and get the process ID and parent process’s ID.(Citation: GitHub Pupy)
- [S0600] Doki: [Doki](https://attack.mitre.org/software/S0600) has searched for the current process’s PID.(Citation: Intezer Doki July 20)
- [C0014] Operation Wocao: During [Operation Wocao](https://attack.mitre.org/campaigns/C0014), the threat actors used `tasklist` to collect a list of running processes on an infected system.(Citation: FoxIT Wocao December 2019)
- [S0223] POWERSTATS: [POWERSTATS](https://attack.mitre.org/software/S0223) has used <code>get_tasklist</code> to discover processes on the compromised host.(Citation: TrendMicro POWERSTATS V3 June 2019)


### T1069 - Permission Groups Discovery

Description:

Adversaries may attempt to discover group and permission settings. This information can help adversaries determine which user accounts and groups are available, the membership of users in particular groups, and which users and groups have elevated permissions.

Adversaries may attempt to discover group permission settings in many different ways. This data may provide the adversary with information about the compromised environment that can be used in follow-on activity and targeting.(Citation: CrowdStrike BloodHound April 2018)

Procedures:

- [G0096] APT41: [APT41](https://attack.mitre.org/groups/G0096) used <code>net group</code> commands to enumerate various Windows user groups and permissions.(Citation: Rostovcev APT41 2021)
- [S0483] IcedID: [IcedID](https://attack.mitre.org/software/S0483) has the ability to identify Workgroup membership.(Citation: IBM IcedID November 2017)
- [S0335] Carbon: [Carbon](https://attack.mitre.org/software/S0335) uses the <code>net group</code> command.(Citation: GovCERT Carbon May 2016)
- [C0024] SolarWinds Compromise: During the [SolarWinds Compromise](https://attack.mitre.org/campaigns/C0024), [APT29](https://attack.mitre.org/groups/G0016) used the `Get-ManagementRoleAssignment` PowerShell cmdlet to enumerate Exchange management role assignments through an Exchange Management Shell.(Citation: Volexity SolarWinds)
- [S0266] TrickBot: [TrickBot](https://attack.mitre.org/software/S0266) can identify the groups the user on a compromised host belongs to.(Citation: Cyberreason Anchor December 2019)
- [S0233] MURKYTOP: [MURKYTOP](https://attack.mitre.org/software/S0233) has the capability to retrieve information about groups.(Citation: FireEye Periscope March 2018)
- [G0092] TA505: [TA505](https://attack.mitre.org/groups/G0092) has used TinyMet to enumerate members of privileged groups.(Citation: IBM TA505 April 2020) [TA505](https://attack.mitre.org/groups/G0092) has also run <code>net group /domain</code>.(Citation: Trend Micro TA505 June 2019)
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has used commercial tools, LOTL utilities, and appliances already present on the system for group and user discovery.(Citation: CISA AA24-038A PRC Critical Infrastructure February 2024)
- [S0445] ShimRatReporter: [ShimRatReporter](https://attack.mitre.org/software/S0445) gathered the local privileges for the infected host.(Citation: FOX-IT May 2016 Mofang)
- [G0022] APT3: [APT3](https://attack.mitre.org/groups/G0022) has a tool that can enumerate the permissions associated with Windows groups.(Citation: Symantec Buckeye)
- [S0623] Siloscape: [Siloscape](https://attack.mitre.org/software/S0623) checks for Kubernetes node permissions.(Citation: Unit 42 Siloscape Jun 2021)
- [G1016] FIN13: [FIN13](https://attack.mitre.org/groups/G1016) has enumerated all users and roles from a victim's main treasury system.(Citation: Mandiant FIN13 Aug 2022)

#### T1069.001 - Local Groups

Description:

Adversaries may attempt to find local system groups and permission settings. The knowledge of local system permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as the users found within the local administrators group.

Commands such as <code>net localgroup</code> of the [Net](https://attack.mitre.org/software/S0039) utility, <code>dscl . -list /Groups</code> on macOS, and <code>groups</code> on Linux can list local groups.

Procedures:

- [G0010] Turla: [Turla](https://attack.mitre.org/groups/G0010) has used <code>net localgroup</code> and <code>net localgroup Administrators</code> to enumerate group information, including members of the local administrators group.(Citation: ESET ComRAT May 2020)
- [S0201] JPIN: [JPIN](https://attack.mitre.org/software/S0201) can obtain the permissions of the victim user.(Citation: Microsoft PLATINUM April 2016)
- [S0060] Sys10: [Sys10](https://attack.mitre.org/software/S0060) collects the group name of the logged-in user and sends it to the C2.(Citation: Baumgartner Naikon 2015)
- [S0521] BloodHound: [BloodHound](https://attack.mitre.org/software/S0521) can collect information about local groups and members.(Citation: CrowdStrike BloodHound April 2018)
- [S0692] SILENTTRINITY: [SILENTTRINITY](https://attack.mitre.org/software/S0692) can obtain a list of local groups and members.(Citation: GitHub SILENTTRINITY Modules July 2019)
- [S1179] Exbyte: [Exbyte](https://attack.mitre.org/software/S1179) checks whether the process is running with privileged local access during execution.(Citation: Microsoft BlackByte 2023)
- [G0131] Tonto Team: [Tonto Team](https://attack.mitre.org/groups/G0131) has used the <code>ShowLocalGroupDetails</code> command to identify administrator, user, and guest accounts on a compromised host.(Citation: TrendMicro Tonto Team October 2020)
- [S0184] POWRUNER: [POWRUNER](https://attack.mitre.org/software/S0184) may collect local group information by running <code>net localgroup administrators</code> or a series of other commands on a victim.(Citation: FireEye APT34 Dec 2017)
- [C0015] C0015: During [C0015](https://attack.mitre.org/campaigns/C0015), the threat actors used the command `net localgroup "adminstrator" ` to identify accounts with local administrator rights.(Citation: DFIR Conti Bazar Nov 2021)
- [G1001] HEXANE: [HEXANE](https://attack.mitre.org/groups/G1001) has run `net localgroup` to enumerate local groups.(Citation: Kaspersky Lyceum October 2021)
- [C0014] Operation Wocao: During [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors used the command `net localgroup administrators` to list all administrators part of a local group.(Citation: FoxIT Wocao December 2019)
- [S0650] QakBot: [QakBot](https://attack.mitre.org/software/S0650) can use <code>net localgroup</code> to enable discovery of local groups.(Citation: Kaspersky QakBot September 2021)(Citation: Trend Micro Black Basta October 2022)
- [S0154] Cobalt Strike: [Cobalt Strike](https://attack.mitre.org/software/S0154) can use <code>net localgroup</code> to list local groups on a system.(Citation: Cobalt Strike Manual 4.3 November 2020)
- [S0039] Net: Commands such as <code>net group</code> and <code>net localgroup</code> can be used in [Net](https://attack.mitre.org/software/S0039) to gather information about and manipulate groups.(Citation: Savill 1999)
- [S0378] PoshC2: [PoshC2](https://attack.mitre.org/software/S0378) contains modules, such as <code>Get-LocAdm</code> for enumerating permission groups.(Citation: GitHub PoshC2)
- [S0265] Kazuar: [Kazuar](https://attack.mitre.org/software/S0265) gathers information about local groups and members.(Citation: Unit 42 Kazuar May 2017)
- [G0018] admin@338: [admin@338](https://attack.mitre.org/groups/G0018) actors used the following command following exploitation of a machine with [LOWBALL](https://attack.mitre.org/software/S0042) malware to list local groups: <code>net localgroup administrator >> %temp%\download</code>(Citation: FireEye admin@338)
- [S0082] Emissary: [Emissary](https://attack.mitre.org/software/S0082) has the capability to execute the command <code>net localgroup administrators</code>.(Citation: Emissary Trojan Feb 2016)
- [S0696] Flagpro: [Flagpro](https://attack.mitre.org/software/S0696) has been used to execute the <code>net localgroup administrators</code> command on a targeted system.(Citation: NTT Security Flagpro new December 2021)
- [C0012] Operation CuckooBees: During [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), the threat actors used the `net group` command as part of their advanced reconnaissance.(Citation: Cybereason OperationCuckooBees May 2022)
- [G0114] Chimera: [Chimera](https://attack.mitre.org/groups/G0114) has used <code>net localgroup administrators</code> to identify  accounts with local administrative rights.(Citation: NCC Group Chimera January 2021)
- [S0572] Caterpillar WebShell: [Caterpillar WebShell](https://attack.mitre.org/software/S0572) can obtain a list of local groups of users from a system.(Citation: ClearSky Lebanese Cedar Jan 2021)
- [S1141] LunarWeb: [LunarWeb](https://attack.mitre.org/software/S1141) can discover local group memberships.(Citation: ESET Turla Lunar toolset May 2024)
- [S0170] Helminth: [Helminth](https://attack.mitre.org/software/S0170) has checked the local administrators group.(Citation: Unit 42 Playbook Dec 2017)
- [S0091] Epic: [Epic](https://attack.mitre.org/software/S0091) gathers information on local group names.(Citation: Kaspersky Turla Aug 2014)
- [S0165] OSInfo: [OSInfo](https://attack.mitre.org/software/S0165) has enumerated the local administrators group.(Citation: Symantec Buckeye)
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has run `net localgroup administrators` in compromised environments to enumerate accounts.(Citation: Joint Cybersecurity Advisory Volt Typhoon June 2023)
- [G0049] OilRig: [OilRig](https://attack.mitre.org/groups/G0049) has used <code>net localgroup administrators</code> to find local administrators on compromised systems.(Citation: Palo Alto OilRig May 2016)(Citation: Symantec Crambus OCT 2023)
- [S1198] Gomir: [Gomir](https://attack.mitre.org/software/S1198) checks the effective group ID of its process when initially executed to determine if it is in group 0, denoting superuser privileges in Linux environments.(Citation: Symantec Troll Stealer 2024)
- [S0381] FlawedAmmyy: [FlawedAmmyy](https://attack.mitre.org/software/S0381) enumerates the privilege level of the victim during the initial infection.(Citation: Proofpoint TA505 Mar 2018)(Citation: Korean FSI TA505 2020)
- [S0236] Kwampirs: [Kwampirs](https://attack.mitre.org/software/S0236) collects a list of users belonging to the local users and administrators groups with the commands <code>net localgroup administrators</code> and <code>net localgroup users</code>.(Citation: Symantec Orangeworm April 2018)

#### T1069.002 - Domain Groups

Description:

Adversaries may attempt to find domain-level groups and permission settings. The knowledge of domain-level permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as domain administrators.

Commands such as <code>net group /domain</code> of the [Net](https://attack.mitre.org/software/S0039) utility,  <code>dscacheutil -q group</code> on macOS, and <code>ldapsearch</code> on Linux can list domain-level groups.

Procedures:

- [S0236] Kwampirs: [Kwampirs](https://attack.mitre.org/software/S0236) collects a list of domain groups with the command <code>net localgroup /domain</code>.(Citation: Symantec Orangeworm April 2018)
- [G1004] LAPSUS$: [LAPSUS$](https://attack.mitre.org/groups/G1004) has used the AD Explorer tool to enumerate groups on a victim's network.(Citation: MSTIC DEV-0537 Mar 2022)
- [S0039] Net: Commands such as <code>net group /domain</code> can be used in [Net](https://attack.mitre.org/software/S0039) to gather information about and manipulate groups.(Citation: Savill 1999)
- [S0521] BloodHound: [BloodHound](https://attack.mitre.org/software/S0521) can collect information about domain groups and members.(Citation: CrowdStrike BloodHound April 2018)
- [S0692] SILENTTRINITY: [SILENTTRINITY](https://attack.mitre.org/software/S0692) can use `System.DirectoryServices` namespace to retrieve domain group information.(Citation: GitHub SILENTTRINITY Modules July 2019)
- [C0024] SolarWinds Compromise: During the [SolarWinds Compromise](https://attack.mitre.org/campaigns/C0024), [APT29](https://attack.mitre.org/groups/G0016) used [AdFind](https://attack.mitre.org/software/S0552) to enumerate domain groups.(Citation: CrowdStrike StellarParticle January 2022)
- [S1138] Gootloader: [Gootloader](https://attack.mitre.org/software/S1138) can determine if a targeted system is part of an Active Directory domain by  expanding the %USERDNSDOMAIN%  environment variable.(Citation: SentinelOne Gootloader June 2021)
- [G1022] ToddyCat: [ToddyCat](https://attack.mitre.org/groups/G1022) has executed `net group "domain admins" /dom` for discovery on compromised machines.(Citation: Kaspersky ToddyCat Check Logs October 2023)
- [S0417] GRIFFON: [GRIFFON](https://attack.mitre.org/software/S0417) has used a reconnaissance module that can be used to retrieve Windows domain membership information.(Citation: SecureList Griffon May 2019)
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has run `net group` in compromised environments to discover domain groups.(Citation: Secureworks BRONZE SILHOUETTE May 2023)
- [G0049] OilRig: [OilRig](https://attack.mitre.org/groups/G0049) has used <code>net group /domain</code>, <code>net group “domain admins” /domain</code>, and <code>net group “Exchange Trusted Subsystem” /domain</code> to find domain group permission settings.(Citation: Palo Alto OilRig May 2016)
- [S0552] AdFind: [AdFind](https://attack.mitre.org/software/S0552) can enumerate domain groups.(Citation: Red Canary Hospital Thwarted Ryuk October 2020)(Citation: FireEye FIN6 Apr 2019)(Citation: FireEye Ryuk and Trickbot January 2019)(Citation: Symantec Bumblebee June 2022)
- [S0154] Cobalt Strike: [Cobalt Strike](https://attack.mitre.org/software/S0154) can identify targets by querying account groups on a domain contoller.(Citation: Cobalt Strike Manual 4.3 November 2020)
- [G0046] FIN7: [FIN7](https://attack.mitre.org/groups/G0046) has used the command `net group "domain admins" /domain` to enumerate domain groups.(Citation: Mandiant FIN7 Apr 2022)
- [S0184] POWRUNER: [POWRUNER](https://attack.mitre.org/software/S0184) may collect domain group information by running <code>net group /domain</code> or a series of other commands on a victim.(Citation: FireEye APT34 Dec 2017)
- [C0015] C0015: During [C0015](https://attack.mitre.org/campaigns/C0015), the threat actors use the command `net group "domain admins" /dom` to enumerate domain groups.(Citation: DFIR Conti Bazar Nov 2021)
- [S1068] BlackCat: [BlackCat](https://attack.mitre.org/software/S1068) can determine if a user on a compromised host has domain admin privileges.(Citation: Microsoft BlackCat Jun 2022)
- [S1063] Brute Ratel C4: [Brute Ratel C4](https://attack.mitre.org/software/S1063) can use `net group` for discovery on targeted domains.(Citation: Trend Micro Black Basta October 2022)
- [S0516] SoreFang: [SoreFang](https://attack.mitre.org/software/S0516) can enumerate domain groups by executing <code>net.exe group /domain</code>.(Citation: CISA SoreFang July 2016)
- [S0165] OSInfo: [OSInfo](https://attack.mitre.org/software/S0165) specifically looks for Domain Admins and power users within the domain.(Citation: Symantec Buckeye)
- [S0514] WellMess: [WellMess](https://attack.mitre.org/software/S0514) can identify domain group membership for the current user.(Citation: CISA WellMess July 2020)
- [S0554] Egregor: [Egregor](https://attack.mitre.org/software/S0554) can conduct Active Directory reconnaissance using tools such as Sharphound or [AdFind](https://attack.mitre.org/software/S0552).(Citation: Intrinsec Egregor Nov 2020)
- [G1032] INC Ransom: [INC Ransom](https://attack.mitre.org/groups/G1032) has enumerated domain groups on targeted hosts.(Citation: Huntress INC Ransom Group August 2023)
- [S1081] BADHATCH: [BADHATCH](https://attack.mitre.org/software/S1081) can use `net.exe group "domain admins" /domain` to identify Domain Administrators.(Citation: BitDefender BADHATCH Mar 2021)
- [G0004] Ke3chang: [Ke3chang](https://attack.mitre.org/groups/G0004) performs discovery of permission groups <code>net group /domain</code>.(Citation: Mandiant Operation Ke3chang November 2014)
- [G0010] Turla: [Turla](https://attack.mitre.org/groups/G0010) has used <code>net group "Domain Admins" /domain</code> to identify domain administrators.(Citation: ESET ComRAT May 2020)
- [G0100] Inception: [Inception](https://attack.mitre.org/groups/G0100) has used specific malware modules to gather domain membership.(Citation: Symantec Inception Framework March 2018)
- [G0035] Dragonfly: [Dragonfly](https://attack.mitre.org/groups/G0035) has used batch scripts to enumerate administrators and users in the domain.(Citation: US-CERT TA18-074A)
- [S0170] Helminth: [Helminth](https://attack.mitre.org/software/S0170) has checked for the domain admin group and Exchange Trusted Subsystem groups using the commands <code>net group Exchange Trusted Subsystem /domain</code> and <code>net group domain admins /domain</code>.(Citation: Unit 42 Playbook Dec 2017)
- [S1160] Latrodectus: [Latrodectus](https://attack.mitre.org/software/S1160) can identify domain groups through `cmd.exe /c net group "Domain Admins" /domain`.(Citation: Bitsight Latrodectus June 2024)(Citation: Elastic Latrodectus May 2024)
- [S0488] CrackMapExec: [CrackMapExec](https://attack.mitre.org/software/S0488) can gather the user accounts within domain groups.(Citation: CME Github September 2018)
- [S0496] REvil: [REvil](https://attack.mitre.org/software/S0496) can identify the domain membership of a compromised host.(Citation: Kaspersky Sodin July 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: Secureworks REvil September 2019)
- [S0105] dsquery: [dsquery](https://attack.mitre.org/software/S0105) can be used to gather information on permission groups within a domain.(Citation: TechNet Dsquery)(Citation: Mandiant APT41)

#### T1069.003 - Cloud Groups

Description:

Adversaries may attempt to find cloud groups and permission settings. The knowledge of cloud permission groups can help adversaries determine the particular roles of users and groups within an environment, as well as which users are associated with a particular group.

With authenticated access there are several tools that can be used to find permissions groups. The <code>Get-MsolRole</code> PowerShell cmdlet can be used to obtain roles and permissions groups for Exchange and Office 365 accounts (Citation: Microsoft Msolrole)(Citation: GitHub Raindance).

Azure CLI (AZ CLI) and the Google Cloud Identity Provider API also provide interfaces to obtain permissions groups. The command <code>az ad user get-member-groups</code> will list groups associated to a user account for Azure while the API endpoint <code>GET https://cloudidentity.googleapis.com/v1/groups</code> lists group resources available to a user for Google.(Citation: Microsoft AZ CLI)(Citation: Black Hills Red Teaming MS AD Azure, 2018)(Citation: Google Cloud Identity API Documentation) In AWS, the commands `ListRolePolicies` and `ListAttachedRolePolicies` allow users to enumerate the policies attached to a role.(Citation: Palo Alto Unit 42 Compromised Cloud Compute Credentials 2022)

Adversaries may attempt to list ACLs for objects to determine the owner and other accounts with access to the object, for example, via the AWS <code>GetBucketAcl</code> API (Citation: AWS Get Bucket ACL). Using this information an adversary can target accounts with permissions to a given object or leverage accounts they have already compromised to access the object.

Procedures:

- [C0027] C0027: During [C0027](https://attack.mitre.org/campaigns/C0027), [Scattered Spider](https://attack.mitre.org/groups/G1015) accessed Azure AD to download bulk lists of group members and their Active Directory attributes.(Citation: Crowdstrike TELCO BPO Campaign December 2022)
- [S0684] ROADTools: [ROADTools](https://attack.mitre.org/software/S0684) can enumerate Azure AD groups.(Citation: Roadtools)
- [S0677] AADInternals: [AADInternals](https://attack.mitre.org/software/S0677) can enumerate Azure AD groups.(Citation: AADInternals Documentation)
- [S1091] Pacu: [Pacu](https://attack.mitre.org/software/S1091) can enumerate IAM permissions.(Citation: GitHub Pacu)


### T1082 - System Information Discovery

Description:

An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from [System Information Discovery](https://attack.mitre.org/techniques/T1082) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Tools such as [Systeminfo](https://attack.mitre.org/software/S0096) can be used to gather detailed system information. If running with privileged access, a breakdown of system data can be gathered through the <code>systemsetup</code> configuration tool on macOS. As an example, adversaries with user-level access can execute the <code>df -aH</code> command to obtain currently mounted disks and associated freely available space. Adversaries may also leverage a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) on network devices to gather detailed system information (e.g. <code>show version</code>).(Citation: US-CERT-TA18-106A) On ESXi servers, threat actors may gather system information from various esxcli utilities, such as `system hostname get`, `system version get`, and `storage filesystem list` (to list storage volumes).(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021)(Citation: Varonis)

Infrastructure as a Service (IaaS) cloud providers such as AWS, GCP, and Azure allow access to instance and virtual machine information via APIs. Successful authenticated API calls can return data such as the operating system platform and status of a particular instance or the model view of a virtual machine.(Citation: Amazon Describe Instance)(Citation: Google Instances Resource)(Citation: Microsoft Virutal Machine API)

[System Information Discovery](https://attack.mitre.org/techniques/T1082) combined with information gathered from other forms of discovery and reconnaissance can drive payload development and concealment.(Citation: OSX.FairyTale)(Citation: 20 macOS Common Tools and Techniques)

Procedures:

- [S0339] Micropsia: [Micropsia](https://attack.mitre.org/software/S0339) gathers the hostname and OS version from the victim’s machine.(Citation: Talos Micropsia June 2017)(Citation: Radware Micropsia July 2018)
- [S0385] njRAT: [njRAT](https://attack.mitre.org/software/S0385) enumerates the victim operating system and computer name during the initial infection.(Citation: Fidelis njRAT June 2013)
- [S1111] DarkGate: [DarkGate](https://attack.mitre.org/software/S1111) uses the Delphi methods <code>Sysutils::DiskSize</code> and <code>GlobalMemoryStatusEx</code> to collect disk size and physical memory as part of the malware's anti-analysis checks for running in a virtualized environment.(Citation: Ensilo Darkgate 2018) [DarkGate](https://attack.mitre.org/software/S1111) will gather various system information such as domain, display adapter description, operating system type and version, processor type, and RAM amount.(Citation: Ensilo Darkgate 2018)(Citation: Rapid7 BlackBasta 2024)
- [S0266] TrickBot: [TrickBot](https://attack.mitre.org/software/S0266) gathers the OS version, machine name, CPU type, amount of RAM available, and UEFI/BIOS firmware information from the victim’s machine.(Citation: S2 Grupo TrickBot June 2017)(Citation: Fidelis TrickBot Oct 2016)(Citation: Cyberreason Anchor December 2019)(Citation: Eclypsium Trickboot December 2020)
- [S0553] MoleNet: [MoleNet](https://attack.mitre.org/software/S0553) can collect information about the about the system.(Citation: Cybereason Molerats Dec 2020)
- [S0388] YAHOYAH: [YAHOYAH](https://attack.mitre.org/software/S0388) checks for the system’s Windows OS version and hostname.(Citation: TrendMicro TropicTrooper 2015)
- [S0464] SYSCON: [SYSCON](https://attack.mitre.org/software/S0464) has the ability to use [Systeminfo](https://attack.mitre.org/software/S0096) to identify system information.(Citation: Unit 42 CARROTBAT January 2020)
- [S0130] Unknown Logger: [Unknown Logger](https://attack.mitre.org/software/S0130) can obtain information about the victim computer name, physical memory, country, and date.(Citation: Forcepoint Monsoon)
- [S1151] ZeroCleare: [ZeroCleare](https://attack.mitre.org/software/S1151) can use the `IOCTL_DISK_GET_DRIVE_GEOMETRY_EX`, `IOCTL_DISK_GET_DRIVE_GEOMETRY`, and `IOCTL_DISK_GET_LENGTH_INFO` system calls to compute disk size.(Citation: Mandiant ROADSWEEP August 2022)
- [S1039] Bumblebee: [Bumblebee](https://attack.mitre.org/software/S1039) can enumerate the OS version and domain on a targeted system.(Citation: Google EXOTIC LILY March 2022)(Citation: Proofpoint Bumblebee April 2022)(Citation: Symantec Bumblebee June 2022)
- [S0237] GravityRAT: [GravityRAT](https://attack.mitre.org/software/S0237) collects the MAC address, computer name, and CPU information.(Citation: Talos GravityRAT)
- [S0211] Linfo: [Linfo](https://attack.mitre.org/software/S0211) creates a backdoor through which remote attackers can retrieve system information.(Citation: Symantec Linfo May 2012)
- [S0250] Koadic: [Koadic](https://attack.mitre.org/software/S0250) can obtain the OS version and build, computer name, and processor architecture from a compromised host.(Citation: MalwareBytes LazyScripter Feb 2021)
- [S0634] EnvyScout: [EnvyScout](https://attack.mitre.org/software/S0634) can determine whether the ISO payload was received by a Windows or iOS device.(Citation: MSTIC Nobelium Toolset May 2021)
- [S0674] CharmPower: [CharmPower](https://attack.mitre.org/software/S0674) can enumerate the OS version and computer name on a targeted system.(Citation: Check Point APT35 CharmPower January 2022)
- [S0625] Cuba: [Cuba](https://attack.mitre.org/software/S0625) can enumerate local drives, disk type, and disk free space.(Citation: McAfee Cuba April 2021)
- [S0603] Stuxnet: [Stuxnet](https://attack.mitre.org/software/S0603) collects system information including computer and domain names, OS version, and S7P paths.(Citation: Nicolas Falliere, Liam O Murchu, Eric Chien February 2011)
- [G0124] Windigo: [Windigo](https://attack.mitre.org/groups/G0124) has used a script to detect which Linux distribution and version is currently installed on the system.(Citation: ESET ForSSHe December 2018)
- [S0254] PLAINTEE: [PLAINTEE](https://attack.mitre.org/software/S0254) collects general system enumeration data about the infected machine and checks the OS version.(Citation: Rancor Unit42 June 2018)
- [S0045] ADVSTORESHELL: [ADVSTORESHELL](https://attack.mitre.org/software/S0045) can run [Systeminfo](https://attack.mitre.org/software/S0096) to gather information about the victim.(Citation: ESET Sednit Part 2)(Citation: Bitdefender APT28 Dec 2015)
- [G1043] BlackByte: [BlackByte](https://attack.mitre.org/groups/G1043) used various system commands and tools to pull system information during operations.(Citation: FBI BlackByte 2022)(Citation: Symantec BlackByte 2022)(Citation: Microsoft BlackByte 2023)
- [S0374] SpeakUp: [SpeakUp](https://attack.mitre.org/software/S0374) uses the <code>cat /proc/cpuinfo | grep -c “cpu family” 2>&1</code> command to gather system information. (Citation: CheckPoint SpeakUp Feb 2019)
- [S0462] CARROTBAT: [CARROTBAT](https://attack.mitre.org/software/S0462) has the ability to determine the operating system of the compromised host and whether Windows is being run with x86 or x64 architecture.(Citation: Unit 42 CARROTBAT November 2018)(Citation: Unit 42 CARROTBAT January 2020)
- [S0678] Torisma: [Torisma](https://attack.mitre.org/software/S0678) can use `GetlogicalDrives` to get a bitmask of all drives available on a compromised system. It can also use `GetDriveType` to determine if a new drive is a CD-ROM drive.(Citation: McAfee Lazarus Nov 2020)
- [S0387] KeyBoy: [KeyBoy](https://attack.mitre.org/software/S0387) can gather extended system information, such as information about the operating system, disks, and memory.(Citation: PWC KeyBoys Feb 2017)(Citation: Rapid7 KeyBoy Jun 2013)
- [G0049] OilRig: [OilRig](https://attack.mitre.org/groups/G0049) has run <code>hostname</code> and <code>systeminfo</code> on a victim.(Citation: Palo Alto OilRig May 2016)(Citation: Palo Alto OilRig Oct 2016)(Citation: FireEye APT34 July 2019)(Citation: Check Point APT34 April 2021)(Citation: Symantec Crambus OCT 2023)
- [S0449] Maze: [Maze](https://attack.mitre.org/software/S0449) has checked the language of the infected system using the "GetUSerDefaultUILanguage" function.(Citation: McAfee Maze March 2020)
- [S0433] Rifdoor: [Rifdoor](https://attack.mitre.org/software/S0433) has the ability to identify the Windows version on the compromised host.(Citation: Carbon Black HotCroissant April 2020)
- [S1129] Akira: [Akira](https://attack.mitre.org/software/S1129) uses the <code>GetSystemInfo</code> Windows function to determine the number of processors on a victim machine.(Citation: Kersten Akira 2023)
- [S0381] FlawedAmmyy: [FlawedAmmyy](https://attack.mitre.org/software/S0381) can collect the victim's operating system and computer name during the initial infection.(Citation: Proofpoint TA505 Mar 2018)
- [G0128] ZIRCONIUM: [ZIRCONIUM](https://attack.mitre.org/groups/G0128) has used a tool to capture the processor architecture of a compromised host in order to register it with C2.(Citation: Zscaler APT31 Covid-19 October 2020)
- [S1070] Black Basta: [Black Basta](https://attack.mitre.org/software/S1070) can enumerate volumes and collect system boot configuration and CPU information.(Citation: Minerva Labs Black Basta May 2022)(Citation: Cyble Black Basta May 2022)
- [S1141] LunarWeb: [LunarWeb](https://attack.mitre.org/software/S1141) can use WMI queries and shell commands such as systeminfo.exe to collect the operating system, BIOS version, and domain name of the targeted system.(Citation: ESET Turla Lunar toolset May 2024)
- [S0252] Brave Prince: [Brave Prince](https://attack.mitre.org/software/S0252) collects hard drive content and system configuration information.(Citation: McAfee Gold Dragon)
- [S1030] Squirrelwaffle: [Squirrelwaffle](https://attack.mitre.org/software/S1030) has gathered victim computer information and configurations.(Citation: ZScaler Squirrelwaffle Sep 2021)
- [G0096] APT41: [APT41](https://attack.mitre.org/groups/G0096) uses multiple built-in commands such as <code>systeminfo</code> and `net config Workstation` to enumerate victim system basic configuration information.(Citation: Rostovcev APT41 2021)
- [S1156] Manjusaka: [Manjusaka](https://attack.mitre.org/software/S1156) performs basic system profiling actions to fingerprint and register the victim system with the C2 controller.(Citation: Talos Manjusaka 2022)
- [S0284] More_eggs: [More_eggs](https://attack.mitre.org/software/S0284) has the capability to gather the OS version and computer name.(Citation: Talos Cobalt Group July 2018)(Citation: Security Intelligence More Eggs Aug 2019)
- [S1130] Raspberry Robin: [Raspberry Robin](https://attack.mitre.org/software/S1130) performs several system checks as part of anti-analysis mechanisms, including querying the operating system build number, processor vendor and type, video controller, and CPU temperature.(Citation: HP RaspberryRobin 2024)
- [C0017] C0017: During [C0017](https://attack.mitre.org/campaigns/C0017), [APT41](https://attack.mitre.org/groups/G0096) issued `ping -n 1 ((cmd /c dir c:\|findstr Number).split()[-1]+` commands to find the volume serial number of compromised systems.(Citation: Mandiant APT41)
- [S0564] BlackMould: [BlackMould](https://attack.mitre.org/software/S0564) can enumerate local drives on a compromised host.(Citation: Microsoft GALLIUM December 2019)
- [S0520] BLINDINGCAN: [BLINDINGCAN](https://attack.mitre.org/software/S0520) has collected from a victim machine the system name, processor information, OS version, and disk information, including type and free space available.(Citation: US-CERT BLINDINGCAN Aug 2020)
- [S1037] STARWHALE: [STARWHALE](https://attack.mitre.org/software/S1037) can gather the computer name of an infected host.(Citation: Mandiant UNC3313 Feb 2022)(Citation: DHS CISA AA22-055A MuddyWater February 2022)
- [S0218] SLOWDRIFT: [SLOWDRIFT](https://attack.mitre.org/software/S0218) collects and sends system information to its C2.(Citation: FireEye APT37 Feb 2018)
- [S1085] Sardonic: [Sardonic](https://attack.mitre.org/software/S1085) has the ability to collect the computer name, CPU manufacturer name, and C:\ drive serial number from a compromised machine. [Sardonic](https://attack.mitre.org/software/S1085) also has the ability to execute the `ver` and `systeminfo` commands.(Citation: Bitdefender Sardonic Aug 2021)
- [S0482] Bundlore: [Bundlore](https://attack.mitre.org/software/S0482) will enumerate the macOS version to determine which follow-on behaviors to execute using <code>/usr/bin/sw_vers -productVersion</code>.(Citation: MacKeeper Bundlore Apr 2019)(Citation: 20 macOS Common Tools and Techniques)
- [S0513] LiteDuke: [LiteDuke](https://attack.mitre.org/software/S0513) can enumerate the CPUID and BIOS version on a compromised system.(Citation: ESET Dukes October 2019)
- [S0081] Elise: [Elise](https://attack.mitre.org/software/S0081) executes <code>systeminfo</code> after initial communication is made to the remote server.(Citation: Lotus Blossom Jun 2015)
- [S0559] SUNBURST: [SUNBURST](https://attack.mitre.org/software/S0559) collected hostname and OS version.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: Microsoft Analyzing Solorigate Dec 2020)
- [S0493] GoldenSpy: [GoldenSpy](https://attack.mitre.org/software/S0493) has gathered operating system information.(Citation: Trustwave GoldenSpy June 2020)
- [S0472] down_new: [down_new](https://attack.mitre.org/software/S0472) has the ability to identify the system volume information of a compromised host.(Citation: Trend Micro Tick November 2019)
- [S1016] MacMa: [MacMa](https://attack.mitre.org/software/S1016) can collect information about a compromised computer, including: Hardware UUID, Mac serial number, macOS version, and disk sizes.(Citation: ESET DazzleSpy Jan 2022)
- [S0046] CozyCar: A system info module in [CozyCar](https://attack.mitre.org/software/S0046) gathers information on the victim host’s configuration.(Citation: F-Secure CozyDuke)
- [S0031] BACKSPACE: During its initial execution, [BACKSPACE](https://attack.mitre.org/software/S0031) extracts operating system information from the infected host.(Citation: FireEye APT30)
- [S1013] ZxxZ: [ZxxZ](https://attack.mitre.org/software/S1013) has collected the host name and operating system product name from a compromised machine.(Citation: Cisco Talos Bitter Bangladesh May 2022)
- [S0356] KONNI: [KONNI](https://attack.mitre.org/software/S0356) can gather the OS version, architecture information, connected drives, hostname, RAM size, and disk space information from the victim’s machine and has used <code>cmd /c systeminfo</code> command to get a snapshot of the current system state of the target machine.(Citation: Talos Konni May 2017)(Citation: Medium KONNI Jan 2020)(Citation: Malwarebytes Konni Aug 2021)
- [S0441] PowerShower: [PowerShower](https://attack.mitre.org/software/S0441) has collected system information on the infected host.(Citation: Unit 42 Inception November 2018)
- [S0467] TajMahal: [TajMahal](https://attack.mitre.org/software/S0467) has the ability to identify hardware information, the computer name, and OS information on an infected host.(Citation: Kaspersky TajMahal April 2019)
- [C0001] Frankenstein: During [Frankenstein](https://attack.mitre.org/campaigns/C0001), the threat actors used [Empire](https://attack.mitre.org/software/S0363) to obtain the compromised machine's name.(Citation: Talos Frankenstein June 2019)
- [S1124] SocGholish: [SocGholish](https://attack.mitre.org/software/S1124) has the ability to enumerate system information including the victim computer name.(Citation: SocGholish-update)(Citation: Red Canary SocGholish March 2024)(Citation: Secureworks Gold Prelude Profile)
- [S1178] ShrinkLocker: [ShrinkLocker](https://attack.mitre.org/software/S1178) uses WMI queries to gather various information about the victim machine and operating system.(Citation: Kaspersky ShrinkLocker 2024)(Citation: Splunk ShrinkLocker 2024)
- [S0567] Dtrack: [Dtrack](https://attack.mitre.org/software/S0567) can collect the victim's computer name, hostname and adapter information to create a unique identifier.(Citation: Securelist Dtrack)(Citation: CyberBit Dtrack)
- [G0108] Blue Mockingbird: [Blue Mockingbird](https://attack.mitre.org/groups/G0108) has collected hardware details for the victim's system, including CPU and memory information.(Citation: RedCanary Mockingbird May 2020)
- [S0457] Netwalker: [Netwalker](https://attack.mitre.org/software/S0457) can determine the system architecture it is running on to choose which version of the DLL to use.(Citation: TrendMicro Netwalker May 2020)
- [S0657] BLUELIGHT: [BLUELIGHT](https://attack.mitre.org/software/S0657) has collected the computer name and OS version from victim machines.(Citation: Volexity InkySquid BLUELIGHT August 2021)
- [S1015] Milan: [Milan](https://attack.mitre.org/software/S1015) can enumerate the targeted machine's name and GUID.(Citation: ClearSky Siamesekitten August 2021)(Citation: Accenture Lyceum Targets November 2021)
- [G1001] HEXANE: [HEXANE](https://attack.mitre.org/groups/G1001) has collected the hostname of a compromised machine.(Citation: Kaspersky Lyceum October 2021)
- [S0139] PowerDuke: [PowerDuke](https://attack.mitre.org/software/S0139) has commands to get information about the victim's name, build, version, serial number, and memory usage.(Citation: Volexity PowerDuke November 2016)
- [C0012] Operation CuckooBees: During [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), the threat actors used the `systeminfo` command to gather details about a compromised system.(Citation: Cybereason OperationCuckooBees May 2022)
- [S0412] ZxShell: [ZxShell](https://attack.mitre.org/software/S0412) can collect the local hostname, operating system details, CPU speed, and total physical memory.(Citation: Talos ZxShell Oct 2014)
- [S1073] Royal: [Royal](https://attack.mitre.org/software/S1073) can use `GetNativeSystemInfo` and `GetLogicalDrives` to enumerate system processors and logical drives.(Citation: Cybereason Royal December 2022)(Citation: Trend Micro Royal Linux ESXi February 2023)
- [S1019] Shark: [Shark](https://attack.mitre.org/software/S1019) can collect the GUID of a targeted machine.(Citation: ClearSky Siamesekitten August 2021)(Citation: Accenture Lyceum Targets November 2021)
- [S0630] Nebulae: [Nebulae](https://attack.mitre.org/software/S0630) can discover logical drive information including the drive type, free space, and volume information.(Citation: Bitdefender Naikon April 2021)
- [S0607] KillDisk: [KillDisk](https://attack.mitre.org/software/S0607) retrieves the hard disk name by calling the <code>CreateFileA to \\.\PHYSICALDRIVE0</code> API.(Citation: Trend Micro KillDisk 1)
- [S0233] MURKYTOP: [MURKYTOP](https://attack.mitre.org/software/S0233) has the capability to retrieve information about the OS.(Citation: FireEye Periscope March 2018)
- [S0504] Anchor: [Anchor](https://attack.mitre.org/software/S0504) can determine the hostname and linux version on a compromised host.(Citation: Medium Anchor DNS July 2020)
- [S0229] Orz: [Orz](https://attack.mitre.org/software/S0229) can gather the victim OS version and whether it is 64 or 32 bit.(Citation: Proofpoint Leviathan Oct 2017)
- [S0501] PipeMon: [PipeMon](https://attack.mitre.org/software/S0501) can collect and send OS version and computer name as a part of its C2 beacon.(Citation: ESET PipeMon May 2020)
- [S0140] Shamoon: [Shamoon](https://attack.mitre.org/software/S0140) obtains the victim's operating system version and keyboard layout and sends the information to the C2 server.(Citation: Palo Alto Shamoon Nov 2016)(Citation: Unit 42 Shamoon3 2018)
- [S0065] 4H RAT: [4H RAT](https://attack.mitre.org/software/S0065) sends an OS version identifier in its beacons.(Citation: CrowdStrike Putter Panda)
- [S0354] Denis: [Denis](https://attack.mitre.org/software/S0354) collects OS information and the computer name from the victim’s machine.(Citation: Securelist Denis April 2017)(Citation: Cybereason Cobalt Kitty 2017)
- [S0373] Astaroth: [Astaroth](https://attack.mitre.org/software/S0373) collects the machine name and keyboard language from the system. (Citation: Cofense Astaroth Sept 2018)(Citation: Cybereason Astaroth Feb 2019)
- [S1020] Kevin: [Kevin](https://attack.mitre.org/software/S1020) can enumerate the OS version and hostname of a targeted machine.(Citation: Kaspersky Lyceum October 2021)
- [S1172] OilBooster: [OilBooster](https://attack.mitre.org/software/S1172) can identify the compromised system's hostname which is used to create a unique identifier.(Citation: ESET OilRig Downloaders DEC 2023)
- [G0012] Darkhotel: [Darkhotel](https://attack.mitre.org/groups/G0012) has collected the hostname, OS version, service pack version, and the processor architecture from the victim’s machine.(Citation: Securelist Darkhotel Aug 2015)(Citation: Microsoft DUBNIUM July 2016)
- [S1081] BADHATCH: [BADHATCH](https://attack.mitre.org/software/S1081) can obtain current system information from a compromised machine such as the `SHELL PID`, `PSVERSION`, `HOSTNAME`, `LOGONSERVER`, `LASTBOOTUP`, drive information, OS type/version, bitness, and hostname.(Citation: Gigamon BADHATCH Jul 2019)(Citation: BitDefender BADHATCH Mar 2021)
- [S1190] Kapeka: [Kapeka](https://attack.mitre.org/software/S1190) utilizes WinAPI calls and registry queries to gather system information.(Citation: WithSecure Kapeka 2024)
- [S0059] WinMM: [WinMM](https://attack.mitre.org/software/S0059) collects the system name, OS version including service pack, and system install date and sends the information to the C2 server.(Citation: Baumgartner Naikon 2015)
- [S1052] DEADEYE: [DEADEYE](https://attack.mitre.org/software/S1052) can enumerate a victim computer's volume serial number and host name.(Citation: Mandiant APT41)
- [G1018] TA2541: [TA2541](https://attack.mitre.org/groups/G1018) has collected system information prior to downloading malware on the targeted host.(Citation: Proofpoint TA2541 February 2022)
- [S1065] Woody RAT: [Woody RAT](https://attack.mitre.org/software/S1065) can retrieve the following information from an infected machine: OS, architecture, computer name, OS build version, environment variables, and storage drives.(Citation: MalwareBytes WoodyRAT Aug 2022)
- [S0051] MiniDuke: [MiniDuke](https://attack.mitre.org/software/S0051) can gather the hostname on a compromised machine.(Citation: ESET Dukes October 2019)
- [G1016] FIN13: [FIN13](https://attack.mitre.org/groups/G1016) has collected local host information by utilizing Windows commands `systeminfo`, `fsutil`, and `fsinfo`. [FIN13](https://attack.mitre.org/groups/G1016) has also utilized a compromised Symantex Altiris console and LanDesk account to retrieve host information.(Citation: Mandiant FIN13 Aug 2022)(Citation: Sygnia Elephant Beetle Jan 2022)
- [S0086] ZLib: [ZLib](https://attack.mitre.org/software/S0086) has the ability to enumerate system information.(Citation: Cylance Dust Storm)
- [G0106] Rocke: [Rocke](https://attack.mitre.org/groups/G0106) has used uname -m to collect the name and information about the infected system's kernel.(Citation: Anomali Rocke March 2019)
- [S0259] InnaputRAT: [InnaputRAT](https://attack.mitre.org/software/S0259) gathers volume drive information and system information.(Citation: ASERT InnaputRAT April 2018)
- [S0486] Bonadan: [Bonadan](https://attack.mitre.org/software/S0486) has discovered the OS version, CPU model, and RAM size of the system it has been installed on.(Citation: ESET ForSSHe December 2018)
- [S0687] Cyclops Blink: [Cyclops Blink](https://attack.mitre.org/software/S0687) has the ability to query device information.(Citation: NCSC Cyclops Blink February 2022)
- [S0180] Volgmer: [Volgmer](https://attack.mitre.org/software/S0180) can gather system information, the computer name, OS version, drive and serial information from the victim's machine.(Citation: US-CERT Volgmer Nov 2017)(Citation: US-CERT Volgmer 2 Nov 2017)(Citation: Symantec Volgmer Aug 2014)
- [G0047] Gamaredon Group: A [Gamaredon Group](https://attack.mitre.org/groups/G0047) file stealer can gather the victim's computer name and drive serial numbers to send to a C2 server.(Citation: Palo Alto Gamaredon Feb 2017)(Citation: TrendMicro Gamaredon April 2020)(Citation: CERT-EE Gamaredon January 2021)
- [S0670] WarzoneRAT: [WarzoneRAT](https://attack.mitre.org/software/S0670) can collect compromised host information, including OS version, PC name, RAM size, and CPU details.(Citation: Check Point Warzone Feb 2020)
- [S0186] DownPaper: [DownPaper](https://attack.mitre.org/software/S0186) collects the victim host name and serial number, and then sends the information to the C2 server.(Citation: ClearSky Charming Kitten Dec 2017)
- [S0363] Empire: [Empire](https://attack.mitre.org/software/S0363) can enumerate host system information like OS, architecture, domain name, applied patches, and more.(Citation: Github PowerShell Empire)(Citation: Talos Frankenstein June 2019)
- [S1068] BlackCat: [BlackCat](https://attack.mitre.org/software/S1068) can obtain the computer name and UUID, and enumerate local drives.(Citation: Microsoft BlackCat Jun 2022)
- [C0049] Leviathan Australian Intrusions: [Leviathan](https://attack.mitre.org/groups/G0065) performed host enumeration and data gathering operations on victim machines during [Leviathan Australian Intrusions](https://attack.mitre.org/campaigns/C0049).(Citation: CISA Leviathan 2024)
- [S0391] HAWKBALL: [HAWKBALL](https://attack.mitre.org/software/S0391) can collect the OS version, architecture information, and computer name.(Citation: FireEye HAWKBALL Jun 2019)
- [S0242] SynAck: [SynAck](https://attack.mitre.org/software/S0242) gathers computer names, OS version info, and also checks installed keyboard layouts to estimate if it has been launched from a certain list of countries.(Citation: SecureList SynAck Doppelgänging May 2018)
- [G0067] APT37: [APT37](https://attack.mitre.org/groups/G0067) collects the computer name, the BIOS model, and execution path.(Citation: Talos Group123)
- [S0568] EVILNUM: [EVILNUM](https://attack.mitre.org/software/S0568) can obtain the computer name from the victim's system.(Citation: Prevailion EvilNum May 2020)
- [S0217] SHUTTERSPEED: [SHUTTERSPEED](https://attack.mitre.org/software/S0217) can collect system information.(Citation: FireEye APT37 Feb 2018)
- [S0156] KOMPROGO: [KOMPROGO](https://attack.mitre.org/software/S0156) is capable of retrieving information about the infected system.(Citation: FireEye APT32 May 2017)
- [G0050] APT32: [APT32](https://attack.mitre.org/groups/G0050) has collected the OS version and computer name from victims. One of the group's backdoors can also query the Windows Registry to gather system information, and another macOS backdoor performs a fingerprint of the machine on its first connection to the C&C server. [APT32](https://attack.mitre.org/groups/G0050) executed shellcode to identify the name of the infected host.(Citation: ESET OceanLotus)(Citation: ESET OceanLotus Mar 2019)(Citation: ESET OceanLotus macOS April 2019)(Citation: FireEye APT32 April 2020)
- [S1087] AsyncRAT: [AsyncRAT](https://attack.mitre.org/software/S1087) can check the disk size through the values obtained with `DeviceInfo.`(Citation: Telefonica Snip3 December 2021)
- [S0646] SpicyOmelette: [SpicyOmelette](https://attack.mitre.org/software/S0646) can identify the system name of a compromised host.(Citation: Secureworks GOLD KINGSWOOD September 2018)
- [S0280] MirageFox: [MirageFox](https://attack.mitre.org/software/S0280) can collect CPU and architecture information from the victim’s machine.(Citation: APT15 Intezer June 2018)
- [S0262] QuasarRAT: [QuasarRAT](https://attack.mitre.org/software/S0262) can gather system information from the victim’s machine including the OS type.(Citation: GitHub QuasarRAT)
- [S0098] T9000: [T9000](https://attack.mitre.org/software/S0098) gathers and beacons the operating system build number and CPU Architecture (32-bit/64-bit) during installation.(Citation: Palo Alto T9000 Feb 2016)
- [S1066] DarkTortilla: [DarkTortilla](https://attack.mitre.org/software/S1066) can obtain system information by querying the `Win32_ComputerSystem`, `Win32_BIOS`, `Win32_MotherboardDevice`, `Win32_PnPEntity`, and `Win32_DiskDrive` WMI objects.(Citation: Secureworks DarkTortilla Aug 2022)
- [S0690] Green Lambert: [Green Lambert](https://attack.mitre.org/software/S0690) can use `uname` to identify the operating system name, version, and processor type.(Citation: Objective See Green Lambert for OSX Oct 2021)(Citation: Glitch-Cat Green Lambert ATTCK Oct 2021)
- [S0088] Kasidet: [Kasidet](https://attack.mitre.org/software/S0088) has the ability to obtain a victim's system name and operating system version.(Citation: Zscaler Kasidet)
- [S1169] Mango: [Mango](https://attack.mitre.org/software/S1169) can collect the machine name of a compromised system which is later used as part of a unique victim identifier.(Citation: ESET OilRig Campaigns Sep 2023)
- [S0082] Emissary: [Emissary](https://attack.mitre.org/software/S0082) has the capability to execute ver and systeminfo commands.(Citation: Emissary Trojan Feb 2016)
- [S0649] SMOKEDHAM: [SMOKEDHAM](https://attack.mitre.org/software/S0649) has used the <code>systeminfo</code> command on a compromised host.(Citation: FireEye SMOKEDHAM June 2021)
- [G0100] Inception: [Inception](https://attack.mitre.org/groups/G0100) has used a reconnaissance module to gather information about the operating system and hardware on the infected host.(Citation: Symantec Inception Framework March 2018)
- [S0267] FELIXROOT: [FELIXROOT](https://attack.mitre.org/software/S0267) collects the victim’s computer name, processor architecture, OS version, volume serial number, and system type.(Citation: FireEye FELIXROOT July 2018)(Citation: ESET GreyEnergy Oct 2018)
- [S0203] Hydraq: [Hydraq](https://attack.mitre.org/software/S0203) creates a backdoor through which remote attackers can retrieve information such as computer name, OS version, processor speed, memory size, and CPU speed.(Citation: Symantec Hydraq Jan 2010)
- [S0115] Crimson: [Crimson](https://attack.mitre.org/software/S0115) contains a command to collect the victim PC name, disk drive information, and operating system.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022)
- [S1122] Mispadu: [Mispadu](https://attack.mitre.org/software/S1122) collects the OS version, computer name, and language ID.(Citation: ESET Security Mispadu Facebook Ads 2019)
- [S1031] PingPull: [PingPull](https://attack.mitre.org/software/S1031) can retrieve the hostname of a compromised host.(Citation: Unit 42 PingPull Jun 2022)
- [S0283] jRAT: [jRAT](https://attack.mitre.org/software/S0283) collects information about the OS (version, build type, install date) as well as system up-time upon receiving a connection from a backdoor.(Citation: Symantec Frutas Feb 2013)
- [S0223] POWERSTATS: [POWERSTATS](https://attack.mitre.org/software/S0223) can retrieve OS name/architecture and computer/domain name information from compromised hosts.(Citation: FireEye MuddyWater Mar 2018)(Citation: TrendMicro POWERSTATS V3 June 2019)
- [S1018] Saint Bot: [Saint Bot](https://attack.mitre.org/software/S1018) can identify the OS version, CPU, and other details from a victim's machine.(Citation: Malwarebytes Saint Bot April 2021)
- [G0032] Lazarus Group: Several [Lazarus Group](https://attack.mitre.org/groups/G0032) malware families collect information on the type and version of the victim OS, as well as the victim computer name and CPU information. A Destover-like variant used by [Lazarus Group](https://attack.mitre.org/groups/G0032) also collects disk space information and sends it to its C2 server.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: Novetta Blockbuster Loaders)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: McAfee GhostSecret)(Citation: Lazarus APT January 2022)
- [S0512] FatDuke: [FatDuke](https://attack.mitre.org/software/S0512) can collect the user name, Windows version, computer name, and available space on discs from a compromised host.(Citation: ESET Dukes October 2019)
- [C0047] RedDelta Modified PlugX Infection Chain Operations: [Mustang Panda](https://attack.mitre.org/groups/G0129) captured victim operating system type via User Agent analysis during [RedDelta Modified PlugX Infection Chain Operations](https://attack.mitre.org/campaigns/C0047).(Citation: Recorded Future RedDelta 2025)
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has discovered file system types, drive names, size, and free space on compromised systems.(Citation: Microsoft Volt Typhoon May 2023)(Citation: Joint Cybersecurity Advisory Volt Typhoon June 2023)(Citation: Secureworks BRONZE SILHOUETTE May 2023)(Citation: CISA AA24-038A PRC Critical Infrastructure February 2024)
- [S0337] BadPatch: [BadPatch](https://attack.mitre.org/software/S0337) collects the OS system, OS version, MAC address, and the computer name from the victim’s machine.(Citation: Unit 42 BadPatch Oct 2017)
- [S0667] Chrommme: [Chrommme](https://attack.mitre.org/software/S0667) has the ability to list drives and obtain the computer name of a compromised host.(Citation: ESET Gelsemium June 2021)
- [S0137] CORESHELL: [CORESHELL](https://attack.mitre.org/software/S0137) collects hostname, volume serial number and OS version data from the victim and sends the information to its C2 server.(Citation: FireEye APT28)
- [G1009] Moses Staff: [Moses Staff](https://attack.mitre.org/groups/G1009) collected information about the infected host, including the machine names and OS architecture.(Citation: Checkpoint MosesStaff Nov 2021)
- [S0665] ThreatNeedle: [ThreatNeedle](https://attack.mitre.org/software/S0665) can collect system profile information from a compromised host.(Citation: Kaspersky ThreatNeedle Feb 2021)
- [S0060] Sys10: [Sys10](https://attack.mitre.org/software/S0060) collects the computer name, OS versioning information, and OS install date and sends the information to the C2.(Citation: Baumgartner Naikon 2015)
- [S0239] Bankshot: [Bankshot](https://attack.mitre.org/software/S0239) gathers system information, network addresses, disk type, disk free space, and the operation system version.(Citation: McAfee Bankshot)(Citation: US-CERT Bankshot Dec 2017)
- [S0669] KOCTOPUS: [KOCTOPUS](https://attack.mitre.org/software/S0669) has checked the OS version using `wmic.exe` and the `find` command.(Citation: MalwareBytes LazyScripter Feb 2021)
- [S0271] KEYMARBLE: [KEYMARBLE](https://attack.mitre.org/software/S0271) has the capability to collect the computer name, language settings, the OS version, CPU information, disk devices, and time elapsed since system start.(Citation: US-CERT KEYMARBLE Aug 2018)
- [S0352] OSX_OCEANLOTUS.D: [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) collects processor information, memory information, computer name, hardware UUID, serial number, and operating system version. [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) has used the <code>ioreg</code> command to gather some of this information.(Citation: TrendMicro MacOS April 2018)(Citation: Trend Micro MacOS Backdoor November 2020)(Citation: 20 macOS Common Tools and Techniques)
- [S0496] REvil: [REvil](https://attack.mitre.org/software/S0496) can identify the username, machine name, system language, keyboard layout, OS version, and system drive information on a compromised host.(Citation: Kaspersky Sodin July 2019)(Citation: Cylance Sodinokibi July 2019)(Citation: Secureworks GandCrab and REvil September 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: Intel 471 REvil March 2020)(Citation: Group IB Ransomware May 2020)(Citation: Secureworks REvil September 2019)
- [S0378] PoshC2: [PoshC2](https://attack.mitre.org/software/S0378) contains modules, such as <code>Get-ComputerInfo</code>, for enumerating common system information.(Citation: GitHub PoshC2)
- [S0094] Trojan.Karagany: [Trojan.Karagany](https://attack.mitre.org/software/S0094) can capture information regarding the victim's OS, security, and hardware configuration.(Citation: Secureworks Karagany July 2019)
- [S0448] Rising Sun: [Rising Sun](https://attack.mitre.org/software/S0448) can detect the computer name, operating system, and drive information, including drive type, total number of bytes on disk, total number of free bytes on disk, and name of a specified volume.(Citation: McAfee Sharpshooter December 2018)
- [S0157] SOUNDBITE: [SOUNDBITE](https://attack.mitre.org/software/S0157) is capable of gathering system information.(Citation: FireEye APT32 May 2017)
- [S0021] Derusbi: [Derusbi](https://attack.mitre.org/software/S0021) gathers the name of the local host, version of GNU Compiler Collection (GCC), and the system information about the CPU, machine, and operating system.(Citation: Fidelis Turbo)
- [S0181] FALLCHILL: [FALLCHILL](https://attack.mitre.org/software/S0181) can collect operating system (OS) version information, processor information, system name, and information about installed disks from the victim.(Citation: US-CERT FALLCHILL Nov 2017)
- [S0514] WellMess: [WellMess](https://attack.mitre.org/software/S0514) can identify the computer name of a compromised host.(Citation: PWC WellMess July 2020)(Citation: CISA WellMess July 2020)
- [S0015] Ixeshe: [Ixeshe](https://attack.mitre.org/software/S0015) collects the computer name of the victim's system during the initial infection.(Citation: Trend Micro IXESHE 2012)
- [S0350] zwShell: [zwShell](https://attack.mitre.org/software/S0350) can obtain the victim PC name and OS version.(Citation: McAfee Night Dragon)
- [S0382] ServHelper: [ServHelper](https://attack.mitre.org/software/S0382) will attempt to enumerate Windows version and system architecture.(Citation: Proofpoint TA505 Jan 2019)
- [S0456] Aria-body: [Aria-body](https://attack.mitre.org/software/S0456) has the ability to identify the hostname, computer name, Windows version, processor speed, machine GUID, and disk information on a compromised host.(Citation: CheckPoint Naikon May 2020)
- [S0251] Zebrocy: [Zebrocy](https://attack.mitre.org/software/S0251) collects the OS version, computer name and serial number for the storage volume C:\. [Zebrocy](https://attack.mitre.org/software/S0251) also runs the <code>systeminfo</code> command to gather system information. (Citation: Palo Alto Sofacy 06-2018)(Citation: Unit42 Cannon Nov 2018)(Citation: ESET Zebrocy Nov 2018)(Citation: Unit42 Sofacy Dec 2018)(Citation: ESET Zebrocy May 2019)(Citation: Accenture SNAKEMACKEREL Nov 2018)(Citation: CISA Zebrocy Oct 2020)
- [S0334] DarkComet: [DarkComet](https://attack.mitre.org/software/S0334) can collect the computer name, RAM used, and operating system version from the victim’s machine.(Citation: TrendMicro DarkComet Sept 2014)(Citation: Malwarebytes DarkComet March 2018)
- [S0642] BADFLICK: [BADFLICK](https://attack.mitre.org/software/S0642) has captured victim computer name, memory space, and CPU details.(Citation: Accenture MUDCARP March 2019)
- [G0126] Higaisa: [Higaisa](https://attack.mitre.org/groups/G0126) collected the system volume serial number, GUID, and computer name.(Citation: PTSecurity Higaisa 2020)(Citation: Malwarebytes Higaisa 2020)
- [S1199] LockBit 2.0: [LockBit 2.0](https://attack.mitre.org/software/S1199) can enumerate system information including hostname, domain information, and local drive configuration.(Citation: FBI Lockbit 2.0 FEB 2022)(Citation: Palo Alto Lockbit 2.0 JUN 2022)
- [G1012] CURIUM: [CURIUM](https://attack.mitre.org/groups/G1012) deploys information gathering tools focused on capturing IP configuration, running application, system information, and network connectivity information.(Citation: Symantec Tortoiseshell 2019)
- [S0091] Epic: [Epic](https://attack.mitre.org/software/S0091) collects the OS version, hardware information, computer name, available system memory status, disk space information, and system and user language settings.(Citation: Kaspersky Turla Aug 2014)
- [S0417] GRIFFON: [GRIFFON](https://attack.mitre.org/software/S0417) has used a reconnaissance module that can be used to retrieve information about a victim's computer, including the resolution of the workstation .(Citation: SecureList Griffon May 2019)
- [S0379] Revenge RAT: [Revenge RAT](https://attack.mitre.org/software/S0379) collects the CPU information, OS information, and system language.(Citation: Cylance Shaheen Nov 2018)
- [S0214] HAPPYWORK: can collect system information, including computer name, system manufacturer, IsDebuggerPresent state, and execution path.(Citation: FireEye APT37 Feb 2018)
- [S1139] INC Ransomware: [INC Ransomware](https://attack.mitre.org/software/S1139) can discover and mount hidden drives to encrypt them.(Citation: Cybereason INC Ransomware November 2023)
- [S0531] Grandoreiro: [Grandoreiro](https://attack.mitre.org/software/S0531) can collect the computer name and OS version from a compromised host.(Citation: ESET Grandoreiro April 2020)
- [S1027] Heyoka Backdoor: [Heyoka Backdoor](https://attack.mitre.org/software/S1027) can enumerate drives on a compromised host.(Citation: SentinelOne Aoqin Dragon June 2022)
- [S0627] SodaMaster: [SodaMaster](https://attack.mitre.org/software/S0627) can enumerate the host name and OS version on a target system.(Citation: Securelist APT10 March 2021)
- [S1155] Covenant: [Covenant](https://attack.mitre.org/software/S1155) implants can gather basic information on infected systems.(Citation: Github Covenant)
- [S0017] BISCUIT: [BISCUIT](https://attack.mitre.org/software/S0017) has a command to collect the processor type, operation system, computer name, and whether the system is a laptop or PC.(Citation: Mandiant APT1)
- [S0264] OopsIE: [OopsIE](https://attack.mitre.org/software/S0264) checks for information on the CPU fan, temperature, mouse, hard disk, and motherboard as part of its anti-VM checks.(Citation: Unit 42 OilRig Sept 2018)
- [S0693] CaddyWiper: [CaddyWiper](https://attack.mitre.org/software/S0693) can use `DsRoleGetPrimaryDomainInformation` to determine the role of the infected machine. [CaddyWiper](https://attack.mitre.org/software/S0693) can also halt execution if the compromised host is identified as a domain controller.(Citation: Cisco CaddyWiper March 2022)(Citation: Malwarebytes IssacWiper CaddyWiper March 2022 )
- [G1026] Malteiro: [Malteiro](https://attack.mitre.org/groups/G1026) collects the machine information, system architecture, the OS version, computer name, and Windows product name.(Citation: SCILabs Malteiro 2021)
- [S1185] LightSpy: [LightSpy](https://attack.mitre.org/software/S1185)'s second stage implant uses the `DeviceInformation` class to collect system information, including CPU usage, battery statistics, memory allocations, screen size, etc.(Citation: Huntress LightSpy macOS 2024)
- [S1086] Snip3: [Snip3](https://attack.mitre.org/software/S1086) has the ability to query `Win32_ComputerSystem` for system information. (Citation: Morphisec Snip3 May 2021)
- [S0487] Kessel: [Kessel](https://attack.mitre.org/software/S0487) has collected the system architecture, OS version, and MAC address information.(Citation: ESET ForSSHe December 2018)
- [S1107] NKAbuse: [NKAbuse](https://attack.mitre.org/software/S1107) conducts multiple system checks and includes these in subsequent "heartbeat" messages to the malware's command and control server.(Citation: NKAbuse SL)
- [S0439] Okrum: [Okrum](https://attack.mitre.org/software/S0439) can collect computer name, locale information, and information about the OS and architecture.(Citation: ESET Okrum July 2019)
- [S1100] Ninja: [Ninja](https://attack.mitre.org/software/S1100) can obtain the computer name and information on the OS and physical drives from targeted hosts.(Citation: Kaspersky ToddyCat June 2022)(Citation: Kaspersky ToddyCat Check Logs October 2023)
- [S0468] Skidmap: [Skidmap](https://attack.mitre.org/software/S0468) has the ability to check whether the infected system’s OS is Debian or RHEL/CentOS to determine which cryptocurrency miner it should use.(Citation: Trend Micro Skidmap)
- [S0584] AppleJeus: [AppleJeus](https://attack.mitre.org/software/S0584) has collected the victim host information after infection.(Citation: CISA AppleJeus Feb 2021)
- [S0205] Naid: [Naid](https://attack.mitre.org/software/S0205) collects a unique identifier (UID) from a compromised host.(Citation: Symantec Naid June 2012)
- [S0395] LightNeuron: [LightNeuron](https://attack.mitre.org/software/S0395) gathers the victim computer name using the Win32 API call <code>GetComputerName</code>.(Citation: ESET LightNeuron May 2019)
- [S1145] Pikabot: [Pikabot](https://attack.mitre.org/software/S1145) performs a variety of system checks and gathers system information, including commands such as <code>whoami</code>.(Citation: Zscaler Pikabot 2023)(Citation: Elastic Pikabot 2024)
- [S1048] macOS.OSAMiner: [macOS.OSAMiner](https://attack.mitre.org/software/S1048) can gather the device serial number and has checked to ensure there is enough disk space using the Unix utility `df`.(Citation: SentinelLabs reversing run-only applescripts 2021)
- [S0149] MoonWind: [MoonWind](https://attack.mitre.org/software/S0149) can obtain the victim hostname, Windows version, RAM amount, number of drives, and screen resolution.(Citation: Palo Alto MoonWind March 2017)
- [S0155] WINDSHIELD: [WINDSHIELD](https://attack.mitre.org/software/S0155) can gather the victim computer name.(Citation: FireEye APT32 May 2017)
- [S0106] cmd: [cmd](https://attack.mitre.org/software/S0106) can be used to find information about the operating system.(Citation: TechNet Dir)
- [S0165] OSInfo: [OSInfo](https://attack.mitre.org/software/S0165) discovers information about the infected machine.(Citation: Symantec Buckeye)
- [S0340] Octopus: [Octopus](https://attack.mitre.org/software/S0340) can collect system drive information, the computer name, the size of the disk, OS version, and OS architecture information.(Citation: Securelist Octopus Oct 2018)
- [S0516] SoreFang: [SoreFang](https://attack.mitre.org/software/S0516) can collect the hostname, operating system configuration, product ID, and disk space on victim machines by executing [Systeminfo](https://attack.mitre.org/software/S0096).(Citation: CISA SoreFang July 2016)
- [S0585] Kerrdown: [Kerrdown](https://attack.mitre.org/software/S0585) has the ability to determine if the compromised host is running a 32 or 64 bit OS architecture.(Citation: Unit 42 KerrDown February 2019)
- [S0635] BoomBox: [BoomBox](https://attack.mitre.org/software/S0635) can enumerate the hostname, domain, and IP of a compromised host.(Citation: MSTIC Nobelium Toolset May 2021)
- [S1152] IMAPLoader: [IMAPLoader](https://attack.mitre.org/software/S1152) uses WMI queries to gather information about the victim machine.(Citation: PWC Yellow Liderc 2023)
- [S0428] PoetRAT: [PoetRAT](https://attack.mitre.org/software/S0428) has the ability to gather information about the compromised host.(Citation: Talos PoetRAT April 2020)
- [S0142] StreamEx: [StreamEx](https://attack.mitre.org/software/S0142) has the ability to enumerate system information.(Citation: Cylance Shell Crew Feb 2017)
- [S0622] AppleSeed: [AppleSeed](https://attack.mitre.org/software/S0622) can identify the OS version of a targeted system.(Citation: Malwarebytes Kimsuky June 2021)
- [S0644] ObliqueRAT: [ObliqueRAT](https://attack.mitre.org/software/S0644) has the ability to check for blocklisted computer names on infected endpoints.(Citation: Talos Oblique RAT March 2021)
- [S0272] NDiskMonitor: [NDiskMonitor](https://attack.mitre.org/software/S0272) obtains the victim computer name and encrypts the information to send over its C2 channel.(Citation: TrendMicro Patchwork Dec 2017)
- [S0652] MarkiRAT: [MarkiRAT](https://attack.mitre.org/software/S0652) can obtain the computer name from a compromised host.(Citation: Kaspersky Ferocious Kitten Jun 2021)
- [S0113] Prikormka: A module in [Prikormka](https://attack.mitre.org/software/S0113) collects information from the victim about Windows OS version, computer name, battery info, and physical memory.(Citation: ESET Operation Groundbait)
- [S0376] HOPLIGHT: [HOPLIGHT](https://attack.mitre.org/software/S0376) has been observed collecting victim machine information like OS version, volume information, and more.(Citation: US-CERT HOPLIGHT Apr 2019)
- [S0048] PinchDuke: [PinchDuke](https://attack.mitre.org/software/S0048) gathers system configuration information.(Citation: F-Secure The Dukes)
- [S0476] Valak: [Valak](https://attack.mitre.org/software/S0476) can determine the Windows version and computer name on a compromised host.(Citation: Cybereason Valak May 2020)(Citation: SentinelOne Valak June 2020)
- [S0230] ZeroT: [ZeroT](https://attack.mitre.org/software/S0230) gathers the victim's computer name, Windows version, and system language, and then sends it to its C2 server.(Citation: Proofpoint ZeroT Feb 2017)
- [S0192] Pupy: [Pupy](https://attack.mitre.org/software/S0192) can grab a system’s information including the OS version, architecture, etc.(Citation: GitHub Pupy)
- [S1210] Sagerunex: [Sagerunex](https://attack.mitre.org/software/S1210) gathers information from the infected system such as hostname.(Citation: Cisco LotusBlossom 2025)
- [S1138] Gootloader: [Gootloader](https://attack.mitre.org/software/S1138) can inspect the User-Agent string in GET request header information to determine the operating system of targeted systems.(Citation: Sophos Gootloader)
- [S0543] Spark: [Spark](https://attack.mitre.org/software/S0543) can collect the hostname, keyboard layout, and language from the system.(Citation: Unit42 Molerat Mar 2020)
- [S0085] S-Type: The initial beacon packet for [S-Type](https://attack.mitre.org/software/S0085) contains the operating system version and file system of the victim.(Citation: Cylance Dust Storm)
- [S1180] BlackByte Ransomware: [BlackByte Ransomware](https://attack.mitre.org/software/S1180) gathers victim system information to generate a unique victim identifier.(Citation: Trustwave BlackByte 2021)
- [S0601] Hildegard: [Hildegard](https://attack.mitre.org/software/S0601) has collected the host's OS, CPU, and memory information.(Citation: Unit 42 Hildegard Malware)
- [G0142] Confucius: [Confucius](https://attack.mitre.org/groups/G0142) has used a file stealer that can examine system drives, including those other than the C drive.(Citation: TrendMicro Confucius APT Aug 2021)
- [S0458] Ramsay: [Ramsay](https://attack.mitre.org/software/S0458) can detect system information--including disk names, total space, and remaining space--to create a hardware profile GUID which acts as a system identifier for operators.(Citation: Eset Ramsay May 2020)(Citation: Antiy CERT Ramsay April 2020)
- [S0410] Fysbis: [Fysbis](https://attack.mitre.org/software/S0410) has used the command <code>ls /etc | egrep -e"fedora\*|debian\*|gentoo\*|mandriva\*|mandrake\*|meego\*|redhat\*|lsb-\*|sun-\*|SUSE\*|release"</code> to determine which Linux OS version is running.(Citation: Fysbis Palo Alto Analysis)
- [S0355] Final1stspy: [Final1stspy](https://attack.mitre.org/software/S0355) obtains victim Microsoft Windows version information and CPU architecture.(Citation: Unit 42 Nokki Oct 2018)
- [S0461] SDBbot: [SDBbot](https://attack.mitre.org/software/S0461) has the ability to identify the OS version, OS bit information and computer name.(Citation: Proofpoint TA505 October 2019)(Citation: Korean FSI TA505 2020)
- [S0556] Pay2Key: [Pay2Key](https://attack.mitre.org/software/S0556) has the ability to gather the hostname of the victim machine.(Citation: Check Point Pay2Key November 2020)
- [S1167] AcidPour: [AcidPour](https://attack.mitre.org/software/S1167) can identify various system locations and mapped devices on Linux systems as a precursor to wiping activity.(Citation: SentinelOne AcidPour 2024)
- [G1039] RedCurl: [RedCurl](https://attack.mitre.org/groups/G1039) has collected information about the target system, such as system information and list of network connections.(Citation: group-ib_redcurl1)(Citation: group-ib_redcurl2)
- [S0666] Gelsemium: [Gelsemium](https://attack.mitre.org/software/S0666) can determine the operating system and whether a targeted machine has a 32 or 64 bit architecture.(Citation: ESET Gelsemium June 2021)
- [G0082] APT38: [APT38](https://attack.mitre.org/groups/G0082) has attempted to get detailed information about a compromised host, including the operating system, version, patches, hotfixes, and service packs.(Citation: CISA AA20-239A BeagleBoyz August 2020)
- [S0215] KARAE: [KARAE](https://attack.mitre.org/software/S0215) can collect system information.(Citation: FireEye APT37 Feb 2018)
- [S0475] BackConfig: [BackConfig](https://attack.mitre.org/software/S0475) has the ability to gather the victim's computer name.(Citation: Unit 42 BackConfig May 2020)
- [S0697] HermeticWiper: [HermeticWiper](https://attack.mitre.org/software/S0697) can determine the OS version, bitness, and enumerate physical drives on a targeted host.(Citation: SentinelOne Hermetic Wiper February 2022)(Citation: Crowdstrike DriveSlayer February 2022)(Citation: ESET Hermetic Wizard March 2022)(Citation: Qualys Hermetic Wiper March 2022)
- [S0083] Misdat: The initial beacon packet for [Misdat](https://attack.mitre.org/software/S0083) contains the operating system version of the victim.(Citation: Cylance Dust Storm)
- [S1078] RotaJakiro: [RotaJakiro](https://attack.mitre.org/software/S1078) executes a set of commands to collect device information, including `uname`.  Another example is the `cat /etc/*release | uniq` command used to collect the current OS distribution.(Citation: RotaJakiro 2021 netlab360 analysis)
- [G0129] Mustang Panda: [Mustang Panda](https://attack.mitre.org/groups/G0129) has gathered system information using <code>systeminfo</code>.(Citation: Avira Mustang Panda January 2020)
- [S0245] BADCALL: [BADCALL](https://attack.mitre.org/software/S0245) collects the computer name and host name on the compromised system.(Citation: US-CERT BADCALL)
- [S0346] OceanSalt: [OceanSalt](https://attack.mitre.org/software/S0346) can collect the computer name from the system.(Citation: McAfee Oceansalt Oct 2018)
- [S0663] SysUpdate: [SysUpdate](https://attack.mitre.org/software/S0663) can collect a system's architecture, operating system version, hostname, and drive information.(Citation: Trend Micro Iron Tiger April 2021)(Citation: Lunghi Iron Tiger Linux)
- [S0247] NavRAT: [NavRAT](https://attack.mitre.org/software/S0247) uses <code>systeminfo</code> on a victim’s machine.(Citation: Talos NavRAT May 2018)
- [S0455] Metamorfo: [Metamorfo](https://attack.mitre.org/software/S0455) has collected the hostname and operating system version from the compromised host.(Citation: FireEye Metamorfo Apr 2018)(Citation: Fortinet Metamorfo Feb 2020)(Citation: ESET Casbaneiro Oct 2019)
- [S0660] Clambling: [Clambling](https://attack.mitre.org/software/S0660) can discover the hostname, computer name, and Windows version of a targeted machine.(Citation: Trend Micro DRBControl February 2020)(Citation: Talent-Jump Clambling February 2020)
- [C0006] Operation Honeybee: During [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), the threat actors collected the computer name, OS, and other system information using `cmd /c systeminfo > %temp%\ temp.ini`.(Citation: McAfee Honeybee)
- [S0265] Kazuar: [Kazuar](https://attack.mitre.org/software/S0265) gathers information on the system and local drives.(Citation: Unit 42 Kazuar May 2017)
- [S0453] Pony: [Pony](https://attack.mitre.org/software/S0453) has collected the Service Pack, language, and region information to send to the C2.(Citation: Malwarebytes Pony April 2016)
- [S1166] Solar: [Solar](https://attack.mitre.org/software/S1166) can send basic information about the infected host to C2.(Citation: ESET OilRig Campaigns Sep 2023)
- [S0275] UPPERCUT: [UPPERCUT](https://attack.mitre.org/software/S0275) has the capability to gather the system’s hostname and OS version.(Citation: FireEye APT10 Sept 2018)
- [S0141] Winnti for Windows: [Winnti for Windows](https://attack.mitre.org/software/S0141) can determine if the OS on a compromised host is newer than Windows XP.(Citation: Novetta Winnti April 2015)
- [S0414] BabyShark: [BabyShark](https://attack.mitre.org/software/S0414) has executed the <code>ver</code> command.(Citation: Unit42 BabyShark Feb 2019)
- [S0260] InvisiMole: [InvisiMole](https://attack.mitre.org/software/S0260) can gather information on the mapped drives, OS version, computer name, DEP policy, memory size, and system volume serial number.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020)
- [S1060] Mafalda: [Mafalda](https://attack.mitre.org/software/S1060) can collect the computer name and enumerate all drives on a compromised host.(Citation: SentinelLabs Metador Sept 2022)(Citation: SentinelLabs Metador Technical Appendix Sept 2022)
- [S1202] LockBit 3.0: [LockBit 3.0](https://attack.mitre.org/software/S1202) can enumerate system hostname, domain, and local drive configuration.(Citation: Joint Cybersecurity Advisory LockBit 3.0 MAR 2023)
- [S0380] StoneDrill: [StoneDrill](https://attack.mitre.org/software/S0380) has the capability to discover the system OS, Windows version, architecture and environment.(Citation: Kaspersky StoneDrill 2017)
- [S0238] Proxysvc: [Proxysvc](https://attack.mitre.org/software/S0238) collects the OS version, country name, MAC address, computer name, physical memory statistics, and volume information for all drives on the system.(Citation: McAfee GhostSecret)
- [G0094] Kimsuky: [Kimsuky](https://attack.mitre.org/groups/G0094) has enumerated drives, OS type, OS version, and other information using a script or the "systeminfo" command.(Citation: Securelist Kimsuky Sept 2013)(Citation: Talos Kimsuky Nov 2021)
- [S1029] AuTo Stealer: [AuTo Stealer](https://attack.mitre.org/software/S1029) has the ability to collect the hostname and OS information from an infected host.(Citation: MalwareBytes SideCopy Dec 2021)
- [S1200] StealBit: [StealBit](https://attack.mitre.org/software/S1200) can enumerate the computer name and domain membership of the compromised system.(Citation: Cybereason StealBit Exfiltration Tool)
- [S0617] HELLOKITTY: [HELLOKITTY](https://attack.mitre.org/software/S0617) can enumerate logical drives on a target system.(Citation: FireEye FiveHands April 2021)
- [S0125] Remsec: [Remsec](https://attack.mitre.org/software/S0125) can obtain the OS version information, computer name, processor architecture, machine role, and OS edition.(Citation: Kaspersky ProjectSauron Technical Analysis)
- [S1034] StrifeWater: [StrifeWater](https://attack.mitre.org/software/S1034) can collect the OS version, architecture, and machine name to create a unique token for the infected host.(Citation: Cybereason StrifeWater Feb 2022)
- [S0460] Get2: [Get2](https://attack.mitre.org/software/S0460) has the ability to identify the computer name and Windows version of an infected host.(Citation: Proofpoint TA505 October 2019)
- [G0069] MuddyWater: [MuddyWater](https://attack.mitre.org/groups/G0069) has used malware that can collect the victim’s OS version and machine name.(Citation: Securelist MuddyWater Oct 2018)(Citation: Talos MuddyWater May 2019)(Citation: Reaqta MuddyWater November 2017)(Citation: Trend Micro Muddy Water March 2021)(Citation: Talos MuddyWater Jan 2022)
- [S0446] Ryuk: [Ryuk](https://attack.mitre.org/software/S0446) has called <code>GetLogicalDrives</code> to emumerate all mounted drives, and <code>GetDriveTypeW</code> to determine the drive type.(Citation: CrowdStrike Ryuk January 2019)
- [S0402] OSX/Shlayer: [OSX/Shlayer](https://attack.mitre.org/software/S0402) has collected the IOPlatformUUID, session UID, and the OS version using the command <code>sw_vers -productVersion</code>.(Citation: Carbon Black Shlayer Feb 2019)(Citation: sentinelone shlayer to zshlayer)
- [S0384] Dridex: [Dridex](https://attack.mitre.org/software/S0384) has collected the computer name and OS architecture information from the system.(Citation: Checkpoint Dridex Jan 2021)
- [S0451] LoudMiner: [LoudMiner](https://attack.mitre.org/software/S0451) has monitored CPU usage.(Citation: ESET LoudMiner June 2019)
- [S0546] SharpStage: [SharpStage](https://attack.mitre.org/software/S0546) has checked the system settings to see if Arabic is the configured language.(Citation: BleepingComputer Molerats Dec 2020)
- [S0199] TURNEDUP: [TURNEDUP](https://attack.mitre.org/software/S0199) is capable of gathering system information.(Citation: FireEye APT33 Sept 2017)
- [S0171] Felismus: [Felismus](https://attack.mitre.org/software/S0171) collects the system information, including hostname and OS version, and sends it to the C2 server.(Citation: Forcepoint Felismus Mar 2017)
- [S0079] MobileOrder: [MobileOrder](https://attack.mitre.org/software/S0079) has a command to upload to its C2 server victim mobile device information, including IMEI, IMSI, SIM card serial number, phone number, Android version, and other information.(Citation: Scarlet Mimic Jan 2016)
- [S0144] ChChes: [ChChes](https://attack.mitre.org/software/S0144) collects the victim hostname, window resolution, and Microsoft Windows version.(Citation: Palo Alto menuPass Feb 2017)(Citation: PWC Cloud Hopper Technical Annex April 2017)
- [S0022] Uroburos: [Uroburos](https://attack.mitre.org/software/S0022) has the ability to gather basic system information and run the POSIX API `gethostbyname`.(Citation: Joint Cybersecurity Advisory AA23-129A Snake Malware May 2023)
- [S1168] SampleCheck5000: [SampleCheck5000](https://attack.mitre.org/software/S1168) can create unique victim identifiers by using the compromised system’s volume ID or computer name.(Citation: ESET OilRig Downloaders DEC 2023)
- [S1150] ROADSWEEP: [ROADSWEEP](https://attack.mitre.org/software/S1150) can enumerate logical drives on targeted devices.(Citation: Mandiant ROADSWEEP August 2022)(Citation: Microsoft Albanian Government Attacks September 2022)
- [G0139] TeamTNT: [TeamTNT](https://attack.mitre.org/groups/G0139) has searched for system version, architecture, disk partition, logical volume, and hostname information.(Citation: ATT TeamTNT Chimaera September 2020)(Citation: Cisco Talos Intelligence Group)
- [S1025] Amadey: [Amadey](https://attack.mitre.org/software/S1025) has collected the computer name and OS version from a compromised machine.(Citation: Korean FSI TA505 2020)(Citation: BlackBerry Amadey 2020)
- [S0491] StrongPity: [StrongPity](https://attack.mitre.org/software/S0491) can identify the hard disk volume serial number on a compromised host.(Citation: Talos Promethium June 2020)
- [S0471] build_downer: [build_downer](https://attack.mitre.org/software/S0471) has the ability to send system volume information to C2.(Citation: Trend Micro Tick November 2019)
- [S1196] Troll Stealer: [Troll Stealer](https://attack.mitre.org/software/S1196) can collect local system information.(Citation: S2W Troll Stealer 2024)(Citation: Symantec Troll Stealer 2024)
- [S0184] POWRUNER: [POWRUNER](https://attack.mitre.org/software/S0184) may collect information about the system by running <code>hostname</code> and <code>systeminfo</code> on a victim.(Citation: FireEye APT34 Dec 2017)
- [S0236] Kwampirs: [Kwampirs](https://attack.mitre.org/software/S0236) collects OS version information such as registered owner details, manufacturer details, processor type, available storage, installed patches, hostname, version info, system date, and other system information by using the commands <code>systeminfo</code>, <code>net config workstation</code>, <code>hostname</code>, <code>ver</code>, <code>set</code>, and <code>date /t</code>.(Citation: Symantec Orangeworm April 2018)
- [S0153] RedLeaves: [RedLeaves](https://attack.mitre.org/software/S0153) can gather extended system information including the hostname, OS version number, platform, memory information, time elapsed since system startup, and CPU information.(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: Accenture Hogfish April 2018)
- [S0447] Lokibot: [Lokibot](https://attack.mitre.org/software/S0447) has the ability to discover the computer name and Windows product name/version.(Citation: FSecure Lokibot November 2019)
- [S0681] Lizar: [Lizar](https://attack.mitre.org/software/S0681) can collect the computer name from the machine,.(Citation: BiZone Lizar May 2021)
- [S0248] yty: [yty](https://attack.mitre.org/software/S0248) gathers the computer name, the serial number of the main disk volume, CPU information, Microsoft Windows version, and runs the command <code>systeminfo</code>.(Citation: ASERT Donot March 2018)
- [S1160] Latrodectus: [Latrodectus](https://attack.mitre.org/software/S1160) can gather operating system information.(Citation: Latrodectus APR 2024)(Citation: Elastic Latrodectus May 2024)(Citation: Elastic Latrodectus May 2024)(Citation: Bitsight Latrodectus June 2024)
- [S0201] JPIN: [JPIN](https://attack.mitre.org/software/S0201) can obtain system information such as OS version and disk space.(Citation: Microsoft PLATINUM April 2016)
- [C0044] Juicy Mix: During [Juicy Mix](https://attack.mitre.org/campaigns/C0044), [OilRig](https://attack.mitre.org/groups/G0049) used a script to send the name of the compromised host via HTTP `POST` to register it with C2.(Citation: ESET OilRig Campaigns Sep 2023)
- [S0532] Lucifer: [Lucifer](https://attack.mitre.org/software/S0532) can collect the computer name, system architecture, default language, and processor frequency of a compromised host.(Citation: Unit 42 Lucifer June 2020)
- [S0084] Mis-Type: The initial beacon packet for [Mis-Type](https://attack.mitre.org/software/S0084) contains the operating system version and file system of the victim.(Citation: Cylance Dust Storm)
- [S0032] gh0st RAT: [gh0st RAT](https://attack.mitre.org/software/S0032) has gathered system architecture, processor, OS configuration, and installed hardware information.(Citation: Gh0stRAT ATT March 2019)
- [G0022] APT3: [APT3](https://attack.mitre.org/groups/G0022) has a tool that can obtain information about the local system.(Citation: Symantec Buckeye)(Citation: evolution of pirpi)
- [C0024] SolarWinds Compromise: During the [SolarWinds Compromise](https://attack.mitre.org/campaigns/C0024), [APT29](https://attack.mitre.org/groups/G0016) used `fsutil` to check available free space before executing actions that might create large files on disk.(Citation: Microsoft Deep Dive Solorigate January 2021)
- [S0253] RunningRAT: [RunningRAT](https://attack.mitre.org/software/S0253) gathers the OS version, logical drives information, processor information, and volume information.(Citation: McAfee Gold Dragon)
- [S0244] Comnie: [Comnie](https://attack.mitre.org/software/S0244) collects the hostname of the victim machine.(Citation: Palo Alto Comnie)
- [G0121] Sidewinder: [Sidewinder](https://attack.mitre.org/groups/G0121) has used tools to collect the computer name, OS version, installed hotfixes, as well as information regarding the memory and processor on a compromised host.(Citation: ATT Sidewinder January 2021)(Citation: Rewterz Sidewinder COVID-19 June 2020)
- [S1075] KOPILUWAK: [KOPILUWAK](https://attack.mitre.org/software/S1075) can discover logical drive information on compromised hosts.(Citation: Mandiant Suspected Turla Campaign February 2023)
- [S0234] Bandook: [Bandook](https://attack.mitre.org/software/S0234) can collect information about the drives available on the system.(Citation: CheckPoint Bandook Nov 2020)
- [S0331] Agent Tesla: [Agent Tesla](https://attack.mitre.org/software/S0331) can collect the system's computer name and also has the capability to collect information on the processor, memory, OS, and video card from the system.(Citation: Fortinet Agent Tesla April 2018)(Citation: Fortinet Agent Tesla June 2017)(Citation: Malwarebytes Agent Tesla April 2020)
- [S0689] WhisperGate: [WhisperGate](https://attack.mitre.org/software/S0689) has the ability to enumerate fixed logical drives on a targeted system.(Citation: Cisco Ukraine Wipers January 2022)
- [G0059] Magic Hound: [Magic Hound](https://attack.mitre.org/groups/G0059) malware has used a PowerShell command to check the victim system architecture to determine if it is an x64 machine. Other malware has obtained the OS version, UUID, and computer/host name to send to the C2 server.(Citation: Unit 42 Magic Hound Feb 2017)(Citation: DFIR Report APT35 ProxyShell March 2022)(Citation: DFIR Phosphorus November 2021)
- [G1034] Daggerfly: [Daggerfly](https://attack.mitre.org/groups/G1034) utilizes victim machine operating system information to create custom User Agent strings for subsequent command and control communication.(Citation: ESET EvasivePanda 2024)
- [S1142] LunarMail: [LunarMail](https://attack.mitre.org/software/S1142) can capture environmental variables on compromised hosts.(Citation: ESET Turla Lunar toolset May 2024)
- [S0572] Caterpillar WebShell: [Caterpillar WebShell](https://attack.mitre.org/software/S0572) has a module to gather information from the compromised asset, including the computer version, computer name, IIS version, and more.(Citation: ClearSky Lebanese Cedar Jan 2021)
- [S0386] Ursnif: [Ursnif](https://attack.mitre.org/software/S0386) has used [Systeminfo](https://attack.mitre.org/software/S0096) to gather system information.(Citation: TrendMicro Ursnif Mar 2015)
- [G1040] Play: [Play](https://attack.mitre.org/groups/G1040) has leveraged tools to enumerate system information.(Citation: Trend Micro Ransomware Spotlight Play July 2023)
- [S1182] MagicRAT: [MagicRAT](https://attack.mitre.org/software/S1182) collects basic system information from victim machines.(Citation: Cisco MagicRAT 2022)
- [C0014] Operation Wocao: During [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors discovered the local disks attached to the system and their hardware information including manufacturer and model, as well as the OS versions of systems connected to a targeted network.(Citation: FoxIT Wocao December 2019)
- [S0672] Zox: [Zox](https://attack.mitre.org/software/S0672) can enumerate attached drives.(Citation: Novetta-Axiom)
- [S1064] SVCReady: [SVCReady](https://attack.mitre.org/software/S1064) has the ability to collect information such as computer name, computer manufacturer, BIOS, operating system, and firmware, including through the use of `systeminfo.exe`.(Citation: HP SVCReady Jun 2022)
- [S0062] DustySky: [DustySky](https://attack.mitre.org/software/S0062) extracts basic information about the operating system.(Citation: DustySky)
- [S0569] Explosive: [Explosive](https://attack.mitre.org/software/S0569) has collected the computer name from the infected host.(Citation: CheckPoint Volatile Cedar March 2015)
- [S0096] Systeminfo: [Systeminfo](https://attack.mitre.org/software/S0096) can be used to gather information about the operating system.(Citation: TechNet Systeminfo)
- [S0691] Neoichor: [Neoichor](https://attack.mitre.org/software/S0691) can collect the OS version and computer name from a compromised host.(Citation: Microsoft NICKEL December 2021)
- [S1089] SharpDisco: [SharpDisco](https://attack.mitre.org/software/S1089) can use a plugin to enumerate system drives.(Citation: MoustachedBouncer ESET August 2023)
- [G1044] APT42: [APT42](https://attack.mitre.org/groups/G1044) has used malware, such as GHAMBAR and POWERPOST, to collect system information.(Citation: Mandiant APT42-charms)
- [S0249] Gold Dragon: [Gold Dragon](https://attack.mitre.org/software/S0249) collects endpoint information using the <code>systeminfo</code> command.(Citation: McAfee Gold Dragon)
- [S0024] Dyre: [Dyre](https://attack.mitre.org/software/S0024) has the ability to identify the computer name, OS version, and hardware configuration on a compromised host.(Citation: Malwarebytes Dyreza November 2015)
- [G1008] SideCopy: [SideCopy](https://attack.mitre.org/groups/G1008) has identified the OS version of a compromised host.(Citation: MalwareBytes SideCopy Dec 2021)
- [C0029] Cutting Edge: During [Cutting Edge](https://attack.mitre.org/campaigns/C0029), threat actors used the ENUM4LINUX Perl script for discovery on Windows and Samba hosts.(Citation: Mandiant Cutting Edge Part 2 January 2024)
- [G0114] Chimera: [Chimera](https://attack.mitre.org/groups/G0114) has used `fsutil fsinfo drives`, `systeminfo`, and `vssadmin list shadows` for system information including shadow volumes and drive information.(Citation: NCC Group Chimera January 2021)
- [S0688] Meteor: [Meteor](https://attack.mitre.org/software/S0688) has the ability to discover the hostname of a compromised host.(Citation: Check Point Meteor Aug 2021)
- [G0073] APT19: [APT19](https://attack.mitre.org/groups/G0073) collected system architecture information. [APT19](https://attack.mitre.org/groups/G0073) used an HTTP malware variant and a Port 22 malware variant to gather the hostname and CPU information from the victim’s machine.(Citation: FireEye APT19)(Citation: Unit 42 C0d0so0 Jan 2016)
- [S0488] CrackMapExec: [CrackMapExec](https://attack.mitre.org/software/S0488) can enumerate the system drives and associated system name.(Citation: CME Github September 2018)
- [S1184] BOLDMOVE: [BOLDMOVE](https://attack.mitre.org/software/S1184) performs system survey actions following initial execution.(Citation: Google Cloud BOLDMOVE 2023)
- [G0026] APT18: [APT18](https://attack.mitre.org/groups/G0026) can collect system information from the victim’s machine.(Citation: PaloAlto DNS Requests May 2016)
- [S0208] Pasam: [Pasam](https://attack.mitre.org/software/S0208) creates a backdoor through which remote attackers can retrieve information such as hostname and free disk space.(Citation: Symantec Pasam May 2012)
- [S0348] Cardinal RAT: [Cardinal RAT](https://attack.mitre.org/software/S0348) can collect the hostname, Microsoft Windows version, and processor architecture from a victim machine.(Citation: PaloAlto CardinalRat Apr 2017)
- [S0679] Ferocious: [Ferocious](https://attack.mitre.org/software/S0679) can use <code>GET.WORKSPACE</code> in Microsoft Excel to determine the OS version of the compromised host.(Citation: Kaspersky WIRTE November 2021)
- [S0445] ShimRatReporter: [ShimRatReporter](https://attack.mitre.org/software/S0445) gathered the operating system name and specific Windows version of an infected machine.(Citation: FOX-IT May 2016 Mofang)
- [S0148] RTM: [RTM](https://attack.mitre.org/software/S0148) can obtain the computer name, OS version, and default language identifier.(Citation: ESET RTM Feb 2017)
- [S1028] Action RAT: [Action RAT](https://attack.mitre.org/software/S1028) has the ability to collect the hostname, OS version, and OS architecture of an infected host.(Citation: MalwareBytes SideCopy Dec 2021)
- [G0061] FIN8: [FIN8](https://attack.mitre.org/groups/G0061) has used PowerShell Scripts to check the architecture of a compromised machine before the selection of a 32-bit or 64-bit version of a malicious .NET loader.(Citation: Symantec FIN8 Jul 2023)
- [S1022] IceApple: The [IceApple](https://attack.mitre.org/software/S1022) Server Variable Dumper module iterates over all server variables present for the current request and returns them to the adversary.(Citation: CrowdStrike IceApple May 2022)
- [S0658] XCSSET: [XCSSET](https://attack.mitre.org/software/S0658) identifies the macOS version and uses <code>ioreg</code> to determine serial number.(Citation: trendmicro xcsset xcode project 2020)
- [S1207] XLoader: [XLoader](https://attack.mitre.org/software/S1207) can collect system information and supported language information from the victim machine.(Citation: Acronis XLoader 2021)
- [S0659] Diavol: [Diavol](https://attack.mitre.org/software/S0659) can collect the computer name and OS version from the system.(Citation: Fortinet Diavol July 2021)
- [G0081] Tropic Trooper: [Tropic Trooper](https://attack.mitre.org/groups/G0081) has detected a target system’s OS version and system volume information.(Citation: TrendMicro TropicTrooper 2015)(Citation: TrendMicro Tropic Trooper May 2020)
- [S0268] Bisonal: [Bisonal](https://attack.mitre.org/software/S0268) has used commands and API calls to gather system information.(Citation: Unit 42 Bisonal July 2018)(Citation: Kaspersky CactusPete Aug 2020)(Citation: Talos Bisonal Mar 2020)
- [G0143] Aquatic Panda: [Aquatic Panda](https://attack.mitre.org/groups/G0143) has used native OS commands to understand privilege levels and system details.(Citation: CrowdStrike AQUATIC PANDA December 2021)
- [S0240] ROKRAT: [ROKRAT](https://attack.mitre.org/software/S0240) can gather the hostname and the OS version to ensure it doesn’t run on a Windows XP or Windows Server 2003 systems.(Citation: Talos ROKRAT)(Citation: Talos ROKRAT 2)(Citation: Securelist ScarCruft May 2019)(Citation: NCCGroup RokRat Nov 2018)(Citation: Volexity InkySquid RokRAT August 2021)(Citation: Malwarebytes RokRAT VBA January 2021)
- [S0604] Industroyer: [Industroyer](https://attack.mitre.org/software/S0604) collects the victim machine’s Windows GUID.(Citation: Dragos Crashoverride 2017)
- [G1035] Winter Vivern: [Winter Vivern](https://attack.mitre.org/groups/G1035) script execution includes basic victim information gathering steps which are then transmitted to command and control servers.(Citation: DomainTools WinterVivern 2021)
- [S0263] TYPEFRAME: [TYPEFRAME](https://attack.mitre.org/software/S0263) can gather the disk volume information.(Citation: US-CERT TYPEFRAME June 2018)
- [S0596] ShadowPad: [ShadowPad](https://attack.mitre.org/software/S0596) has discovered system information including memory status, CPU frequency, OS versions, and volume serial numbers.(Citation: Kaspersky ShadowPad Aug 2017)
- [S1198] Gomir: [Gomir](https://attack.mitre.org/software/S1198) collects information on infected systems such as hostname, username, CPU, and RAM information.(Citation: Symantec Troll Stealer 2024)
- [S1026] Mongall: [Mongall](https://attack.mitre.org/software/S1026) can identify drives on compromised hosts and retrieve the hostname via `gethostbyname`.(Citation: SentinelOne Aoqin Dragon June 2022)
- [S0650] QakBot: [QakBot](https://attack.mitre.org/software/S0650) can collect system information including the OS version and domain on a compromised host.(Citation: Crowdstrike Qakbot October 2020)(Citation: ATT QakBot April 2021)(Citation: Group IB Ransomware September 2020)(Citation: Microsoft Ransomware as a Service)
- [S0151] HALFBAKED: [HALFBAKED](https://attack.mitre.org/software/S0151) can obtain information about the OS, processor, and BIOS.(Citation: FireEye FIN7 April 2017)
- [S0610] SideTwist: [SideTwist](https://attack.mitre.org/software/S0610) can collect the computer name of a targeted system.(Citation: Check Point APT34 April 2021)
- [S0662] RCSession: [RCSession](https://attack.mitre.org/software/S0662) can gather system information from a compromised host.(Citation: Profero APT27 December 2020)
- [S0454] Cadelspy: [Cadelspy](https://attack.mitre.org/software/S0454) has the ability to discover information about the compromised host.(Citation: Symantec Chafer Dec 2015)
- [S0409] Machete: [Machete](https://attack.mitre.org/software/S0409) collects the hostname of the target computer.(Citation: ESET Machete July 2019)
- [S0270] RogueRobin: [RogueRobin](https://attack.mitre.org/software/S0270) gathers BIOS versions and manufacturers, the number of CPU cores, the total physical memory, and the computer name.(Citation: Unit 42 DarkHydrus July 2018)
- [S1159] DUSTTRAP: [DUSTTRAP](https://attack.mitre.org/software/S1159) reads the value of the infected system's `HKLM\SYSTEM\Microsoft\Cryptography\MachineGUID` value.(Citation: Google Cloud APT41 2024)
- [S0647] Turian: [Turian](https://attack.mitre.org/software/S0647) can retrieve system information including OS version, memory usage, local hostname, and system adapter information.(Citation: ESET BackdoorDiplomacy Jun 2021)
- [S0330] Zeus Panda: [Zeus Panda](https://attack.mitre.org/software/S0330) collects the OS version, system architecture, computer name, product ID, install date, and information on the keyboard mapping to determine the language used on the system.(Citation: Talos Zeus Panda Nov 2017)(Citation: GDATA Zeus Panda June 2017)
- [S0484] Carberp: [Carberp](https://attack.mitre.org/software/S0484) has collected the operating system version from the infected system.(Citation: Prevx Carberp March 2011)
- [S0182] FinFisher: [FinFisher](https://attack.mitre.org/software/S0182) checks if the victim OS is 32 or 64-bit.(Citation: FinFisher Citation)(Citation: Microsoft FinFisher March 2018)
- [S0526] KGH_SPY: [KGH_SPY](https://attack.mitre.org/software/S0526) can collect drive information from a compromised host.(Citation: Cybereason Kimsuky November 2020)
- [S0450] SHARPSTATS: [SHARPSTATS](https://attack.mitre.org/software/S0450) has the ability to identify the IP address, machine name, and OS of the compromised host.(Citation: TrendMicro POWERSTATS V3 June 2019)
- [S1183] StrelaStealer: [StrelaStealer](https://attack.mitre.org/software/S1183) variants collect victim system information for exfiltration.(Citation: IBM StrelaStealer 2024)
- [S0638] Babuk: [Babuk](https://attack.mitre.org/software/S0638) can enumerate disk volumes, get disk information, and query service status.(Citation: McAfee Babuk February 2021)
- [G1020] Mustard Tempest: [Mustard Tempest](https://attack.mitre.org/groups/G1020) has used implants to perform system reconnaissance on targeted systems.(Citation: Microsoft Ransomware as a Service)
- [S1147] Nightdoor: [Nightdoor](https://attack.mitre.org/software/S1147) gathers information on the victim system such as CPU and Computer name as well as device drivers. [Nightdoor](https://attack.mitre.org/software/S1147) can also collect information about disk drives, their total and free space, and file system type.(Citation: ESET EvasivePanda 2024)
- [S0547] DropBook: [DropBook](https://attack.mitre.org/software/S0547) has checked for the presence of Arabic language in the infected machine's settings.(Citation: Cybereason Molerats Dec 2020)
- [S0044] JHUHUGIT: [JHUHUGIT](https://attack.mitre.org/software/S0044) obtains a build identifier as well as victim hard drive information from Windows registry key <code>HKLM\SYSTEM\CurrentControlSet\Services\Disk\Enum</code>. Another [JHUHUGIT](https://attack.mitre.org/software/S0044) variant gathers the victim storage volume serial number and the storage device name.(Citation: ESET Sednit Part 1)(Citation: Unit 42 Sofacy Feb 2018)
- [S0586] TAINTEDSCRIBE: [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) can use <code>DriveList</code> to retrieve drive information.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE MAY 2020)
- [G0054] Sowbug: [Sowbug](https://attack.mitre.org/groups/G0054) obtained OS version and hardware configuration from a victim.(Citation: Symantec Sowbug Nov 2017)
- [G0102] Wizard Spider: [Wizard Spider](https://attack.mitre.org/groups/G0102) has used [Systeminfo](https://attack.mitre.org/software/S0096) and similar commands to acquire detailed configuration information of a victim's machine. [Wizard Spider](https://attack.mitre.org/groups/G0102) has also utilized the PowerShell cmdlet `Get-ADComputer` to collect DNS hostnames, last logon dates, and operating system information from Active Directory.(Citation: DFIR Ryuk's Return October 2020)(Citation: Mandiant FIN12 Oct 2021)
- [G0010] Turla: [Turla](https://attack.mitre.org/groups/G0010) surveys a system upon check-in to discover operating system configuration details using the <code>systeminfo</code> and <code>set</code> commands.(Citation: Kaspersky Turla)(Citation: ESET ComRAT May 2020)
- [C0046] ArcaneDoor: [ArcaneDoor](https://attack.mitre.org/campaigns/C0046) included collection of victim device configuration information.(Citation: CCCS ArcaneDoor 2024)
- [S0587] Penquin: [Penquin](https://attack.mitre.org/software/S0587) can report the file system type and disk space of a compromised host to C2.(Citation: Leonardo Turla Penquin May 2020)
- [S0198] NETWIRE: [NETWIRE](https://attack.mitre.org/software/S0198) can discover and collect victim system information.(Citation: McAfee Netwire Mar 2015)
- [S0431] HotCroissant: [HotCroissant](https://attack.mitre.org/software/S0431) has the ability to determine if the current user is an administrator, Windows product name, processor name, screen resolution, and physical RAM of the infected host.(Citation: US-CERT HOTCROISSANT February 2020)
- [C0035] KV Botnet Activity: [KV Botnet Activity](https://attack.mitre.org/campaigns/C0035) includes use of native system tools, such as <code>uname</code>, to obtain information about victim device architecture, as well as gathering other system information such as the victim's hosts file and CPU utilization.(Citation: Lumen KVBotnet 2023)
- [S0344] Azorult: [Azorult](https://attack.mitre.org/software/S0344) can collect the machine information, system architecture, the OS version, computer name, Windows product name, the number of CPU cores, video card information, and the system language.(Citation: Unit42 Azorult Nov 2018)(Citation: Proofpoint Azorult July 2018)
- [S1186] Line Dancer: [Line Dancer](https://attack.mitre.org/software/S1186) can gather system configuration information by running the native `show configuration` command.(Citation: Cisco ArcaneDoor 2024)
- [S1148] Raccoon Stealer: [Raccoon Stealer](https://attack.mitre.org/software/S1148) gathers information on infected systems such as operating system, processor information, RAM, and display information.(Citation: S2W Racoon 2022)(Citation: Sekoia Raccoon2 2022)
- [S0616] DEATHRANSOM: [DEATHRANSOM](https://attack.mitre.org/software/S0616) can enumerate logical drives on a target system.(Citation: FireEye FiveHands April 2021)
- [G0040] Patchwork: [Patchwork](https://attack.mitre.org/groups/G0040) collected the victim computer name, OS version, and architecture type and sent the information to its C2 server. [Patchwork](https://attack.mitre.org/groups/G0040) also enumerated all available drives on the victim's machine.(Citation: Cymmetria Patchwork)(Citation: TrendMicro Patchwork Dec 2017)
- [G0112] Windshift: [Windshift](https://attack.mitre.org/groups/G0112) has used malware to identify the computer name of a compromised host.(Citation: BlackBerry Bahamut)
- [S0043] BUBBLEWRAP: [BUBBLEWRAP](https://attack.mitre.org/software/S0043) collects system information, including the operating system version and hostname.(Citation: FireEye admin@338)
- [S0257] VERMIN: [VERMIN](https://attack.mitre.org/software/S0257) collects the OS name, machine name, and architecture information.(Citation: Unit 42 VERMIN Jan 2018)
- [G0018] admin@338: [admin@338](https://attack.mitre.org/groups/G0018) actors used the following commands after exploiting a machine with [LOWBALL](https://attack.mitre.org/software/S0042) malware to obtain information about the OS: <code>ver >> %temp%\download</code> <code>systeminfo >> %temp%\download</code>(Citation: FireEye admin@338)
- [S0161] XAgentOSX: [XAgentOSX](https://attack.mitre.org/software/S0161) contains the getInstalledAPP function to run <code>ls -la /Applications</code> to gather what applications are installed.(Citation: XAgentOSX 2017)
- [S0228] NanHaiShu: [NanHaiShu](https://attack.mitre.org/software/S0228) can gather the victim computer name and serial number.(Citation: Proofpoint Leviathan Oct 2017)
- [S0196] PUNCHBUGGY: [PUNCHBUGGY](https://attack.mitre.org/software/S0196) can gather system information such as computer names.(Citation: Morphisec ShellTea June 2019)
- [S0673] DarkWatchman: [DarkWatchman](https://attack.mitre.org/software/S0673) can collect the OS version, system architecture, and computer name.(Citation: Prevailion DarkWatchman 2021)
- [S0219] WINERACK: [WINERACK](https://attack.mitre.org/software/S0219) can gather information about the host.(Citation: FireEye APT37 Feb 2018)
- [S0124] Pisloader: [Pisloader](https://attack.mitre.org/software/S0124) has a command to collect victim system information, including the system name and OS version.(Citation: Palo Alto DNS Requests)
- [S0172] Reaver: [Reaver](https://attack.mitre.org/software/S0172) collects system information from the victim, including CPU speed, computer name, volume serial number, ANSI code page, OEM code page identifier for the OS, Microsoft Windows version, and memory information.(Citation: Palo Alto Reaver Nov 2017)
- [S0631] Chaes: [Chaes](https://attack.mitre.org/software/S0631) has collected system information, including the machine name and OS version.(Citation: Cybereason Chaes Nov 2020)
- [S1153] Cuckoo Stealer: [Cuckoo Stealer](https://attack.mitre.org/software/S1153) can gather information about the OS version and hardware on compromised hosts.(Citation: Kandji Cuckoo April 2024)(Citation: SentinelOne Cuckoo Stealer May 2024)
- [S0632] GrimAgent: [GrimAgent](https://attack.mitre.org/software/S0632) can collect the OS, and build version on a compromised host.(Citation: Group IB GrimAgent July 2021)
- [S0353] NOKKI: [NOKKI](https://attack.mitre.org/software/S0353) can gather information on drives and the operating system on the victim’s machine.(Citation: Unit 42 NOKKI Sept 2018)
- [S0089] BlackEnergy: [BlackEnergy](https://attack.mitre.org/software/S0089) has used [Systeminfo](https://attack.mitre.org/software/S0096) to gather the OS version, as well as information on the system configuration, BIOS, the motherboard, and the processor.(Citation: F-Secure BlackEnergy 2014)(Citation: Securelist BlackEnergy Nov 2014)
- [G1022] ToddyCat: [ToddyCat](https://attack.mitre.org/groups/G1022) has collected information on bootable drives including model, vendor, and serial numbers.(Citation: Kaspersky ToddyCat Check Logs October 2023)
- [G0038] Stealth Falcon: [Stealth Falcon](https://attack.mitre.org/groups/G0038) malware gathers system information via WMI, including the system directory, build number, serial number, version, manufacturer, model, and total physical memory.(Citation: Citizen Lab Stealth Falcon May 2016)
- [S0641] Kobalos: [Kobalos](https://attack.mitre.org/software/S0641) can record the hostname and kernel version of the target machine.(Citation: ESET Kobalos Jan 2021)
- [S0554] Egregor: [Egregor](https://attack.mitre.org/software/S0554) can perform a language check of the infected system and can query the CPU information (cupid).(Citation: JoeSecurity Egregor 2020)(Citation: NHS Digital Egregor Nov 2020)
- [S1044] FunnyDream: [FunnyDream](https://attack.mitre.org/software/S1044) can enumerate all logical drives on a targeted machine.(Citation: Bitdefender FunnyDream Campaign November 2020)
- [S0216] POORAIM: [POORAIM](https://attack.mitre.org/software/S0216) can identify system information, including battery status.(Citation: FireEye APT37 Feb 2018)
- [S0093] Backdoor.Oldrea: [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) collects information about the OS and computer name.(Citation: Symantec Dragonfly)(Citation: Gigamon Berserk Bear October 2021)
- [S0483] IcedID: [IcedID](https://attack.mitre.org/software/S0483) has the ability to identify the computer name and OS version on a compromised host.(Citation: IBM IcedID November 2017)(Citation: DFIR_Quantum_Ransomware)
- [S0241] RATANKBA: [RATANKBA](https://attack.mitre.org/software/S0241) gathers information about the OS architecture, OS name, and OS version/Service pack.(Citation: Lazarus RATANKBA)(Citation: RATANKBA)
- [S1121] LITTLELAMB.WOOLTEA: [LITTLELAMB.WOOLTEA](https://attack.mitre.org/software/S1121) can check the type of Ivanti VPN device it is running on by executing `first_run()` to identify the first four bytes of the motherboard serial number.(Citation: Mandiant Cutting Edge Part 3 February 2024)
- [S1212] RansomHub: [RansomHub](https://attack.mitre.org/software/S1212) can retrieve information about virtual machines.(Citation: Group-IB RansomHub FEB 2025)
- [G1036] Moonstone Sleet: [Moonstone Sleet](https://attack.mitre.org/groups/G1036) has gathered information on victim systems.(Citation: Microsoft Moonstone Sleet 2024)
- [S0534] Bazar: [Bazar](https://attack.mitre.org/software/S0534) can fingerprint architecture, computer name, and OS version on the compromised host. [Bazar](https://attack.mitre.org/software/S0534) can also check if the Russian language is installed on the infected machine and terminate if it is found.(Citation: Cybereason Bazar July 2020)(Citation: NCC Group Team9 June 2020)
- [G0034] Sandworm Team: [Sandworm Team](https://attack.mitre.org/groups/G0034) used a backdoor to enumerate information about the infected system's operating system.(Citation: ESET Telebots July 2017)(Citation: US District Court Indictment GRU Unit 74455 October 2020)
- [G0004] Ke3chang: [Ke3chang](https://attack.mitre.org/groups/G0004) performs operating system information discovery using <code>systeminfo</code> and has used implants to identify the system language and computer name.(Citation: Mandiant Operation Ke3chang November 2014)(Citation: NCC Group APT15 Alive and Strong)(Citation: Microsoft NICKEL December 2021)
- [S0533] SLOTHFULMEDIA: [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) has collected system name, OS version, adapter information, memory usage, and disk information from a victim machine.(Citation: CISA MAR SLOTHFULMEDIA October 2020)
- [S0680] LitePower: [LitePower](https://attack.mitre.org/software/S0680) has the ability to list local drives and enumerate the OS architecture.(Citation: Kaspersky WIRTE November 2021)
- [S0351] Cannon: [Cannon](https://attack.mitre.org/software/S0351) can gather system information from the victim’s machine such as the OS version, machine name, and drive information.(Citation: Unit42 Cannon Nov 2018)(Citation: Unit42 Sofacy Dec 2018)
- [S0105] dsquery: [dsquery](https://attack.mitre.org/software/S0105) has the ability to enumerate various information, such as the operating system and host name, for systems within a domain.(Citation: Mandiant APT41)
- [S0438] Attor: [Attor](https://attack.mitre.org/software/S0438) monitors the free disk space on the system.(Citation: ESET Attor Oct 2019)
- [S0692] SILENTTRINITY: [SILENTTRINITY](https://attack.mitre.org/software/S0692) can collect information related to a compromised host, including OS version and a list of drives.(Citation: GitHub SILENTTRINITY Modules July 2019)
- [S0058] SslMM: [SslMM](https://attack.mitre.org/software/S0058) sends information to its hard-coded C2, including OS version, service pack information, processor speed, system name, and OS install date.(Citation: Baumgartner Naikon 2015)
- [S0473] Avenger: [Avenger](https://attack.mitre.org/software/S0473) has the ability to identify the host volume ID and the OS architecture on a compromised host.(Citation: Trend Micro Tick November 2019)
- [S1059] metaMain: [metaMain](https://attack.mitre.org/software/S1059) can collect the computer name from a compromised host.(Citation: SentinelLabs Metador Technical Appendix Sept 2022)
- [C0007] FunnyDream: During [FunnyDream](https://attack.mitre.org/campaigns/C0007), the threat actors used [Systeminfo](https://attack.mitre.org/software/S0096) to collect information on targeted hosts.(Citation: Bitdefender FunnyDream Campaign November 2020)
- [S0176] Wingbird: [Wingbird](https://attack.mitre.org/software/S0176) checks the victim OS version after executing to determine where to drop files based on whether the victim is 32-bit or 64-bit.(Citation: Microsoft SIR Vol 21)
- [S1213] Lumma Stealer: [Lumma Stealer](https://attack.mitre.org/software/S1213) has gathered various system information from victim machines.(Citation: Cybereason LumaStealer Undated)(Citation: Fortinet LummaStealer 2024)(Citation: TrendMicro LummaStealer 2025)
- [S0615] SombRAT: [SombRAT](https://attack.mitre.org/software/S0615) can execute <code>getinfo</code> to enumerate the computer name and OS version of a compromised system.(Citation: BlackBerry CostaRicto November 2020)


### T1083 - File and Directory Discovery

Description:

Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system. Adversaries may use the information from [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Many command shell utilities can be used to obtain this information. Examples include <code>dir</code>, <code>tree</code>, <code>ls</code>, <code>find</code>, and <code>locate</code>.(Citation: Windows Commands JPCERT) Custom tools may also be used to gather file and directory information and interact with the [Native API](https://attack.mitre.org/techniques/T1106). Adversaries may also leverage a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) on network devices to gather file and directory information (e.g. <code>dir</code>, <code>show flash</code>, and/or <code>nvram</code>).(Citation: US-CERT-TA18-106A)

Some files and directories may require elevated or specific user permissions to access.

Procedures:

- [S0069] BLACKCOFFEE: [BLACKCOFFEE](https://attack.mitre.org/software/S0069) has the capability to enumerate files.(Citation: FireEye APT17)
- [S0229] Orz: [Orz](https://attack.mitre.org/software/S0229) can gather victim drive information.(Citation: Proofpoint Leviathan Oct 2017)
- [S0438] Attor: [Attor](https://attack.mitre.org/software/S0438) has a plugin that enumerates files with specific extensions on all hard disk drives and stores file information in encrypted log files.(Citation: ESET Attor Oct 2019)
- [S0136] USBStealer: [USBStealer](https://attack.mitre.org/software/S0136) searches victim drives for files matching certain extensions (“.skr”,“.pkr” or “.key”) or names.(Citation: ESET Sednit USBStealer 2014)(Citation: Kaspersky Sofacy)
- [S0461] SDBbot: [SDBbot](https://attack.mitre.org/software/S0461) has the ability to get directory listings or drive information on a compromised host.(Citation: Proofpoint TA505 October 2019)
- [S0599] Kinsing: [Kinsing](https://attack.mitre.org/software/S0599) has used the find command to search for specific files.(Citation: Aqua Kinsing April 2020)
- [S1025] Amadey: [Amadey](https://attack.mitre.org/software/S1025) has searched for folders associated with antivirus software.(Citation: Korean FSI TA505 2020)
- [S1065] Woody RAT: [Woody RAT](https://attack.mitre.org/software/S1065) can list all files and their associated attributes, including filename, type, owner, creation time, last access time, last write time, size, and permissions.(Citation: MalwareBytes WoodyRAT Aug 2022)
- [S0013] PlugX: [PlugX](https://attack.mitre.org/software/S0013) has a module to enumerate drives and find files recursively.(Citation: CIRCL PlugX March 2013)(Citation: Proofpoint TA416 Europe March 2022)
- [S1129] Akira: [Akira](https://attack.mitre.org/software/S1129) examines files prior to encryption to determine if they meet requirements for encryption and can be encrypted by the ransomware. These checks are performed through native Windows functions such as <code>GetFileAttributesW</code>.(Citation: Kersten Akira 2023)(Citation: Cisco Akira Ransomware OCT 2024)
- [S0180] Volgmer: [Volgmer](https://attack.mitre.org/software/S0180) can list directories on a victim.(Citation: US-CERT Volgmer Nov 2017)
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has enumerated directories containing vulnerability testing and cyber related content and facilities data such as construction drawings.(Citation: CISA AA24-038A PRC Critical Infrastructure February 2024)
- [S0598] P.A.S. Webshell: [P.A.S. Webshell](https://attack.mitre.org/software/S0598) has the ability to list files and file characteristics including extension, size, ownership, and permissions.(Citation: ANSSI Sandworm January 2021)
- [S0534] Bazar: [Bazar](https://attack.mitre.org/software/S0534) can enumerate the victim's desktop.(Citation: Cybereason Bazar July 2020)(Citation: NCC Group Team9 June 2020)
- [S0115] Crimson: [Crimson](https://attack.mitre.org/software/S0115) contains commands to list files and directories, as well as search for files matching certain extensions from a defined list.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022)
- [S0242] SynAck: [SynAck](https://attack.mitre.org/software/S0242) checks its directory location in an attempt to avoid launching in a sandbox.(Citation: SecureList SynAck Doppelgänging May 2018)(Citation: Kaspersky Lab SynAck May 2018)
- [G0040] Patchwork: A [Patchwork](https://attack.mitre.org/groups/G0040) payload has searched all fixed drives on the victim for files matching a specified list of extensions.(Citation: Cymmetria Patchwork)(Citation: TrendMicro Patchwork Dec 2017)
- [G0054] Sowbug: [Sowbug](https://attack.mitre.org/groups/G0054) identified and extracted all Word documents on a server by using a command containing * .doc and *.docx. The actors also searched for documents based on a specific date range and attempted to identify all installed software on a victim.(Citation: Symantec Sowbug Nov 2017)
- [S0248] yty: [yty](https://attack.mitre.org/software/S0248) gathers information on victim’s drives and has a plugin for document listing.(Citation: ASERT Donot March 2018)
- [S0586] TAINTEDSCRIBE: [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) can use <code>DirectoryList</code> to enumerate files in a specified directory.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE MAY 2020)
- [S0064] ELMER: [ELMER](https://attack.mitre.org/software/S0064) is capable of performing directory listings.(Citation: FireEye EPS Awakens Part 2)
- [S1042] SUGARDUMP: [SUGARDUMP](https://attack.mitre.org/software/S1042) can search for and collect data from specific Chrome, Opera, Microsoft Edge, and Firefox files, including any folders that have the string `Profile` in its name.(Citation: Mandiant UNC3890 Aug 2022)
- [C0015] C0015: During [C0015](https://attack.mitre.org/campaigns/C0015), the threat actors conducted a file listing discovery against multiple hosts to ensure locker encryption was successful.(Citation: DFIR Conti Bazar Nov 2021)
- [S0410] Fysbis: [Fysbis](https://attack.mitre.org/software/S0410) has the ability to search for files.(Citation: Fysbis Dr Web Analysis)
- [S0125] Remsec: [Remsec](https://attack.mitre.org/software/S0125) is capable of listing contents of folders on the victim. [Remsec](https://attack.mitre.org/software/S0125) also searches for custom network encryption software on victims.(Citation: Symantec Remsec IOCs)(Citation: Kaspersky ProjectSauron Full Report)(Citation: Kaspersky ProjectSauron Technical Analysis)
- [S0607] KillDisk: [KillDisk](https://attack.mitre.org/software/S0607) has used the <code>FindNextFile</code> command as part of its file deletion process.(Citation: Trend Micro KillDisk 2)
- [C0006] Operation Honeybee: During [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), the threat actors used a malicious DLL to search for files with specific keywords.(Citation: McAfee Honeybee)
- [S0059] WinMM: [WinMM](https://attack.mitre.org/software/S0059) sets a WH_CBT Windows hook to search for and capture files on the victim.(Citation: Baumgartner Naikon 2015)
- [G0047] Gamaredon Group: [Gamaredon Group](https://attack.mitre.org/groups/G0047) macros can scan for Microsoft Word and Excel files to inject with additional malicious macros. [Gamaredon Group](https://attack.mitre.org/groups/G0047) has also used its backdoors to automatically list interesting files (such as Office documents) found on a system.(Citation: ESET Gamaredon June 2020)(Citation: Unit 42 Gamaredon February 2022)
- [S0647] Turian: [Turian](https://attack.mitre.org/software/S0647) can search for specific files and list directories.(Citation: ESET BackdoorDiplomacy Jun 2021)
- [S0216] POORAIM: [POORAIM](https://attack.mitre.org/software/S0216) can conduct file browsing.(Citation: FireEye APT37 Feb 2018)
- [S0339] Micropsia: [Micropsia](https://attack.mitre.org/software/S0339) can perform a recursive directory listing for all volume drives available on the victim's machine and can also fetch specific files by their paths.(Citation: Radware Micropsia July 2018)
- [S0083] Misdat: [Misdat](https://attack.mitre.org/software/S0083) is capable of running commands to obtain a list of files and directories, as well as enumerating logical drives.(Citation: Cylance Dust Storm)
- [S0141] Winnti for Windows: [Winnti for Windows](https://attack.mitre.org/software/S0141) can check for the presence of specific files prior to moving to the next phase of execution.(Citation: Novetta Winnti April 2015)
- [S0049] GeminiDuke: [GeminiDuke](https://attack.mitre.org/software/S0049) collects information from the victim, including installed drivers, programs previously executed by users, programs and services configured to automatically run at startup, files and folders present in any user's home folder, files and folders present in any user's My Documents, programs installed to the Program Files folder, and recently accessed files, folders, and programs.(Citation: F-Secure The Dukes)
- [S0651] BoxCaon: [BoxCaon](https://attack.mitre.org/software/S0651) has searched for files on the system, such as documents located in the desktop folder.(Citation: Checkpoint IndigoZebra July 2021)
- [C0012] Operation CuckooBees: During [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), the threat actors used `dir c:\\` to search for files.(Citation: Cybereason OperationCuckooBees May 2022)
- [S0385] njRAT: [njRAT](https://attack.mitre.org/software/S0385) can browse file systems using a file manager module.(Citation: Fidelis njRAT June 2013)
- [S0048] PinchDuke: [PinchDuke](https://attack.mitre.org/software/S0048) searches for files created within a certain timeframe and whose file extension matches a predefined list.(Citation: F-Secure The Dukes)
- [S0466] WindTail: [WindTail](https://attack.mitre.org/software/S0466) has the ability to enumerate the users home directory and the path to its own application bundle.(Citation: objective-see windtail1 dec 2018)(Citation: objective-see windtail2 jan 2019)
- [G0035] Dragonfly: [Dragonfly](https://attack.mitre.org/groups/G0035) has used a batch script to gather folder and file names from victim hosts.(Citation: US-CERT TA18-074A)(Citation: Gigamon Berserk Bear October 2021)(Citation: CISA AA20-296A Berserk Bear December 2020)
- [S0347] AuditCred: [AuditCred](https://attack.mitre.org/software/S0347) can search through folders and files on the system.(Citation: TrendMicro Lazarus Nov 2018)
- [S0659] Diavol: [Diavol](https://attack.mitre.org/software/S0659) has a command to traverse the files and directories in a given path.(Citation: Fortinet Diavol July 2021)
- [S0633] Sliver: [Sliver](https://attack.mitre.org/software/S0633) can enumerate files on a target system.(Citation: GitHub Sliver File System August 2021)
- [S0139] PowerDuke: [PowerDuke](https://attack.mitre.org/software/S0139) has commands to get the current directory name as well as the size of a file. It also has commands to obtain information about logical drives, drive type, and free space.(Citation: Volexity PowerDuke November 2016)
- [S0475] BackConfig: [BackConfig](https://attack.mitre.org/software/S0475) has the ability to identify folders and files related to previous infections.(Citation: Unit 42 BackConfig May 2020)
- [S0239] Bankshot: [Bankshot](https://attack.mitre.org/software/S0239) searches for files on the victim's machine.(Citation: US-CERT Bankshot Dec 2017)
- [S1031] PingPull: [PingPull](https://attack.mitre.org/software/S1031) can enumerate storage volumes and folder contents of a compromised host.(Citation: Unit 42 PingPull Jun 2022)
- [S0065] 4H RAT: [4H RAT](https://attack.mitre.org/software/S0065) has the capability to obtain file and directory listings.(Citation: CrowdStrike Putter Panda)
- [S0181] FALLCHILL: [FALLCHILL](https://attack.mitre.org/software/S0181) can search files on a victim.(Citation: US-CERT FALLCHILL Nov 2017)
- [S0652] MarkiRAT: [MarkiRAT](https://attack.mitre.org/software/S0652) can look for files carrying specific extensions such as: .rtf, .doc, .docx, .xls, .xlsx, .ppt, .pptx, .pps, .ppsx, .txt, .gpg, .pkr, .kdbx, .key, and .jpb.(Citation: Kaspersky Ferocious Kitten Jun 2021)
- [S0091] Epic: [Epic](https://attack.mitre.org/software/S0091) recursively searches for all .doc files on the system and collects a directory listing of the Desktop, %TEMP%, and %WINDOWS%\Temp directories.(Citation: Kaspersky Turla)(Citation: Kaspersky Turla Aug 2014)
- [S0660] Clambling: [Clambling](https://attack.mitre.org/software/S0660) can browse directories on a compromised host.(Citation: Trend Micro DRBControl February 2020)(Citation: Talent-Jump Clambling February 2020)
- [S0472] down_new: [down_new](https://attack.mitre.org/software/S0472) has the ability to list the directories on a compromised host.(Citation: Trend Micro Tick November 2019)
- [S0446] Ryuk: [Ryuk](https://attack.mitre.org/software/S0446) has enumerated files and folders on all mounted drives.(Citation: CrowdStrike Ryuk January 2019)
- [S0650] QakBot: [QakBot](https://attack.mitre.org/software/S0650) can identify whether it has been run previously on a host by checking for a specified folder.(Citation: ATT QakBot April 2021)
- [S0428] PoetRAT: [PoetRAT](https://attack.mitre.org/software/S0428) has the ability to list files upon receiving the <code>ls</code> command from C2.(Citation: Talos PoetRAT April 2020)
- [S0689] WhisperGate: [WhisperGate](https://attack.mitre.org/software/S0689) can locate files based on hardcoded file extensions.(Citation: Microsoft WhisperGate January 2022)(Citation: Unit 42 WhisperGate January 2022)(Citation: Cisco Ukraine Wipers January 2022)(Citation: Medium S2W WhisperGate January 2022)
- [S0106] cmd: [cmd](https://attack.mitre.org/software/S0106) can be used to find files and directories with native functionality such as <code>dir</code> commands.(Citation: TechNet Dir)
- [S0345] Seasalt: [Seasalt](https://attack.mitre.org/software/S0345) has the capability to identify the drive type on a victim.(Citation: McAfee Oceansalt Oct 2018)
- [G0082] APT38: [APT38](https://attack.mitre.org/groups/G0082) have enumerated files and directories, or searched in specific locations within a compromised host.(Citation: CISA AA20-239A BeagleBoyz August 2020)
- [G0007] APT28: [APT28](https://attack.mitre.org/groups/G0007) has used [Forfiles](https://attack.mitre.org/software/S0193) to locate PDF, Excel, and Word documents during collection. The group also searched a compromised DCCC computer for specific terms.(Citation: Überwachung APT28 Forfiles June 2015)(Citation: DOJ GRU Indictment Jul 2018)
- [S0271] KEYMARBLE: [KEYMARBLE](https://attack.mitre.org/software/S0271) has a command to search for files on the victim’s machine.(Citation: US-CERT KEYMARBLE Aug 2018)
- [S0063] SHOTPUT: [SHOTPUT](https://attack.mitre.org/software/S0063) has a command to obtain a directory listing.(Citation: Palo Alto CVE-2015-3113 July 2015)
- [S0219] WINERACK: [WINERACK](https://attack.mitre.org/software/S0219) can enumerate files and directories.(Citation: FireEye APT37 Feb 2018)
- [S0348] Cardinal RAT: [Cardinal RAT](https://attack.mitre.org/software/S0348) checks its current working directory upon execution and also contains watchdog functionality that ensures its executable is located in the correct path (else it will rewrite the payload).(Citation: PaloAlto CardinalRat Apr 2017)
- [S0072] OwaAuth: [OwaAuth](https://attack.mitre.org/software/S0072) has a command to list its directory and logical drives.(Citation: Dell TG-3390)
- [S0055] RARSTONE: [RARSTONE](https://attack.mitre.org/software/S0055) obtains installer properties from Uninstall Registry Key entries to obtain information about installed applications and how to uninstall certain applications.(Citation: Camba RARSTONE)
- [S0437] Kivars: [Kivars](https://attack.mitre.org/software/S0437) has the ability to list drives on the infected host.(Citation: TrendMicro BlackTech June 2017)
- [S0089] BlackEnergy: [BlackEnergy](https://attack.mitre.org/software/S0089) gathers a list of installed apps from the uninstall program Registry. It also gathers registered mail, browser, and instant messaging clients from the Registry. [BlackEnergy](https://attack.mitre.org/software/S0089) has searched for given file types.(Citation: F-Secure BlackEnergy 2014)(Citation: Securelist BlackEnergy Nov 2014)
- [S1090] NightClub: [NightClub](https://attack.mitre.org/software/S1090) can use a file monitor to identify .lnk, .doc, .docx, .xls, .xslx, and .pdf files.(Citation: MoustachedBouncer ESET August 2023)
- [S1141] LunarWeb: [LunarWeb](https://attack.mitre.org/software/S1141) has the ability to retrieve directory listings.(Citation: ESET Turla Lunar toolset May 2024)
- [S0366] WannaCry: [WannaCry](https://attack.mitre.org/software/S0366) searches for variety of user files by file extension before encrypting them using RSA and AES, including Office, PDF, image, audio, video, source code, archive/compression format, and key and certificate files.(Citation: LogRhythm WannaCry)(Citation: FireEye WannaCry 2017)
- [S0516] SoreFang: [SoreFang](https://attack.mitre.org/software/S0516) has the ability to list directories.(Citation: CISA SoreFang July 2016)
- [S0129] AutoIt backdoor: [AutoIt backdoor](https://attack.mitre.org/software/S0129) is capable of identifying documents on the victim with the following extensions: .doc; .pdf, .csv, .ppt, .docx, .pst, .xls, .xlsx, .pptx, and .jpeg.(Citation: Forcepoint Monsoon)
- [S0572] Caterpillar WebShell: [Caterpillar WebShell](https://attack.mitre.org/software/S0572) can search for files in directories.(Citation: ClearSky Lebanese Cedar Jan 2021)
- [G0100] Inception: [Inception](https://attack.mitre.org/groups/G0100) used a file listing plugin to collect information about file and directories both on local and remote drives.(Citation: Symantec Inception Framework March 2018)
- [S0452] USBferry: [USBferry](https://attack.mitre.org/software/S0452) can detect the victim's file or folder list.(Citation: TrendMicro Tropic Trooper May 2020)
- [S0640] Avaddon: [Avaddon](https://attack.mitre.org/software/S0640) has searched for specific files prior to encryption.(Citation: Arxiv Avaddon Feb 2021)
- [S1040] Rclone: [Rclone](https://attack.mitre.org/software/S1040) can list files and directories with the `ls`, `lsd`, and `lsl` commands.(Citation: Rclone)
- [S0610] SideTwist: [SideTwist](https://attack.mitre.org/software/S0610) has the ability to search for specific files.(Citation: Check Point APT34 April 2021)
- [S0632] GrimAgent: [GrimAgent](https://attack.mitre.org/software/S0632) has the ability to enumerate files and directories on a compromised host.(Citation: Group IB GrimAgent July 2021)
- [S0468] Skidmap: [Skidmap](https://attack.mitre.org/software/S0468) has checked for the existence of specific files including <code>/usr/sbin/setenforce</code> and <code> /etc/selinux/config</code>. It also has the ability to monitor the cryptocurrency miner file and process. (Citation: Trend Micro Skidmap)
- [G1039] RedCurl: [RedCurl](https://attack.mitre.org/groups/G1039) has searched for and collected files on local and network drives.(Citation: therecord_redcurl)(Citation: group-ib_redcurl1)(Citation: group-ib_redcurl2)
- [S0350] zwShell: [zwShell](https://attack.mitre.org/software/S0350) can browse the file system.(Citation: McAfee Night Dragon)
- [S0412] ZxShell: [ZxShell](https://attack.mitre.org/software/S0412) has a command to open a file manager and explorer on the system.(Citation: Talos ZxShell Oct 2014)
- [S1149] CHIMNEYSWEEP: [CHIMNEYSWEEP](https://attack.mitre.org/software/S1149) has the ability to enumerate directories for files that match a set list.(Citation: Mandiant ROADSWEEP August 2022)
- [S0547] DropBook: [DropBook](https://attack.mitre.org/software/S0547) can collect the names of all files and folders in the Program Files directories.(Citation: Cybereason Molerats Dec 2020)(Citation: BleepingComputer Molerats Dec 2020)
- [S0436] TSCookie: [TSCookie](https://attack.mitre.org/software/S0436) has the ability to discover drive information on the infected host.(Citation: JPCert TSCookie March 2018)
- [G1047] Velvet Ant: [Velvet Ant](https://attack.mitre.org/groups/G1047) has enumerated local files and folders on victim devices.(Citation: Sygnia VelvetAnt 2024A)
- [S0236] Kwampirs: [Kwampirs](https://attack.mitre.org/software/S0236) collects a list of files and directories in C:\ with the command <code>dir /s /a c:\ >> "C:\windows\TEMP\[RANDOM].tmp"</code>.(Citation: Symantec Orangeworm April 2018)
- [S1100] Ninja: [Ninja](https://attack.mitre.org/software/S1100) has the ability to enumerate directory content.(Citation: Kaspersky ToddyCat June 2022)(Citation: Kaspersky ToddyCat Check Logs October 2023)
- [S0201] JPIN: [JPIN](https://attack.mitre.org/software/S0201) can enumerate drives and their types. It can also change file permissions using cacls.exe.(Citation: Microsoft PLATINUM April 2016)
- [S0086] ZLib: [ZLib](https://attack.mitre.org/software/S0086) has the ability to enumerate files and drives.(Citation: Cylance Dust Storm)
- [S0036] FLASHFLOOD: [FLASHFLOOD](https://attack.mitre.org/software/S0036) searches for interesting files (either a default or customized set of file extensions) on the local system and removable media.(Citation: FireEye APT30)
- [S0447] Lokibot: [Lokibot](https://attack.mitre.org/software/S0447) can search for specific files on an infected host.(Citation: Talos Lokibot Jan 2021)
- [S0376] HOPLIGHT: [HOPLIGHT](https://attack.mitre.org/software/S0376) has been observed enumerating system drives and partitions.(Citation: US-CERT HOPLIGHT Apr 2019)
- [G0114] Chimera: [Chimera](https://attack.mitre.org/groups/G0114) has utilized multiple commands to identify data of interest in file and directory listings.(Citation: NCC Group Chimera January 2021)
- [S1169] Mango: [Mango](https://attack.mitre.org/software/S1169) can enumerate the contents of current working or other specified directories.(Citation: ESET OilRig Campaigns Sep 2023)
- [S0337] BadPatch: [BadPatch](https://attack.mitre.org/software/S0337) searches for files with specific file extensions.(Citation: Unit 42 BadPatch Oct 2017)
- [S0034] NETEAGLE: [NETEAGLE](https://attack.mitre.org/software/S0034) allows adversaries to enumerate and modify the infected host's file system. It supports searching for directories, creating directories, listing directory contents, reading and writing to files, retrieving file attributes, and retrieving volume information.(Citation: FireEye APT30)
- [S0663] SysUpdate: [SysUpdate](https://attack.mitre.org/software/S0663) can search files on a compromised host.(Citation: Trend Micro Iron Tiger April 2021)(Citation: Lunghi Iron Tiger Linux)
- [S1160] Latrodectus: [Latrodectus](https://attack.mitre.org/software/S1160) can collect desktop filenames.(Citation: Latrodectus APR 2024)(Citation: Bitsight Latrodectus June 2024)(Citation: Elastic Latrodectus May 2024)
- [S1202] LockBit 3.0: [LockBit 3.0](https://attack.mitre.org/software/S1202) can exclude files associated with core system functions from encryption.(Citation: Joint Cybersecurity Advisory LockBit 3.0 MAR 2023)
- [S0414] BabyShark: [BabyShark](https://attack.mitre.org/software/S0414) has used <code>dir</code> to search for "programfiles" and "appdata".(Citation: Unit42 BabyShark Feb 2019)
- [G0018] admin@338: [admin@338](https://attack.mitre.org/groups/G0018) actors used the following commands after exploiting a machine with [LOWBALL](https://attack.mitre.org/software/S0042) malware to obtain information about files and directories: <code>dir c:\ >> %temp%\download</code> <code>dir "c:\Documents and Settings" >> %temp%\download</code> <code>dir "c:\Program Files\" >> %temp%\download</code> <code>dir d:\ >> %temp%\download</code>(Citation: FireEye admin@338)
- [S0149] MoonWind: [MoonWind](https://attack.mitre.org/software/S0149) has a command to return a directory listing for a specified directory.(Citation: Palo Alto MoonWind March 2017)
- [G0004] Ke3chang: [Ke3chang](https://attack.mitre.org/groups/G0004) uses command-line interaction to search files and directories.(Citation: Mandiant Operation Ke3chang November 2014)(Citation: Microsoft NICKEL December 2021)
- [S0576] MegaCortex: [MegaCortex](https://attack.mitre.org/software/S0576) can parse the available drives and directories to determine which files to encrypt.(Citation: IBM MegaCortex)
- [S1153] Cuckoo Stealer: [Cuckoo Stealer](https://attack.mitre.org/software/S1153) can search for files associated with specific applications.(Citation: Kandji Cuckoo April 2024)(Citation: SentinelOne Cuckoo Stealer May 2024)
- [S0147] Pteranodon: [Pteranodon](https://attack.mitre.org/software/S0147) identifies files matching certain file extension and copies them to subdirectories it created.(Citation: Palo Alto Gamaredon Feb 2017)
- [S0492] CookieMiner: [CookieMiner](https://attack.mitre.org/software/S0492) has looked for files in the user's home directory with "wallet" in their name using <code>find</code>.(Citation: Unit42 CookieMiner Jan 2019)
- [S0235] CrossRAT: [CrossRAT](https://attack.mitre.org/software/S0235) can list all files on a system.(Citation: Lookout Dark Caracal Jan 2018)
- [S0616] DEATHRANSOM: [DEATHRANSOM](https://attack.mitre.org/software/S0616) can use loop operations to enumerate directories on a compromised host.(Citation: FireEye FiveHands April 2021)
- [S0259] InnaputRAT: [InnaputRAT](https://attack.mitre.org/software/S0259) enumerates directories and obtains file attributes on a system.(Citation: ASERT InnaputRAT April 2018)
- [S0559] SUNBURST: [SUNBURST](https://attack.mitre.org/software/S0559) had commands to enumerate files and directories.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: Microsoft Analyzing Solorigate Dec 2020)
- [S1184] BOLDMOVE: [BOLDMOVE](https://attack.mitre.org/software/S1184) can list information of all files in the system recursively from the root directory or from a specified directory.(Citation: Google Cloud BOLDMOVE 2023)
- [S0625] Cuba: [Cuba](https://attack.mitre.org/software/S0625) can enumerate files by using a variety of functions.(Citation: McAfee Cuba April 2021)
- [S0211] Linfo: [Linfo](https://attack.mitre.org/software/S0211) creates a backdoor through which remote attackers can list contents of drives and search for files.(Citation: Symantec Linfo May 2012)
- [S0050] CosmicDuke: [CosmicDuke](https://attack.mitre.org/software/S0050) searches attached and mounted drives for file extensions and keywords that match a predefined list.(Citation: F-Secure Cosmicduke)
- [G0034] Sandworm Team: [Sandworm Team](https://attack.mitre.org/groups/G0034) has enumerated files on a compromised host.(Citation: US District Court Indictment GRU Unit 74455 October 2020)(Citation: Dragos Crashoverride 2018)
- [S1140] Spica: [Spica](https://attack.mitre.org/software/S1140) can list filesystem contents on targeted systems.(Citation: Google TAG COLDRIVER January 2024)
- [S0265] Kazuar: [Kazuar](https://attack.mitre.org/software/S0265) finds a specified directory, lists the files and metadata about those files.(Citation: Unit 42 Kazuar May 2017)
- [S0161] XAgentOSX: [XAgentOSX](https://attack.mitre.org/software/S0161) contains the readFiles function to return a detailed listing (sometimes recursive) of a specified directory.(Citation: XAgentOSX 2017) [XAgentOSX](https://attack.mitre.org/software/S0161) contains the showBackupIosFolder function to check for IOS device backups by running <code>ls -la ~/Library/Application\ Support/MobileSync/Backup/</code>.(Citation: XAgentOSX 2017)
- [S0697] HermeticWiper: [HermeticWiper](https://attack.mitre.org/software/S0697) can enumerate common folders such as My Documents, Desktop, and AppData.(Citation: SentinelOne Hermetic Wiper February 2022)(Citation: Qualys Hermetic Wiper March 2022)
- [S0687] Cyclops Blink: [Cyclops Blink](https://attack.mitre.org/software/S0687) can use the Linux API `statvfs` to enumerate the current working directory.(Citation: NCSC Cyclops Blink February 2022)(Citation: Trend Micro Cyclops Blink March 2022)
- [S0618] FIVEHANDS: [FIVEHANDS](https://attack.mitre.org/software/S0618) has the ability to enumerate files on a compromised host in order to encrypt files with specific extensions.(Citation: CISA AR21-126A FIVEHANDS May 2021)(Citation: NCC Group Fivehands June 2021)
- [S1070] Black Basta: [Black Basta](https://attack.mitre.org/software/S1070) can enumerate specific files for encryption.(Citation: Cyble Black Basta May 2022)(Citation: Avertium Black Basta June 2022)(Citation: NCC Group Black Basta June 2022)(Citation: Uptycs Black Basta ESXi June 2022)(Citation: Deep Instinct Black Basta August 2022)(Citation: Palo Alto Networks Black Basta August 2022)(Citation: Trend Micro Black Basta Spotlight September 2022)(Citation: Check Point Black Basta October 2022)
- [S0154] Cobalt Strike: [Cobalt Strike](https://attack.mitre.org/software/S0154) can explore files on a compromised system.(Citation: Cobalt Strike Manual 4.3 November 2020)
- [S0673] DarkWatchman: [DarkWatchman](https://attack.mitre.org/software/S0673) has the ability to enumerate file and folder names.(Citation: Prevailion DarkWatchman 2021)
- [S0604] Industroyer: [Industroyer](https://attack.mitre.org/software/S0604)’s data wiper component enumerates specific files on all the Windows drives.(Citation: ESET Industroyer)
- [S0252] Brave Prince: [Brave Prince](https://attack.mitre.org/software/S0252) gathers file and directory information from the victim’s machine.(Citation: McAfee Gold Dragon)
- [S0346] OceanSalt: [OceanSalt](https://attack.mitre.org/software/S0346) can extract drive information from the endpoint and search files on the system.(Citation: McAfee Oceansalt Oct 2018)
- [S0198] NETWIRE: [NETWIRE](https://attack.mitre.org/software/S0198) has the ability to search for files on the compromised host.(Citation: Proofpoint NETWIRE December 2020)
- [S1156] Manjusaka: [Manjusaka](https://attack.mitre.org/software/S1156) can gather information about specific files on the victim system.(Citation: Talos Manjusaka 2022)
- [G0121] Sidewinder: [Sidewinder](https://attack.mitre.org/groups/G0121) has used malware to collect information on files and directories.(Citation: ATT Sidewinder January 2021)
- [S0131] TINYTYPHON: [TINYTYPHON](https://attack.mitre.org/software/S0131) searches through the drive containing the OS, then all drive letters C through to Z, for documents matching certain extensions.(Citation: Forcepoint Monsoon)
- [S0340] Octopus: [Octopus](https://attack.mitre.org/software/S0340) can collect information on the Windows directory and searches for compressed RAR files on the host.(Citation: Securelist Octopus Oct 2018)(Citation: Security Affairs DustSquad Oct 2018)(Citation: ESET Nomadic Octopus 2018)
- [S0562] SUNSPOT: [SUNSPOT](https://attack.mitre.org/software/S0562) enumerated the Orion software Visual Studio solution directory path.(Citation: CrowdStrike SUNSPOT Implant January 2021)
- [S0672] Zox: [Zox](https://attack.mitre.org/software/S0672) can enumerate files on a compromised host.(Citation: Novetta-Axiom)
- [S0081] Elise: A variant of [Elise](https://attack.mitre.org/software/S0081) executes <code>dir C:\progra~1</code> when initially run.(Citation: Lotus Blossom Jun 2015)(Citation: Accenture Dragonfish Jan 2018)
- [S0268] Bisonal: [Bisonal](https://attack.mitre.org/software/S0268) can retrieve a file listing from the system.(Citation: Kaspersky CactusPete Aug 2020)(Citation: Talos Bisonal Mar 2020)
- [S0051] MiniDuke: [MiniDuke](https://attack.mitre.org/software/S0051) can enumerate local drives.(Citation: ESET Dukes October 2019)
- [S0575] Conti: [Conti](https://attack.mitre.org/software/S0575) can discover files on a local system.(Citation: CarbonBlack Conti July 2020)
- [S0533] SLOTHFULMEDIA: [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) can enumerate files and directories.(Citation: CISA MAR SLOTHFULMEDIA October 2020)
- [S0045] ADVSTORESHELL: [ADVSTORESHELL](https://attack.mitre.org/software/S0045) can list files and directories.(Citation: ESET Sednit Part 2)(Citation: Bitdefender APT28 Dec 2015)
- [S0182] FinFisher: [FinFisher](https://attack.mitre.org/software/S0182) enumerates directories and scans for certain files.(Citation: FinFisher Citation)(Citation: Microsoft FinFisher March 2018)
- [S1179] Exbyte: [Exbyte](https://attack.mitre.org/software/S1179) enumerates all document files on an infected machine, then creates a summary of these items including filename and directory location prior to exfiltration to cloud hosting services.(Citation: Symantec BlackByte 2022)
- [S1102] Pcexter: [Pcexter](https://attack.mitre.org/software/S1102) has the ability to search for files in specified directories.(Citation: Kaspersky ToddyCat Check Logs October 2023)
- [S1101] LoFiSe: [LoFiSe](https://attack.mitre.org/software/S1101) can monitor the file system to identify files less than 6.4 MB in size with file extensions including .doc, .docx, .xls, .xlsx, .ppt, .pptx, .pdf, .rtf, .tif, .odt, .ods, .odp, .eml, and .msg.(Citation: Kaspersky ToddyCat Check Logs October 2023)
- [S0473] Avenger: [Avenger](https://attack.mitre.org/software/S0473) has the ability to browse files in directories such as Program Files and the Desktop.(Citation: Trend Micro Tick November 2019)
- [S1105] COATHANGER: [COATHANGER](https://attack.mitre.org/software/S1105) will survey the contents of system files during installation.(Citation: NCSC-NL COATHANGER Feb 2024)
- [S0674] CharmPower: [CharmPower](https://attack.mitre.org/software/S0674) can enumerate drives and list the contents of the C: drive on a victim's computer.(Citation: Check Point APT35 CharmPower January 2022)
- [S0496] REvil: [REvil](https://attack.mitre.org/software/S0496) has the ability to identify specific files and directories that are not to be encrypted.(Citation: Kaspersky Sodin July 2019)(Citation: Cylance Sodinokibi July 2019)(Citation: Secureworks GandCrab and REvil September 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: Intel 471 REvil March 2020)(Citation: Secureworks REvil September 2019)
- [C0024] SolarWinds Compromise: During the [SolarWinds Compromise](https://attack.mitre.org/campaigns/C0024), [APT29](https://attack.mitre.org/groups/G0016) obtained information about the configured Exchange virtual directory using `Get-WebServicesVirtualDirectory`.(Citation: Volexity SolarWinds)
- [S0363] Empire: [Empire](https://attack.mitre.org/software/S0363) includes various modules for finding files of interest on hosts and network shares.(Citation: Github PowerShell Empire)
- [S0192] Pupy: [Pupy](https://attack.mitre.org/software/S0192) can walk through directories and recursively search for strings in files.(Citation: GitHub Pupy)
- [G1015] Scattered Spider: [Scattered Spider](https://attack.mitre.org/groups/G1015) Spider enumerates a target organization for files and directories of interest, including source code.(Citation: CISA Scattered Spider Advisory November 2023)(Citation: MSTIC Octo Tempest Operations October 2023)
- [S1185] LightSpy: [LightSpy](https://attack.mitre.org/software/S1185) uses the `NSFileManager` to move, create and delete files. [LightSpy](https://attack.mitre.org/software/S1185) can also use the assembly `bt` instruction to determine a file's executable permissions.(Citation: Huntress LightSpy macOS 2024)
- [S0666] Gelsemium: [Gelsemium](https://attack.mitre.org/software/S0666) can retrieve data from specific Windows directories, as well as open random files as part of [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497).(Citation: ESET Gelsemium June 2021)
- [G1007] Aoqin Dragon: [Aoqin Dragon](https://attack.mitre.org/groups/G1007) has run scripts to identify file formats including Microsoft Word.(Citation: SentinelOne Aoqin Dragon June 2022)
- [S0238] Proxysvc: [Proxysvc](https://attack.mitre.org/software/S0238) lists files in directories.(Citation: McAfee GhostSecret)
- [S1199] LockBit 2.0: [LockBit 2.0](https://attack.mitre.org/software/S1199) can exclude files associated with core system functions from encryption.(Citation: FBI Lockbit 2.0 FEB 2022)
- [G0081] Tropic Trooper: [Tropic Trooper](https://attack.mitre.org/groups/G0081) has monitored files' modified time.(Citation: TrendMicro Tropic Trooper May 2020)
- [G0070] Dark Caracal: [Dark Caracal](https://attack.mitre.org/groups/G0070) collected file listings of all default Windows directories.(Citation: Lookout Dark Caracal Jan 2018)
- [S0237] GravityRAT: [GravityRAT](https://attack.mitre.org/software/S0237) collects the volumes mapped on the system, and also steals files with the following extensions: .docx, .doc, .pptx, .ppt, .xlsx, .xls, .rtf, and .pdf.(Citation: Talos GravityRAT)
- [S0234] Bandook: [Bandook](https://attack.mitre.org/software/S0234) has a command to list files on a system.(Citation: CheckPoint Bandook Nov 2020)
- [G0069] MuddyWater: [MuddyWater](https://attack.mitre.org/groups/G0069) has used malware that checked if the ProgramData folder had folders or files with the keywords "Kasper," "Panda," or "ESET."(Citation: Securelist MuddyWater Oct 2018)
- [S0094] Trojan.Karagany: [Trojan.Karagany](https://attack.mitre.org/software/S0094) can enumerate files and directories on a compromised host.(Citation: Secureworks Karagany July 2019)
- [S0378] PoshC2: [PoshC2](https://attack.mitre.org/software/S0378) can enumerate files on the local file system and includes a module for enumerating recently accessed files.(Citation: GitHub PoshC2)
- [S0066] 3PARA RAT: [3PARA RAT](https://attack.mitre.org/software/S0066) has a command to retrieve metadata for files on disk as well as a command to list the current working directory.(Citation: CrowdStrike Putter Panda)
- [S1159] DUSTTRAP: [DUSTTRAP](https://attack.mitre.org/software/S1159) can enumerate files and directories.(Citation: Google Cloud APT41 2024)
- [S0368] NotPetya: [NotPetya](https://attack.mitre.org/software/S0368) searches for files ending with dozens of different file extensions prior to encryption.(Citation: US District Court Indictment GRU Unit 74455 October 2020)
- [S0665] ThreatNeedle: [ThreatNeedle](https://attack.mitre.org/software/S0665) can obtain file and directory information.(Citation: Kaspersky ThreatNeedle Feb 2021)
- [S0635] BoomBox: [BoomBox](https://attack.mitre.org/software/S0635) can search for specific files and directories on a machine.(Citation: MSTIC Nobelium Toolset May 2021)
- [S1099] Samurai: [Samurai](https://attack.mitre.org/software/S1099) can use a specific module for file enumeration.(Citation: Kaspersky ToddyCat June 2022)
- [S0283] jRAT: [jRAT](https://attack.mitre.org/software/S0283) can browse file systems.(Citation: Kaspersky Adwind Feb 2016)(Citation: Symantec Frutas Feb 2013)
- [S0611] Clop: [Clop](https://attack.mitre.org/software/S0611) has searched folders and subfolders for files to encrypt.(Citation: Mcafee Clop Aug 2019)
- [S0493] GoldenSpy: [GoldenSpy](https://attack.mitre.org/software/S0493) has included a program "ExeProtector", which monitors for the existence of [GoldenSpy](https://attack.mitre.org/software/S0493) on the infected system and redownloads if necessary.(Citation: Trustwave GoldenSpy June 2020)
- [S1017] OutSteel: [OutSteel](https://attack.mitre.org/software/S1017) can search for specific file extensions, including zipped files.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 )
- [S0628] FYAnti: [FYAnti](https://attack.mitre.org/software/S0628) can search the <code>C:\Windows\Microsoft.NET\</code> directory for files of a specified size.(Citation: Securelist APT10 March 2021)
- [S0642] BADFLICK: [BADFLICK](https://attack.mitre.org/software/S0642) has searched for files on the infected host.(Citation: Accenture MUDCARP March 2019)
- [S0693] CaddyWiper: [CaddyWiper](https://attack.mitre.org/software/S0693) can enumerate all files and directories on a compromised host.(Citation: Malwarebytes IssacWiper CaddyWiper March 2022 )
- [S0603] Stuxnet: [Stuxnet](https://attack.mitre.org/software/S0603) uses a driver to scan for specific filesystem driver objects.(Citation: Nicolas Falliere, Liam O Murchu, Eric Chien February 2011)
- [S0023] CHOPSTICK: An older version of [CHOPSTICK](https://attack.mitre.org/software/S0023) has a module that monitors all mounted volumes for files with the extensions .doc, .docx, .pgp, .gpg, .m2f, or .m2o.(Citation: ESET Sednit Part 2)
- [S0251] Zebrocy: [Zebrocy](https://attack.mitre.org/software/S0251) searches for files that are 60mb and less and contain the following extensions: .doc, .docx, .xls, .xlsx, .ppt, .pptx, .exe, .zip, and .rar. [Zebrocy](https://attack.mitre.org/software/S0251) also runs the <code>echo %APPDATA%</code> command to list the contents of the directory.(Citation: Securelist Sofacy Feb 2018)(Citation: ESET Zebrocy Nov 2018)(Citation: ESET Zebrocy May 2019) [Zebrocy](https://attack.mitre.org/software/S0251) can obtain the current execution path as well as perform drive enumeration.(Citation: Accenture SNAKEMACKEREL Nov 2018)(Citation: CISA Zebrocy Oct 2020)
- [S1053] AvosLocker: [AvosLocker](https://attack.mitre.org/software/S1053) has searched for files and directories on a compromised network.(Citation: Malwarebytes AvosLocker Jul 2021)(Citation: Trend Micro AvosLocker Apr 2022)
- [G0059] Magic Hound: [Magic Hound](https://attack.mitre.org/groups/G0059) malware can list a victim's logical drives and the type, as well the total/free space of the fixed devices. Other malware can list a directory's contents.(Citation: Unit 42 Magic Hound Feb 2017)
- [S0435] PLEAD: [PLEAD](https://attack.mitre.org/software/S0435) has the ability to list drives and files on the compromised host.(Citation: TrendMicro BlackTech June 2017)(Citation: JPCert PLEAD Downloader June 2018)
- [S0439] Okrum: [Okrum](https://attack.mitre.org/software/S0439) has used DriveLetterView to enumerate drive information.(Citation: ESET Okrum July 2019)
- [S0644] ObliqueRAT: [ObliqueRAT](https://attack.mitre.org/software/S0644) has the ability to recursively enumerate files on an infected endpoint.(Citation: Talos Oblique RAT March 2021)
- [S0127] BBSRAT: [BBSRAT](https://attack.mitre.org/software/S0127) can list file and directory information.(Citation: Palo Alto Networks BBSRAT)
- [S0491] StrongPity: [StrongPity](https://attack.mitre.org/software/S0491) can parse the hard drive on a compromised host to identify specific file extensions.(Citation: Talos Promethium June 2020)
- [S1196] Troll Stealer: [Troll Stealer](https://attack.mitre.org/software/S1196) can enumerate and collect items from local drives and folders.(Citation: S2W Troll Stealer 2024)
- [S0686] QuietSieve: [QuietSieve](https://attack.mitre.org/software/S0686) can search files on the target host by extension, including doc, docx, xls, rtf, odt, txt, jpg, pdf, rar, zip, and 7z.(Citation: Microsoft Actinium February 2022)
- [S0240] ROKRAT: [ROKRAT](https://attack.mitre.org/software/S0240) has the ability to gather a list of files and directories on the infected system.(Citation: Securelist ScarCruft May 2019)(Citation: NCCGroup RokRat Nov 2018)(Citation: Volexity InkySquid RokRAT August 2021)
- [G0139] TeamTNT: [TeamTNT](https://attack.mitre.org/groups/G0139) has used a script that checks `/proc/*/environ` for environment variables related to AWS.(Citation: Cisco Talos Intelligence Group)
- [S1170] ODAgent: [ODAgent](https://attack.mitre.org/software/S1170) can identify the current working directory.(Citation: ESET OilRig Downloaders DEC 2023)
- [S0431] HotCroissant: [HotCroissant](https://attack.mitre.org/software/S0431) has the ability to retrieve a list of files in a given directory as well as drives and drive types.(Citation: Carbon Black HotCroissant April 2020)
- [S1130] Raspberry Robin: [Raspberry Robin](https://attack.mitre.org/software/S1130) will check to see if the initial executing script is located on the user's Desktop as an anti-analysis check.(Citation: HP RaspberryRobin 2024)
- [S0643] Peppy: [Peppy](https://attack.mitre.org/software/S0643) can identify specific files for exfiltration.(Citation: Proofpoint Operation Transparent Tribe March 2016)
- [S0078] Psylo: [Psylo](https://attack.mitre.org/software/S0078) has commands to enumerate all storage devices and to find all files that start with a particular string.(Citation: Scarlet Mimic Jan 2016)
- [S0600] Doki: [Doki](https://attack.mitre.org/software/S0600) has resolved the path of a process PID to use as a script argument.(Citation: Intezer Doki July 20)
- [S1114] ZIPLINE: [ZIPLINE](https://attack.mitre.org/software/S1114) can find and append specific files on Ivanti Connect Secure VPNs based upon received commands.(Citation: Mandiant Cutting Edge January 2024)
- [G0030] Lotus Blossom: [Lotus Blossom](https://attack.mitre.org/groups/G0030) has used commands such as `dir` to examine the local filesystem of victim machines.(Citation: Cisco LotusBlossom 2025)
- [S0250] Koadic: [Koadic](https://attack.mitre.org/software/S0250) can obtain a list of directories.(Citation: MalwareBytes LazyScripter Feb 2021)
- [S0564] BlackMould: [BlackMould](https://attack.mitre.org/software/S0564) has the ability to find files on the targeted system.(Citation: Microsoft GALLIUM December 2019)
- [S1023] CreepyDrive: [CreepyDrive](https://attack.mitre.org/software/S1023) can specify the local file path to upload files from.(Citation: Microsoft POLONIUM June 2022)
- [G1014] LuminousMoth: [LuminousMoth](https://attack.mitre.org/groups/G1014) has used malware that scans for files in the Documents, Desktop, and Download folders and in other drives.(Citation: Kaspersky LuminousMoth July 2021)(Citation: Bitdefender LuminousMoth July 2021)
- [C0014] Operation Wocao: During [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors gathered a recursive directory listing to find files and directories of interest.(Citation: FoxIT Wocao December 2019)
- [S0184] POWRUNER: [POWRUNER](https://attack.mitre.org/software/S0184) may enumerate user directories on a victim.(Citation: FireEye APT34 Dec 2017)
- [S0387] KeyBoy: [KeyBoy](https://attack.mitre.org/software/S0387) has a command to launch a file browser or explorer on the system.(Citation: PWC KeyBoys Feb 2017)
- [S0567] Dtrack: [Dtrack](https://attack.mitre.org/software/S0567) can list files on available disk volumes.(Citation: Securelist Dtrack)(Citation: CyberBit Dtrack)
- [S0031] BACKSPACE: [BACKSPACE](https://attack.mitre.org/software/S0031) allows adversaries to search for files.(Citation: FireEye APT30)
- [S0255] DDKONG: [DDKONG](https://attack.mitre.org/software/S0255) lists files on the victim’s machine.(Citation: Rancor Unit42 June 2018)
- [S0354] Denis: [Denis](https://attack.mitre.org/software/S0354) has several commands to search directories for files.(Citation: Cybereason Oceanlotus May 2017)(Citation: Cybereason Cobalt Kitty 2017)
- [S1142] LunarMail: [LunarMail](https://attack.mitre.org/software/S1142) can search its staging directory for output files it has produced.(Citation: ESET Turla Lunar toolset May 2024)
- [S1139] INC Ransomware: [INC Ransomware](https://attack.mitre.org/software/S1139) can receive command line arguments to encrypt specific files and directories.(Citation: Cybereason INC Ransomware November 2023)(Citation: SentinelOne INC Ransomware)
- [S0402] OSX/Shlayer: [OSX/Shlayer](https://attack.mitre.org/software/S0402) has used the command <code>appDir="$(dirname $(dirname "$currentDir"))"</code> and <code>$(dirname "$(pwd -P)")</code> to construct installation paths.(Citation: sentinelone shlayer to zshlayer)(Citation: 20 macOS Common Tools and Techniques)
- [S1027] Heyoka Backdoor: [Heyoka Backdoor](https://attack.mitre.org/software/S1027) has the ability to search the compromised host for files.(Citation: SentinelOne Aoqin Dragon June 2022)
- [S0193] Forfiles: [Forfiles](https://attack.mitre.org/software/S0193) can be used to locate certain types of files/directories in a system.(ex: locate all files with a specific extension, name, and/or age)(Citation: Überwachung APT28 Forfiles June 2015)
- [S0498] Cryptoistic: [Cryptoistic](https://attack.mitre.org/software/S0498) can scan a directory to identify files for deletion.(Citation: SentinelOne Lazarus macOS July 2020)
- [S1111] DarkGate: Some versions of [DarkGate](https://attack.mitre.org/software/S1111) search for the hard-coded folder <code>C:\Program Files\e Carte Bleue</code>.(Citation: Ensilo Darkgate 2018)
- [S1212] RansomHub: [RansomHub](https://attack.mitre.org/software/S1212) has the ability to only encrypt specific files.(Citation: Group-IB RansomHub FEB 2025)
- [S0212] CORALDECK: [CORALDECK](https://attack.mitre.org/software/S0212) searches for specified files.(Citation: FireEye APT37 Feb 2018)
- [S0070] HTTPBrowser: [HTTPBrowser](https://attack.mitre.org/software/S0070) is capable of listing files, folders, and drives on a victim.(Citation: Dell TG-3390)(Citation: ZScaler Hacking Team)
- [C0022] Operation Dream Job: During [Operation Dream Job](https://attack.mitre.org/campaigns/C0022), [Lazarus Group](https://attack.mitre.org/groups/G0032) conducted word searches within documents on a compromised host in search of security and financial matters.(Citation: ClearSky Lazarus Aug 2020)
- [S0144] ChChes: [ChChes](https://attack.mitre.org/software/S0144) collects the victim's %TEMP% directory path and version of Internet Explorer.(Citation: FireEye APT10 April 2017)
- [G0022] APT3: [APT3](https://attack.mitre.org/groups/G0022) has a tool that looks for files and directories on the local file system.(Citation: FireEye Clandestine Fox)(Citation: evolution of pirpi)
- [G0050] APT32: [APT32](https://attack.mitre.org/groups/G0050)'s backdoor possesses the capability to list files and directories on a machine. (Citation: ESET OceanLotus Mar 2019)
- [G0129] Mustang Panda: [Mustang Panda](https://attack.mitre.org/groups/G0129) has searched the entire target system for DOC, DOCX, PPT, PPTX, XLS, XLSX, and PDF files.(Citation: Avira Mustang Panda January 2020)
- [S0208] Pasam: [Pasam](https://attack.mitre.org/software/S0208) creates a backdoor through which remote attackers can retrieve lists of files.(Citation: Symantec Pasam May 2012)
- [S1059] metaMain: [metaMain](https://attack.mitre.org/software/S1059) can recursively enumerate files in an operator-provided directory.(Citation: SentinelLabs Metador Sept 2022)(Citation: SentinelLabs Metador Technical Appendix Sept 2022)
- [S0629] RainyDay: [RainyDay](https://attack.mitre.org/software/S0629) can use a file exfiltration tool to collect recently changed files with specific extensions.(Citation: Bitdefender Naikon April 2021)
- [S0260] InvisiMole: [InvisiMole](https://attack.mitre.org/software/S0260) can list information about files in a directory and recently opened or used documents. [InvisiMole](https://attack.mitre.org/software/S0260) can also search for specific files by supplied file mask.(Citation: ESET InvisiMole June 2018)
- [C0002] Night Dragon: During [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors used [zwShell](https://attack.mitre.org/software/S0350) to establish full remote control of the connected machine and browse the victim file system.(Citation: McAfee Night Dragon)
- [S0249] Gold Dragon: [Gold Dragon](https://attack.mitre.org/software/S0249) lists the directories for Desktop, program files, and the user’s recently accessed files.(Citation: McAfee Gold Dragon)
- [S1162] Playcrypt: [Playcrypt](https://attack.mitre.org/software/S1162) can avoid encrypting files with a .PLAY, .exe, .msi, .dll, .lnk, or .sys file extension.(Citation: Trend Micro Ransomware Spotlight Play July 2023)
- [S0622] AppleSeed: [AppleSeed](https://attack.mitre.org/software/S0622) has the ability to search for .txt, .ppt, .hwp, .pdf, and .doc files in specified directories.(Citation: Malwarebytes Kimsuky June 2021)
- [S0488] CrackMapExec: [CrackMapExec](https://attack.mitre.org/software/S0488) can discover specified filetypes and log files on a targeted system.(Citation: CME Github September 2018)
- [S0661] FoggyWeb: [FoggyWeb](https://attack.mitre.org/software/S0661)'s loader can check for the [FoggyWeb](https://attack.mitre.org/software/S0661) backdoor .pri file on a compromised AD FS server.(Citation: MSTIC FoggyWeb September 2021)
- [S0351] Cannon: [Cannon](https://attack.mitre.org/software/S0351) can obtain victim drive information as well as a list of folders in C:\Program Files.(Citation: Unit42 Cannon Nov 2018)
- [S0526] KGH_SPY: [KGH_SPY](https://attack.mitre.org/software/S0526) can enumerate files and directories on a compromised host.(Citation: Cybereason Kimsuky November 2020)
- [S1122] Mispadu: [Mispadu](https://attack.mitre.org/software/S1122) searches for various filesystem paths to determine what banking applications are installed on the victim’s machine.(Citation: ESET Security Mispadu Facebook Ads 2019)
- [S0612] WastedLocker: [WastedLocker](https://attack.mitre.org/software/S0612) can enumerate files and directories just prior to encryption.(Citation: NCC Group WastedLocker June 2020)
- [S0272] NDiskMonitor: [NDiskMonitor](https://attack.mitre.org/software/S0272) can obtain a list of all files and directories as well as logical drives.(Citation: TrendMicro Patchwork Dec 2017)
- [S0015] Ixeshe: [Ixeshe](https://attack.mitre.org/software/S0015) can list file and directory information.(Citation: Trend Micro IXESHE 2012)
- [S1194] Akira _v2: [Akira _v2](https://attack.mitre.org/software/S1194) can target specific files and folders for encryption.(Citation: CISA Akira Ransomware APR 2024)(Citation: Cisco Akira Ransomware OCT 2024)(Citation: Palo Alto Howling Scorpius DEC 2024)
- [S0093] Backdoor.Oldrea: [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) collects information about available drives, default browser, desktop file list, My Documents, Internet history, program files, and root of available drives. It also searches for ICS-related software files.(Citation: Symantec Dragonfly)
- [S0021] Derusbi: [Derusbi](https://attack.mitre.org/software/S0021) is capable of obtaining directory, file, and drive listings.(Citation: Fidelis Turbo)(Citation: FireEye Periscope March 2018)
- [S0623] Siloscape: [Siloscape](https://attack.mitre.org/software/S0623) searches for the Kubernetes config file and other related files using a regular expression.(Citation: Unit 42 Siloscape Jun 2021)
- [G0087] APT39: [APT39](https://attack.mitre.org/groups/G0087) has used tools with the ability to search for files on a compromised host.(Citation: FBI FLASH APT39 September 2020)
- [G1022] ToddyCat: [ToddyCat](https://attack.mitre.org/groups/G1022) has run scripts to enumerate recently modified documents having either a .pdf, .doc, .docx, .xls or .xlsx extension.(Citation: Kaspersky ToddyCat Check Logs October 2023)
- [S1034] StrifeWater: [StrifeWater](https://attack.mitre.org/software/S1034) can enumerate files on a compromised host.(Citation: Cybereason StrifeWater Feb 2022)
- [S0079] MobileOrder: [MobileOrder](https://attack.mitre.org/software/S0079) has a command to upload to its C2 server information about files on the victim mobile device, including SD card size, installed app list, SMS content, contacts, and calling history.(Citation: Scarlet Mimic Jan 2016)
- [S0657] BLUELIGHT: [BLUELIGHT](https://attack.mitre.org/software/S0657) can enumerate files and collect associated metadata.(Citation: Volexity InkySquid BLUELIGHT August 2021)
- [S1043] ccf32: [ccf32](https://attack.mitre.org/software/S1043) can parse collected files to identify specific file extensions.(Citation: Bitdefender FunnyDream Campaign November 2020)
- [G0032] Lazarus Group: [Lazarus Group](https://attack.mitre.org/groups/G0032) malware can use a common function to identify target files by their extension, and some also enumerate files and directories, including a Destover-like variant that lists files and gathers information for all drives.(Citation: Novetta Blockbuster)(Citation: McAfee GhostSecret)(Citation: Lazarus APT January 2022)(Citation: Qualys LolZarus)
- [S0692] SILENTTRINITY: [SILENTTRINITY](https://attack.mitre.org/software/S0692) has several modules, such as `ls.py`, `pwd.py`, and `recentFiles.py`, to enumerate directories and files.(Citation: GitHub SILENTTRINITY Modules July 2019)
- [G0012] Darkhotel: [Darkhotel](https://attack.mitre.org/groups/G0012) has used malware that searched for files with specific patterns.(Citation: Microsoft DUBNIUM July 2016)
- [S0467] TajMahal: [TajMahal](https://attack.mitre.org/software/S0467) has the ability to index files from drives, user profiles, and removable drives.(Citation: Kaspersky TajMahal April 2019)
- [S1058] Prestige: [Prestige](https://attack.mitre.org/software/S1058) can traverse the file system to discover files to encrypt by identifying specific extensions defined in a hardcoded list.(Citation: Microsoft Prestige ransomware October 2022)
- [S1198] Gomir: [Gomir](https://attack.mitre.org/software/S1198) collects information about directory and file structures, including total number of subdirectories, total number of files, and total size of files on infected systems.(Citation: Symantec Troll Stealer 2024)
- [G1040] Play: [Play](https://attack.mitre.org/groups/G1040) has used the Grixba information stealer to list security files and processes.(Citation: Trend Micro Ransomware Spotlight Play July 2023)
- [S0157] SOUNDBITE: [SOUNDBITE](https://attack.mitre.org/software/S0157) is capable of enumerating and manipulating files and directories.(Citation: FireEye APT32 May 2017)
- [S0592] RemoteUtilities: [RemoteUtilities](https://attack.mitre.org/software/S0592) can enumerate files and directories on a target machine.(Citation: Trend Micro Muddy Water March 2021)
- [S0203] Hydraq: [Hydraq](https://attack.mitre.org/software/S0203) creates a backdoor through which remote attackers can check for the existence of files, including its own components, as well as retrieve a list of logical drives.(Citation: Symantec Trojan.Hydraq Jan 2010)(Citation: Symantec Hydraq Jan 2010)
- [S0142] StreamEx: [StreamEx](https://attack.mitre.org/software/S0142) has the ability to enumerate drive types.(Citation: Cylance Shell Crew Feb 2017)
- [S0011] Taidoor: [Taidoor](https://attack.mitre.org/software/S0011) can search for specific files.(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021)
- [G0045] menuPass: [menuPass](https://attack.mitre.org/groups/G0045) has searched compromised systems for folders of interest including those related to HR, audit and expense, and meeting memos.(Citation: Symantec Cicada November 2020)
- [S0520] BLINDINGCAN: [BLINDINGCAN](https://attack.mitre.org/software/S0520) can search, read, write, move, and execute files.(Citation: US-CERT BLINDINGCAN Aug 2020)(Citation: NHS UK BLINDINGCAN Aug 2020)
- [S0266] TrickBot: [TrickBot](https://attack.mitre.org/software/S0266) searches the system for all of the following file extensions: .avi, .mov, .mkv, .mpeg, .mpeg4, .mp4, .mp3, .wav, .ogg, .jpeg, .jpg, .png, .bmp, .gif, .tiff, .ico, .xlsx, and .zip. It can also obtain browsing history, cookies, and plug-in information.(Citation: S2 Grupo TrickBot June 2017)(Citation: Trend Micro Trickbot Nov 2018)
- [S0332] Remcos: [Remcos](https://attack.mitre.org/software/S0332) can search for files on the infected machine.(Citation: Riskiq Remcos Jan 2018)
- [S1060] Mafalda: [Mafalda](https://attack.mitre.org/software/S1060) can search for files and directories.(Citation: SentinelLabs Metador Sept 2022)
- [S0582] LookBack: [LookBack](https://attack.mitre.org/software/S0582) can retrieve file listings from the victim machine.(Citation: Proofpoint LookBack Malware Aug 2019)
- [S0456] Aria-body: [Aria-body](https://attack.mitre.org/software/S0456) has the ability to gather metadata from a file and to search for file and directory names.(Citation: CheckPoint Naikon May 2020)
- [S0088] Kasidet: [Kasidet](https://attack.mitre.org/software/S0088) has the ability to search for a given filename on a victim.(Citation: Zscaler Kasidet)
- [G0094] Kimsuky: [Kimsuky](https://attack.mitre.org/groups/G0094) has the ability to enumerate all files and directories on an infected system.(Citation: Securelist Kimsuky Sept 2013)(Citation: Talos Kimsuky Nov 2021)(Citation: KISA Operation Muzabi)
- [S0458] Ramsay: [Ramsay](https://attack.mitre.org/software/S0458) can collect directory and file lists.(Citation: Eset Ramsay May 2020)(Citation: Antiy CERT Ramsay April 2020)
- [S1022] IceApple: The [IceApple](https://attack.mitre.org/software/S1022) Directory Lister module can list information about files and directories including creation time, last write time, name, and size.(Citation: CrowdStrike IceApple May 2022)
- [S1028] Action RAT: [Action RAT](https://attack.mitre.org/software/S1028) has the ability to collect drive and file information on an infected machine.(Citation: MalwareBytes SideCopy Dec 2021)
- [G0125] HAFNIUM: [HAFNIUM](https://attack.mitre.org/groups/G0125) has searched file contents on a compromised host.(Citation: Rapid7 HAFNIUM Mar 2021)
- [S0448] Rising Sun: [Rising Sun](https://attack.mitre.org/software/S0448) can enumerate information about files from the infected system, including file size, attributes, creation time, last access time, and write time. [Rising Sun](https://attack.mitre.org/software/S0448) can enumerate the compilation timestamp of Windows executable files.(Citation: McAfee Sharpshooter December 2018)
- [S0035] SPACESHIP: [SPACESHIP](https://attack.mitre.org/software/S0035) identifies files and directories for collection by searching for specific file extensions or file modification time.(Citation: FireEye APT30)
- [S0587] Penquin: [Penquin](https://attack.mitre.org/software/S0587) can use the command code <code>do_vslist</code> to send file names, size, and status to C2.(Citation: Leonardo Turla Penquin May 2020)
- [S0409] Machete: [Machete](https://attack.mitre.org/software/S0409) produces file listings in order to search for files to be exfiltrated.(Citation: ESET Machete July 2019)(Citation: Cylance Machete Mar 2017)(Citation: 360 Machete Sep 2020)
- [S1150] ROADSWEEP: [ROADSWEEP](https://attack.mitre.org/software/S1150) can enumerate files on infected devices and avoid encrypting files with .exe, .dll, 	.sys, .lnk, or . lck extensions.(Citation: Mandiant ROADSWEEP August 2022)(Citation: CISA Iran Albanian Attacks September 2022)(Citation: Microsoft Albanian Government Attacks September 2022)
- [S0148] RTM: [RTM](https://attack.mitre.org/software/S0148) can check for specific files and directories associated with virtualization and malware analysis.(Citation: Unit42 Redaman January 2019)
- [S0356] KONNI: A version of [KONNI](https://attack.mitre.org/software/S0356) searches for filenames created with a previous version of the malware, suggesting different versions targeted the same victims and the versions may work together.(Citation: Talos Konni May 2017)
- [S0153] RedLeaves: [RedLeaves](https://attack.mitre.org/software/S0153) can enumerate and search for files and directories.(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: FireEye APT10 April 2017)
- [G0142] Confucius: [Confucius](https://attack.mitre.org/groups/G0142) has used a file stealer that checks the Document, Downloads, Desktop, and Picture folders for documents and images with specific extensions.(Citation: TrendMicro Confucius APT Aug 2021)
- [S0670] WarzoneRAT: [WarzoneRAT](https://attack.mitre.org/software/S0670) can enumerate directories on a compromise host.(Citation: Check Point Warzone Feb 2020)
- [S1167] AcidPour: [AcidPour](https://attack.mitre.org/software/S1167) can identify specific files and directories within the Linux operating system corresponding with storage devices for follow-on wiping activity, similar to [AcidRain](https://attack.mitre.org/software/S1125).(Citation: SentinelOne AcidPour 2024)
- [G0096] APT41: [APT41](https://attack.mitre.org/groups/G0096) has executed <code>file /bin/pwd</code> on exploited victims, perhaps to return architecture related information.(Citation: FireEye APT41 March 2020)
- [G0044] Winnti Group: [Winnti Group](https://attack.mitre.org/groups/G0044) has used a program named ff.exe to search for specific documents on compromised hosts.(Citation: Kaspersky Winnti April 2013)
- [S1125] AcidRain: [AcidRain](https://attack.mitre.org/software/S1125) identifies specific files and directories in the Linux operating system associated with storage devices.(Citation: AcidRain JAGS 2022)
- [S1018] Saint Bot: [Saint Bot](https://attack.mitre.org/software/S1018) can search a compromised host for specific files.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 )
- [S0630] Nebulae: [Nebulae](https://attack.mitre.org/software/S0630) can list files and directories on a compromised host.(Citation: Bitdefender Naikon April 2021)
- [S0277] FruitFly: [FruitFly](https://attack.mitre.org/software/S0277) looks for specific files and file types.(Citation: objsee mac malware 2017)
- [S0658] XCSSET: [XCSSET](https://attack.mitre.org/software/S0658) has used `mdfind` to enumerate a list of apps known to grant screen sharing permissions and leverages a module to run the command `ls -la ~/Desktop`.(Citation: Application Bundle Manipulation Brandon Dalton)(Citation: Microsoft March 2025 XCSSET)
- [S0344] Azorult: [Azorult](https://attack.mitre.org/software/S0344) can recursively search for files in folders and collects files from the desktop with certain extensions.(Citation: Unit42 Azorult Nov 2018)
- [C0035] KV Botnet Activity: [KV Botnet Activity](https://attack.mitre.org/campaigns/C0035) gathers a list of filenames from the following locations during execution of the final botnet stage: <code>\/usr\/sbin\/</code>, <code>\/usr\/bin\/</code>,  <code>\/sbin\/</code>, <code>\/pfrm2.0\/bin\/</code>, <code>\/usr\/local\/bin\/</code>.(Citation: Lumen KVBotnet 2023)
- [S1109] PACEMAKER: [PACEMAKER](https://attack.mitre.org/software/S1109) can parse `/proc/"process_name"/cmdline` to look for the string `dswsd` within the command line.(Citation: Mandiant Pulse Secure Zero-Day April 2021)
- [S0375] Remexi: [Remexi](https://attack.mitre.org/software/S0375) searches for files on the system. (Citation: Securelist Remexi Jan 2019)
- [G1035] Winter Vivern: [Winter Vivern](https://attack.mitre.org/groups/G1035) delivered malicious JavaScript payloads capable of listing folders and emails in exploited email servers.(Citation: ESET WinterVivern 2023)
- [G0124] Windigo: [Windigo](https://attack.mitre.org/groups/G0124) has used a script to check for the presence of files created by OpenSSH backdoors.(Citation: ESET ForSSHe December 2018)
- [S0615] SombRAT: [SombRAT](https://attack.mitre.org/software/S0615) can execute <code>enum</code> to enumerate files in storage on a compromised system.(Citation: BlackBerry CostaRicto November 2020)
- [S1135] MultiLayer Wiper: [MultiLayer Wiper](https://attack.mitre.org/software/S1135) generates a list of all files and paths on the fixed drives of an infected system, enumerating all files on the system except specific folders defined in a hardcoded list.(Citation: Unit42 Agrius 2023)
- [S1096] Cheerscrypt: [Cheerscrypt](https://attack.mitre.org/software/S1096) can search for log and VMware-related files with .log, .vmdk, .vmem, .vswp, and .vmsn extensions.(Citation: Trend Micro Cheerscrypt May 2022)
- [G0026] APT18: [APT18](https://attack.mitre.org/groups/G0026) can list files information for specific directories.(Citation: PaloAlto DNS Requests May 2016)
- [S0113] Prikormka: A module in [Prikormka](https://attack.mitre.org/software/S0113) collects information about the paths, size, and creation time of files with specific file extensions, but not the actual content of the file.(Citation: ESET Operation Groundbait)
- [S0497] Dacls: [Dacls](https://attack.mitre.org/software/S0497) can scan directories on a compromised host.(Citation: TrendMicro macOS Dacls May 2020)
- [S0434] Imminent Monitor: [Imminent Monitor](https://attack.mitre.org/software/S0434) has a dynamic debugging feature to check whether it is located in the %TEMP% directory, otherwise it copies itself there.(Citation: QiAnXin APT-C-36 Feb2019)
- [S0330] Zeus Panda: [Zeus Panda](https://attack.mitre.org/software/S0330) searches for specific directories on the victim’s machine.(Citation: GDATA Zeus Panda June 2017)
- [S0090] Rover: [Rover](https://attack.mitre.org/software/S0090) automatically searches for files on local drives based on a predefined list of file extensions.(Citation: Palo Alto Rover)
- [S0512] FatDuke: [FatDuke](https://attack.mitre.org/software/S0512) can enumerate directories on target machines.(Citation: ESET Dukes October 2019)
- [S0444] ShimRat: [ShimRat](https://attack.mitre.org/software/S0444) can list directories.(Citation: FOX-IT May 2016 Mofang)
- [S0124] Pisloader: [Pisloader](https://attack.mitre.org/software/S0124) has commands to list drives on the victim machine and to list file information for a given directory.(Citation: Palo Alto DNS Requests)
- [G1023] APT5: [APT5](https://attack.mitre.org/groups/G1023) has used the BLOODMINE utility to discover files with .css, .jpg, .png, .gif, .ico, .js, and .jsp extensions in Pulse Secure Connect logs.(Citation: Mandiant Pulse Secure Update May 2021)
- [S1148] Raccoon Stealer: [Raccoon Stealer](https://attack.mitre.org/software/S1148) identifies target files and directories for collection based on a configuration file.(Citation: S2W Racoon 2022)(Citation: Sekoia Raccoon2 2022)
- [S1121] LITTLELAMB.WOOLTEA: [LITTLELAMB.WOOLTEA](https://attack.mitre.org/software/S1121) can monitor for system upgrade events by checking for the presence of `/tmp/data/root/dev`.(Citation: Mandiant Cutting Edge Part 3 February 2024)
- [G0117] Fox Kitten: [Fox Kitten](https://attack.mitre.org/groups/G0117) has used WizTree to obtain network files and directory listings.(Citation: CISA AA20-259A Iran-Based Actor September 2020)
- [S1016] MacMa: [MacMa](https://attack.mitre.org/software/S1016) can search for a specific file on the compromised computer and can enumerate files in Desktop, Downloads, and Documents folders.(Citation: ESET DazzleSpy Jan 2022)
- [S1073] Royal: [Royal](https://attack.mitre.org/software/S1073) can identify specific files and directories to exclude from the encryption process.(Citation: Cybereason Royal December 2022)(Citation: Kroll Royal Deep Dive February 2023)(Citation: Trend Micro Royal Linux ESXi February 2023)
- [S0455] Metamorfo: [Metamorfo](https://attack.mitre.org/software/S0455) has searched the Program Files directories for specific folders and has searched for strings related to its mutexes.(Citation: Medium Metamorfo Apr 2020)(Citation: Fortinet Metamorfo Feb 2020)(Citation: FireEye Metamorfo Apr 2018)
- [S1191] Megazord: [Megazord](https://attack.mitre.org/software/S1191) can ignore specified directories for encryption.(Citation: Palo Alto Howling Scorpius DEC 2024)
- [S1089] SharpDisco: [SharpDisco](https://attack.mitre.org/software/S1089) can identify recently opened files by using an LNK format parser to extract the original file path from LNK files found in either `%USERPROFILE%\Recent` (Windows XP) or `%APPDATA%\Microsoft\Windows\Recent` (newer Windows versions) .(Citation: MoustachedBouncer ESET August 2023)
- [S1068] BlackCat: [BlackCat](https://attack.mitre.org/software/S1068) can enumerate files for encryption.(Citation: Microsoft BlackCat Jun 2022)
- [S0226] Smoke Loader: [Smoke Loader](https://attack.mitre.org/software/S0226) recursively searches through directories for files.(Citation: Talos Smoke Loader July 2018)
- [S0275] UPPERCUT: [UPPERCUT](https://attack.mitre.org/software/S0275) has the capability to gather the victim's current directory.(Citation: FireEye APT10 Sept 2018)
- [S0128] BADNEWS: [BADNEWS](https://attack.mitre.org/software/S0128) identifies files with certain extensions from USB devices, then copies them to a predefined directory.(Citation: TrendMicro Patchwork Dec 2017)
- [G0077] Leafminer: [Leafminer](https://attack.mitre.org/groups/G0077) used a tool called MailSniper to search for files on the desktop and another utility called Sobolsoft to extract attachments from EML files.(Citation: Symantec Leafminer July 2018)
- [S0062] DustySky: [DustySky](https://attack.mitre.org/software/S0062) scans the victim for files that contain certain keywords and document types including PDF, DOC, DOCX, XLS, and XLSX, from a list that is obtained from the C2 as a text file. It can also identify logical drives for the infected machine.(Citation: DustySky)(Citation: Kaspersky MoleRATs April 2019)
- [G1016] FIN13: [FIN13](https://attack.mitre.org/groups/G1016) has used the Windows `dir` command to enumerate files and directories in a victim's network.(Citation: Mandiant FIN13 Aug 2022)
- [S0443] MESSAGETAP: [MESSAGETAP](https://attack.mitre.org/software/S0443) checks for the existence of two configuration files (keyword_parm.txt and parm.txt) and attempts to read the files every 30 seconds.(Citation: FireEye MESSAGETAP October 2019)
- [G0010] Turla: [Turla](https://attack.mitre.org/groups/G0010) surveys a system upon check-in to discover files in specific locations on the hard disk %TEMP% directory, the current user's desktop, the Program Files directory, and Recent.(Citation: Kaspersky Turla)(Citation: ESET ComRAT May 2020) [Turla](https://attack.mitre.org/groups/G0010) RPC backdoors have also searched for files matching the <code>lPH*.dll</code> pattern.(Citation: ESET Turla PowerShell May 2019)
- [S0638] Babuk: [Babuk](https://attack.mitre.org/software/S0638) has the ability to enumerate files on a targeted system.(Citation: McAfee Babuk February 2021)(Citation: Trend Micro Ransomware February 2021)
- [S0020] China Chopper: [China Chopper](https://attack.mitre.org/software/S0020)'s server component can list directory contents.(Citation: FireEye Periscope March 2018)(Citation: Rapid7 HAFNIUM Mar 2021)
- [S1044] FunnyDream: [FunnyDream](https://attack.mitre.org/software/S1044) can identify files with .doc, .docx, .ppt, .pptx, .xls, .xlsx, and .pdf extensions and specific timestamps for collection.(Citation: Bitdefender FunnyDream Campaign November 2020)
- [G0060] BRONZE BUTLER: [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) has collected a list of files from the victim and uploaded it to its C2 server, and then created a new list of specific files to steal.(Citation: Secureworks BRONZE BUTLER Oct 2017)
- [S0022] Uroburos: [Uroburos](https://attack.mitre.org/software/S0022) can search for specific files on a compromised system.(Citation: Joint Cybersecurity Advisory AA23-129A Snake Malware May 2023)
- [S0263] TYPEFRAME: [TYPEFRAME](https://attack.mitre.org/software/S0263) can search directories for files on the victim’s machine.(Citation: US-CERT TYPEFRAME June 2018)
- [S1200] StealBit: [StealBit](https://attack.mitre.org/software/S1200) can be configured to exfiltrate specific file types.(Citation: FBI Lockbit 2.0 FEB 2022)(Citation: Cybereason StealBit Exfiltration Tool)


### T1087 - Account Discovery

Description:

Adversaries may attempt to get a listing of valid accounts, usernames, or email addresses on a system or within a compromised environment. This information can help adversaries determine which accounts exist, which can aid in follow-on behavior such as brute-forcing, spear-phishing attacks, or account takeovers (e.g., [Valid Accounts](https://attack.mitre.org/techniques/T1078)).

Adversaries may use several methods to enumerate accounts, including abuse of existing tools, built-in commands, and potential misconfigurations that leak account names and roles or permissions in the targeted environment.

For examples, cloud environments typically provide easily accessible interfaces to obtain user lists.(Citation: AWS List Users)(Citation: Google Cloud - IAM Servie Accounts List API) On hosts, adversaries can use default [PowerShell](https://attack.mitre.org/techniques/T1059/001) and other command line functionality to identify accounts. Information about email addresses and accounts may also be extracted by searching an infected system’s files.

Procedures:

- [G0143] Aquatic Panda: [Aquatic Panda](https://attack.mitre.org/groups/G0143) used the <code>last</code> command in Linux environments to identify recently logged-in users on victim machines.(Citation: Crowdstrike HuntReport 2022)
- [S0445] ShimRatReporter: [ShimRatReporter](https://attack.mitre.org/software/S0445) listed all non-privileged and privileged accounts available on the machine.(Citation: FOX-IT May 2016 Mofang)
- [S1065] Woody RAT: [Woody RAT](https://attack.mitre.org/software/S1065) can identify administrator accounts on an infected machine.(Citation: MalwareBytes WoodyRAT Aug 2022)
- [S0658] XCSSET: [XCSSET](https://attack.mitre.org/software/S0658) attempts to discover accounts from various locations such as a user's Evernote, AppleID, Telegram, Skype, and WeChat data.(Citation: trendmicro xcsset xcode project 2020)
- [C0024] SolarWinds Compromise: During the [SolarWinds Compromise](https://attack.mitre.org/campaigns/C0024), [APT29](https://attack.mitre.org/groups/G0016) obtained a list of users and their roles from an Exchange server using `Get-ManagementRoleAssignment`.(Citation: Volexity SolarWinds)
- [G1016] FIN13: [FIN13](https://attack.mitre.org/groups/G1016) has enumerated all users and their roles from a victim's main treasury system.(Citation: Mandiant FIN13 Aug 2022)

#### T1087.001 - Local Account

Description:

Adversaries may attempt to get a listing of local system accounts. This information can help adversaries determine which local accounts exist on a system to aid in follow-on behavior.

Commands such as <code>net user</code> and <code>net localgroup</code> of the [Net](https://attack.mitre.org/software/S0039) utility and <code>id</code> and <code>groups</code> on macOS and Linux can list local users and groups.(Citation: Mandiant APT1)(Citation: id man page)(Citation: groups man page) On Linux, local users can also be enumerated through the use of the <code>/etc/passwd</code> file. On macOS, the <code>dscl . list /Users</code> command can be used to enumerate local accounts. On ESXi servers, the `esxcli system account list` command can list local user accounts.(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021)

Procedures:

- [S0452] USBferry: [USBferry](https://attack.mitre.org/software/S0452) can use <code>net user</code> to gather information about local accounts.(Citation: TrendMicro Tropic Trooper May 2020)
- [S0331] Agent Tesla: [Agent Tesla](https://attack.mitre.org/software/S0331) can collect account information from the victim’s machine.(Citation: DigiTrust Agent Tesla Jan 2017)
- [S0236] Kwampirs: [Kwampirs](https://attack.mitre.org/software/S0236) collects a list of accounts with the command <code>net users</code>.(Citation: Symantec Orangeworm April 2018)
- [G0004] Ke3chang: [Ke3chang](https://attack.mitre.org/groups/G0004) performs account discovery using commands such as <code>net localgroup administrators</code> and <code>net group "REDACTED" /domain</code> on specific permissions groups.(Citation: Mandiant Operation Ke3chang November 2014)
- [S0039] Net: Commands under <code>net user</code> can be used in [Net](https://attack.mitre.org/software/S0039) to gather information about and manipulate user accounts.(Citation: Savill 1999)
- [G1009] Moses Staff: [Moses Staff](https://attack.mitre.org/groups/G1009) has collected the administrator username from a compromised host.(Citation: Checkpoint MosesStaff Nov 2021)
- [S0196] PUNCHBUGGY: [PUNCHBUGGY](https://attack.mitre.org/software/S0196) can gather user names.(Citation: Morphisec ShellTea June 2019)
- [S1146] MgBot: [MgBot](https://attack.mitre.org/software/S1146) includes modules for identifying local administrator accounts on victim systems.(Citation: Symantec Daggerfly 2023)
- [S0223] POWERSTATS: [POWERSTATS](https://attack.mitre.org/software/S0223) can retrieve usernames from compromised hosts.(Citation: FireEye MuddyWater Mar 2018)
- [S0038] Duqu: The discovery modules used with [Duqu](https://attack.mitre.org/software/S0038) can collect information on accounts and permissions.(Citation: Symantec W32.Duqu)
- [S0049] GeminiDuke: [GeminiDuke](https://attack.mitre.org/software/S0049) collects information on local user accounts from the victim.(Citation: F-Secure The Dukes)
- [S0165] OSInfo: [OSInfo](https://attack.mitre.org/software/S0165) enumerates local and domain users(Citation: Symantec Buckeye)
- [S0063] SHOTPUT: [SHOTPUT](https://attack.mitre.org/software/S0063) has a command to retrieve information about connected users.(Citation: Palo Alto CVE-2015-3113 July 2015)
- [G0049] OilRig: [OilRig](https://attack.mitre.org/groups/G0049) has run <code>net user</code>, <code>net user /domain</code>, <code>net group “domain admins” /domain</code>, and <code>net group “Exchange Trusted Subsystem” /domain</code> to get account listings on a victim.(Citation: Palo Alto OilRig May 2016)
- [S0378] PoshC2: [PoshC2](https://attack.mitre.org/software/S0378) can enumerate local and domain user account information.(Citation: GitHub PoshC2)
- [S0244] Comnie: [Comnie](https://attack.mitre.org/software/S0244) uses the <code>net user</code> command.(Citation: Palo Alto Comnie)
- [G0096] APT41: [APT41](https://attack.mitre.org/groups/G0096) used built-in <code>net</code> commands to enumerate local administrator groups.(Citation: Rostovcev APT41 2021)
- [G0030] Lotus Blossom: [Lotus Blossom](https://attack.mitre.org/groups/G0030) has used commands such as `net` to profile local system users.(Citation: Cisco LotusBlossom 2025)
- [S1159] DUSTTRAP: [DUSTTRAP](https://attack.mitre.org/software/S1159) can enumerate local user accounts.(Citation: Google Cloud APT41 2024)
- [G0050] APT32: [APT32](https://attack.mitre.org/groups/G0050) enumerated administrative users using the commands <code>net localgroup administrators</code>.(Citation: Cybereason Cobalt Kitty 2017)
- [S0521] BloodHound: [BloodHound](https://attack.mitre.org/software/S0521) can identify users with local administrator rights.(Citation: CrowdStrike BloodHound April 2018)
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has executed `net user` and `quser` to enumerate local account information.(Citation: CISA AA24-038A PRC Critical Infrastructure February 2024)
- [S1145] Pikabot: [Pikabot](https://attack.mitre.org/software/S1145) will retrieve the name of the user associated with the thread under which the malware is executing.(Citation: Elastic Pikabot 2024)
- [C0012] Operation CuckooBees: During [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), the threat actors used the `net user` command to gather account information.(Citation: Cybereason OperationCuckooBees May 2022)
- [S0266] TrickBot: [TrickBot](https://attack.mitre.org/software/S0266) collects the users of the system.(Citation: S2 Grupo TrickBot June 2017)(Citation: Trend Micro Trickbot Nov 2018)
- [G1044] APT42: [APT42](https://attack.mitre.org/groups/G1044) has used the PowerShell-based POWERPOST script to collect local account names from the victim machine.(Citation: Mandiant APT42-charms)
- [S0241] RATANKBA: [RATANKBA](https://attack.mitre.org/software/S0241) uses the <code>net user</code> command.(Citation: RATANKBA)
- [G1039] RedCurl: [RedCurl](https://attack.mitre.org/groups/G1039) has collected information about local accounts.(Citation: group-ib_redcurl1)(Citation: group-ib_redcurl2)
- [G0114] Chimera: [Chimera](https://attack.mitre.org/groups/G0114) has used <code>net user</code> for account discovery.(Citation: NCC Group Chimera January 2021)
- [G0010] Turla: [Turla](https://attack.mitre.org/groups/G0010) has used <code>net user</code> to enumerate local accounts on the system.(Citation: ESET ComRAT May 2020)(Citation: ESET Crutch December 2020)
- [G0117] Fox Kitten: [Fox Kitten](https://attack.mitre.org/groups/G0117) has accessed ntuser.dat and UserClass.dat on compromised hosts.(Citation: CISA AA20-259A Iran-Based Actor September 2020)
- [S0091] Epic: [Epic](https://attack.mitre.org/software/S0091) gathers a list of all user accounts, privilege classes, and time of last logon.(Citation: Kaspersky Turla Aug 2014)
- [S0516] SoreFang: [SoreFang](https://attack.mitre.org/software/S0516) can collect usernames from the local system via <code>net.exe user</code>.(Citation: CISA SoreFang July 2016)
- [G0022] APT3: [APT3](https://attack.mitre.org/groups/G0022) has used a tool that can obtain info about local and global group users, power users, and administrators.(Citation: Symantec Buckeye)
- [S0125] Remsec: [Remsec](https://attack.mitre.org/software/S0125) can obtain a list of users.(Citation: Kaspersky ProjectSauron Technical Analysis)
- [S0084] Mis-Type: [Mis-Type](https://attack.mitre.org/software/S0084) may create a file containing the results of the command <code>cmd.exe /c net user {Username}</code>.(Citation: Cylance Dust Storm)
- [S0239] Bankshot: [Bankshot](https://attack.mitre.org/software/S0239) gathers domain and account names/information through process monitoring.(Citation: McAfee Bankshot)
- [S0260] InvisiMole: [InvisiMole](https://attack.mitre.org/software/S0260) has a command to list account information on the victim’s machine.(Citation: ESET InvisiMole June 2018)
- [S1015] Milan: [Milan](https://attack.mitre.org/software/S1015) has run `C:\Windows\system32\cmd.exe /c cmd /c dir c:\users\ /s 2>&1` to discover local accounts.(Citation: ClearSky Siamesekitten August 2021)
- [G0027] Threat Group-3390: [Threat Group-3390](https://attack.mitre.org/groups/G0027) has used <code>net user</code> to conduct internal discovery of systems.(Citation: SecureWorks BRONZE UNION June 2017)
- [S0603] Stuxnet: [Stuxnet](https://attack.mitre.org/software/S0603) enumerates user accounts of the local host.(Citation: Nicolas Falliere, Liam O Murchu, Eric Chien February 2011)
- [S0194] PowerSploit: [PowerSploit](https://attack.mitre.org/software/S0194)'s <code>Get-ProcessTokenGroup</code> Privesc-PowerUp module can enumerate all SIDs associated with its current token.(Citation: GitHub PowerSploit May 2012)(Citation: PowerSploit Documentation)
- [G0033] Poseidon Group: [Poseidon Group](https://attack.mitre.org/groups/G0033) searches for administrator accounts on both the local victim machine and the network.(Citation: Kaspersky Poseidon Group)
- [S0363] Empire: [Empire](https://attack.mitre.org/software/S0363) can acquire local and domain user account information.(Citation: Github PowerShell Empire)
- [S0192] Pupy: [Pupy](https://attack.mitre.org/software/S0192) uses PowerView and Pywerview to perform discovery commands such as net user, net group, net local group, etc.(Citation: GitHub Pupy)
- [G0018] admin@338: [admin@338](https://attack.mitre.org/groups/G0018) actors used the following commands following exploitation of a machine with [LOWBALL](https://attack.mitre.org/software/S0042) malware to enumerate user accounts: <code>net user >> %temp%\download</code> <code>net user /domain >> %temp%\download</code>(Citation: FireEye admin@338)
- [S0537] HyperStack: [HyperStack](https://attack.mitre.org/software/S0537) can enumerate all account names on a remote share.(Citation: Accenture HyperStack October 2020)
- [S0081] Elise: [Elise](https://attack.mitre.org/software/S0081) executes <code>net user</code> after initial communication is made to the remote server.(Citation: Lotus Blossom Jun 2015)
- [S0534] Bazar: [Bazar](https://attack.mitre.org/software/S0534) can identify administrator accounts on an infected host.(Citation: NCC Group Team9 June 2020)
- [G0006] APT1: [APT1](https://attack.mitre.org/groups/G0006) used the commands <code>net localgroup</code>,<code>net user</code>, and <code>net group</code> to find accounts on the system.(Citation: Mandiant APT1)
- [S1148] Raccoon Stealer: [Raccoon Stealer](https://attack.mitre.org/software/S1148) checks the privileges of running processes to determine if the running user is equivalent to `NT Authority\System`.(Citation: Sekoia Raccoon2 2022)
- [S0570] BitPaymer: [BitPaymer](https://attack.mitre.org/software/S0570) can enumerate the sessions for each user logged onto the infected host.(Citation: Crowdstrike Indrik November 2018)
- [S0453] Pony: [Pony](https://attack.mitre.org/software/S0453) has used the <code>NetUserEnum</code> function to enumerate local accounts.(Citation: Malwarebytes Pony April 2016)
- [S0476] Valak: [Valak](https://attack.mitre.org/software/S0476) has the ability to enumerate local admin accounts.(Citation: Cybereason Valak May 2020)
- [S0265] Kazuar: [Kazuar](https://attack.mitre.org/software/S0265) gathers information on local groups and members on the victim’s machine.(Citation: Unit 42 Kazuar May 2017)
- [S0649] SMOKEDHAM: [SMOKEDHAM](https://attack.mitre.org/software/S0649) has used <code>net.exe user</code> and <code>net.exe users</code> to enumerate local accounts on a compromised host.(Citation: FireEye SMOKEDHAM June 2021)
- [S0233] MURKYTOP: [MURKYTOP](https://attack.mitre.org/software/S0233) has the capability to retrieve information about users on remote hosts.(Citation: FireEye Periscope March 2018)
- [S0598] P.A.S. Webshell: [P.A.S. Webshell](https://attack.mitre.org/software/S0598) can display the /etc/passwd file on a compromised host.(Citation: ANSSI Sandworm January 2021)
- [S0085] S-Type: [S-Type](https://attack.mitre.org/software/S0085) has run the command `net user` on a victim.(Citation: Cylance Dust Storm)

#### T1087.002 - Domain Account

Description:

Adversaries may attempt to get a listing of domain accounts. This information can help adversaries determine which domain accounts exist to aid in follow-on behavior such as targeting specific accounts which possess particular privileges.

Commands such as <code>net user /domain</code> and <code>net group /domain</code> of the [Net](https://attack.mitre.org/software/S0039) utility, <code>dscacheutil -q group</code> on macOS, and <code>ldapsearch</code> on Linux can list domain users and groups. [PowerShell](https://attack.mitre.org/techniques/T1059/001) cmdlets including <code>Get-ADUser</code> and <code>Get-ADGroupMember</code> may enumerate members of Active Directory groups.(Citation: CrowdStrike StellarParticle January 2022)

Procedures:

- [S1159] DUSTTRAP: [DUSTTRAP](https://attack.mitre.org/software/S1159) can enumerate domain accounts.(Citation: Google Cloud APT41 2024)
- [C0024] SolarWinds Compromise: During the [SolarWinds Compromise](https://attack.mitre.org/campaigns/C0024), [APT29](https://attack.mitre.org/groups/G0016) used PowerShell to discover domain accounts by exectuing `Get-ADUser` and `Get-ADGroupMember`.(Citation: CrowdStrike StellarParticle January 2022)(Citation: Secureworks IRON RITUAL Profile)
- [S0516] SoreFang: [SoreFang](https://attack.mitre.org/software/S0516) can enumerate domain accounts via <code>net.exe user /domain</code>.(Citation: CISA SoreFang July 2016)
- [S0039] Net: [Net](https://attack.mitre.org/software/S0039) commands used with the <code>/domain</code> flag can be used to gather information about and manipulate user accounts on the current domain.(Citation: Microsoft Net)
- [G1016] FIN13: [FIN13](https://attack.mitre.org/groups/G1016) can identify user accounts associated with a Service Principal Name and query Service Principal Names within the domain by utilizing the following scripts: `GetUserSPNs.vbs` and `querySpn.vbs`.(Citation: Mandiant FIN13 Aug 2022)(Citation: Sygnia Elephant Beetle Jan 2022)
- [S0534] Bazar: [Bazar](https://attack.mitre.org/software/S0534) has the ability to identify domain administrator accounts.(Citation: NCC Group Team9 June 2020)(Citation: DFIR Ryuk's Return October 2020)
- [G0037] FIN6: [FIN6](https://attack.mitre.org/groups/G0037) has used Metasploit’s [PsExec](https://attack.mitre.org/software/S0029) NTDSGRAB module to obtain a copy of the victim's Active Directory database.(Citation: FireEye FIN6 April 2016)
- [S0488] CrackMapExec: [CrackMapExec](https://attack.mitre.org/software/S0488) can enumerate the domain user accounts on a targeted system.(Citation: CME Github September 2018)
- [S1146] MgBot: [MgBot](https://attack.mitre.org/software/S1146) includes modules for collecting information on Active Directory domain accounts.(Citation: Symantec Daggerfly 2023)
- [G0096] APT41: [APT41](https://attack.mitre.org/groups/G0096) used built-in <code>net</code> commands to enumerate domain administrator users.(Citation: Rostovcev APT41 2021)
- [G0004] Ke3chang: [Ke3chang](https://attack.mitre.org/groups/G0004) performs account discovery using commands such as <code>net localgroup administrators</code> and <code>net group "REDACTED" /domain</code> on specific permissions groups.(Citation: Mandiant Operation Ke3chang November 2014)
- [G1015] Scattered Spider: [Scattered Spider](https://attack.mitre.org/groups/G1015) leverages legitimate domain accounts to gain access to the target environment.(Citation: CISA Scattered Spider Advisory November 2023)(Citation: MSTIC Octo Tempest Operations October 2023)
- [S0018] Sykipot: [Sykipot](https://attack.mitre.org/software/S0018) may use <code>net group "domain admins" /domain</code> to display accounts in the "domain admins" permissions group and <code>net localgroup "administrators"</code> to list local system administrator group membership.(Citation: AlienVault Sykipot 2011)
- [S0635] BoomBox: [BoomBox](https://attack.mitre.org/software/S0635) has the ability to execute an LDAP query to enumerate the distinguished name, SAM account name, and display name for all domain users.(Citation: MSTIC Nobelium Toolset May 2021)
- [G0030] Lotus Blossom: [Lotus Blossom](https://attack.mitre.org/groups/G0030) has used `net` commands and tools such as [AdFind](https://attack.mitre.org/software/S0552) to profile domain accounts associated with victim machines and make Active Directory queries.(Citation: Cisco LotusBlossom 2025)(Citation: Symantec Bilbug 2022)
- [G0069] MuddyWater: [MuddyWater](https://attack.mitre.org/groups/G0069) has used <code>cmd.exe net user /domain</code> to enumerate domain users.(Citation: Trend Micro Muddy Water March 2021)
- [S0105] dsquery: [dsquery](https://attack.mitre.org/software/S0105) can be used to gather information on user accounts within a domain.(Citation: TechNet Dsquery)(Citation: Mandiant APT41)
- [G1032] INC Ransom: [INC Ransom](https://attack.mitre.org/groups/G1032) has scanned for domain admin accounts in compromised environments.(Citation: SOCRadar INC Ransom January 2024)
- [S1068] BlackCat: [BlackCat](https://attack.mitre.org/software/S1068) can utilize `net use` commands to identify domain users.(Citation: Microsoft BlackCat Jun 2022)
- [S0521] BloodHound: [BloodHound](https://attack.mitre.org/software/S0521) can collect information about domain users, including identification of domain admin accounts.(Citation: CrowdStrike BloodHound April 2018)
- [G1004] LAPSUS$: [LAPSUS$](https://attack.mitre.org/groups/G1004) has used the AD Explorer tool to enumerate users on a victim's network.(Citation: MSTIC DEV-0537 Mar 2022)(Citation: NCC Group LAPSUS Apr 2022)
- [G0114] Chimera: [Chimera](https://attack.mitre.org/groups/G0114) has has used <code>net user /dom</code> and <code>net user Administrator</code> to enumerate domain accounts including administrator accounts.(Citation: Cycraft Chimera April 2020)(Citation: NCC Group Chimera January 2021)
- [S0363] Empire: [Empire](https://attack.mitre.org/software/S0363) can acquire local and domain user account information.(Citation: Github PowerShell Empire)(Citation: SecureWorks August 2019)
- [G0045] menuPass: [menuPass](https://attack.mitre.org/groups/G0045) has used the Microsoft administration tool csvde.exe to export Active Directory data.(Citation: PWC Cloud Hopper Technical Annex April 2017)
- [G0049] OilRig: [OilRig](https://attack.mitre.org/groups/G0049) has run <code>net user</code>, <code>net user /domain</code>, <code>net group “domain admins” /domain</code>, and <code>net group “Exchange Trusted Subsystem” /domain</code> to get account listings on a victim.(Citation: Palo Alto OilRig May 2016)
- [S0378] PoshC2: [PoshC2](https://attack.mitre.org/software/S0378) can enumerate local and domain user account information.(Citation: GitHub PoshC2)
- [S0184] POWRUNER: [POWRUNER](https://attack.mitre.org/software/S0184) may collect user account information by running <code>net user /domain</code> or a series of other commands on a victim.(Citation: FireEye APT34 Dec 2017)
- [G1022] ToddyCat: [ToddyCat](https://attack.mitre.org/groups/G1022) has run `net user %USER% /dom` for account discovery.(Citation: Kaspersky ToddyCat Check Logs October 2023)
- [G0010] Turla: [Turla](https://attack.mitre.org/groups/G0010) has used <code>net user /domain</code> to enumerate domain accounts.(Citation: ESET ComRAT May 2020)
- [G1043] BlackByte: [BlackByte](https://attack.mitre.org/groups/G1043) has used tools such as [AdFind](https://attack.mitre.org/software/S0552) to identify and enumerate domain accounts.(Citation: Microsoft BlackByte 2023)
- [C0012] Operation CuckooBees: During [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), the threat actors used the `dsquery` and `dsget` commands to get domain environment information and to query users in administrative groups.(Citation: Cybereason OperationCuckooBees May 2022)
- [S0692] SILENTTRINITY: [SILENTTRINITY](https://attack.mitre.org/software/S0692) can use `System.Security.AccessControl` namespaces to retrieve domain user information.(Citation: GitHub SILENTTRINITY Modules July 2019)
- [G0102] Wizard Spider: [Wizard Spider](https://attack.mitre.org/groups/G0102) has identified domain admins through the use of `net group "Domain admins" /DOMAIN`. [Wizard Spider](https://attack.mitre.org/groups/G0102) has also leveraged the PowerShell cmdlet `Get-ADComputer` to collect account names from Active Directory data.(Citation: DFIR Ryuk's Return October 2020)(Citation: Mandiant FIN12 Oct 2021)
- [G0117] Fox Kitten: [Fox Kitten](https://attack.mitre.org/groups/G0117) has used the Softerra LDAP browser to browse documentation on service accounts.(Citation: CISA AA20-259A Iran-Based Actor September 2020)
- [S0603] Stuxnet: [Stuxnet](https://attack.mitre.org/software/S0603) enumerates user accounts of the domain.(Citation: Nicolas Falliere, Liam O Murchu, Eric Chien February 2011)
- [C0014] Operation Wocao: During [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors used the `net` command to retrieve information about domain accounts.(Citation: FoxIT Wocao December 2019)
- [C0022] Operation Dream Job: During [Operation Dream Job](https://attack.mitre.org/campaigns/C0022), [Lazarus Group](https://attack.mitre.org/groups/G0032) queried compromised victim's active directory servers to obtain the list of employees including administrator accounts.(Citation: ESET Lazarus Jun 2020)
- [S0154] Cobalt Strike: [Cobalt Strike](https://attack.mitre.org/software/S0154) can determine if the user on an infected machine is in the admin or domain admin group.(Citation: Cyberreason Anchor December 2019)
- [S0483] IcedID: [IcedID](https://attack.mitre.org/software/S0483) can query LDAP and can use built-in `net` commands to identify additional users on the network to infect.(Citation: IBM IcedID November 2017)(Citation: DFIR_Quantum_Ransomware)
- [S1063] Brute Ratel C4: [Brute Ratel C4](https://attack.mitre.org/software/S1063) can use LDAP queries, `net group "Domain Admins" /domain` and `net user /domain` for discovery.(Citation: Palo Alto Brute Ratel July 2022)(Citation: Trend Micro Black Basta October 2022)
- [G0033] Poseidon Group: [Poseidon Group](https://attack.mitre.org/groups/G0033) searches for administrator accounts on both the local victim machine and the network.(Citation: Kaspersky Poseidon Group)
- [S0165] OSInfo: [OSInfo](https://attack.mitre.org/software/S0165) enumerates local and domain users(Citation: Symantec Buckeye)
- [S0239] Bankshot: [Bankshot](https://attack.mitre.org/software/S0239) gathers domain and account names/information through process monitoring.(Citation: McAfee Bankshot)
- [G1039] RedCurl: [RedCurl](https://attack.mitre.org/groups/G1039) has collected information about domain accounts using SysInternal’s AdExplorer functionality   .(Citation: group-ib_redcurl1)(Citation: group-ib_redcurl2)
- [G1046] Storm-1811: [Storm-1811](https://attack.mitre.org/groups/G1046) has performed domain account enumeration during intrusions.(Citation: Microsoft Storm-1811 2024)
- [S0476] Valak: [Valak](https://attack.mitre.org/software/S0476) has the ability to enumerate domain admin accounts.(Citation: Cybereason Valak May 2020)
- [S1022] IceApple: The [IceApple](https://attack.mitre.org/software/S1022) Active Directory Querier module  can perform authenticated requests against an Active Directory server.(Citation: CrowdStrike IceApple May 2022)
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has run `net group /dom` and `net group "Domain Admins" /dom` in compromised environments for account discovery.(Citation: Joint Cybersecurity Advisory Volt Typhoon June 2023)(Citation: Secureworks BRONZE SILHOUETTE May 2023)
- [S1160] Latrodectus: [Latrodectus](https://attack.mitre.org/software/S1160) can run `C:\Windows\System32\cmd.exe /c net group "Domain Admins" /domain` to identify domain administrator accounts.(Citation: Elastic Latrodectus May 2024)
- [G0034] Sandworm Team: [Sandworm Team](https://attack.mitre.org/groups/G0034) has used a tool to query Active Directory using LDAP, discovering information about usernames listed in AD.(Citation: ESET Telebots Dec 2016)
- [G0060] BRONZE BUTLER: [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) has used <code>net user /domain</code> to identify account information.(Citation: Secureworks BRONZE BUTLER Oct 2017)
- [G0035] Dragonfly: [Dragonfly](https://attack.mitre.org/groups/G0035) has used batch scripts to enumerate users on a victim domain controller.(Citation: US-CERT TA18-074A)
- [S0552] AdFind: [AdFind](https://attack.mitre.org/software/S0552) can enumerate domain users.(Citation: Red Canary Hospital Thwarted Ryuk October 2020)(Citation: FireEye FIN6 Apr 2019)(Citation: FireEye Ryuk and Trickbot January 2019)(Citation: Cybereason Bumblebee August 2022)(Citation: Symantec Bumblebee June 2022)

#### T1087.003 - Email Account

Description:

Adversaries may attempt to get a listing of email addresses and accounts. Adversaries may try to dump Exchange address lists such as global address lists (GALs).(Citation: Microsoft Exchange Address Lists)

In on-premises Exchange and Exchange Online, the <code>Get-GlobalAddressList</code> PowerShell cmdlet can be used to obtain email addresses and accounts from a domain using an authenticated session.(Citation: Microsoft getglobaladdresslist)(Citation: Black Hills Attacking Exchange MailSniper, 2016)

In Google Workspace, the GAL is shared with Microsoft Outlook users through the Google Workspace Sync for Microsoft Outlook (GWSMO) service. Additionally, the Google Workspace Directory allows for users to get a listing of other users within the organization.(Citation: Google Workspace Global Access List)

Procedures:

- [G0092] TA505: [TA505](https://attack.mitre.org/groups/G0092) has used the tool EmailStealer to steal and send lists of e-mail addresses to a remote server.(Citation: Trend Micro TA505 June 2019)
- [G0059] Magic Hound: [Magic Hound](https://attack.mitre.org/groups/G0059) has used Powershell to discover email accounts.(Citation: DFIR Report APT35 ProxyShell March 2022)
- [S0531] Grandoreiro: [Grandoreiro](https://attack.mitre.org/software/S0531) can parse Outlook .pst files to extract e-mail addresses.(Citation: ESET Grandoreiro April 2020)
- [G1039] RedCurl: [RedCurl](https://attack.mitre.org/groups/G1039) has collected information about email accounts.(Citation: group-ib_redcurl1)(Citation: group-ib_redcurl2)
- [G0034] Sandworm Team: [Sandworm Team](https://attack.mitre.org/groups/G0034) used malware to enumerate email settings, including usernames and passwords, from the M.E.Doc application.(Citation: ESET Telebots July 2017)
- [C0027] C0027: During [C0027](https://attack.mitre.org/campaigns/C0027), [Scattered Spider](https://attack.mitre.org/groups/G1015) accessed Azure AD to identify email addresses.(Citation: Crowdstrike TELCO BPO Campaign December 2022)
- [S0093] Backdoor.Oldrea: [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) collects address book information from Outlook.(Citation: Symantec Dragonfly)
- [S0266] TrickBot: [TrickBot](https://attack.mitre.org/software/S0266) collects email addresses from Outlook.(Citation: Trend Micro Trickbot Nov 2018)
- [S0681] Lizar: [Lizar](https://attack.mitre.org/software/S0681) can collect email accounts from Microsoft Outlook and Mozilla Thunderbird.(Citation: BiZone Lizar May 2021)
- [S0358] Ruler: [Ruler](https://attack.mitre.org/software/S0358) can be used to enumerate Exchange users and dump the GAL.(Citation: SensePost Ruler GitHub)
- [S0413] MailSniper: [MailSniper](https://attack.mitre.org/software/S0413) can be used to obtain account names from Exchange and Office 365 using the <code>Get-GlobalAddressList</code> cmdlet.(Citation: Black Hills Attacking Exchange MailSniper, 2016)
- [S0367] Emotet: [Emotet](https://attack.mitre.org/software/S0367) has been observed leveraging a module that can scrape email addresses from Outlook.(Citation: CIS Emotet Dec 2018)(Citation: IBM IcedID November 2017)(Citation: Binary Defense Emotes Wi-Fi Spreader)
- [C0038] HomeLand Justice: During [HomeLand Justice](https://attack.mitre.org/campaigns/C0038), threat actors used compromised Exchange accounts to search mailboxes for administrator accounts.(Citation: CISA Iran Albanian Attacks September 2022)
- [S0635] BoomBox: [BoomBox](https://attack.mitre.org/software/S0635) can execute an LDAP query to discover e-mail accounts for domain users.(Citation: MSTIC Nobelium Toolset May 2021)

#### T1087.004 - Cloud Account

Description:

Adversaries may attempt to get a listing of cloud accounts. Cloud accounts are those created and configured by an organization for use by users, remote support, services, or for administration of resources within a cloud service provider or SaaS application.

With authenticated access there are several tools that can be used to find accounts. The <code>Get-MsolRoleMember</code> PowerShell cmdlet can be used to obtain account names given a role or permissions group in Office 365.(Citation: Microsoft msolrolemember)(Citation: GitHub Raindance) The Azure CLI (AZ CLI) also provides an interface to obtain user accounts with authenticated access to a domain. The command <code>az ad user list</code> will list all users within a domain.(Citation: Microsoft AZ CLI)(Citation: Black Hills Red Teaming MS AD Azure, 2018) 

The AWS command <code>aws iam list-users</code> may be used to obtain a list of users in the current account while <code>aws iam list-roles</code> can obtain IAM roles that have a specified path prefix.(Citation: AWS List Roles)(Citation: AWS List Users) In GCP, <code>gcloud iam service-accounts list</code> and <code>gcloud projects get-iam-policy</code> may be used to obtain a listing of service accounts and users in a project.(Citation: Google Cloud - IAM Servie Accounts List API)

Procedures:

- [C0027] C0027: During [C0027](https://attack.mitre.org/campaigns/C0027), [Scattered Spider](https://attack.mitre.org/groups/G1015) accessed Azure AD to download bulk lists of group members and to identify privileged users, along with the email addresses and AD attributes.(Citation: Crowdstrike TELCO BPO Campaign December 2022)
- [S0684] ROADTools: [ROADTools](https://attack.mitre.org/software/S0684) can enumerate Azure AD users.(Citation: Roadtools)
- [S0677] AADInternals: [AADInternals](https://attack.mitre.org/software/S0677) can enumerate Azure AD users.(Citation: AADInternals Documentation)
- [G0016] APT29: [APT29](https://attack.mitre.org/groups/G0016) has conducted enumeration of Azure AD accounts.(Citation: MSTIC Nobelium Oct 2021)
- [S1091] Pacu: [Pacu](https://attack.mitre.org/software/S1091) can enumerate IAM users, roles, and groups. (Citation: GitHub Pacu)


### T1120 - Peripheral Device Discovery

Description:

Adversaries may attempt to gather information about attached peripheral devices and components connected to a computer system.(Citation: Peripheral Discovery Linux)(Citation: Peripheral Discovery macOS) Peripheral devices could include auxiliary resources that support a variety of functionalities such as keyboards, printers, cameras, smart card readers, or removable storage. The information may be used to enhance their awareness of the system and network environment or may be used for further actions.

Procedures:

- [S1139] INC Ransomware: [INC Ransomware](https://attack.mitre.org/software/S1139) can identify external USB and hard drives for encryption and printers to print ransom notes.(Citation: Cybereason INC Ransomware November 2023)
- [G0020] Equation: [Equation](https://attack.mitre.org/groups/G0020) has used tools with the functionality to search for specific information about the attached hard drive that could be used to identify and overwrite the firmware.(Citation: Kaspersky Equation QA)
- [C0012] Operation CuckooBees: During [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), the threat actors used the `fsutil fsinfo drives` command as part of their advanced reconnaissance.(Citation: Cybereason OperationCuckooBees May 2022)
- [G0067] APT37: [APT37](https://attack.mitre.org/groups/G0067) has a Bluetooth device harvester, which uses Windows Bluetooth APIs to find information on connected Bluetooth devices. (Citation: Securelist ScarCruft May 2019)
- [S0283] jRAT: [jRAT](https://attack.mitre.org/software/S0283) can map UPnP ports.(Citation: Kaspersky Adwind Feb 2016)
- [S0538] Crutch: [Crutch](https://attack.mitre.org/software/S0538) can monitor for removable drives being plugged into the compromised machine.(Citation: ESET Crutch December 2020)
- [S1044] FunnyDream: The [FunnyDream](https://attack.mitre.org/software/S1044) FilepakMonitor component can detect removable drive insertion.(Citation: Bitdefender FunnyDream Campaign November 2020)
- [S1149] CHIMNEYSWEEP: [CHIMNEYSWEEP](https://attack.mitre.org/software/S1149) can monitor for removable drives.(Citation: Mandiant ROADSWEEP August 2022)
- [S0385] njRAT: [njRAT](https://attack.mitre.org/software/S0385) will attempt to detect if the victim system has a camera during the initial infection. [njRAT](https://attack.mitre.org/software/S0385) can also detect any removable drives connected to the system.(Citation: Fidelis njRAT June 2013)(Citation: Trend Micro njRAT 2018)
- [S1026] Mongall: [Mongall](https://attack.mitre.org/software/S1026) can identify removable media attached to compromised hosts.(Citation: SentinelOne Aoqin Dragon June 2022)
- [S0113] Prikormka: A module in [Prikormka](https://attack.mitre.org/software/S0113) collects information on available printers and disk drives.(Citation: ESET Operation Groundbait)
- [S0366] WannaCry: [WannaCry](https://attack.mitre.org/software/S0366) contains a thread that will attempt to scan for new attached drives every few seconds. If one is identified, it will encrypt the files on the attached device.(Citation: FireEye WannaCry 2017)
- [S0251] Zebrocy: [Zebrocy](https://attack.mitre.org/software/S0251) enumerates information about connected storage devices.(Citation: Unit42 Cannon Nov 2018)
- [S0148] RTM: [RTM](https://attack.mitre.org/software/S0148) can obtain a list of smart card readers attached to the victim.(Citation: ESET RTM Feb 2017)(Citation: Unit42 Redaman January 2019)
- [S0644] ObliqueRAT: [ObliqueRAT](https://attack.mitre.org/software/S0644) can discover pluggable/removable drives to extract files from.(Citation: Talos Oblique RAT March 2021)
- [S0234] Bandook: [Bandook](https://attack.mitre.org/software/S0234) can detect USB devices.(Citation: EFF Manul Aug 2016)
- [S1167] AcidPour: [AcidPour](https://attack.mitre.org/software/S1167) includes functionality to identify MMC and SD cards connected to the victim device.(Citation: SentinelOne AcidPour 2024)
- [S0458] Ramsay: [Ramsay](https://attack.mitre.org/software/S0458) can scan for removable media which may contain documents for collection.(Citation: Eset Ramsay May 2020)(Citation: Antiy CERT Ramsay April 2020)
- [G0007] APT28: [APT28](https://attack.mitre.org/groups/G0007) uses a module to receive a notification every time a USB mass storage device is inserted into a victim.(Citation: Microsoft SIR Vol 19)
- [S0452] USBferry: [USBferry](https://attack.mitre.org/software/S0452) can check for connected USB devices.(Citation: TrendMicro Tropic Trooper May 2020)
- [S0149] MoonWind: [MoonWind](https://attack.mitre.org/software/S0149) obtains the number of removable drives from the victim.(Citation: Palo Alto MoonWind March 2017)
- [S0062] DustySky: [DustySky](https://attack.mitre.org/software/S0062) can detect connected USB devices.(Citation: Kaspersky MoleRATs April 2019)
- [S0438] Attor: [Attor](https://attack.mitre.org/software/S0438) has a plugin that collects information about inserted storage devices, modems, and phone devices.(Citation: ESET Attor Oct 2019)
- [S1064] SVCReady: [SVCReady](https://attack.mitre.org/software/S1064) can check for the number of devices plugged into an infected host.(Citation: HP SVCReady Jun 2022)
- [S0679] Ferocious: [Ferocious](https://attack.mitre.org/software/S0679) can run <code>GET.WORKSPACE</code> in Microsoft Excel to check if a mouse is present.(Citation: Kaspersky WIRTE November 2021)
- [S1199] LockBit 2.0: [LockBit 2.0](https://attack.mitre.org/software/S1199) has the ability to identify mounted external storage devices.(Citation: FBI Lockbit 2.0 FEB 2022)
- [S0089] BlackEnergy: [BlackEnergy](https://attack.mitre.org/software/S0089) can gather very specific information about attached USB devices, to include device instance ID and drive geometry.(Citation: Securelist BlackEnergy Nov 2014)
- [G0010] Turla: [Turla](https://attack.mitre.org/groups/G0010) has used <code>fsutil fsinfo drives</code> to list connected drives.(Citation: ESET ComRAT May 2020)
- [G0049] OilRig: [OilRig](https://attack.mitre.org/groups/G0049) has used tools to identify if a mouse is connected to a targeted system.(Citation: Check Point APT34 April 2021)
- [S0115] Crimson: [Crimson](https://attack.mitre.org/software/S0115) has the ability to discover pluggable/removable drives to extract files from.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)
- [S0603] Stuxnet: [Stuxnet](https://attack.mitre.org/software/S0603) enumerates removable drives for infection.(Citation: Nicolas Falliere, Liam O Murchu, Eric Chien February 2011)
- [S0381] FlawedAmmyy: [FlawedAmmyy](https://attack.mitre.org/software/S0381) will attempt to detect if a usable smart card is current inserted into a card reader.(Citation: Proofpoint TA505 Mar 2018)
- [S0045] ADVSTORESHELL: [ADVSTORESHELL](https://attack.mitre.org/software/S0045) can list connected devices.(Citation: ESET Sednit Part 2)
- [S0612] WastedLocker: [WastedLocker](https://attack.mitre.org/software/S0612) can enumerate removable drives prior to the encryption process.(Citation: Sentinel Labs WastedLocker July 2020)
- [S0686] QuietSieve: [QuietSieve](https://attack.mitre.org/software/S0686) can identify and search removable drives for specific file name extensions.(Citation: Microsoft Actinium February 2022)
- [S0650] QakBot: [QakBot](https://attack.mitre.org/software/S0650) can identify peripheral devices on targeted systems.(Citation: Trend Micro Qakbot May 2020)
- [C0014] Operation Wocao: During [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors discovered removable disks attached to a system.(Citation: FoxIT Wocao December 2019)
- [S0409] Machete: [Machete](https://attack.mitre.org/software/S0409) detects the insertion of new devices by listening for the WM_DEVICECHANGE window message.(Citation: ESET Machete July 2019)
- [S1150] ROADSWEEP: [ROADSWEEP](https://attack.mitre.org/software/S1150) can identify removable drives attached to the victim's machine.(Citation: Mandiant ROADSWEEP August 2022)
- [G0139] TeamTNT: [TeamTNT](https://attack.mitre.org/groups/G0139) has searched for attached VGA devices using lspci.(Citation: Cisco Talos Intelligence Group)
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has obtained victim's screen dimension and display device information.(Citation: CISA AA24-038A PRC Critical Infrastructure February 2024)
- [S1090] NightClub: [NightClub](https://attack.mitre.org/software/S1090) has the ability to monitor removable drives.(Citation: MoustachedBouncer ESET August 2023)
- [G0047] Gamaredon Group: [Gamaredon Group](https://attack.mitre.org/groups/G0047) tools have contained an application to check performance of USB flash drives. [Gamaredon Group](https://attack.mitre.org/groups/G0047) has also used malware to scan for removable drives.(Citation: Palo Alto Gamaredon Feb 2017)(Citation: ESET Gamaredon June 2020)
- [S1202] LockBit 3.0: [LockBit 3.0](https://attack.mitre.org/software/S1202) has the ability to discover external storage devices.(Citation: Joint Cybersecurity Advisory LockBit 3.0 MAR 2023)
- [G0135] BackdoorDiplomacy: [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) has used an executable to detect removable media, such as USB flash drives.(Citation: ESET BackdoorDiplomacy Jun 2021)
- [S1027] Heyoka Backdoor: [Heyoka Backdoor](https://attack.mitre.org/software/S1027) can identify removable media attached to victim's machines.(Citation: SentinelOne Aoqin Dragon June 2022)
- [S0454] Cadelspy: [Cadelspy](https://attack.mitre.org/software/S0454) has the ability to steal information about printers and the documents sent to printers.(Citation: Symantec Chafer Dec 2015)
- [S0481] Ragnar Locker: [Ragnar Locker](https://attack.mitre.org/software/S0481) may attempt to connect to removable drives and mapped network drives.(Citation: Sophos Ragnar May 2020)
- [S0098] T9000: [T9000](https://attack.mitre.org/software/S0098) searches through connected drives for removable storage devices.(Citation: Palo Alto T9000 Feb 2016)
- [S0467] TajMahal: [TajMahal](https://attack.mitre.org/software/S0467) has the ability to identify connected Apple devices.(Citation: Kaspersky TajMahal April 2019)
- [S1089] SharpDisco: [SharpDisco](https://attack.mitre.org/software/S1089) has dropped a plugin to monitor external drives to `C:\Users\Public\It3.exe`.(Citation: MoustachedBouncer ESET August 2023)
- [S0647] Turian: [Turian](https://attack.mitre.org/software/S0647) can scan for removable media to collect data.(Citation: ESET BackdoorDiplomacy Jun 2021)
- [S0136] USBStealer: [USBStealer](https://attack.mitre.org/software/S0136) monitors victims for insertion of removable drives. When dropped onto a second victim, it also enumerates drives connected to the system.(Citation: ESET Sednit USBStealer 2014)
- [S0128] BADNEWS: [BADNEWS](https://attack.mitre.org/software/S0128) checks for new hard drives on the victim, such as USB devices, by listening for the WM_DEVICECHANGE window message.(Citation: Forcepoint Monsoon)(Citation: TrendMicro Patchwork Dec 2017)
- [S0673] DarkWatchman: [DarkWatchman](https://attack.mitre.org/software/S0673) can list signed PnP drivers for smartcard readers.(Citation: Prevailion DarkWatchman 2021)


### T1124 - System Time Discovery

Description:

An adversary may gather the system time and/or time zone settings from a local or remote system. The system time is set and stored by services, such as the Windows Time Service on Windows or <code>systemsetup</code> on macOS.(Citation: MSDN System Time)(Citation: Technet Windows Time Service)(Citation: systemsetup mac time) These time settings may also be synchronized between systems and services in an enterprise network, typically accomplished with a network time server within a domain.(Citation: Mac Time Sync)(Citation: linux system time)

System time information may be gathered in a number of ways, such as with [Net](https://attack.mitre.org/software/S0039) on Windows by performing <code>net time \\hostname</code> to gather the system time on a remote system. The victim's time zone may also be inferred from the current system time or gathered by using <code>w32tm /tz</code>.(Citation: Technet Windows Time Service) In addition, adversaries can discover device uptime through functions such as <code>GetTickCount()</code> to determine how long it has been since the system booted up.(Citation: Virtualization/Sandbox Evasion)

On network devices, [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as `show clock detail` can be used to see the current time configuration.(Citation: show_clock_detail_cisco_cmd) On ESXi servers, `esxcli system clock get` can be used for the same purpose.

In addition, system calls – such as <code>time()</code> – have been used to collect the current time on Linux devices.(Citation: MAGNET GOBLIN) On macOS systems, adversaries may use commands such as <code>systemsetup -gettimezone</code> or <code>timeIntervalSinceNow</code> to gather current time zone information or current date and time.(Citation: System Information Discovery Technique)(Citation: ESET DazzleSpy Jan 2022)

This information could be useful for performing other techniques, such as executing a file with a [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053)(Citation: RSA EU12 They're Inside), or to discover locality information based on time zone to assist in victim targeting (i.e. [System Location Discovery](https://attack.mitre.org/techniques/T1614)). Adversaries may also use knowledge of system time as part of a time bomb, or delaying execution until a specified date/time.(Citation: AnyRun TimeBomb)

Procedures:

- [S0140] Shamoon: [Shamoon](https://attack.mitre.org/software/S0140) obtains the system time and will only activate if it is greater than a preset date.(Citation: Palo Alto Shamoon Nov 2016)(Citation: Unit 42 Shamoon3 2018)
- [S1178] ShrinkLocker: [ShrinkLocker](https://attack.mitre.org/software/S1178) retrieves a system timestamp that is used in generating an encryption key.(Citation: Splunk ShrinkLocker 2024)
- [S0373] Astaroth: [Astaroth](https://attack.mitre.org/software/S0373) collects the timestamp from the infected machine. (Citation: Cofense Astaroth Sept 2018)
- [S0251] Zebrocy: [Zebrocy](https://attack.mitre.org/software/S0251) gathers the current time zone and date information from the system.(Citation: ESET Zebrocy Nov 2018)(Citation: CISA Zebrocy Oct 2020)
- [S0596] ShadowPad: [ShadowPad](https://attack.mitre.org/software/S0596) has collected the current date and time of the victim system.(Citation: Kaspersky ShadowPad Aug 2017)
- [S0011] Taidoor: [Taidoor](https://attack.mitre.org/software/S0011) can use <code>GetLocalTime</code> and <code>GetSystemTime</code> to collect system time.(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021)
- [S0396] EvilBunny: [EvilBunny](https://attack.mitre.org/software/S0396) has used the API calls NtQuerySystemTime, GetSystemTimeAsFileTime, and GetTickCount to gather time metrics as part of its checks to see if the malware is running in a sandbox.(Citation: Cyphort EvilBunny Dec 2014)
- [S0098] T9000: [T9000](https://attack.mitre.org/software/S0098) gathers and beacons the system time during installation.(Citation: Palo Alto T9000 Feb 2016)
- [S1051] KEYPLUG: [KEYPLUG](https://attack.mitre.org/software/S1051) can obtain the current tick count of an infected computer.(Citation: Mandiant APT41)
- [G0121] Sidewinder: [Sidewinder](https://attack.mitre.org/groups/G0121) has used tools to obtain the current system time.(Citation: ATT Sidewinder January 2021)
- [S0039] Net: The <code>net time</code> command can be used in [Net](https://attack.mitre.org/software/S0039) to determine the local or remote system time.(Citation: TechNet Net Time)
- [S0615] SombRAT: [SombRAT](https://attack.mitre.org/software/S0615) can execute <code>getinfo</code>  to discover the current time on a compromised host.(Citation: BlackBerry CostaRicto November 2020)(Citation: CISA AR21-126A FIVEHANDS May 2021)
- [S0091] Epic: [Epic](https://attack.mitre.org/software/S0091) uses the <code>net time</code> command  to get the system time from the machine and collect the current date and time zone information.(Citation: Kaspersky Turla)
- [S0678] Torisma: [Torisma](https://attack.mitre.org/software/S0678) can collect the current time on a victim machine.(Citation: McAfee Lazarus Nov 2020)
- [C0012] Operation CuckooBees: During [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), the threat actors used the `net time` command as part of their advanced reconnaissance.(Citation: Cybereason OperationCuckooBees May 2022)
- [S0275] UPPERCUT: [UPPERCUT](https://attack.mitre.org/software/S0275) has the capability to obtain the time zone information and current timestamp of the victim’s machine.(Citation: FireEye APT10 Sept 2018)
- [S0588] GoldMax: [GoldMax](https://attack.mitre.org/software/S0588) can check the current date-time value of the compromised system, comparing it to the hardcoded execution trigger and can send the current timestamp to the C2 server.(Citation: MSTIC NOBELIUM Mar 2021)(Citation: FireEye SUNSHUTTLE Mar 2021)
- [S0608] Conficker: [Conficker](https://attack.mitre.org/software/S0608) uses the current UTC victim system date for domain generation and connects to time servers to determine the current date.(Citation: SANS Conficker)(Citation: Trend Micro Conficker)
- [C0014] Operation Wocao: During [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors used the `time` command to retrieve the current time of a compromised system.(Citation: FoxIT Wocao December 2019)
- [S0237] GravityRAT: [GravityRAT](https://attack.mitre.org/software/S0237) can obtain the date and time of a system.(Citation: Talos GravityRAT)
- [S0331] Agent Tesla: [Agent Tesla](https://attack.mitre.org/software/S0331) can collect the timestamp from the victim’s machine.(Citation: DigiTrust Agent Tesla Jan 2017)
- [S1043] ccf32: [ccf32](https://attack.mitre.org/software/S1043) can determine the local time on targeted machines.(Citation: Bitdefender FunnyDream Campaign November 2020)
- [S1081] BADHATCH: [BADHATCH](https://attack.mitre.org/software/S1081) can obtain the `DATETIME` and `UPTIME` from a compromised machine.(Citation: BitDefender BADHATCH Mar 2021)
- [S0417] GRIFFON: [GRIFFON](https://attack.mitre.org/software/S0417) has used a reconnaissance module that can be used to retrieve the date and time of the system.(Citation: SecureList Griffon May 2019)
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has obtained the victim's system timezone.(Citation: CISA AA24-038A PRC Critical Infrastructure February 2024)
- [S0650] QakBot: [QakBot](https://attack.mitre.org/software/S0650) can identify the system time on a targeted host.(Citation: Kaspersky QakBot September 2021)
- [S0335] Carbon: [Carbon](https://attack.mitre.org/software/S0335) uses the command <code>net time \\127.0.0.1</code> to get information the system’s time.(Citation: GovCERT Carbon May 2016)
- [G0126] Higaisa: [Higaisa](https://attack.mitre.org/groups/G0126) used a function to gather the current time.(Citation: Zscaler Higaisa 2020)
- [S0554] Egregor: [Egregor](https://attack.mitre.org/software/S0554) contains functionality to query the local/system time.(Citation: JoeSecurity Egregor 2020)
- [S0115] Crimson: [Crimson](https://attack.mitre.org/software/S0115) has the ability to determine the date and time on a compromised host.(Citation: Kaspersky Transparent Tribe August 2020)
- [S0455] Metamorfo: [Metamorfo](https://attack.mitre.org/software/S0455) uses JavaScript to get the system time.(Citation: Medium Metamorfo Apr 2020)
- [S0148] RTM: [RTM](https://attack.mitre.org/software/S0148) can obtain the victim time zone.(Citation: ESET RTM Feb 2017)
- [S0353] NOKKI: [NOKKI](https://attack.mitre.org/software/S0353) can collect the current timestamp of the victim's machine.(Citation: Unit 42 NOKKI Sept 2018)
- [S0531] Grandoreiro: [Grandoreiro](https://attack.mitre.org/software/S0531) can determine the time on the victim machine via IPinfo.(Citation: ESET Grandoreiro April 2020)
- [S0673] DarkWatchman: [DarkWatchman](https://attack.mitre.org/software/S0673) can collect time zone information and system `UPTIME`.(Citation: Prevailion DarkWatchman 2021)
- [S0694] DRATzarus: [DRATzarus](https://attack.mitre.org/software/S0694) can use the `GetTickCount` and `GetSystemTimeAsFileTime` API calls to inspect system time.(Citation: ClearSky Lazarus Aug 2020)
- [S0380] StoneDrill: [StoneDrill](https://attack.mitre.org/software/S0380) can obtain the current date and time of the victim machine.(Citation: Kaspersky StoneDrill 2017)
- [S0559] SUNBURST: [SUNBURST](https://attack.mitre.org/software/S0559) collected device `UPTIME`.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: Microsoft Analyzing Solorigate Dec 2020)
- [S0471] build_downer: [build_downer](https://attack.mitre.org/software/S0471) has the ability to determine the local time to ensure malware installation only happens during the hours that the infected system is active.(Citation: Trend Micro Tick November 2019)
- [G0128] ZIRCONIUM: [ZIRCONIUM](https://attack.mitre.org/groups/G0128) has used a tool to capture the time on a compromised host in order to register it with C2.(Citation: Zscaler APT31 Covid-19 October 2020)
- [S1148] Raccoon Stealer: [Raccoon Stealer](https://attack.mitre.org/software/S1148) gathers victim machine timezone information.(Citation: S2W Racoon 2022)(Citation: Sekoia Raccoon2 2022)
- [S0467] TajMahal: [TajMahal](https://attack.mitre.org/software/S0467) has the ability to determine local time on a compromised host.(Citation: Kaspersky TajMahal April 2019)
- [S1033] DCSrv: [DCSrv](https://attack.mitre.org/software/S1033) can compare the current time on an infected host with a configuration value to determine when to start the encryption process.(Citation: Checkpoint MosesStaff Nov 2021)
- [S0692] SILENTTRINITY: [SILENTTRINITY](https://attack.mitre.org/software/S0692) can collect start time information from a compromised host.(Citation: GitHub SILENTTRINITY Modules July 2019)
- [S0139] PowerDuke: [PowerDuke](https://attack.mitre.org/software/S0139) has commands to get the time the machine was built, the time, and the time zone.(Citation: Volexity PowerDuke November 2016)
- [G0060] BRONZE BUTLER: [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) has used <code>net time</code> to check the local time on a target system.(Citation: Secureworks BRONZE BUTLER Oct 2017)
- [S0534] Bazar: [Bazar](https://attack.mitre.org/software/S0534) can collect the time on the compromised host.(Citation: Cybereason Bazar July 2020)(Citation: NCC Group Team9 June 2020)
- [S0149] MoonWind: [MoonWind](https://attack.mitre.org/software/S0149) obtains the victim's current time.(Citation: Palo Alto MoonWind March 2017)
- [S0017] BISCUIT: [BISCUIT](https://attack.mitre.org/software/S0017) has a command to collect the system `UPTIME`.(Citation: Mandiant APT1)
- [G1012] CURIUM: [CURIUM](https://attack.mitre.org/groups/G1012) deployed mechanisms to check system time information following strategic website compromise attacks.(Citation: PWC Yellow Liderc 2023)
- [S1044] FunnyDream: [FunnyDream](https://attack.mitre.org/software/S1044) can check system time to help determine when changes were made to specified files.(Citation: Bitdefender FunnyDream Campaign November 2020)
- [G0010] Turla: [Turla](https://attack.mitre.org/groups/G0010) surveys a system upon check-in to discover the system time by using the <code>net time</code> command.(Citation: Kaspersky Turla)
- [S0267] FELIXROOT: [FELIXROOT](https://attack.mitre.org/software/S0267) gathers the time zone information from the victim’s machine.(Citation: ESET GreyEnergy Oct 2018)
- [S1034] StrifeWater: [StrifeWater](https://attack.mitre.org/software/S1034) can collect the time zone from the victim's machine.(Citation: Cybereason StrifeWater Feb 2022)
- [S1147] Nightdoor: [Nightdoor](https://attack.mitre.org/software/S1147) can identify the system local time information.(Citation: ESET EvasivePanda 2024)
- [G0012] Darkhotel: [Darkhotel](https://attack.mitre.org/groups/G0012) malware can obtain system time from a compromised host.(Citation: Lastline DarkHotel Just In Time Decryption Nov 2015)
- [S1064] SVCReady: [SVCReady](https://attack.mitre.org/software/S1064) can collect time zone information.(Citation: HP SVCReady Jun 2022)
- [S0330] Zeus Panda: [Zeus Panda](https://attack.mitre.org/software/S0330) collects the current system time (UTC) and sends it back to the C2 server.(Citation: GDATA Zeus Panda June 2017)
- [S0501] PipeMon: [PipeMon](https://attack.mitre.org/software/S0501) can send time zone information from a compromised host to C2.(Citation: ESET PipeMon May 2020)
- [G0114] Chimera: [Chimera](https://attack.mitre.org/groups/G0114) has used <code>time /t</code> and <code>net time \\ip/hostname</code> for system time discovery.(Citation: NCC Group Chimera January 2021)
- [S0344] Azorult: [Azorult](https://attack.mitre.org/software/S0344) can collect the time zone information from the system.(Citation: Unit42 Azorult Nov 2018)(Citation: Proofpoint Azorult July 2018)
- [S0351] Cannon: [Cannon](https://attack.mitre.org/software/S0351) can collect the current time zone information from the victim’s machine.(Citation: Unit42 Cannon Nov 2018)
- [S1111] DarkGate: [DarkGate](https://attack.mitre.org/software/S1111) creates a log file for capturing keylogging, clipboard, and related data using the victim host's current date for the filename.(Citation: Ensilo Darkgate 2018) [DarkGate](https://attack.mitre.org/software/S1111) queries victim system epoch time during execution.(Citation: Ensilo Darkgate 2018) [DarkGate](https://attack.mitre.org/software/S1111) captures system time information as part of automated profiling on initial installation.(Citation: Trellix Darkgate 2023)
- [S1134] DEADWOOD: [DEADWOOD](https://attack.mitre.org/software/S1134) will set a timestamp value to determine when wiping functionality starts. When the timestamp is met on the system, a trigger file is created on the operating system allowing for execution to proceed. If the timestamp is in the past, the wiper will execute immediately.(Citation: SentinelOne Agrius 2021)
- [S0660] Clambling: [Clambling](https://attack.mitre.org/software/S0660) can determine the current time.(Citation: Trend Micro DRBControl February 2020)
- [S1159] DUSTTRAP: [DUSTTRAP](https://attack.mitre.org/software/S1159) reads the infected system's current time and writes it to a log file during execution.(Citation: Google Cloud APT41 2024)
- [S0586] TAINTEDSCRIBE: [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) can execute <code>GetLocalTime</code> for time discovery.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE MAY 2020)
- [C0015] C0015: During [C0015](https://attack.mitre.org/campaigns/C0015), the threat actors used the command `net view /all time` to gather the local time of a compromised network.(Citation: DFIR Conti Bazar Nov 2021)
- [S0126] ComRAT: [ComRAT](https://attack.mitre.org/software/S0126) has checked the victim system's date and time to perform tasks during business hours (9 to 5, Monday to Friday).(Citation: CISA ComRAT Oct 2020)
- [S0574] BendyBear: [BendyBear](https://attack.mitre.org/software/S0574) has the ability to determine local time on a compromised host.(Citation: Unit42 BendyBear Feb 2021)
- [S0603] Stuxnet: [Stuxnet](https://attack.mitre.org/software/S0603) collects the time and date of a system when it is infected.(Citation: Nicolas Falliere, Liam O Murchu, Eric Chien February 2011)
- [G0032] Lazarus Group: A Destover-like implant used by [Lazarus Group](https://attack.mitre.org/groups/G0032) can obtain the current system time and send it to the C2 server.(Citation: McAfee GhostSecret)
- [S0376] HOPLIGHT: [HOPLIGHT](https://attack.mitre.org/software/S0376) has been observed collecting system time from victim machines.(Citation: US-CERT HOPLIGHT Apr 2019)
- [S0657] BLUELIGHT: [BLUELIGHT](https://attack.mitre.org/software/S0657) can collect the local time on a compromised host.(Citation: Volexity InkySquid BLUELIGHT August 2021)
- [S0238] Proxysvc: As part of the data reconnaissance phase, [Proxysvc](https://attack.mitre.org/software/S0238) grabs the system time to send back to the control server.(Citation: McAfee GhostSecret)
- [S0264] OopsIE: [OopsIE](https://attack.mitre.org/software/S0264) checks to see if the system is configured with "Daylight" time and checks for a specific region to be set for the timezone.(Citation: Unit 42 OilRig Sept 2018)
- [S0260] InvisiMole: [InvisiMole](https://attack.mitre.org/software/S0260) gathers the local system time from the victim’s machine.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020)
- [S0450] SHARPSTATS: [SHARPSTATS](https://attack.mitre.org/software/S0450) has the ability to identify the current date and time on the compromised host.(Citation: TrendMicro POWERSTATS V3 June 2019)
- [S0690] Green Lambert: [Green Lambert](https://attack.mitre.org/software/S0690) can collect the date and time from a compromised host.(Citation: Objective See Green Lambert for OSX Oct 2021)(Citation: Glitch-Cat Green Lambert ATTCK Oct 2021)
- [S0439] Okrum: [Okrum](https://attack.mitre.org/software/S0439) can obtain the date and time of the compromised system.(Citation: ESET Okrum July 2019)
- [S0268] Bisonal: [Bisonal](https://attack.mitre.org/software/S0268) can check the system time set on the infected host.(Citation: Kaspersky CactusPete Aug 2020)
- [S0622] AppleSeed: [AppleSeed](https://attack.mitre.org/software/S0622) can pull a timestamp from the victim's machine.(Citation: Malwarebytes Kimsuky June 2021)
- [S1053] AvosLocker: [AvosLocker](https://attack.mitre.org/software/S1053) has checked the system time before and after encryption.(Citation: Malwarebytes AvosLocker Jul 2021)
- [G0089] The White Company: [The White Company](https://attack.mitre.org/groups/G0089) has checked the current date on the victim system.(Citation: Cylance Shaheen Nov 2018)
- [S0466] WindTail: [WindTail](https://attack.mitre.org/software/S0466) has the ability to generate the current date and time.(Citation: objective-see windtail1 dec 2018)


### T1135 - Network Share Discovery

Description:

Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement. Networks often contain shared network drives and folders that enable users to access file directories on various systems across a network. 

File sharing over a Windows network occurs over the SMB protocol. (Citation: Wikipedia Shared Resource) (Citation: TechNet Shared Folder) [Net](https://attack.mitre.org/software/S0039) can be used to query a remote system for available shared drives using the <code>net view \\\\remotesystem</code> command. It can also be used to query shared drives on the local system using <code>net share</code>. For macOS, the <code>sharing -l</code> command lists all shared points used for smb services.

Procedures:

- [S1081] BADHATCH: [BADHATCH](https://attack.mitre.org/software/S1081) can check a user's access to the C$ share on a compromised machine.(Citation: BitDefender BADHATCH Mar 2021)
- [S1180] BlackByte Ransomware: [BlackByte Ransomware](https://attack.mitre.org/software/S1180) can identify network shares connected to the victim machine.(Citation: Trustwave BlackByte 2021)
- [S0458] Ramsay: [Ramsay](https://attack.mitre.org/software/S0458) can scan for network drives which may contain documents for collection.(Citation: Eset Ramsay May 2020)(Citation: Antiy CERT Ramsay April 2020)
- [C0015] C0015: During [C0015](https://attack.mitre.org/campaigns/C0015), the threat actors executed the PowerView ShareFinder module to identify open shares.(Citation: DFIR Conti Bazar Nov 2021)
- [S0575] Conti: [Conti](https://attack.mitre.org/software/S0575) can enumerate remote open SMB network shares using <code>NetShareEnum()</code>.(Citation: CarbonBlack Conti July 2020)(Citation: CrowdStrike Wizard Spider October 2020)
- [G0131] Tonto Team: [Tonto Team](https://attack.mitre.org/groups/G0131) has used tools such as [NBTscan](https://attack.mitre.org/software/S0590) to enumerate network shares.(Citation: TrendMicro Tonto Team October 2020)
- [S0192] Pupy: [Pupy](https://attack.mitre.org/software/S0192) can list local and remote shared drives and folders over SMB.(Citation: GitHub Pupy)
- [S0534] Bazar: [Bazar](https://attack.mitre.org/software/S0534) can enumerate shared drives on the domain.(Citation: NCC Group Team9 June 2020)
- [S1160] Latrodectus: [Latrodectus](https://attack.mitre.org/software/S1160) can run `C:\Windows\System32\cmd.exe /c net view /all` to discover network shares.(Citation: Elastic Latrodectus May 2024)(Citation: Bitsight Latrodectus June 2024)
- [S0625] Cuba: [Cuba](https://attack.mitre.org/software/S0625) can discover shared resources using the <code>NetShareEnum</code> API call.(Citation: McAfee Cuba April 2021)
- [S0236] Kwampirs: [Kwampirs](https://attack.mitre.org/software/S0236) collects a list of network shares with the command <code>net share</code>.(Citation: Symantec Orangeworm April 2018)
- [S0650] QakBot: [QakBot](https://attack.mitre.org/software/S0650) can use <code>net share</code> to identify network shares for use in lateral movement.(Citation: Trend Micro Qakbot May 2020)(Citation: Kaspersky QakBot September 2021)
- [G0087] APT39: [APT39](https://attack.mitre.org/groups/G0087) has used the post exploitation tool [CrackMapExec](https://attack.mitre.org/software/S0488) to enumerate network shares.(Citation: BitDefender Chafer May 2020)
- [S0692] SILENTTRINITY: [SILENTTRINITY](https://attack.mitre.org/software/S0692) can enumerate shares on a compromised host.(Citation: GitHub SILENTTRINITY Modules July 2019)
- [S0659] Diavol: [Diavol](https://attack.mitre.org/software/S0659) has a `ENMDSKS` command to enumerates available network shares.(Citation: Fortinet Diavol July 2021)
- [G0105] DarkVishnya: [DarkVishnya](https://attack.mitre.org/groups/G0105) scanned the network for public shared folders.(Citation: Securelist DarkVishnya Dec 2018)
- [S0039] Net: The <code>net view \\remotesystem</code> and <code>net share</code> commands in [Net](https://attack.mitre.org/software/S0039) can be used to find shared drives and directories on remote and local systems respectively.(Citation: Savill 1999)
- [S1141] LunarWeb: [LunarWeb](https://attack.mitre.org/software/S1141) can identify shared resources in compromised environments.(Citation: ESET Turla Lunar toolset May 2024)
- [G0050] APT32: [APT32](https://attack.mitre.org/groups/G0050) used the <code>net view</code> command to show all shares available, including the administrative shares such as <code>C$</code> and <code>ADMIN$</code>.(Citation: Cybereason Cobalt Kitty 2017)
- [S0618] FIVEHANDS: [FIVEHANDS](https://attack.mitre.org/software/S0618) can enumerate network shares and mounted drives on a network.(Citation: NCC Group Fivehands June 2021)
- [S0367] Emotet: [Emotet](https://attack.mitre.org/software/S0367) has enumerated non-hidden network shares using `WNetEnumResourceW`. (Citation: Binary Defense Emotes Wi-Fi Spreader)
- [G0096] APT41: [APT41](https://attack.mitre.org/groups/G0096) used the <code>net share</code> command as part of network reconnaissance.(Citation: FireEye APT41 Aug 2019)(Citation: Group IB APT 41 June 2021)
- [S1085] Sardonic: [Sardonic](https://attack.mitre.org/software/S1085) has the ability to execute the `net view` command.(Citation: Bitdefender Sardonic Aug 2021)
- [S0013] PlugX: [PlugX](https://attack.mitre.org/software/S0013) has a module to enumerate network shares.(Citation: CIRCL PlugX March 2013)
- [S0488] CrackMapExec: [CrackMapExec](https://attack.mitre.org/software/S0488) can enumerate the shared folders and associated permissions for a targeted network.(Citation: CME Github September 2018)
- [S0570] BitPaymer: [BitPaymer](https://attack.mitre.org/software/S0570) can search for network shares on the domain or workgroup using <code>net view <host></code>.(Citation: Crowdstrike Indrik November 2018)
- [S1139] INC Ransomware: [INC Ransomware](https://attack.mitre.org/software/S1139) has the ability to check for shared network drives to encrypt.(Citation: Cybereason INC Ransomware November 2023)
- [S0363] Empire: [Empire](https://attack.mitre.org/software/S0363) can find shared drives on the local system.(Citation: Github PowerShell Empire)
- [G0114] Chimera: [Chimera](https://attack.mitre.org/groups/G0114) has used <code>net share</code> and <code>net view</code> to identify network shares of interest.(Citation: NCC Group Chimera January 2021)
- [S0606] Bad Rabbit: [Bad Rabbit](https://attack.mitre.org/software/S0606) enumerates open SMB shares on internal victim networks.(Citation: ESET Bad Rabbit)
- [S1181] BlackByte 2.0 Ransomware: [BlackByte 2.0 Ransomware](https://attack.mitre.org/software/S1181) can identify network shares connected to the victim machine.(Citation: Microsoft BlackByte 2023)
- [S0266] TrickBot: [TrickBot](https://attack.mitre.org/software/S0266) module shareDll/mshareDll discovers network shares via the WNetOpenEnumA API.(Citation: ESET Trickbot Oct 2020)(Citation: Bitdefender Trickbot March 2020)
- [C0014] Operation Wocao: During [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors discovered network disks mounted to the system using [netstat](https://attack.mitre.org/software/S0104).(Citation: FoxIT Wocao December 2019)
- [S1075] KOPILUWAK: [KOPILUWAK](https://attack.mitre.org/software/S1075) can use [netstat](https://attack.mitre.org/software/S0104) and [Net](https://attack.mitre.org/software/S0039) to discover network shares.(Citation: Mandiant Suspected Turla Campaign February 2023)
- [S1129] Akira: [Akira](https://attack.mitre.org/software/S1129) can identify remote file shares for encryption.(Citation: Kersten Akira 2023)
- [S1199] LockBit 2.0: [LockBit 2.0](https://attack.mitre.org/software/S1199) can discover remote shares.(Citation: FBI Lockbit 2.0 FEB 2022)
- [G0082] APT38: [APT38](https://attack.mitre.org/groups/G0082) has enumerated network shares on a compromised host.(Citation: CISA AA20-239A BeagleBoyz August 2020)
- [S1073] Royal: [Royal](https://attack.mitre.org/software/S1073) can enumerate the shared resources of a given IP addresses using the API call `NetShareEnum`.(Citation: Cybereason Royal December 2022)
- [S0689] WhisperGate: [WhisperGate](https://attack.mitre.org/software/S0689) can enumerate connected remote logical drives.(Citation: Cisco Ukraine Wipers January 2022)
- [S0617] HELLOKITTY: [HELLOKITTY](https://attack.mitre.org/software/S0617) has the ability to enumerate network resources.(Citation: FireEye FiveHands April 2021)
- [S0660] Clambling: [Clambling](https://attack.mitre.org/software/S0660) has the ability to enumerate network shares.(Citation: Trend Micro DRBControl February 2020)
- [S1202] LockBit 3.0: [LockBit 3.0](https://attack.mitre.org/software/S1202) can identify network shares on compromised systems.(Citation: Joint Cybersecurity Advisory LockBit 3.0 MAR 2023)
- [S1068] BlackCat: [BlackCat](https://attack.mitre.org/software/S1068) has the ability to discover network shares on compromised networks.(Citation: Microsoft BlackCat Jun 2022)(Citation: Sophos BlackCat Jul 2022)
- [C0049] Leviathan Australian Intrusions: [Leviathan](https://attack.mitre.org/groups/G0065) scanned and enumerated remote network shares in victim environments during [Leviathan Australian Intrusions](https://attack.mitre.org/campaigns/C0049).(Citation: CISA Leviathan 2024)
- [S0154] Cobalt Strike: [Cobalt Strike](https://attack.mitre.org/software/S0154) can query shared drives on the local system.(Citation: Cobalt Strike TTPs Dec 2017)
- [S0640] Avaddon: [Avaddon](https://attack.mitre.org/software/S0640) has enumerated shared folders and mapped volumes.(Citation: Arxiv Avaddon Feb 2021)
- [G1043] BlackByte: [BlackByte](https://attack.mitre.org/groups/G1043) enumerated network shares on victim devices.(Citation: Cisco BlackByte 2024)
- [S0696] Flagpro: [Flagpro](https://attack.mitre.org/software/S0696) has been used to execute `net view` to discover mapped network shares.(Citation: NTT Security Flagpro new December 2021)
- [S0611] Clop: [Clop](https://attack.mitre.org/software/S0611) can enumerate network shares.(Citation: Mcafee Clop Aug 2019)
- [S0483] IcedID: [IcedID](https://attack.mitre.org/software/S0483) has used the `net view /all` command to show available shares.(Citation: DFIR_Quantum_Ransomware)
- [S0638] Babuk: [Babuk](https://attack.mitre.org/software/S0638) has the ability to enumerate network shares.(Citation: Sogeti CERT ESEC Babuk March 2021)
- [G1016] FIN13: [FIN13](https://attack.mitre.org/groups/G1016) has executed net view commands for enumeration of open shares on compromised machines.(Citation: Mandiant FIN13 Aug 2022)(Citation: Sygnia Elephant Beetle Jan 2022)
- [G0081] Tropic Trooper: [Tropic Trooper](https://attack.mitre.org/groups/G0081) used <code>netview</code> to scan target systems for shared resources.(Citation: TrendMicro TropicTrooper 2015)
- [S1212] RansomHub: [RansomHub](https://attack.mitre.org/software/S1212) has the ability to target specific network shares for encryption.(Citation: Group-IB RansomHub FEB 2025)
- [S0612] WastedLocker: [WastedLocker](https://attack.mitre.org/software/S0612) can identify network adjacent and accessible drives.(Citation: Sentinel Labs WastedLocker July 2020)
- [S0365] Olympic Destroyer: [Olympic Destroyer](https://attack.mitre.org/software/S0365) will attempt to enumerate mapped network shares to later attempt to wipe all files on those shares.(Citation: Talos Olympic Destroyer 2018)
- [G1032] INC Ransom: [INC Ransom](https://attack.mitre.org/groups/G1032) has used Internet Explorer to view folders on other systems.(Citation: Huntress INC Ransom Group August 2023)
- [G0054] Sowbug: [Sowbug](https://attack.mitre.org/groups/G0054) listed remote shared drives that were accessible from a victim.(Citation: Symantec Sowbug Nov 2017)
- [S0233] MURKYTOP: [MURKYTOP](https://attack.mitre.org/software/S0233) has the capability to retrieve information about shares on remote hosts.(Citation: FireEye Periscope March 2018)
- [S0165] OSInfo: [OSInfo](https://attack.mitre.org/software/S0165) discovers shares on the network(Citation: Symantec Buckeye)
- [S0603] Stuxnet: [Stuxnet](https://attack.mitre.org/software/S0603) enumerates the directories of a network resource.(Citation: Nicolas Falliere, Liam O Murchu, Eric Chien February 2011)
- [S0444] ShimRat: [ShimRat](https://attack.mitre.org/software/S0444) can enumerate connected drives for infected host machines.(Citation: FOX-IT May 2016 Mofang)
- [G0035] Dragonfly: [Dragonfly](https://attack.mitre.org/groups/G0035) has identified and browsed file servers in the victim network, sometimes , viewing files pertaining to ICS or Supervisory Control and Data Acquisition (SCADA) systems.(Citation: US-CERT TA18-074A)
- [S1053] AvosLocker: [AvosLocker](https://attack.mitre.org/software/S1053) has enumerated shared drives on a compromised network.(Citation: Malwarebytes AvosLocker Jul 2021)(Citation: Joint CSA AvosLocker Mar 2022)
- [C0012] Operation CuckooBees: During [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), the threat actors used the `net share` command as part of their advanced reconnaissance.(Citation: Cybereason OperationCuckooBees May 2022)
- [G0006] APT1: [APT1](https://attack.mitre.org/groups/G0006) listed connected network shares.(Citation: Mandiant APT1)
- [S0260] InvisiMole: [InvisiMole](https://attack.mitre.org/software/S0260) can gather network share information.(Citation: ESET InvisiMole June 2018)
- [S0251] Zebrocy: [Zebrocy](https://attack.mitre.org/software/S0251) identifies network drives when they are added to victim systems.(Citation: Securelist Sofacy Feb 2018)
- [G0102] Wizard Spider: [Wizard Spider](https://attack.mitre.org/groups/G0102) has used the “net view” command to locate mapped network shares.(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020)
- [S0250] Koadic: [Koadic](https://attack.mitre.org/software/S0250) can scan local network for open SMB.(Citation: Github Koadic)
- [S0616] DEATHRANSOM: [DEATHRANSOM](https://attack.mitre.org/software/S0616) has the ability to use loop operations to enumerate network resources.(Citation: FireEye FiveHands April 2021)
- [S0686] QuietSieve: [QuietSieve](https://attack.mitre.org/software/S0686) can identify and search networked drives for specific file name extensions.(Citation: Microsoft Actinium February 2022)
- [S1159] DUSTTRAP: [DUSTTRAP](https://attack.mitre.org/software/S1159) can identify and enumerate victim system network shares.(Citation: Google Cloud APT41 2024)


### T1201 - Password Policy Discovery

Description:

Adversaries may attempt to access detailed information about the password policy used within an enterprise network or cloud environment. Password policies are a way to enforce complex passwords that are difficult to guess or crack through [Brute Force](https://attack.mitre.org/techniques/T1110). This information may help the adversary to create a list of common passwords and launch dictionary and/or brute force attacks which adheres to the policy (e.g. if the minimum password length should be 8, then not trying passwords such as 'pass123'; not checking for more than 3-4 passwords per account if the lockout is set to 6 as to not lock out accounts).

Password policies can be set and discovered on Windows, Linux, and macOS systems via various command shell utilities such as <code>net accounts (/domain)</code>, <code>Get-ADDefaultDomainPasswordPolicy</code>, <code>chage -l <username></code>, <code>cat /etc/pam.d/common-password</code>, and <code>pwpolicy getaccountpolicies</code> (Citation: Superuser Linux Password Policies) (Citation: Jamf User Password Policies). Adversaries may also leverage a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) on network devices to discover password policy information (e.g. <code>show aaa</code>, <code>show aaa common-criteria policy all</code>).(Citation: US-CERT-TA18-106A)

Password policies can be discovered in cloud environments using available APIs such as <code>GetAccountPasswordPolicy</code> in AWS (Citation: AWS GetPasswordPolicy).

Procedures:

- [S0039] Net: The <code>net accounts</code> and <code>net accounts /domain</code> commands with [Net](https://attack.mitre.org/software/S0039) can be used to obtain password policy information.(Citation: Savill 1999)
- [S0488] CrackMapExec: [CrackMapExec](https://attack.mitre.org/software/S0488) can discover the password policies applied to the target system.(Citation: CME Github September 2018)
- [C0012] Operation CuckooBees: During [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), the threat actors used the `net accounts` command as part of their advanced reconnaissance.(Citation: Cybereason OperationCuckooBees May 2022)
- [G0049] OilRig: [OilRig](https://attack.mitre.org/groups/G0049) has used net.exe in a script with <code>net accounts /domain</code> to find the password policy of a domain.(Citation: FireEye Targeted Attacks Middle East Banks)
- [G0114] Chimera: [Chimera](https://attack.mitre.org/groups/G0114) has used the NtdsAudit utility to collect information related to accounts and passwords.(Citation: NCC Group Chimera January 2021)
- [S0236] Kwampirs: [Kwampirs](https://attack.mitre.org/software/S0236) collects password policy information with the command <code>net accounts</code>.(Citation: Symantec Orangeworm April 2018)
- [G0010] Turla: [Turla](https://attack.mitre.org/groups/G0010) has used <code>net accounts</code> and <code>net accounts /domain</code> to acquire password policy information.(Citation: ESET ComRAT May 2020)
- [S0378] PoshC2: [PoshC2](https://attack.mitre.org/software/S0378) can use <code>Get-PassPol</code> to enumerate the domain password policy.(Citation: GitHub PoshC2)


### T1217 - Browser Information Discovery

Description:

Adversaries may enumerate information about browsers to learn more about compromised environments. Data saved by browsers (such as bookmarks, accounts, and browsing history) may reveal a variety of personal information about users (e.g., banking sites, relationships/interests, social media, etc.) as well as details about internal network resources such as servers, tools/dashboards, or other related infrastructure.(Citation: Kaspersky Autofill)

Browser information may also highlight additional targets after an adversary has access to valid credentials, especially [Credentials In Files](https://attack.mitre.org/techniques/T1552/001) associated with logins cached by a browser.

Specific storage locations vary based on platform and/or application, but browser information is typically stored in local files and databases (e.g., `%APPDATA%/Google/Chrome`).(Citation: Chrome Roaming Profiles)

Procedures:

- [S0274] Calisto: [Calisto](https://attack.mitre.org/software/S0274) collects information on bookmarks from Google Chrome.(Citation: Securelist Calisto July 2018)
- [S0681] Lizar: [Lizar](https://attack.mitre.org/software/S0681) can retrieve browser history and database files.(Citation: Threatpost Lizar May 2021)(Citation: BiZone Lizar May 2021)
- [C0044] Juicy Mix: During [Juicy Mix](https://attack.mitre.org/campaigns/C0044), [OilRig](https://attack.mitre.org/groups/G0049) used the CDumper (Chrome browser) and EDumper (Edge browser) data stealers to collect cookies, browsing history, and credentials.(Citation: ESET OilRig Campaigns Sep 2023)
- [S0409] Machete: [Machete](https://attack.mitre.org/software/S0409) retrieves the user profile data (e.g., browsers) from Chrome and Firefox browsers.(Citation: ESET Machete July 2019)
- [C0042] Outer Space: During [Outer Space](https://attack.mitre.org/campaigns/C0042), [OilRig](https://attack.mitre.org/groups/G0049) used a Chrome data dumper named MKG.(Citation: ESET OilRig Campaigns Sep 2023)
- [S1122] Mispadu: [Mispadu](https://attack.mitre.org/software/S1122) can monitor browser activity for online banking actions and display full-screen overlay images to block user access to the intended site or present additional data fields.(Citation: Segurança Informática URSA Sophisticated Loader 2020)(Citation: SCILabs Malteiro 2021)
- [S1012] PowerLess: [PowerLess](https://attack.mitre.org/software/S1012) has a browser info stealer module that can read Chrome and Edge browser database files.(Citation: Cybereason PowerLess February 2022)
- [S0567] Dtrack: [Dtrack](https://attack.mitre.org/software/S0567) can retrieve browser history.(Citation: Securelist Dtrack)(Citation: CyberBit Dtrack)
- [G0117] Fox Kitten: [Fox Kitten](https://attack.mitre.org/groups/G0117) has used Google Chrome bookmarks to identify internal resources and assets.(Citation: CISA AA20-259A Iran-Based Actor September 2020)
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has targeted the browsing history of network administrators.(Citation: CISA AA24-038A PRC Critical Infrastructure February 2024)
- [G0082] APT38: [APT38](https://attack.mitre.org/groups/G0082) has collected browser bookmark information to learn more about compromised hosts, obtain personal information about users, and acquire details about internal network resources.(Citation: CISA AA20-239A BeagleBoyz August 2020)
- [S0673] DarkWatchman: [DarkWatchman](https://attack.mitre.org/software/S0673) can retrieve browser history.(Citation: Prevailion DarkWatchman 2021)
- [S1060] Mafalda: [Mafalda](https://attack.mitre.org/software/S1060) can collect the contents of the `%USERPROFILE%\AppData\Local\Google\Chrome\User Data\LocalState` file.(Citation: SentinelLabs Metador Sept 2022)
- [S0363] Empire: [Empire](https://attack.mitre.org/software/S0363) has the ability to gather browser data such as bookmarks and visited sites.(Citation: Github PowerShell Empire)
- [S1185] LightSpy: To collect data on the host's Wi-Fi connection history, [LightSpy](https://attack.mitre.org/software/S1185) reads the `/Library/Preferences/SystemConfiguration/com.apple.airport.preferences.plist` file. It also utilizes Apple's `CWWiFiClient` API to scan for nearby Wi-Fi networks and obtain data on the SSID, security type, and RSSI (signal strength) values.(Citation: Huntress LightSpy macOS 2024)
- [S1042] SUGARDUMP: [SUGARDUMP](https://attack.mitre.org/software/S1042) has collected browser bookmark and history information.(Citation: Mandiant UNC3890 Aug 2022)
- [S1196] Troll Stealer: [Troll Stealer](https://attack.mitre.org/software/S1196) collects information from Chromium-based browsers and Firefox such as cookies, history, downloads, and extensions.(Citation: S2W Troll Stealer 2024)(Citation: Symantec Troll Stealer 2024)
- [G1015] Scattered Spider: [Scattered Spider](https://attack.mitre.org/groups/G1015) retrieves browser histories via infostealer malware such as Raccoon Stealer.(Citation: CISA Scattered Spider Advisory November 2023)
- [S0079] MobileOrder: [MobileOrder](https://attack.mitre.org/software/S0079) has a command to upload to its C2 server victim browser bookmarks.(Citation: Scarlet Mimic Jan 2016)
- [S1213] Lumma Stealer: [Lumma Stealer](https://attack.mitre.org/software/S1213) has identified and gathered information from two-factor authentication extensions for multiple browsers.(Citation: Cybereason LumaStealer Undated)
- [G1036] Moonstone Sleet: [Moonstone Sleet](https://attack.mitre.org/groups/G1036) deployed malware such as YouieLoader capable of capturing victim system browser information.(Citation: Microsoft Moonstone Sleet 2024)
- [G0114] Chimera: [Chimera](https://attack.mitre.org/groups/G0114) has used <code>type \\<hostname>\c$\Users\<username>\Favorites\Links\Bookmarks bar\Imported From IE\*citrix*</code> for bookmark discovery.(Citation: NCC Group Chimera January 2021)
- [S1153] Cuckoo Stealer: [Cuckoo Stealer](https://attack.mitre.org/software/S1153) can collect bookmarks, cookies, and history from Safari.(Citation: Kandji Cuckoo April 2024)


### T1482 - Domain Trust Discovery

Description:

Adversaries may attempt to gather information on domain trust relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments. Domain trusts provide a mechanism for a domain to allow access to resources based on the authentication procedures of another domain.(Citation: Microsoft Trusts) Domain trusts allow the users of the trusted domain to access resources in the trusting domain. The information discovered may help the adversary conduct [SID-History Injection](https://attack.mitre.org/techniques/T1134/005), [Pass the Ticket](https://attack.mitre.org/techniques/T1550/003), and [Kerberoasting](https://attack.mitre.org/techniques/T1558/003).(Citation: AdSecurity Forging Trust Tickets)(Citation: Harmj0y Domain Trusts) Domain trusts can be enumerated using the `DSEnumerateDomainTrusts()` Win32 API call, .NET methods, and LDAP.(Citation: Harmj0y Domain Trusts) The Windows utility [Nltest](https://attack.mitre.org/software/S0359) is known to be used by adversaries to enumerate domain trusts.(Citation: Microsoft Operation Wilysupply)

Procedures:

- [S0363] Empire: [Empire](https://attack.mitre.org/software/S0363) has modules for enumerating domain trusts.(Citation: Github PowerShell Empire)
- [G1043] BlackByte: [BlackByte](https://attack.mitre.org/groups/G1043) enumerated Active Directory information and trust relationships during operations.(Citation: FBI BlackByte 2022)(Citation: Microsoft BlackByte 2023)
- [S0534] Bazar: [Bazar](https://attack.mitre.org/software/S0534) can use [Nltest](https://attack.mitre.org/software/S0359) tools to obtain information about the domain.(Citation: Cybereason Bazar July 2020)(Citation: NCC Group Team9 June 2020)
- [S0483] IcedID: [IcedID](https://attack.mitre.org/software/S0483) used [Nltest](https://attack.mitre.org/software/S0359) during initial discovery.(Citation: DFIR_Sodinokibi_Ransomware)(Citation: DFIR_Quantum_Ransomware)
- [S1145] Pikabot: [Pikabot](https://attack.mitre.org/software/S1145) will gather information concerning the Windows Domain the victim machine is a member of during execution.(Citation: Elastic Pikabot 2024)
- [S0552] AdFind: [AdFind](https://attack.mitre.org/software/S0552) can gather information about organizational units (OUs) and domain trusts from Active Directory.(Citation: Red Canary Hospital Thwarted Ryuk October 2020)(Citation: FireEye FIN6 Apr 2019)(Citation: FireEye Ryuk and Trickbot January 2019)(Citation: Symantec Bumblebee June 2022)
- [S1071] Rubeus: [Rubeus](https://attack.mitre.org/software/S1071) can gather information about domain trusts.(Citation: DFIR Ryuk's Return October 2020)(Citation: DFIR Ryuk 2 Hour Speed Run November 2020)
- [G1024] Akira: [Akira](https://attack.mitre.org/groups/G1024) uses the built-in [Nltest](https://attack.mitre.org/software/S0359) utility or tools such as [AdFind](https://attack.mitre.org/software/S0552) to enumerate Active Directory trusts in victim environments.(Citation: Arctic Wolf Akira 2023)
- [G0114] Chimera: [Chimera](https://attack.mitre.org/groups/G0114) has <code>nltest /domain_trusts</code> to identify domain trust relationships.(Citation: NCC Group Chimera January 2021)
- [S1124] SocGholish: [SocGholish](https://attack.mitre.org/software/S1124) can profile compromised systems to identify domain trust relationships.(Citation: SocGholish-update)(Citation: Red Canary SocGholish March 2024)
- [C0049] Leviathan Australian Intrusions: [Leviathan](https://attack.mitre.org/groups/G0065) performed Active Directory enumeration of victim environments during [Leviathan Australian Intrusions](https://attack.mitre.org/campaigns/C0049).(Citation: CISA Leviathan 2024)
- [G0030] Lotus Blossom: [Lotus Blossom](https://attack.mitre.org/groups/G0030) has used tools such as [AdFind](https://attack.mitre.org/software/S0552) to make Active Directory queries.(Citation: Symantec Bilbug 2022)
- [S1146] MgBot: [MgBot](https://attack.mitre.org/software/S1146) includes modules for collecting information on local domain users and permissions.(Citation: Symantec Daggerfly 2023)
- [S0359] Nltest: [Nltest](https://attack.mitre.org/software/S0359) may be used to enumerate trusted domains by using commands such as <code>nltest /domain_trusts</code>.(Citation: Nltest Manual)(Citation: Fortinet TrickBot)
- [S0650] QakBot: [QakBot](https://attack.mitre.org/software/S0650) can run <code>nltest /domain_trusts /all_trusts</code> for domain trust discovery.(Citation: Kaspersky QakBot September 2021)
- [G1006] Earth Lusca: [Earth Lusca](https://attack.mitre.org/groups/G1006) has used [Nltest](https://attack.mitre.org/software/S0359) to obtain information about domain controllers.(Citation: TrendMicro EarthLusca 2022)
- [S1063] Brute Ratel C4: [Brute Ratel C4](https://attack.mitre.org/software/S1063) can use LDAP queries and `nltest /domain_trusts` for domain trust discovery.(Citation: Palo Alto Brute Ratel July 2022)(Citation: Trend Micro Black Basta October 2022)
- [S0521] BloodHound: [BloodHound](https://attack.mitre.org/software/S0521) has the ability to map domain trusts and identify misconfigurations for potential abuse.(Citation: CrowdStrike BloodHound April 2018)
- [S1160] Latrodectus: [Latrodectus](https://attack.mitre.org/software/S1160) can run `C:\Windows\System32\cmd.exe /c nltest /domain_trusts` to discover domain trusts.(Citation: Elastic Latrodectus May 2024)(Citation: Bitsight Latrodectus June 2024)
- [S1081] BADHATCH: [BADHATCH](https://attack.mitre.org/software/S1081) can use `nltest.exe /domain_trusts` to discover domain trust relationships on a compromised machine.(Citation: BitDefender BADHATCH Mar 2021)
- [S1159] DUSTTRAP: [DUSTTRAP](https://attack.mitre.org/software/S1159) can identify Active Directory information and related items.(Citation: Google Cloud APT41 2024)
- [S0378] PoshC2: [PoshC2](https://attack.mitre.org/software/S0378) has modules for enumerating domain trusts.(Citation: GitHub PoshC2)
- [G1046] Storm-1811: [Storm-1811](https://attack.mitre.org/groups/G1046) has enumerated domain accounts and access during intrusions.(Citation: Microsoft Storm-1811 2024)
- [C0024] SolarWinds Compromise: During the [SolarWinds Compromise](https://attack.mitre.org/campaigns/C0024), [APT29](https://attack.mitre.org/groups/G0016) used the `Get-AcceptedDomain` PowerShell cmdlet to enumerate accepted domains through an Exchange Management Shell.(Citation: Volexity SolarWinds) They also used [AdFind](https://attack.mitre.org/software/S0552) to enumerate domains and to discover trust between federated domains.(Citation: CrowdStrike StellarParticle January 2022)(Citation: Microsoft Deep Dive Solorigate January 2021)
- [G0059] Magic Hound: [Magic Hound](https://attack.mitre.org/groups/G0059) has used a web shell to execute `nltest /trusted_domains` to identify trust relationships.(Citation: DFIR Phosphorus November 2021)
- [S0105] dsquery: [dsquery](https://attack.mitre.org/software/S0105) can be used to gather information on domain trusts with <code>dsquery * -filter "(objectClass=trustedDomain)" -attr *</code>.(Citation: Harmj0y Domain Trusts)
- [S0194] PowerSploit: [PowerSploit](https://attack.mitre.org/software/S0194) has modules such as <code>Get-NetDomainTrust</code> and <code>Get-NetForestTrust</code> to enumerate domain and forest trusts.(Citation: GitHub PowerSploit May 2012)(Citation: PowerSploit Documentation)
- [S0266] TrickBot: [TrickBot](https://attack.mitre.org/software/S0266) can gather information about domain trusts by utilizing [Nltest](https://attack.mitre.org/software/S0359).(Citation: Fortinet TrickBot)(Citation: Cyberreason Anchor December 2019)
- [G0061] FIN8: [FIN8](https://attack.mitre.org/groups/G0061) has retrieved a list of trusted domains by using <code>nltest.exe /domain_trusts</code>.(Citation: Bitdefender FIN8 July 2021)
- [C0015] C0015: During [C0015](https://attack.mitre.org/campaigns/C0015), the threat actors used the command `nltest /domain_trusts /all_trusts` to enumerate domain trusts.(Citation: DFIR Conti Bazar Nov 2021)


### T1497 - Virtualization/Sandbox Evasion

Description:

Adversaries may employ various means to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for VME artifacts before dropping secondary or additional payloads. Adversaries may use the information learned from [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) during automated discovery to shape follow-on behaviors.(Citation: Deloitte Environment Awareness)

Adversaries may use several methods to accomplish [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) such as checking for security monitoring tools (e.g., Sysinternals, Wireshark, etc.) or other system artifacts associated with analysis or virtualization. Adversaries may also check for legitimate user activity to help determine if it is in an analysis environment. Additional methods include use of sleep timers or loops within malware code to avoid operating within a temporary sandbox.(Citation: Unit 42 Pirpi July 2015)

Procedures:

- [S0380] StoneDrill: [StoneDrill](https://attack.mitre.org/software/S0380) has used several anti-emulation techniques to prevent automated analysis by emulators or sandboxes.(Citation: Kaspersky StoneDrill 2017)
- [S0483] IcedID: [IcedID](https://attack.mitre.org/software/S0483) has manipulated Keitaro Traffic Direction System to filter researcher and sandbox traffic.(Citation: Trendmicro_IcedID)
- [S0331] Agent Tesla: [Agent Tesla](https://attack.mitre.org/software/S0331) has the ability to perform anti-sandboxing and anti-virtualization checks.(Citation: Malwarebytes Agent Tesla April 2020)
- [G1031] Saint Bear: [Saint Bear](https://attack.mitre.org/groups/G1031) contains several anti-analysis and anti-virtualization checks.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 )
- [S0268] Bisonal: [Bisonal](https://attack.mitre.org/software/S0268) can check to determine if the compromised system is running on VMware.(Citation: Talos Bisonal Mar 2020)
- [S0484] Carberp: [Carberp](https://attack.mitre.org/software/S0484) has removed various hooks before installing the trojan or bootkit to evade sandbox analysis or other analysis software.(Citation: ESET Carberp March 2012)
- [S1070] Black Basta: [Black Basta](https://attack.mitre.org/software/S1070) can make a random number of calls to the `kernel32.beep` function to hinder log analysis.(Citation: Check Point Black Basta October 2022)
- [C0005] Operation Spalax: During [Operation Spalax](https://attack.mitre.org/campaigns/C0005), the threat actors used droppers that would run anti-analysis checks before executing malware on a compromised host.(Citation: ESET Operation Spalax Jan 2021)
- [S1130] Raspberry Robin: [Raspberry Robin](https://attack.mitre.org/software/S1130) contains real and fake second-stage payloads following initial execution, with the real payload only delivered if the malware determines it is not running in a virtualized environment.(Citation: TrendMicro RaspberryRobin 2022)
- [S0534] Bazar: [Bazar](https://attack.mitre.org/software/S0534) can attempt to overload sandbox analysis by sending 1550 calls to <code>printf</code>.(Citation: Cybereason Bazar July 2020)
- [S0666] Gelsemium: [Gelsemium](https://attack.mitre.org/software/S0666) can use junk code to generate random activity to obscure malware behavior.(Citation: ESET Gelsemium June 2021)
- [S0023] CHOPSTICK: [CHOPSTICK](https://attack.mitre.org/software/S0023)  includes runtime checks to identify an analysis environment and prevent execution on it.(Citation: FireEye APT28)
- [S0455] Metamorfo: [Metamorfo](https://attack.mitre.org/software/S0455) has embedded a "vmdetect.exe" executable to identify virtual machines at the beginning of execution.(Citation: Medium Metamorfo Apr 2020)
- [S1039] Bumblebee: [Bumblebee](https://attack.mitre.org/software/S1039) has the ability to perform anti-virtualization checks.(Citation: Proofpoint Bumblebee April 2022)
- [S1207] XLoader: [XLoader](https://attack.mitre.org/software/S1207) can utilize decoy command and control domains within the malware configuration to circumvent sandbox analysis.(Citation: ANY.RUN XLoader 2023)(Citation: CheckPoint XLoader 2022)
- [S1183] StrelaStealer: [StrelaStealer](https://attack.mitre.org/software/S1183) payloads have used control flow obfuscation techniques such as excessively long code blocks of mathematical instructions to defeat sandboxing and related analysis methods.(Citation: PaloAlto StrelaStealer 2024)(Citation: Fortgale StrelaStealer 2023)
- [S0148] RTM: [RTM](https://attack.mitre.org/software/S0148) can detect if it is running within a sandbox or other virtualized analysis environment.(Citation: Unit42 Redaman January 2019)
- [G0012] Darkhotel: [Darkhotel](https://attack.mitre.org/groups/G0012) malware has employed just-in-time decryption of strings to evade sandbox detection.(Citation: Lastline DarkHotel Just In Time Decryption Nov 2015)
- [S0554] Egregor: [Egregor](https://attack.mitre.org/software/S0554) has used multiple anti-analysis and anti-sandbox techniques to prevent automated analysis by sandboxes.(Citation: Cyble Egregor Oct 2020)(Citation: NHS Digital Egregor Nov 2020)
- [S0046] CozyCar: Some versions of [CozyCar](https://attack.mitre.org/software/S0046) will check to ensure it is not being executed inside a virtual machine or a known malware analysis sandbox environment. If it detects that it is, it will exit.(Citation: F-Secure CozyDuke)
- [S1020] Kevin: [Kevin](https://attack.mitre.org/software/S1020) can sleep for a time interval between C2 communication attempts.(Citation: Kaspersky Lyceum October 2021)
- [S0147] Pteranodon: [Pteranodon](https://attack.mitre.org/software/S0147) has the ability to use anti-detection functions to identify sandbox environments.(Citation: Unit 42 Gamaredon February 2022)
- [S1030] Squirrelwaffle: [Squirrelwaffle](https://attack.mitre.org/software/S1030) has contained a hardcoded list of IP addresses to block that belong to sandboxes and analysis platforms.(Citation: ZScaler Squirrelwaffle Sep 2021)(Citation: Netskope Squirrelwaffle Oct 2021)
- [S0499] Hancitor: [Hancitor](https://attack.mitre.org/software/S0499) has used a macro to check that an ActiveDocument shape object in the lure message is present. If this object is not found, the macro will exit without downloading additional payloads.(Citation: FireEye Hancitor)

#### T1497.001 - System Checks

Description:

Adversaries may employ various system checks to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for VME artifacts before dropping secondary or additional payloads. Adversaries may use the information learned from [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) during automated discovery to shape follow-on behaviors.(Citation: Deloitte Environment Awareness)

Specific checks will vary based on the target and/or adversary, but may involve behaviors such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047), [PowerShell](https://attack.mitre.org/techniques/T1059/001), [System Information Discovery](https://attack.mitre.org/techniques/T1082), and [Query Registry](https://attack.mitre.org/techniques/T1012) to obtain system information and search for VME artifacts. Adversaries may search for VME artifacts in memory, processes, file system, hardware, and/or the Registry. Adversaries may use scripting to automate these checks  into one script and then have the program exit if it determines the system to be a virtual environment. 

Checks could include generic system properties such as host/domain name and samples of network traffic. Adversaries may also check the network adapters addresses, CPU core count, and available memory/drive size. Once executed, malware may also use [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) to check if it was saved in a folder or file with unexpected or even analysis-related naming artifacts such as `malware`, `sample`, or `hash`.

Other common checks may enumerate services running that are unique to these applications, installed programs on the system, manufacturer/product fields for strings relating to virtual machine applications, and VME-specific hardware/processor instructions.(Citation: McAfee Virtual Jan 2017) In applications like VMWare, adversaries can also use a special I/O port to send commands and receive output. 
 
Hardware checks, such as the presence of the fan, temperature, and audio devices, could also be used to gather evidence that can be indicative a virtual environment. Adversaries may also query for specific readings from these devices.(Citation: Unit 42 OilRig Sept 2018)

Procedures:

- [S0650] QakBot: [QakBot](https://attack.mitre.org/software/S0650) can check the compromised host for the presence of multiple executables associated with analysis tools and halt execution if any are found.(Citation: Trend Micro Qakbot May 2020)(Citation: ATT QakBot April 2021)
- [S0354] Denis: [Denis](https://attack.mitre.org/software/S0354) ran multiple system checks, looking for processor and register characteristics, to evade emulation and analysis.(Citation: Cybereason Cobalt Kitty 2017)
- [S0627] SodaMaster: [SodaMaster](https://attack.mitre.org/software/S0627) can check for the presence of the Registry key <code>HKEY_CLASSES_ROOT\\Applications\\VMwareHostOpen.exe</code> before proceeding to its main functionality.(Citation: Securelist APT10 March 2021)
- [S0439] Okrum: [Okrum](https://attack.mitre.org/software/S0439)'s loader can check the amount of physical memory and terminates itself if the host has less than 1.5 Gigabytes of physical memory in total.(Citation: ESET Okrum July 2019)
- [S0260] InvisiMole: [InvisiMole](https://attack.mitre.org/software/S0260) can check for artifacts of VirtualBox, Virtual PC and VMware environment, and terminate itself if they are detected.(Citation: ESET InvisiMole June 2020)
- [G0120] Evilnum: [Evilnum](https://attack.mitre.org/groups/G0120) has used a component called TerraLoader to check certain hardware and file information to detect sandboxed environments. (Citation: ESET EvilNum July 2020)
- [S0024] Dyre: [Dyre](https://attack.mitre.org/software/S0024) can detect sandbox analysis environments by inspecting the process list and Registry.(Citation: Symantec Dyre June 2015)(Citation: Malwarebytes Dyreza November 2015)
- [C0022] Operation Dream Job: During [Operation Dream Job](https://attack.mitre.org/campaigns/C0022), [Lazarus Group](https://attack.mitre.org/groups/G0032) used tools that conducted a variety of system checks to detect sandboxes or VMware services.(Citation: ClearSky Lazarus Aug 2020)
- [S0438] Attor: [Attor](https://attack.mitre.org/software/S0438) can detect whether it is executed in some virtualized or emulated environment by searching for specific artifacts, such as communication with I/O ports and using VM-specific instructions.(Citation: ESET Attor Oct 2019)
- [S1039] Bumblebee: [Bumblebee](https://attack.mitre.org/software/S1039) has the ability to search for designated file paths and Registry keys that indicate a virtualized environment from multiple products.(Citation: Medium Ali Salem Bumblebee April 2022)
- [S0182] FinFisher: [FinFisher](https://attack.mitre.org/software/S0182) obtains the hardware device list and checks if the MD5 of the vendor ID is equal to a predefined list in order to check for sandbox/virtualized environments.(Citation: Microsoft FinFisher March 2018)
- [S0373] Astaroth: [Astaroth](https://attack.mitre.org/software/S0373) can check for Windows product ID's used by sandboxes and usernames and disk serial numbers associated with analyst environments.(Citation: Securelist Brazilian Banking Malware July 2020)
- [S0242] SynAck: [SynAck](https://attack.mitre.org/software/S0242) checks its directory location in an attempt to avoid launching in a sandbox.(Citation: SecureList SynAck Doppelgänging May 2018)(Citation: Kaspersky Lab SynAck May 2018)
- [S0576] MegaCortex: [MegaCortex](https://attack.mitre.org/software/S0576) has checked the number of CPUs in the system to avoid being run in a sandbox or emulator.(Citation: IBM MegaCortex)
- [S0352] OSX_OCEANLOTUS.D: [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) checks a number of system parameters to see if it is being run on real hardware or in a virtual machine environment, such as `sysctl hw.model` and the kernel boot time.(Citation: Unit42 OceanLotus 2017)(Citation: ESET OceanLotus macOS April 2019)(Citation: 20 macOS Common Tools and Techniques)
- [S1048] macOS.OSAMiner: [macOS.OSAMiner](https://attack.mitre.org/software/S1048) can parse the output of the native `system_profiler` tool to determine if the machine is running with 4 cores.(Citation: SentinelLabs reversing run-only applescripts 2021)
- [S0226] Smoke Loader: [Smoke Loader](https://attack.mitre.org/software/S0226) scans processes to perform anti-VM checks. (Citation: Talos Smoke Loader July 2018)
- [S0561] GuLoader: [GuLoader](https://attack.mitre.org/software/S0561) has the ability to perform anti-VM and anti-sandbox checks using string hashing, the API call <code>EnumWindows</code>, and checking for Qemu guest agent.(Citation: Medium Eli Salem GuLoader April 2021)
- [S0396] EvilBunny: [EvilBunny](https://attack.mitre.org/software/S0396)'s dropper has checked the number of processes and the length and strings of its own file name to identify if the malware is in a sandbox environment.(Citation: Cyphort EvilBunny Dec 2014)
- [S0248] yty: [yty](https://attack.mitre.org/software/S0248) has some basic anti-sandbox detection that tries to detect Virtual PC, Sandboxie, and VMware. (Citation: ASERT Donot March 2018)
- [S0532] Lucifer: [Lucifer](https://attack.mitre.org/software/S0532) can check for specific usernames, computer names, device drivers, DLL's, and virtual devices associated with sandboxed environments and can enter an infinite loop and stop itself if any are detected.(Citation: Unit 42 Lucifer June 2020)
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has run system checks to determine if they were operating in a virtualized environment.(Citation: Microsoft Volt Typhoon May 2023)
- [S0237] GravityRAT: [GravityRAT](https://attack.mitre.org/software/S0237) uses WMI to check the BIOS and manufacturer information for strings like "VMWare", "Virtual", and "XEN" and another WMI request to get the current temperature of the hardware to determine if it's a virtual machine environment. (Citation: Talos GravityRAT)
- [S1213] Lumma Stealer: [Lumma Stealer](https://attack.mitre.org/software/S1213) has queried system resources on the victim device to identify if it is executing in a sandbox or virtualized environments, checking usernames, conducting WMI queries for system details, checking for files commonly found in virtualized environments, searching system services, and inspecting process names.(Citation: Fortinet LummaStealer 2024) [Lumma Stealer](https://attack.mitre.org/software/S1213) has checked system GPU configurations for sandbox detection.(Citation: TrendMicro LummaStealer 2025)
- [S0337] BadPatch: [BadPatch](https://attack.mitre.org/software/S0337) attempts to detect if it is being run in a Virtual Machine (VM) using a WMI query for disk drive name, BIOS, and motherboard information. (Citation: Unit 42 BadPatch Oct 2017)
- [S0428] PoetRAT: [PoetRAT](https://attack.mitre.org/software/S0428) checked the size of the hard drive to determine if it was being run in a sandbox environment. In the event of sandbox detection, it would delete itself by overwriting the malware scripts with the contents of "License.txt" and exiting.(Citation: Talos PoetRAT April 2020)
- [S0612] WastedLocker: [WastedLocker](https://attack.mitre.org/software/S0612) checked if UCOMIEnumConnections and IActiveScriptParseProcedure32 Registry keys were detected as part of its anti-analysis technique.(Citation: NCC Group WastedLocker June 2020)
- [S0264] OopsIE: [OopsIE](https://attack.mitre.org/software/S0264) performs several anti-VM and sandbox checks on the victim's machine. One technique the group has used was to perform a WMI query <code>SELECT * FROM MSAcpi_ThermalZoneTemperature</code> to check the temperature to see if it’s running in a virtual environment.(Citation: Unit 42 OilRig Sept 2018)
- [S1066] DarkTortilla: [DarkTortilla](https://attack.mitre.org/software/S1066) can search a compromised system's running processes and services to detect Hyper-V, QEMU, Virtual PC, Virtual Box, and VMware, as well as Sandboxie.(Citation: Secureworks DarkTortilla Aug 2022)
- [S0333] UBoatRAT: [UBoatRAT](https://attack.mitre.org/software/S0333) checks for virtualization software such as VMWare, VirtualBox, or QEmu on the compromised machine.(Citation: PaloAlto UBoatRAT Nov 2017)
- [S0689] WhisperGate: [WhisperGate](https://attack.mitre.org/software/S0689) can stop its execution when it recognizes the presence of certain monitoring tools.(Citation: Unit 42 WhisperGate January 2022)
- [S1087] AsyncRAT: [AsyncRAT](https://attack.mitre.org/software/S1087) can identify strings such as Virtual, vmware, or VirtualBox to detect virtualized environments.(Citation: Telefonica Snip3 December 2021)
- [S1018] Saint Bot: [Saint Bot](https://attack.mitre.org/software/S1018) has run several virtual machine and sandbox checks, including checking if `Sbiedll.dll` is present in a list of loaded modules, comparing the machine name to `HAL9TH` and the user name to `JohnDoe`, and checking the BIOS version for known virtual machine identifiers.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 )
- [G0012] Darkhotel: [Darkhotel](https://attack.mitre.org/groups/G0012) malware has used a series of checks to determine if it's being analyzed; checks include the length of executable names, if a filename ends with <code>.Md5.exe</code>, and if the program is executed from the root of the C:\ drive, as well as checks for sandbox-related libraries.(Citation: Lastline DarkHotel Just In Time Decryption Nov 2015)(Citation: Microsoft DUBNIUM June 2016)
- [S0013] PlugX: [PlugX](https://attack.mitre.org/software/S0013) checks if VMware tools is running in the background by searching for any process named "vmtoolsd".(Citation: Unit42 PlugX June 2017)
- [S1019] Shark: [Shark](https://attack.mitre.org/software/S1019) can stop execution if the screen width of the targeted machine is not over 600 pixels.(Citation: ClearSky Siamesekitten August 2021)
- [S0192] Pupy: [Pupy](https://attack.mitre.org/software/S0192) has a module that checks a number of indicators on the system to determine if its running on a virtual machine.(Citation: GitHub Pupy)
- [S0626] P8RAT: [P8RAT](https://attack.mitre.org/software/S0626) can check the compromised host for processes associated with VMware or VirtualBox environments.(Citation: Securelist APT10 March 2021)
- [S0531] Grandoreiro: [Grandoreiro](https://attack.mitre.org/software/S0531) can detect VMWare via its I/O port and Virtual PC via the <code>vpcext</code> instruction.(Citation: ESET Grandoreiro April 2020)
- [S0240] ROKRAT: [ROKRAT](https://attack.mitre.org/software/S0240) can check for VMware-related files and DLLs related to sandboxes.(Citation: Talos Group123)(Citation: NCCGroup RokRat Nov 2018)(Citation: Malwarebytes RokRAT VBA January 2021)
- [S0332] Remcos: [Remcos](https://attack.mitre.org/software/S0332) searches for Sandboxie and VMware on the system.(Citation: Talos Remcos Aug 2018)
- [S1147] Nightdoor: [Nightdoor](https://attack.mitre.org/software/S1147) embeds code from the public `al-khaser` project, a repository that works to detect virtual machines, sandboxes, and malware analysis environments.(Citation: Symantec Daggerfly 2024)
- [S1070] Black Basta: [Black Basta](https://attack.mitre.org/software/S1070) can check system flags and libraries, process timing, and API's to detect code emulation or sandboxing.(Citation: Palo Alto Networks Black Basta August 2022)(Citation: Check Point Black Basta October 2022)
- [C0001] Frankenstein: During [Frankenstein](https://attack.mitre.org/campaigns/C0001), the threat actors used a script that ran WMI queries to check if a VM or sandbox was running, including VMWare and Virtualbox. The script would also call WMI to determine the number of cores allocated to the system; if less than two the script would stop execution.(Citation: Talos Frankenstein June 2019)
- [S0270] RogueRobin: [RogueRobin](https://attack.mitre.org/software/S0270) uses WMI to check BIOS version for VBOX, bochs, qemu, virtualbox, and vm to check for evidence that the script might be executing within an analysis environment. (Citation: Unit 42 DarkHydrus July 2018)(Citation: Unit42 DarkHydrus Jan 2019)
- [S0644] ObliqueRAT: [ObliqueRAT](https://attack.mitre.org/software/S0644) can halt execution if it identifies processes belonging to virtual machine software or analysis tools.(Citation: Talos Oblique RAT March 2021)
- [S0637] NativeZone: [NativeZone](https://attack.mitre.org/software/S0637) has checked if Vmware or VirtualBox VM is running on a compromised host.(Citation: MSTIC Nobelium Toolset May 2021)
- [S0094] Trojan.Karagany: [Trojan.Karagany](https://attack.mitre.org/software/S0094) can detect commonly used and generic virtualization platforms based primarily on drivers and file paths.(Citation: Secureworks Karagany July 2019)
- [S0657] BLUELIGHT: [BLUELIGHT](https://attack.mitre.org/software/S0657) can check to see if the infected machine has VM tools running.(Citation: Volexity InkySquid BLUELIGHT August 2021)
- [S1122] Mispadu: [Mispadu](https://attack.mitre.org/software/S1122) can run checks to verify if it is running within a virtualized environments including Hyper-V, VirtualBox or VMWare and will terminate execution if the computer name is “JOHN-PC.”(Citation: ESET Security Mispadu Facebook Ads 2019)(Citation: SCILabs Malteiro 2021)
- [S1207] XLoader: [XLoader](https://attack.mitre.org/software/S1207) performs timing checks using the Read-Time Stamp Counter (RDTSC) instruction on the victim CPU.(Citation: Google XLoader 2017)
- [S1064] SVCReady: [SVCReady](https://attack.mitre.org/software/S1064) has the ability to determine if its runtime environment is virtualized.(Citation: HP SVCReady Jun 2022)
- [S0679] Ferocious: [Ferocious](https://attack.mitre.org/software/S0679) can run anti-sandbox checks using the Microsoft Excel 4.0 function <code>GET.WORKSPACE</code> to determine the OS version, if there is a mouse present, and if the host is capable of playing sounds.(Citation: Kaspersky WIRTE November 2021)
- [S0559] SUNBURST: [SUNBURST](https://attack.mitre.org/software/S0559) checked the domain name of the compromised host to verify it was running in a real environment.(Citation: Microsoft Analyzing Solorigate Dec 2020)
- [S1086] Snip3: [Snip3](https://attack.mitre.org/software/S1086) has the ability to detect Windows Sandbox, VMWare, or VirtualBox by querying `Win32_ComputerSystem` to extract the `Manufacturer` string.(Citation: Morphisec Snip3 May 2021)
- [S1130] Raspberry Robin: [Raspberry Robin](https://attack.mitre.org/software/S1130) performs a variety of system environment checks to determine if it is running in a virtualized or sandboxed environment, such as querying CPU temperature information and network card MAC address information.(Citation: HP RaspberryRobin 2024)
- [S0588] GoldMax: [GoldMax](https://attack.mitre.org/software/S0588) will check if it is being run in a virtualized environment by comparing the collected MAC address to <code>c8:27:cc:c2:37:5a</code>.(Citation: MSTIC NOBELIUM Mar 2021)(Citation: FireEye SUNSHUTTLE Mar 2021)
- [S1160] Latrodectus: [Latrodectus](https://attack.mitre.org/software/S1160) can determine if it is running in a virtualized environment by checking the OS version, checking the number of running processes, ensuring a 64-bit application is running on a 64-bit host, and checking if the host has a valid MAC address.(Citation: Latrodectus APR 2024)(Citation: Elastic Latrodectus May 2024)(Citation: Bitsight Latrodectus June 2024)
- [S0527] CSPY Downloader: [CSPY Downloader](https://attack.mitre.org/software/S0527) can search loaded modules, PEB structure, file paths, Registry keys, and memory to determine if it is being debugged or running in a virtual environment.(Citation: Cybereason Kimsuky November 2020)
- [S1111] DarkGate: [DarkGate](https://attack.mitre.org/software/S1111) queries system resources on an infected machine to identify if it is executing in a sandbox or virtualized environment.(Citation: Ensilo Darkgate 2018)
- [G0049] OilRig: [OilRig](https://attack.mitre.org/groups/G0049) has used macros to verify if a mouse is connected to a compromised machine.(Citation: Check Point APT34 April 2021)
- [S1179] Exbyte: [Exbyte](https://attack.mitre.org/software/S1179) performs various checks to determine if it is running in a sandboxed environment to prevent analysis.(Citation: Symantec BlackByte 2022)
- [S1145] Pikabot: [Pikabot](https://attack.mitre.org/software/S1145) performs a variety of system checks to determine if it is running in an analysis environment or sandbox, such as checking the number of processors (must be greater than two), and the amount of RAM (must be greater than 2GB).(Citation: Elastic Pikabot 2024)
- [S1180] BlackByte Ransomware: [BlackByte Ransomware](https://attack.mitre.org/software/S1180) checks for files related to known sandboxes.(Citation: Trustwave BlackByte 2021)
- [S1159] DUSTTRAP: [DUSTTRAP](https://attack.mitre.org/software/S1159) decryption relies on the infected machine's `HKLM\SOFTWARE\Microsoft\Cryptography\MachineGUID` value.(Citation: Google Cloud APT41 2024)

#### T1497.002 - User Activity Based Checks

Description:

Adversaries may employ various user activity checks to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for VME artifacts before dropping secondary or additional payloads. Adversaries may use the information learned from [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) during automated discovery to shape follow-on behaviors.(Citation: Deloitte Environment Awareness)

Adversaries may search for user activity on the host based on variables such as the speed/frequency of mouse movements and clicks (Citation: Sans Virtual Jan 2016) , browser history, cache, bookmarks, or number of files in common directories such as home or the desktop. Other methods may rely on specific user interaction with the system before the malicious code is activated, such as waiting for a document to close before activating a macro (Citation: Unit 42 Sofacy Nov 2018) or waiting for a user to double click on an embedded image to activate.(Citation: FireEye FIN7 April 2017)

Procedures:

- [G0012] Darkhotel: [Darkhotel](https://attack.mitre.org/groups/G0012) has used malware that repeatedly checks the mouse cursor position to determine if a real user is on the system.(Citation: Lastline DarkHotel Just In Time Decryption Nov 2015)
- [S0439] Okrum: [Okrum](https://attack.mitre.org/software/S0439) loader only executes the payload after the left mouse button has been pressed at least three times, in order to avoid being executed within virtualized or emulated environments.(Citation: ESET Okrum July 2019)
- [G0046] FIN7: [FIN7](https://attack.mitre.org/groups/G0046) used images embedded into document lures that only activate the payload when a user double clicks to avoid sandboxes.(Citation: FireEye FIN7 April 2017)
- [S0543] Spark: [Spark](https://attack.mitre.org/software/S0543) has used a splash screen to check whether an user actively clicks on the screen before running malicious code.(Citation: Unit42 Molerat Mar 2020)

#### T1497.003 - Time Based Evasion

Description:

Adversaries may employ various time-based methods to detect and avoid virtualization and analysis environments. This may include enumerating time-based properties, such as uptime or the system clock, as well as the use of timers or other triggers to avoid a virtual machine environment (VME) or sandbox, specifically those that are automated or only operate for a limited amount of time.

Adversaries may employ various time-based evasions, such as delaying malware functionality upon initial execution using programmatic sleep commands or native system scheduling functionality (ex: [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053)). Delays may also be based on waiting for specific victim conditions to be met (ex: system time, events, etc.) or employ scheduled [Multi-Stage Channels](https://attack.mitre.org/techniques/T1104) to avoid analysis and scrutiny.(Citation: Deloitte Environment Awareness)

Benign commands or other operations may also be used to delay malware execution. Loops or otherwise needless repetitions of commands, such as [Ping](https://attack.mitre.org/software/S0097)s, may be used to delay malware execution and potentially exceed time thresholds of automated analysis environments.(Citation: Revil Independence Day)(Citation: Netskope Nitol) Another variation, commonly referred to as API hammering, involves making various calls to [Native API](https://attack.mitre.org/techniques/T1106) functions in order to delay execution (while also potentially overloading analysis environments with junk data).(Citation: Joe Sec Nymaim)(Citation: Joe Sec Trickbot)

Adversaries may also use time as a metric to detect sandboxes and analysis environments, particularly those that attempt to manipulate time mechanisms to simulate longer elapses of time. For example, an adversary may be able to identify a sandbox accelerating time by sampling and calculating the expected value for an environment's timestamp before and after execution of a sleep function.(Citation: ISACA Malware Tricks)

Procedures:

- [S0565] Raindrop: After initial installation, [Raindrop](https://attack.mitre.org/software/S0565) runs a computation to delay execution.(Citation: Symantec RAINDROP January 2021)
- [S0626] P8RAT: [P8RAT](https://attack.mitre.org/software/S0626) has the ability to "sleep" for a specified time to evade detection.(Citation: Securelist APT10 March 2021)
- [S0559] SUNBURST: [SUNBURST](https://attack.mitre.org/software/S0559) remained dormant after initial access for a period of up to two weeks.(Citation: FireEye SUNBURST Backdoor December 2020)
- [S0574] BendyBear: [BendyBear](https://attack.mitre.org/software/S0574) can check for analysis environments and signs of debugging using the Windows API <code>kernel32!GetTickCountKernel32</code> call.(Citation: Unit42 BendyBear Feb 2021)
- [S0554] Egregor: [Egregor](https://attack.mitre.org/software/S0554) can perform a  long sleep (greater than or equal to 3 minutes) to evade detection.(Citation: JoeSecurity Egregor 2020)
- [S0611] Clop: [Clop](https://attack.mitre.org/software/S0611) has used the <code>sleep</code> command to avoid sandbox detection.(Citation: Unit42 Clop April 2021)
- [S0627] SodaMaster: [SodaMaster](https://attack.mitre.org/software/S0627) has the ability to put itself to "sleep" for a specified time.(Citation: Securelist APT10 March 2021)
- [S0660] Clambling: [Clambling](https://attack.mitre.org/software/S0660) can wait 30 minutes before initiating contact with C2.(Citation: Trend Micro DRBControl February 2020)
- [S0386] Ursnif: [Ursnif](https://attack.mitre.org/software/S0386) has used a 30 minute delay after execution to evade sandbox monitoring tools.(Citation: TrendMicro Ursnif File Dec 2014)
- [S0439] Okrum: [Okrum](https://attack.mitre.org/software/S0439)'s loader can detect presence of an emulator by using two calls to GetTickCount API, and checking whether the time has been accelerated.(Citation: ESET Okrum July 2019)
- [S0512] FatDuke: [FatDuke](https://attack.mitre.org/software/S0512) can turn itself on or off at random intervals.(Citation: ESET Dukes October 2019)
- [S1066] DarkTortilla: [DarkTortilla](https://attack.mitre.org/software/S1066) can implement the `kernel32.dll` Sleep function to delay execution for up to 300 seconds before implementing persistence or processing an addon package.(Citation: Secureworks DarkTortilla Aug 2022)
- [S1141] LunarWeb: [LunarWeb](https://attack.mitre.org/software/S1141) can pause for a number of hours before entering its C2 communication loop.(Citation: ESET Turla Lunar toolset May 2024)
- [S1039] Bumblebee: [Bumblebee](https://attack.mitre.org/software/S1039) has the ability to set a hardcoded and randomized sleep interval.(Citation: Proofpoint Bumblebee April 2022)
- [S0115] Crimson: [Crimson](https://attack.mitre.org/software/S0115) can determine when it has been installed on a host for at least 15 days before downloading the final payload.(Citation: Proofpoint Operation Transparent Tribe March 2016)
- [S1138] Gootloader: [Gootloader](https://attack.mitre.org/software/S1138) can designate a sleep period of more than 22 seconds between stages of infection.(Citation: Sophos Gootloader)
- [S1018] Saint Bot: [Saint Bot](https://attack.mitre.org/software/S1018) has used the command `timeout 20` to pause the execution of its initial loader.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 )
- [C0022] Operation Dream Job: During [Operation Dream Job](https://attack.mitre.org/campaigns/C0022), [Lazarus Group](https://attack.mitre.org/groups/G0032) used tools that collected `GetTickCount` and `GetSystemTimeAsFileTime` data to detect sandbox or VMware services.(Citation: ClearSky Lazarus Aug 2020)
- [S0671] Tomiris: [Tomiris](https://attack.mitre.org/software/S0671) has the ability to sleep for at least nine minutes to evade sandbox-based analysis systems.(Citation: Kaspersky Tomiris Sep 2021)
- [S0697] HermeticWiper: [HermeticWiper](https://attack.mitre.org/software/S0697) has the ability to receive a command parameter to sleep prior to carrying out destructive actions on a targeted host.(Citation: Crowdstrike DriveSlayer February 2022)
- [S0447] Lokibot: [Lokibot](https://attack.mitre.org/software/S0447) has performed a time-based anti-debug check before downloading its third stage.(Citation: Talos Lokibot Jan 2021)
- [S1086] Snip3: [Snip3](https://attack.mitre.org/software/S1086) can execute `WScript.Sleep` to delay execution of its second stage.(Citation: Morphisec Snip3 May 2021)
- [S1212] RansomHub: [RansomHub](https://attack.mitre.org/software/S1212) can sleep for a set number of minutes before beginning execution.(Citation: Group-IB RansomHub FEB 2025)
- [S0268] Bisonal: [Bisonal](https://attack.mitre.org/software/S0268) has checked if the malware is running in a virtual environment with the anti-debug function GetTickCount() to compare the timing.(Citation: Kaspersky CactusPete Aug 2020)(Citation: Talos Bisonal Mar 2020)
- [S1034] StrifeWater: [StrifeWater](https://attack.mitre.org/software/S1034) can modify its sleep time responses from the default of 20-22 seconds.(Citation: Cybereason StrifeWater Feb 2022)
- [S0453] Pony: [Pony](https://attack.mitre.org/software/S0453) has delayed execution using a built-in function to avoid detection and analysis.(Citation: Malwarebytes Pony April 2016)
- [S1132] IPsec Helper: [IPsec Helper](https://attack.mitre.org/software/S1132) will sleep for a random number of seconds, iterating 200 times over sleeps between one to three seconds, before continuing execution flow.(Citation: SentinelOne Agrius 2021)
- [S0266] TrickBot: [TrickBot](https://attack.mitre.org/software/S0266) has used <code>printf</code> and file I/O loops to delay process execution as part of API hammering.(Citation: Joe Sec Trickbot)
- [S1059] metaMain: [metaMain](https://attack.mitre.org/software/S1059) has delayed execution for five to six minutes during its persistence establishment process.(Citation: SentinelLabs Metador Technical Appendix Sept 2022)
- [S0650] QakBot: The [QakBot](https://attack.mitre.org/software/S0650) dropper can delay dropping the payload to evade detection.(Citation: Cyberint Qakbot May 2021)(Citation: Kaspersky QakBot September 2021)
- [S0513] LiteDuke: [LiteDuke](https://attack.mitre.org/software/S0513) can wait 30 seconds before executing additional code if security software is detected.(Citation: ESET Dukes October 2019)
- [S0632] GrimAgent: [GrimAgent](https://attack.mitre.org/software/S0632) can sleep for 195 - 205 seconds after payload execution and before deleting its task.(Citation: Group IB GrimAgent July 2021)
- [S0534] Bazar: [Bazar](https://attack.mitre.org/software/S0534) can use a timer to delay execution of core functionality.(Citation: NCC Group Team9 June 2020)
- [S0396] EvilBunny: [EvilBunny](https://attack.mitre.org/software/S0396) has used time measurements from 3 different APIs before and after performing sleep operations to check and abort if the malware is running in a sandbox.(Citation: Cyphort EvilBunny Dec 2014)
- [S0642] BADFLICK: [BADFLICK](https://attack.mitre.org/software/S0642) has delayed communication to the actor-controlled IP address by 5 minutes.(Citation: Accenture MUDCARP March 2019)
- [S0493] GoldenSpy: [GoldenSpy](https://attack.mitre.org/software/S0493)'s installer has delayed installation of [GoldenSpy](https://attack.mitre.org/software/S0493) for two hours after it reaches a victim system.(Citation: Trustwave GoldenSpy June 2020)
- [S0689] WhisperGate: [WhisperGate](https://attack.mitre.org/software/S0689) can pause for 20 seconds to bypass antivirus solutions.(Citation: Medium S2W WhisperGate January 2022)(Citation: RecordedFuture WhisperGate Jan 2022)
- [S0694] DRATzarus: [DRATzarus](https://attack.mitre.org/software/S0694) can use the `GetTickCount` and `GetSystemTimeAsFileTime` API calls to measure function timing.(Citation: ClearSky Lazarus Aug 2020) [DRATzarus](https://attack.mitre.org/software/S0694) can also remotely shut down into sleep mode under specific conditions to evade 
detection.(Citation: ClearSky Lazarus Aug 2020)
- [S0588] GoldMax: [GoldMax](https://attack.mitre.org/software/S0588) has set an execution trigger date and time, stored as an ASCII Unix/Epoch time value.(Citation: MSTIC NOBELIUM Mar 2021)
- [S0561] GuLoader: [GuLoader](https://attack.mitre.org/software/S0561) has the ability to perform anti-debugging based on time checks, API calls, and CPUID.(Citation: Medium Eli Salem GuLoader April 2021)
- [S1064] SVCReady: [SVCReady](https://attack.mitre.org/software/S1064) can enter a sleep stage for 30 minutes to evade detection.(Citation: HP SVCReady Jun 2022)
- [S1063] Brute Ratel C4: [Brute Ratel C4](https://attack.mitre.org/software/S1063) can call `NtDelayExecution` to pause execution.(Citation: Palo Alto Brute Ratel July 2022)(Citation: MDSec Brute Ratel August 2022)
- [S0658] XCSSET: Using the machine's local time, [XCSSET](https://attack.mitre.org/software/S0658) waits 43200 seconds (12 hours) from the initial creation timestamp of a specific file, <code>.report</code>. After the elapsed time, [XCSSET](https://attack.mitre.org/software/S0658) executes additional modules.(Citation: trendmicro xcsset xcode project 2020)
- [S0595] ThiefQuest: [ThiefQuest](https://attack.mitre.org/software/S0595) invokes <code>time</code> call to check the system's time, executes a <code>sleep</code> command, invokes a second <code>time</code> call, and then compares the time difference between the two <code>time</code> calls and the amount of time the system slept to identify the sandbox.(Citation: wardle evilquest parti)
- [S0584] AppleJeus: [AppleJeus](https://attack.mitre.org/software/S0584) has waited a specified time before downloading a second stage payload.(Citation: CISA AppleJeus Feb 2021)


### T1518 - Software Discovery

Description:

Adversaries may attempt to get a listing of software and software versions that are installed on a system or in a cloud environment. Adversaries may use the information from [Software Discovery](https://attack.mitre.org/techniques/T1518) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Such software may be deployed widely across the environment for configuration management or security reasons, such as [Software Deployment Tools](https://attack.mitre.org/techniques/T1072), and may allow adversaries broad access to infect devices or move laterally.

Adversaries may attempt to enumerate software for a variety of reasons, such as figuring out what security measures are present or if the compromised system has a version of software that is vulnerable to [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068).

Procedures:

- [S0455] Metamorfo: [Metamorfo](https://attack.mitre.org/software/S0455) has searched the compromised system for banking applications.(Citation: FireEye Metamorfo Apr 2018)(Citation: ESET Casbaneiro Oct 2019)
- [S0658] XCSSET: [XCSSET](https://attack.mitre.org/software/S0658) uses <code>ps aux</code> with the <code>grep</code> command to enumerate common browsers and system processes potentially impacting [XCSSET](https://attack.mitre.org/software/S0658)'s exfiltration capabilities.(Citation: trendmicro xcsset xcode project 2020)
- [S0623] Siloscape: [Siloscape](https://attack.mitre.org/software/S0623) searches for the kubectl binary.(Citation: Unit 42 Siloscape Jun 2021)
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has queried the Registry on compromised systems for information on installed software.(Citation: Joint Cybersecurity Advisory Volt Typhoon June 2023)(Citation: CISA AA24-038A PRC Critical Infrastructure February 2024)
- [S0674] CharmPower: [CharmPower](https://attack.mitre.org/software/S0674) can list the installed applications on a compromised host.(Citation: Check Point APT35 CharmPower January 2022)
- [S0445] ShimRatReporter: [ShimRatReporter](https://attack.mitre.org/software/S0445) gathered a list of installed software on the infected host.(Citation: FOX-IT May 2016 Mofang)
- [S0062] DustySky: [DustySky](https://attack.mitre.org/software/S0062) lists all installed software for the infected machine.(Citation: Kaspersky MoleRATs April 2019)
- [S1153] Cuckoo Stealer: [Cuckoo Stealer](https://attack.mitre.org/software/S1153) has the ability to search systems for installed applications.(Citation: Kandji Cuckoo April 2024)
- [S1042] SUGARDUMP: [SUGARDUMP](https://attack.mitre.org/software/S1042) can identify Chrome, Opera, Edge Chromium, and Firefox browsers, including version number, on a compromised host.(Citation: Mandiant UNC3890 Aug 2022)
- [S0126] ComRAT: [ComRAT](https://attack.mitre.org/software/S0126) can check the victim's default browser to determine which process to inject its communications module into.(Citation: ESET ComRAT May 2020)
- [S0154] Cobalt Strike: The [Cobalt Strike](https://attack.mitre.org/software/S0154) System Profiler can discover applications through the browser and identify the version of Java the target has.(Citation: Cobalt Strike Manual 4.3 November 2020)
- [G0124] Windigo: [Windigo](https://attack.mitre.org/groups/G0124) has used a script to detect installed software on targeted systems.(Citation: ESET ForSSHe December 2018)
- [G0100] Inception: [Inception](https://attack.mitre.org/groups/G0100) has enumerated installed software on compromised systems.(Citation: Symantec Inception Framework March 2018)
- [S0384] Dridex: [Dridex](https://attack.mitre.org/software/S0384) has collected a list of installed software on the system.(Citation: Checkpoint Dridex Jan 2021)
- [S1141] LunarWeb: [LunarWeb](https://attack.mitre.org/software/S1141) can list installed software on compromised systems.(Citation: ESET Turla Lunar toolset May 2024)
- [S0646] SpicyOmelette: [SpicyOmelette](https://attack.mitre.org/software/S0646) can enumerate running software on a targeted system.(Citation: Secureworks GOLD KINGSWOOD September 2018)
- [S1183] StrelaStealer: [StrelaStealer](https://attack.mitre.org/software/S1183) variants use COM objects to enumerate installed applications from the "AppsFolder" on victim machines.(Citation: IBM StrelaStealer 2024)
- [G0060] BRONZE BUTLER: [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) has used tools to enumerate software installed on an infected host.(Citation: Trend Micro Tick November 2019)
- [C0044] Juicy Mix: During [Juicy Mix](https://attack.mitre.org/campaigns/C0044), [OilRig](https://attack.mitre.org/groups/G0049) used browser data dumper tools to create a list of users with Google Chrome installed.(Citation: ESET OilRig Campaigns Sep 2023)
- [S0229] Orz: [Orz](https://attack.mitre.org/software/S0229) can gather the victim's Internet Explorer version.(Citation: Proofpoint Leviathan Oct 2017)
- [G0112] Windshift: [Windshift](https://attack.mitre.org/groups/G0112) has used malware to identify installed software.(Citation: BlackBerry Bahamut)
- [G0069] MuddyWater: [MuddyWater](https://attack.mitre.org/groups/G0069) has used a PowerShell backdoor to check for Skype connectivity on the target machine.(Citation: Trend Micro Muddy Water March 2021)
- [S0534] Bazar: [Bazar](https://attack.mitre.org/software/S0534) can query the Registry for installed applications.(Citation: Cybereason Bazar July 2020)
- [S0467] TajMahal: [TajMahal](https://attack.mitre.org/software/S0467) has the ability to identify the Internet Explorer (IE) version on an infected host.(Citation: Kaspersky TajMahal April 2019)
- [G0102] Wizard Spider: [Wizard Spider](https://attack.mitre.org/groups/G0102) has utilized the PowerShell script `Get-DataInfo.ps1` to collect installed backup software information from a compromised machine.(Citation: Mandiant FIN12 Oct 2021)
- [S0598] P.A.S. Webshell: [P.A.S. Webshell](https://attack.mitre.org/software/S0598) can list PHP server configuration details.(Citation: ANSSI Sandworm January 2021)
- [S0482] Bundlore: [Bundlore](https://attack.mitre.org/software/S0482) has the ability to enumerate what browser is being used as well as version information for Safari.(Citation: MacKeeper Bundlore Apr 2019)
- [G1008] SideCopy: [SideCopy](https://attack.mitre.org/groups/G1008) has collected browser information from a compromised host.(Citation: MalwareBytes SideCopy Dec 2021)
- [G0121] Sidewinder: [Sidewinder](https://attack.mitre.org/groups/G0121) has used tools to enumerate software installed on an infected host.(Citation: ATT Sidewinder January 2021)(Citation: Rewterz Sidewinder APT April 2020)
- [G0129] Mustang Panda: [Mustang Panda](https://attack.mitre.org/groups/G0129) has searched the victim system for the <code>InstallUtil.exe</code> program and its version.(Citation: Anomali MUSTANG PANDA October 2019)
- [S0260] InvisiMole: [InvisiMole](https://attack.mitre.org/software/S0260) can collect information about installed software used by specific users, software executed on user login, and software executed by each system.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020)
- [S1124] SocGholish: [SocGholish](https://attack.mitre.org/software/S1124) can identify the victim's browser in order to serve the correct fake update page.(Citation: Secureworks Gold Prelude Profile)
- [S1185] LightSpy: If sent the command `16001`, [LightSpy](https://attack.mitre.org/software/S1185) uses the `NSFileManger contentsOfDirectoryAtPath()` to enumerate the Applications folder to collect the bundle name, bundle identifier, and version information from each application's `info.plist` file. The results are then converted into a JSON blob for exfiltration.(Citation: Huntress LightSpy macOS 2024)
- [C0016] Operation Dust Storm: During [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016), the threat actors deployed a file called `DeployJava.js` to fingerprint installed software on a victim system prior to exploit delivery.(Citation: Cylance Dust Storm)
- [S0472] down_new: [down_new](https://attack.mitre.org/software/S0472) has the ability to gather information on installed applications.(Citation: Trend Micro Tick November 2019)
- [S1148] Raccoon Stealer: [Raccoon Stealer](https://attack.mitre.org/software/S1148) is capable of identifying running software on victim machines.(Citation: Sekoia Raccoon1 2022)(Citation: Sekoia Raccoon2 2022)
- [S1064] SVCReady: [SVCReady](https://attack.mitre.org/software/S1064) can collect a list of installed software from an infected host.(Citation: HP SVCReady Jun 2022)
- [S0431] HotCroissant: [HotCroissant](https://attack.mitre.org/software/S0431) can retrieve a list of applications from the <code>SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths</code> registry key.(Citation: Carbon Black HotCroissant April 2020)
- [S0652] MarkiRAT: [MarkiRAT](https://attack.mitre.org/software/S0652) can check for the Telegram installation directory by enumerating the files on disk.(Citation: Kaspersky Ferocious Kitten Jun 2021)
- [G1001] HEXANE: [HEXANE](https://attack.mitre.org/groups/G1001) has enumerated programs installed on an infected machine.(Citation: Kaspersky Lyceum October 2021)
- [S0526] KGH_SPY: [KGH_SPY](https://attack.mitre.org/software/S0526) can collect information on installed applications.(Citation: Cybereason Kimsuky November 2020)
- [S0650] QakBot: [QakBot](https://attack.mitre.org/software/S0650) can enumerate a list of installed programs.(Citation: Group IB Ransomware September 2020)
- [S0024] Dyre: [Dyre](https://attack.mitre.org/software/S0024) has the ability to identify installed programs on a compromised host.(Citation: Malwarebytes Dyreza November 2015)
- [C0014] Operation Wocao: During [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors collected a list of installed software on the infected system.(Citation: FoxIT Wocao December 2019)
- [S1065] Woody RAT: [Woody RAT](https://attack.mitre.org/software/S1065) can collect .NET, PowerShell, and Python information from an infected host.(Citation: MalwareBytes WoodyRAT Aug 2022)
- [S0148] RTM: [RTM](https://attack.mitre.org/software/S0148) can scan victim drives to look for specific banking software on the machine to determine next actions.(Citation: ESET RTM Feb 2017)
- [G0081] Tropic Trooper: [Tropic Trooper](https://attack.mitre.org/groups/G0081)'s backdoor could list the infected system's installed software.(Citation: TrendMicro Tropic Trooper May 2020)
- [S1099] Samurai: [Samurai](https://attack.mitre.org/software/S1099) can check for the presence and version of the .NET framework.(Citation: Kaspersky ToddyCat June 2022)

#### T1518.001 - Security Software Discovery

Description:

Adversaries may attempt to get a listing of security software, configurations, defensive tools, and sensors that are installed on a system or in a cloud environment. This may include things such as cloud monitoring agents and anti-virus. Adversaries may use the information from [Security Software Discovery](https://attack.mitre.org/techniques/T1518/001) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Example commands that can be used to obtain security software information are [netsh](https://attack.mitre.org/software/S0108), <code>reg query</code> with [Reg](https://attack.mitre.org/software/S0075), <code>dir</code> with [cmd](https://attack.mitre.org/software/S0106), and [Tasklist](https://attack.mitre.org/software/S0057), but other indicators of discovery behavior may be more specific to the type of software or security system the adversary is looking for. It is becoming more common to see macOS malware perform checks for LittleSnitch and KnockKnock software.

Adversaries may also utilize the [Cloud API](https://attack.mitre.org/techniques/T1059/009) to discover cloud-native security software installed on compute infrastructure, such as the AWS CloudWatch agent, Azure VM Agent, and Google Cloud Monitor agent. These agents  may collect  metrics and logs from the VM, which may be centrally aggregated in a cloud-based monitoring platform.

Procedures:

- [G0012] Darkhotel: [Darkhotel](https://attack.mitre.org/groups/G0012) has searched for anti-malware strings and anti-virus processes running on the system.(Citation: Securelist Darkhotel Aug 2015)(Citation: Microsoft DUBNIUM June 2016)
- [S1130] Raspberry Robin: [Raspberry Robin](https://attack.mitre.org/software/S1130) attempts to identify security software running on the victim machine, such as BitDefender, Avast, and Kaspersky.(Citation: TrendMicro RaspberryRobin 2022)(Citation: HP RaspberryRobin 2024)
- [S0611] Clop: [Clop](https://attack.mitre.org/software/S0611) can search for processes with antivirus and antimalware product names.(Citation: Mcafee Clop Aug 2019)(Citation: Cybereason Clop Dec 2020)
- [S0469] ABK: [ABK](https://attack.mitre.org/software/S0469) has the ability to identify the installed anti-virus product on the compromised host.(Citation: Trend Micro Tick November 2019)
- [C0014] Operation Wocao: During [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors used scripts to detect security software.(Citation: FoxIT Wocao December 2019)
- [G0121] Sidewinder: [Sidewinder](https://attack.mitre.org/groups/G0121) has used the Windows service <code>winmgmts:\\.\root\SecurityCenter2</code> to check installed antivirus products.(Citation: Rewterz Sidewinder APT April 2020)
- [S0455] Metamorfo: [Metamorfo](https://attack.mitre.org/software/S0455) collects a list of installed antivirus software from the victim’s system.(Citation: Fortinet Metamorfo Feb 2020)(Citation: ESET Casbaneiro Oct 2019)
- [S0650] QakBot: [QakBot](https://attack.mitre.org/software/S0650) can identify the installed antivirus product on a targeted system.(Citation: Crowdstrike Qakbot October 2020)(Citation: ATT QakBot April 2021)(Citation: ATT QakBot April 2021)(Citation: Kaspersky QakBot September 2021)
- [S0339] Micropsia: [Micropsia](https://attack.mitre.org/software/S0339) searches for anti-virus software and firewall products installed on the victim’s machine using WMI.(Citation: Talos Micropsia June 2017)(Citation: Radware Micropsia July 2018)
- [G1008] SideCopy: [SideCopy](https://attack.mitre.org/groups/G1008) uses a loader DLL file to collect AV product names from an infected host.(Citation: MalwareBytes SideCopy Dec 2021)
- [S0115] Crimson: [Crimson](https://attack.mitre.org/software/S0115) contains a command to collect information about anti-virus software on the victim.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)
- [S0330] Zeus Panda: [Zeus Panda](https://attack.mitre.org/software/S0330) checks to see if anti-virus, anti-spyware, or firewall products are installed in the victim’s environment.(Citation: Talos Zeus Panda Nov 2017)(Citation: GDATA Zeus Panda June 2017)
- [G0112] Windshift: [Windshift](https://attack.mitre.org/groups/G0112) has used malware to identify installed AV and commonly used forensic and malware analysis tools.(Citation: BlackBerry Bahamut)
- [G0082] APT38: [APT38](https://attack.mitre.org/groups/G0082) has identified security software, configurations, defensive tools, and sensors installed on a compromised system.(Citation: CISA AA20-239A BeagleBoyz August 2020)(Citation: 1 - appv)
- [G0061] FIN8: [FIN8](https://attack.mitre.org/groups/G0061) has used Registry keys to detect and avoid executing in potential sandboxes.(Citation: FireEye Know Your Enemy FIN8 Aug 2016)
- [G1044] APT42: [APT42](https://attack.mitre.org/groups/G1044) has used Windows Management Instrumentation (WMI) to check for anti-virus products.(Citation: Mandiant APT42-untangling)
- [S1025] Amadey: [Amadey](https://attack.mitre.org/software/S1025) has checked for a variety of antivirus products.(Citation: Korean FSI TA505 2020)(Citation: BlackBerry Amadey 2020)
- [G1018] TA2541: [TA2541](https://attack.mitre.org/groups/G1018) has used tools to search victim systems for security products such as antivirus and firewall software.(Citation: Proofpoint TA2541 February 2022)
- [S0244] Comnie: [Comnie](https://attack.mitre.org/software/S0244) attempts to detect several anti-virus products.(Citation: Palo Alto Comnie)
- [G0089] The White Company: [The White Company](https://attack.mitre.org/groups/G0089) has checked for specific antivirus products on the target’s computer, including Kaspersky, Quick Heal, AVG, BitDefender, Avira, Sophos, Avast!, and ESET.(Citation: Cylance Shaheen Nov 2018)
- [G0019] Naikon: [Naikon](https://attack.mitre.org/groups/G0019) uses commands such as <code>netsh advfirewall firewall</code> to discover local firewall settings.(Citation: Baumgartner Naikon 2015)
- [S0534] Bazar: [Bazar](https://attack.mitre.org/software/S0534) can identify the installed antivirus engine.(Citation: Cybereason Bazar July 2020)
- [G0080] Cobalt Group: [Cobalt Group](https://attack.mitre.org/groups/G0080) used a JavaScript backdoor that is capable of collecting a list of the security solutions installed on the victim's machine.(Citation: Morphisec Cobalt Gang Oct 2018)
- [S0046] CozyCar: The main [CozyCar](https://attack.mitre.org/software/S0046) dropper checks whether the victim has an anti-virus product installed. If the installed product is on a predetermined list, the dropper will exit.(Citation: F-Secure CozyDuke)
- [S1213] Lumma Stealer: [Lumma Stealer](https://attack.mitre.org/software/S1213) has detected antivirus processes using commands such as “tasklist” and “findstr.”(Citation: Qualys LummaStealer 2024)
- [S1013] ZxxZ: [ZxxZ](https://attack.mitre.org/software/S1013) can search a compromised host to determine if it is running Windows Defender or Kasperky antivirus.(Citation: Cisco Talos Bitter Bangladesh May 2022)
- [S0196] PUNCHBUGGY: [PUNCHBUGGY](https://attack.mitre.org/software/S0196) can gather AVs registered in the system.(Citation: Morphisec ShellTea June 2019)
- [S1066] DarkTortilla: [DarkTortilla](https://attack.mitre.org/software/S1066) can check for the Kaspersky Anti-Virus suite.(Citation: Secureworks DarkTortilla Aug 2022)
- [S0223] POWERSTATS: [POWERSTATS](https://attack.mitre.org/software/S0223) has detected security tools.(Citation: FireEye MuddyWater Mar 2018)
- [S0267] FELIXROOT: [FELIXROOT](https://attack.mitre.org/software/S0267) checks for installed security software like antivirus and firewall.(Citation: ESET GreyEnergy Oct 2018)
- [S0467] TajMahal: [TajMahal](https://attack.mitre.org/software/S0467) has the ability to identify which anti-virus products, firewalls, and anti-spyware products are in use.(Citation: Kaspersky TajMahal April 2019)
- [S0256] Mosquito: [Mosquito](https://attack.mitre.org/software/S0256)'s installer searches the Registry and system to see if specific antivirus tools are installed on the system.(Citation: ESET Turla Mosquito Jan 2018)
- [S0257] VERMIN: [VERMIN](https://attack.mitre.org/software/S0257) uses WMI to check for anti-virus software installed on the system.(Citation: Unit 42 VERMIN Jan 2018)
- [S0476] Valak: [Valak](https://attack.mitre.org/software/S0476) can determine if a compromised host has security products installed.(Citation: Cybereason Valak May 2020)
- [S0468] Skidmap: [Skidmap](https://attack.mitre.org/software/S0468) has the ability to check if <code>/usr/sbin/setenforce</code> exists. This file controls what mode SELinux is in.(Citation: Trend Micro Skidmap)
- [S0143] Flame: [Flame](https://attack.mitre.org/software/S0143) identifies security software such as antivirus through the Security module.(Citation: Kaspersky Flame)(Citation: Kaspersky Flame Functionality)
- [S0373] Astaroth: [Astaroth](https://attack.mitre.org/software/S0373) checks for the presence of Avast antivirus in the <code>C:\Program\Files\</code> folder. (Citation: Cofense Astaroth Sept 2018)
- [S1039] Bumblebee: [Bumblebee](https://attack.mitre.org/software/S1039) can identify specific analytical tools based on running processes.(Citation: Proofpoint Bumblebee April 2022)(Citation: Symantec Bumblebee June 2022)(Citation: Medium Ali Salem Bumblebee April 2022)
- [S0473] Avenger: [Avenger](https://attack.mitre.org/software/S0473) has the ability to identify installed anti-virus products on a compromised host.(Citation: Trend Micro Tick November 2019)
- [S0184] POWRUNER: [POWRUNER](https://attack.mitre.org/software/S0184) may collect information on the victim's anti-virus software.(Citation: FireEye APT34 Dec 2017)
- [C0001] Frankenstein: During [Frankenstein](https://attack.mitre.org/campaigns/C0001), the threat actors used WMI queries to determine if analysis tools were running on a compromised system.(Citation: Talos Frankenstein June 2019)
- [S0657] BLUELIGHT: [BLUELIGHT](https://attack.mitre.org/software/S0657) can collect a list of anti-virus products installed on a machine.(Citation: Volexity InkySquid BLUELIGHT August 2021)
- [S1065] Woody RAT: [Woody RAT](https://attack.mitre.org/software/S1065) can detect Avast Software, Doctor Web, Kaspersky, AVG, ESET, and Sophos antivirus programs.(Citation: MalwareBytes WoodyRAT Aug 2022)
- [S0368] NotPetya: [NotPetya](https://attack.mitre.org/software/S0368) determines if specific antivirus programs are running on an infected host machine.(Citation: US District Court Indictment GRU Unit 74455 October 2020)
- [S0388] YAHOYAH: [YAHOYAH](https://attack.mitre.org/software/S0388) checks for antimalware solution processes on the system.(Citation: TrendMicro TropicTrooper 2015)
- [G0102] Wizard Spider: [Wizard Spider](https://attack.mitre.org/groups/G0102) has used WMI to identify anti-virus products installed on a victim's machine.(Citation: DFIR Ryuk's Return October 2020)
- [S1159] DUSTTRAP: [DUSTTRAP](https://attack.mitre.org/software/S1159) can identify security software.(Citation: Google Cloud APT41 2024)
- [S0457] Netwalker: [Netwalker](https://attack.mitre.org/software/S0457) can detect and terminate active security software-related processes on infected systems.(Citation: TrendMicro Netwalker May 2020)
- [G0040] Patchwork: [Patchwork](https://attack.mitre.org/groups/G0040) scanned the “Program Files” directories for a directory with the string “Total Security” (the installation path of the “360 Total Security” antivirus tool).(Citation: Cymmetria Patchwork)
- [S0652] MarkiRAT: [MarkiRAT](https://attack.mitre.org/software/S0652) can check for running processes on the victim’s machine to look for Kaspersky and Bitdefender antivirus products.(Citation: Kaspersky Ferocious Kitten Jun 2021)
- [G0069] MuddyWater: [MuddyWater](https://attack.mitre.org/groups/G0069) has used malware to check running processes against a hard-coded list of security tools often used by malware researchers.(Citation: Securelist MuddyWater Oct 2018)
- [S0679] Ferocious: [Ferocious](https://attack.mitre.org/software/S0679) has checked for AV software as part of its persistence process.(Citation: Kaspersky WIRTE November 2021)
- [S0531] Grandoreiro: [Grandoreiro](https://attack.mitre.org/software/S0531) can list installed security products including the Trusteer and Diebold Warsaw GAS Tecnologia online banking protections.(Citation: ESET Grandoreiro April 2020)(Citation: ESET Grandoreiro April 2020)
- [S0098] T9000: [T9000](https://attack.mitre.org/software/S0098) performs checks for various antivirus and security products during installation.(Citation: Palo Alto T9000 Feb 2016)
- [S0023] CHOPSTICK: [CHOPSTICK](https://attack.mitre.org/software/S0023) checks for antivirus and forensics software.(Citation: FireEye APT28)
- [S0472] down_new: [down_new](https://attack.mitre.org/software/S0472) has the ability to detect anti-virus products and processes on a compromised host.(Citation: Trend Micro Tick November 2019)
- [S0471] build_downer: [build_downer](https://attack.mitre.org/software/S0471) has the ability to detect if the infected host is running an anti-virus process.(Citation: Trend Micro Tick November 2019)
- [S0381] FlawedAmmyy: [FlawedAmmyy](https://attack.mitre.org/software/S0381) will attempt to detect anti-virus products during the initial infection.(Citation: Proofpoint TA505 Mar 2018)
- [S0689] WhisperGate: [WhisperGate](https://attack.mitre.org/software/S0689) can recognize the presence of monitoring tools on a target system.(Citation: Unit 42 WhisperGate January 2022)
- [S0491] StrongPity: [StrongPity](https://attack.mitre.org/software/S0491) can identify if ESET or BitDefender antivirus are installed before dropping its payload.(Citation: Talos Promethium June 2020)
- [S0380] StoneDrill: [StoneDrill](https://attack.mitre.org/software/S0380) can check for antivirus and antimalware programs.(Citation: Kaspersky StoneDrill 2017)
- [S0483] IcedID: [IcedID](https://attack.mitre.org/software/S0483) can identify AV products on an infected host using the following command:
` WMIC.exe WMIC /Node:localhost /Namespace:\\root\SecurityCenter2 Path AntiVirusProduct Get * /Format:List`.(Citation: DFIR_Sodinokibi_Ransomware)(Citation: DFIR_Quantum_Ransomware)
- [S0057] Tasklist: [Tasklist](https://attack.mitre.org/software/S0057) can be used to enumerate security software currently running on a system by process name of known products.(Citation: Microsoft Tasklist)
- [S0484] Carberp: [Carberp](https://attack.mitre.org/software/S0484) has queried the infected system's registry searching for specific registry keys associated with antivirus products.(Citation: Prevx Carberp March 2011)
- [S1063] Brute Ratel C4: [Brute Ratel C4](https://attack.mitre.org/software/S1063) can detect EDR userland hooks.(Citation: Palo Alto Brute Ratel July 2022)
- [S1179] Exbyte: [Exbyte](https://attack.mitre.org/software/S1179) checks for the presence of various security software products during execution.(Citation: Symantec BlackByte 2022)
- [G0143] Aquatic Panda: [Aquatic Panda](https://attack.mitre.org/groups/G0143) has attempted to discover third party endpoint detection and response (EDR) tools on compromised systems.(Citation: CrowdStrike AQUATIC PANDA December 2021)
- [S0653] xCaon: [xCaon](https://attack.mitre.org/software/S0653) has checked for the existence of Kaspersky antivirus software on the system.(Citation: Checkpoint IndigoZebra July 2021)
- [S0171] Felismus: [Felismus](https://attack.mitre.org/software/S0171) checks for processes associated with anti-virus vendors.(Citation: Forcepoint Felismus Mar 2017)
- [G0094] Kimsuky: [Kimsuky](https://attack.mitre.org/groups/G0094) has checked for the presence of antivirus software with <code>powershell Get-CimInstance -Namespace root/securityCenter2 – classname antivirusproduct</code>.(Citation: KISA Operation Muzabi)
- [S0666] Gelsemium: [Gelsemium](https://attack.mitre.org/software/S0666) can check for the presence of specific security products.(Citation: ESET Gelsemium June 2021)
- [G0139] TeamTNT: [TeamTNT](https://attack.mitre.org/groups/G0139) has searched for security products on infected machines.(Citation: ATT TeamTNT Chimaera September 2020)(Citation: Cisco Talos Intelligence Group)
- [S0283] jRAT: [jRAT](https://attack.mitre.org/software/S0283) can list security software, such as by using WMIC to identify anti-virus products installed on the victim’s machine and to obtain firewall details.(Citation: jRAT Symantec Aug 2018)(Citation: Kaspersky Adwind Feb 2016)
- [G1026] Malteiro: [Malteiro](https://attack.mitre.org/groups/G1026) collects the installed antivirus on the victim machine.(Citation: SCILabs Malteiro 2021)
- [S0088] Kasidet: [Kasidet](https://attack.mitre.org/software/S0088) has the ability to identify any anti-virus installed on the infected system.(Citation: Zscaler Kasidet)
- [S0113] Prikormka: A module in [Prikormka](https://attack.mitre.org/software/S0113) collects information from the victim about installed anti-virus software.(Citation: ESET Operation Groundbait)
- [S0270] RogueRobin: [RogueRobin](https://attack.mitre.org/software/S0270) enumerates running processes to search for Wireshark and Windows Sysinternals suite.(Citation: Unit 42 DarkHydrus July 2018)(Citation: Unit42 DarkHydrus Jan 2019)
- [S0579] Waterbear: [Waterbear](https://attack.mitre.org/software/S0579) can find the presence of a specific security software.(Citation: Trend Micro Waterbear December 2019)
- [S0603] Stuxnet: [Stuxnet](https://attack.mitre.org/software/S0603) enumerates the currently running processes related to a variety of security products.(Citation: Nicolas Falliere, Liam O Murchu, Eric Chien February 2011)
- [S1122] Mispadu: [Mispadu](https://attack.mitre.org/software/S1122) can list installed security products in the victim’s environment.(Citation: ESET Security Mispadu Facebook Ads 2019)(Citation: Metabase Q Mispadu Trojan 2023)
- [S0201] JPIN: [JPIN](https://attack.mitre.org/software/S0201) checks for the presence of certain security-related processes and deletes its installer/uninstaller component if it identifies any of them.(Citation: Microsoft PLATINUM April 2016)
- [S0062] DustySky: [DustySky](https://attack.mitre.org/software/S0062) checks for the existence of anti-virus.(Citation: DustySky)
- [G0010] Turla: [Turla](https://attack.mitre.org/groups/G0010) has obtained information on security software, including security logging information that may indicate whether their malware has been detected.(Citation: ESET ComRAT May 2020)
- [S1160] Latrodectus: [Latrodectus](https://attack.mitre.org/software/S1160) has the ability to identify installed antivirus products.(Citation: Elastic Latrodectus May 2024)(Citation: Bitsight Latrodectus June 2024)
- [S1149] CHIMNEYSWEEP: [CHIMNEYSWEEP](https://attack.mitre.org/software/S1149) is capable of checking whether a compromised device is running DeepFreeze by Faronics.(Citation: Mandiant ROADSWEEP August 2022)
- [S0176] Wingbird: [Wingbird](https://attack.mitre.org/software/S0176) checks for the presence of Bitdefender security software.(Citation: Microsoft SIR Vol 21)
- [G1022] ToddyCat: [ToddyCat](https://attack.mitre.org/groups/G1022) can determine is Kaspersky software is running on an endpoint by running `cmd /c wmic process where name="avp.exe"`.(Citation: Kaspersky ToddyCat Check Logs October 2023)
- [S1111] DarkGate: [DarkGate](https://attack.mitre.org/software/S1111) looks for various security products by process name using hard-coded values in the malware.(Citation: Rapid7 BlackBasta 2024) [DarkGate](https://attack.mitre.org/software/S1111) will not execute its keylogging thread if a process name associated with Trend Micro anti-virus is identified, or if runtime checks identify the presence of Kaspersky anti-virus. [DarkGate](https://attack.mitre.org/software/S1111) will initiate a new thread if certain security products are identified on the victim, and recreate any malicious files associated with it if it determines they were removed by security software in a new system location.(Citation: Ensilo Darkgate 2018)
- [S0681] Lizar: [Lizar](https://attack.mitre.org/software/S0681) can search for processes associated with an anti-virus product from list.(Citation: BiZone Lizar May 2021)
- [S0658] XCSSET: [XCSSET](https://attack.mitre.org/software/S0658) searches firewall configuration files located in <code>/Library/Preferences/</code> and uses <code>csrutil status</code> to determine if System Integrity Protection is enabled.(Citation: trendmicro xcsset xcode project 2020)
- [S0284] More_eggs: [More_eggs](https://attack.mitre.org/software/S0284) can obtain information on installed anti-malware programs.(Citation: Talos Cobalt Group July 2018)
- [S0363] Empire: [Empire](https://attack.mitre.org/software/S0363) can enumerate antivirus software on the target.(Citation: Github PowerShell Empire)
- [S0492] CookieMiner: [CookieMiner](https://attack.mitre.org/software/S0492) has checked for the presence of "Little Snitch", macOS network monitoring and application firewall software, stopping and exiting if it is found.(Citation: Unit42 CookieMiner Jan 2019)
- [S0513] LiteDuke: [LiteDuke](https://attack.mitre.org/software/S0513) has the ability to check for the presence of Kaspersky security software.(Citation: ESET Dukes October 2019)
- [S0337] BadPatch: [BadPatch](https://attack.mitre.org/software/S0337) uses WMI to enumerate installed security products in the victim’s environment.(Citation: Unit 42 BadPatch Oct 2017)
- [G1040] Play: [Play](https://attack.mitre.org/groups/G1040) has used the information-stealing tool Grixba to scan for anti-virus software.(Citation: CISA Play Ransomware Advisory December 2023)
- [S1060] Mafalda: [Mafalda](https://attack.mitre.org/software/S1060) can search for a variety of security software programs, EDR systems, and malware analysis tools.(Citation: SentinelLabs Metador Sept 2022)(Citation: SentinelLabs Metador Technical Appendix Sept 2022)
- [G0081] Tropic Trooper: [Tropic Trooper](https://attack.mitre.org/groups/G0081) can search for anti-virus software running on the system.(Citation: Unit 42 Tropic Trooper Nov 2016)
- [S0568] EVILNUM: [EVILNUM](https://attack.mitre.org/software/S0568) can search for anti-virus products on the system.(Citation: Prevailion EvilNum May 2020)
- [S0559] SUNBURST: [SUNBURST](https://attack.mitre.org/software/S0559) checked for a variety of antivirus/endpoint detection agents prior to execution.(Citation: Microsoft Analyzing Solorigate Dec 2020)(Citation: FireEye SUNBURST Additional Details Dec 2020)
- [S1193] TAMECAT: [TAMECAT](https://attack.mitre.org/software/S1193) has used Windows Management Instrumentation (WMI) to check for anti-virus products.(Citation: Mandiant APT42-untangling)
- [S0595] ThiefQuest: [ThiefQuest](https://attack.mitre.org/software/S0595) uses the <code>kill_unwanted</code> function to get a list of running processes, compares each process with an encrypted list of “unwanted” security related programs, and kills the processes for security related programs.(Citation: wardle evilquest parti)
- [S0091] Epic: [Epic](https://attack.mitre.org/software/S0091) searches for anti-malware services running on the victim’s machine and terminates itself if it finds them.(Citation: Kaspersky Turla)
- [S0148] RTM: [RTM](https://attack.mitre.org/software/S0148) can obtain information about security software on the victim.(Citation: ESET RTM Feb 2017)
- [S0673] DarkWatchman: [DarkWatchman](https://attack.mitre.org/software/S0673) can search for anti-virus products on the system.(Citation: Prevailion DarkWatchman 2021)
- [S0182] FinFisher: [FinFisher](https://attack.mitre.org/software/S0182) probes the system to check for antimalware processes.(Citation: FinFisher Citation)(Citation: Securelist BlackOasis Oct 2017)
- [S0260] InvisiMole: [InvisiMole](https://attack.mitre.org/software/S0260) can check for the presence of network sniffers, AV, and BitDefender firewall.(Citation: ESET InvisiMole June 2020)
- [S0249] Gold Dragon: [Gold Dragon](https://attack.mitre.org/software/S0249) checks for anti-malware products and processes.(Citation: McAfee Gold Dragon)
- [S0142] StreamEx: [StreamEx](https://attack.mitre.org/software/S0142) has the ability to scan for security tools such as firewalls and antivirus tools.(Citation: Cylance Shell Crew Feb 2017)
- [S1029] AuTo Stealer: [AuTo Stealer](https://attack.mitre.org/software/S1029) has the ability to collect information about installed AV products from an infected host.(Citation: MalwareBytes SideCopy Dec 2021)
- [S0688] Meteor: [Meteor](https://attack.mitre.org/software/S0688) has the ability to search for Kaspersky Antivirus on a victim's machine.(Citation: Check Point Meteor Aug 2021)
- [G1043] BlackByte: [BlackByte](https://attack.mitre.org/groups/G1043) enumerated installed security products during operations.(Citation: Microsoft BlackByte 2023)
- [S1028] Action RAT: [Action RAT](https://attack.mitre.org/software/S1028) can identify AV products on an infected host using the following command: `cmd.exe WMIC /Node:localhost /Namespace:\\root\SecurityCenter2 Path AntiVirusProduct Get displayName /Format:List`.(Citation: MalwareBytes SideCopy Dec 2021)
- [S0396] EvilBunny: [EvilBunny](https://attack.mitre.org/software/S0396) has been observed querying installed antivirus software.(Citation: Cyphort EvilBunny Dec 2014)
- [S0646] SpicyOmelette: [SpicyOmelette](https://attack.mitre.org/software/S0646) can check for the presence of 29 different antivirus tools.(Citation: Secureworks GOLD KINGSWOOD September 2018)
- [S0125] Remsec: [Remsec](https://attack.mitre.org/software/S0125) has a plugin detect security products via active drivers.(Citation: Kaspersky ProjectSauron Technical Analysis)
- [S1091] Pacu: [Pacu](https://attack.mitre.org/software/S1091) can enumerate AWS security services, including WAF rules and GuardDuty detectors.(Citation: GitHub Pacu)
- [S1044] FunnyDream: [FunnyDream](https://attack.mitre.org/software/S1044) can identify the processes for Bkav antivirus.(Citation: Bitdefender FunnyDream Campaign November 2020)
- [S0553] MoleNet: [MoleNet](https://attack.mitre.org/software/S0553) can use WMI commands to check the system for firewall and antivirus software.(Citation: Cybereason Molerats Dec 2020)
- [S0108] netsh: [netsh](https://attack.mitre.org/software/S0108) can be used to discover system firewall settings.(Citation: TechNet Netsh)(Citation: TechNet Netsh Firewall)
- [S1180] BlackByte Ransomware: [BlackByte Ransomware](https://attack.mitre.org/software/S1180) looks for security software products prior to full execution.(Citation: Trustwave BlackByte 2021)
- [S0692] SILENTTRINITY: [SILENTTRINITY](https://attack.mitre.org/software/S0692) can determine if an anti-virus product is installed through the resolution of the service's virtual SID.(Citation: Security Affairs SILENTTRINITY July 2019)
- [S0501] PipeMon: [PipeMon](https://attack.mitre.org/software/S0501) can check for the presence of ESET and Kaspersky security software.(Citation: ESET PipeMon May 2020)
- [S0680] LitePower: [LitePower](https://attack.mitre.org/software/S0680) can identify installed AV software.(Citation: Kaspersky WIRTE November 2021)
- [C0035] KV Botnet Activity: [KV Botnet Activity](https://attack.mitre.org/campaigns/C0035) involved removal of security tools, as well as other identified IOT malware, from compromised devices.(Citation: Lumen KVBotnet 2023)
- [G0106] Rocke: [Rocke](https://attack.mitre.org/groups/G0106) used scripts which detected and uninstalled antivirus software.(Citation: Talos Rocke August 2018)(Citation: Unit 42 Rocke January 2019)
- [S1141] LunarWeb: [LunarWeb](https://attack.mitre.org/software/S1141) has run shell commands to obtain a list of installed security products.(Citation: ESET Turla Lunar toolset May 2024)


### T1526 - Cloud Service Discovery

Description:

An adversary may attempt to enumerate the cloud services running on a system after gaining access. These methods can differ from platform-as-a-service (PaaS), to infrastructure-as-a-service (IaaS), or software-as-a-service (SaaS). Many services exist throughout the various cloud providers and can include Continuous Integration and Continuous Delivery (CI/CD), Lambda Functions, Entra ID, etc. They may also include security services, such as AWS GuardDuty and Microsoft Defender for Cloud, and logging services, such as AWS CloudTrail and Google Cloud Audit Logs.

Adversaries may attempt to discover information about the services enabled throughout the environment. Azure tools and APIs, such as the Microsoft Graph API and Azure Resource Manager API, can enumerate resources and services, including applications, management groups, resources and policy definitions, and their relationships that are accessible by an identity.(Citation: Azure - Resource Manager API)(Citation: Azure AD Graph API)

For example, Stormspotter is an open source tool for enumerating and constructing a graph for Azure resources and services, and Pacu is an open source AWS exploitation framework that supports several methods for discovering cloud services.(Citation: Azure - Stormspotter)(Citation: GitHub Pacu)

Adversaries may use the information gained to shape follow-on behaviors, such as targeting data or credentials from enumerated services or evading identified defenses through [Disable or Modify Tools](https://attack.mitre.org/techniques/T1562/001) or [Disable or Modify Cloud Logs](https://attack.mitre.org/techniques/T1562/008).

Procedures:

- [S0677] AADInternals: [AADInternals](https://attack.mitre.org/software/S0677) can enumerate information about a variety of cloud services, such as Office 365 and Sharepoint instances or OpenID Configurations.(Citation: AADInternals Documentation)
- [S0684] ROADTools: [ROADTools](https://attack.mitre.org/software/S0684) can enumerate Azure AD applications and service principals.(Citation: Roadtools)
- [S1091] Pacu: [Pacu](https://attack.mitre.org/software/S1091) can enumerate AWS services, such as CloudTrail and CloudWatch.(Citation: GitHub Pacu)


### T1538 - Cloud Service Dashboard

Description:

An adversary may use a cloud service dashboard GUI with stolen credentials to gain useful information from an operational cloud environment, such as specific services, resources, and features. For example, the GCP Command Center can be used to view all assets, review findings of potential security risks, and run additional queries, such as finding public IP addresses and open ports.(Citation: Google Command Center Dashboard)

Depending on the configuration of the environment, an adversary may be able to enumerate more information via the graphical dashboard than an API. This also allows the adversary to gain information without manually making any API requests.

Procedures:

- [G1015] Scattered Spider: [Scattered Spider](https://attack.mitre.org/groups/G1015) abused AWS Systems Manager Inventory to identify targets on the compromised network prior to lateral movement.(Citation: CISA Scattered Spider Advisory November 2023)


### T1580 - Cloud Infrastructure Discovery

Description:

An adversary may attempt to discover infrastructure and resources that are available within an infrastructure-as-a-service (IaaS) environment. This includes compute service resources such as instances, virtual machines, and snapshots as well as resources of other services including the storage and database services.

Cloud providers offer methods such as APIs and commands issued through CLIs to serve information about infrastructure. For example, AWS provides a <code>DescribeInstances</code> API within the Amazon EC2 API that can return information about one or more instances within an account, the <code>ListBuckets</code> API that returns a list of all buckets owned by the authenticated sender of the request, the <code>HeadBucket</code> API to determine a bucket’s existence along with access permissions of the request sender, or the <code>GetPublicAccessBlock</code> API to retrieve access block configuration for a bucket.(Citation: Amazon Describe Instance)(Citation: Amazon Describe Instances API)(Citation: AWS Get Public Access Block)(Citation: AWS Head Bucket) Similarly, GCP's Cloud SDK CLI provides the <code>gcloud compute instances list</code> command to list all Google Compute Engine instances in a project (Citation: Google Compute Instances), and Azure's CLI command <code>az vm list</code> lists details of virtual machines.(Citation: Microsoft AZ CLI) In addition to API commands, adversaries can utilize open source tools to discover cloud storage infrastructure through [Wordlist Scanning](https://attack.mitre.org/techniques/T1595/003).(Citation: Malwarebytes OSINT Leaky Buckets - Hioureas)

An adversary may enumerate resources using a compromised user's access keys to determine which are available to that user.(Citation: Expel IO Evil in AWS) The discovery of these available resources may help adversaries determine their next steps in the Cloud environment, such as establishing Persistence.(Citation: Mandiant M-Trends 2020)An adversary may also use this information to change the configuration to make the bucket publicly accessible, allowing data to be accessed without authentication. Adversaries have also may use infrastructure discovery APIs such as <code>DescribeDBInstances</code> to determine size, owner, permissions, and network ACLs of database resources. (Citation: AWS Describe DB Instances) Adversaries can use this information to determine the potential value of databases and discover the requirements to access them. Unlike in [Cloud Service Discovery](https://attack.mitre.org/techniques/T1526), this technique focuses on the discovery of components of the provided services rather than the services themselves.

Procedures:

- [G1015] Scattered Spider: [Scattered Spider](https://attack.mitre.org/groups/G1015) enumerates cloud environments to identify server and backup management infrastructure, resource access, databases and storage containers.(Citation: MSTIC Octo Tempest Operations October 2023)
- [S1091] Pacu: [Pacu](https://attack.mitre.org/software/S1091) can enumerate AWS infrastructure, such as EC2 instances.(Citation: GitHub Pacu)


### T1613 - Container and Resource Discovery

Description:

Adversaries may attempt to discover containers and other resources that are available within a containers environment. Other resources may include images, deployments, pods, nodes, and other information such as the status of a cluster.

These resources can be viewed within web applications such as the Kubernetes dashboard or can be queried via the Docker and Kubernetes APIs.(Citation: Docker API)(Citation: Kubernetes API) In Docker, logs may leak information about the environment, such as the environment’s configuration, which services are available, and what cloud provider the victim may be utilizing. The discovery of these resources may inform an adversary’s next steps in the environment, such as how to perform lateral movement and which methods to utilize for execution.

Procedures:

- [S0683] Peirates: [Peirates](https://attack.mitre.org/software/S0683) can enumerate Kubernetes pods in a given namespace.(Citation: Peirates GitHub)
- [G0139] TeamTNT: [TeamTNT](https://attack.mitre.org/groups/G0139) has checked for running containers with <code>docker ps</code> and for specific container names with <code>docker inspect</code>.(Citation: Trend Micro TeamTNT) [TeamTNT](https://attack.mitre.org/groups/G0139) has also searched for Kubernetes pods running in a local network.(Citation: Cisco Talos Intelligence Group)
- [S0601] Hildegard: [Hildegard](https://attack.mitre.org/software/S0601) has used masscan to search for kubelets and the kubelet API for additional running containers.(Citation: Unit 42 Hildegard Malware)


### T1614 - System Location Discovery

Description:

Adversaries may gather information in an attempt to calculate the geographical location of a victim host. Adversaries may use the information from [System Location Discovery](https://attack.mitre.org/techniques/T1614) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Adversaries may attempt to infer the location of a system using various system checks, such as time zone, keyboard layout, and/or language settings.(Citation: FBI Ragnar Locker 2020)(Citation: Sophos Geolocation 2016)(Citation: Bleepingcomputer RAT malware 2020) Windows API functions such as <code>GetLocaleInfoW</code> can also be used to determine the locale of the host.(Citation: FBI Ragnar Locker 2020) In cloud environments, an instance's availability zone may also be discovered by accessing the instance metadata service from the instance.(Citation: AWS Instance Identity Documents)(Citation: Microsoft Azure Instance Metadata 2021)

Adversaries may also attempt to infer the location of a victim host using IP addressing, such as via online geolocation IP-lookup services.(Citation: Securelist Trasparent Tribe 2020)(Citation: Sophos Geolocation 2016)

Procedures:

- [S0673] DarkWatchman: [DarkWatchman](https://attack.mitre.org/software/S0673) can identity the OS locale of a compromised host.(Citation: Prevailion DarkWatchman 2021)
- [S1138] Gootloader: [Gootloader](https://attack.mitre.org/software/S1138)  can use IP geolocation to determine if the person browsing to a compromised site is within a targeted territory such as the US, Canada, Germany, and South Korea.(Citation: SentinelOne Gootloader June 2021)
- [G1008] SideCopy: [SideCopy](https://attack.mitre.org/groups/G1008) has identified the country location of a compromised host.(Citation: MalwareBytes SideCopy Dec 2021)
- [S1153] Cuckoo Stealer: [Cuckoo Stealer](https://attack.mitre.org/software/S1153) can determine the geographical location of a victim host by checking the language.(Citation: Kandji Cuckoo April 2024)
- [S1111] DarkGate: [DarkGate](https://attack.mitre.org/software/S1111) queries system locale information during execution.(Citation: Ensilo Darkgate 2018) Later versions of [DarkGate](https://attack.mitre.org/software/S1111) query <code>GetSystemDefaultLCID</code> for locale information to determine if the malware is executing in Russian-speaking countries.(Citation: Trellix Darkgate 2023)
- [S1124] SocGholish: [SocGholish](https://attack.mitre.org/software/S1124) can use IP-based geolocation to limit infections to victims in North America, Europe, and a small number of Asian-Pacific nations.(Citation: Secureworks Gold Prelude Profile)
- [S0262] QuasarRAT: [QuasarRAT](https://attack.mitre.org/software/S0262) can determine the country a victim host is located in.(Citation: CISA AR18-352A Quasar RAT December 2018)
- [S0461] SDBbot: [SDBbot](https://attack.mitre.org/software/S0461) can collected the country code of a compromised machine.(Citation: Korean FSI TA505 2020)
- [S0481] Ragnar Locker: Before executing malicious code, [Ragnar Locker](https://attack.mitre.org/software/S0481) checks the Windows API <code>GetLocaleInfoW</code> and doesn't encrypt files if it finds a former Soviet country.(Citation: FBI Ragnar Locker 2020)
- [S1148] Raccoon Stealer: [Raccoon Stealer](https://attack.mitre.org/software/S1148) collects the `Locale Name` of the infected device via `GetUserDefaultLocaleName` to determine whether the string `ru` is included, but in analyzed samples no action is taken if present.(Citation: S2W Racoon 2022)
- [S0115] Crimson: [Crimson](https://attack.mitre.org/software/S0115) can identify the geographical location of a victim host.(Citation: Kaspersky Transparent Tribe August 2020)
- [S1018] Saint Bot: [Saint Bot](https://attack.mitre.org/software/S1018) has conducted system locale checks to see if the compromised host is in Russia, Ukraine, Belarus, Armenia, Kazakhstan, or Moldova.(Citation: Malwarebytes Saint Bot April 2021)(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 )
- [S0632] GrimAgent: [GrimAgent](https://attack.mitre.org/software/S0632) can identify the country code on a compromised host.(Citation: Group IB GrimAgent July 2021)
- [S1025] Amadey: [Amadey](https://attack.mitre.org/software/S1025) does not run any tasks or install additional malware if the victim machine is based in Russia.(Citation: BlackBerry Amadey 2020)
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has obtained the victim's system current location.(Citation: CISA AA24-038A PRC Critical Infrastructure February 2024)

#### T1614.001 - System Language Discovery

Description:

Adversaries may attempt to gather information about the system language of a victim in order to infer the geographical location of that host. This information may be used to shape follow-on behaviors, including whether the adversary infects the target and/or attempts specific actions. This decision may be employed by malware developers and operators to reduce their risk of attracting the attention of specific law enforcement agencies or prosecution/scrutiny from other entities.(Citation: Malware System Language Check)

There are various sources of data an adversary could use to infer system language, such as system defaults and keyboard layouts. Specific checks will vary based on the target and/or adversary, but may involve behaviors such as [Query Registry](https://attack.mitre.org/techniques/T1012) and calls to [Native API](https://attack.mitre.org/techniques/T1106) functions.(Citation: CrowdStrike Ryuk January 2019) 

For example, on a Windows system adversaries may attempt to infer the language of a system by querying the registry key <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Nls\Language</code> or parsing the outputs of Windows API functions <code>GetUserDefaultUILanguage</code>, <code>GetSystemDefaultUILanguage</code>, <code>GetKeyboardLayoutList</code> and <code>GetUserDefaultLangID</code>.(Citation: Darkside Ransomware Cybereason)(Citation: Securelist JSWorm)(Citation: SecureList SynAck Doppelgänging May 2018)

On a macOS or Linux system, adversaries may query <code>locale</code> to retrieve the value of the <code>$LANG</code> environment variable.

Procedures:

- [C0022] Operation Dream Job: During [Operation Dream Job](https://attack.mitre.org/campaigns/C0022), [Lazarus Group](https://attack.mitre.org/groups/G0032) deployed malware designed not to run on computers set to Korean, Japanese, or Chinese in Windows language preferences.(Citation: ClearSky Lazarus Aug 2020)
- [S1153] Cuckoo Stealer: [Cuckoo Stealer](https://attack.mitre.org/software/S1153) can check the systems `LANG` environmental variable to prevent infecting devices from Armenia (`hy_AM`), Belarus (`be_BY`), Kazakhstan (`kk_KZ`), Russia (`ru_RU`), and Ukraine (`uk_UA`).(Citation: Kandji Cuckoo April 2024)
- [S0652] MarkiRAT: [MarkiRAT](https://attack.mitre.org/software/S0652) can use the <code>GetKeyboardLayout</code> API to check if a compromised host's keyboard is set to Persian.(Citation: Kaspersky Ferocious Kitten Jun 2021)
- [S0658] XCSSET: [XCSSET](https://attack.mitre.org/software/S0658) uses AppleScript to check the host's language and location with the command <code>user locale of (get system info)</code>.(Citation: trendmicro xcsset xcode project 2020)
- [S0625] Cuba: [Cuba](https://attack.mitre.org/software/S0625) can check if Russian language is installed on the infected machine by using the function <code>GetKeyboardLayoutList</code>.(Citation: McAfee Cuba April 2021)
- [G0004] Ke3chang: [Ke3chang](https://attack.mitre.org/groups/G0004) has used implants to collect the system language ID of a compromised machine.(Citation: Microsoft NICKEL December 2021)
- [S0696] Flagpro: [Flagpro](https://attack.mitre.org/software/S0696) can check whether the target system is using Japanese, Taiwanese, or English through detection of specific Windows Security and Internet Explorer dialog.(Citation: NTT Security Flagpro new December 2021)
- [S0483] IcedID: [IcedID](https://attack.mitre.org/software/S0483) used the following command to check the country/language of the active console: 
` cmd.exe /c chcp >&2`.(Citation: DFIR_Quantum_Ransomware)
- [S0640] Avaddon: [Avaddon](https://attack.mitre.org/software/S0640) checks for specific keyboard layouts and OS languages to avoid targeting Commonwealth of Independent States (CIS) entities.(Citation: Arxiv Avaddon Feb 2021)
- [S0449] Maze: [Maze](https://attack.mitre.org/software/S0449) has checked the language of the machine with function <code>GetUserDefaultUILanguage</code> and terminated execution if the language matches with an entry in the predefined list.(Citation: McAfee Maze March 2020)
- [S1122] Mispadu: [Mispadu](https://attack.mitre.org/software/S1122) checks and will terminate execution if the compromised system’s language ID is not Spanish or Portuguese.(Citation: Segurança Informática URSA Sophisticated Loader 2020)(Citation: SCILabs Malteiro 2021)
- [S0543] Spark: [Spark](https://attack.mitre.org/software/S0543) has checked the results of the <code>GetKeyboardLayoutList</code> and the language name returned by <code>GetLocaleInfoA</code> to make sure they contain the word “Arabic” before executing.(Citation: Unit42 Molerat Mar 2020)
- [G1043] BlackByte: [BlackByte](https://attack.mitre.org/groups/G1043) identified system language settings to determine follow-on execution.(Citation: Picus BlackByte 2022)
- [S0446] Ryuk: [Ryuk](https://attack.mitre.org/software/S0446) has been observed to query the registry key <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Nls\Language</code> and the value <code>InstallLanguage</code>. If the machine has the value 0x419 (Russian), 0x422 (Ukrainian), or 0x423 (Belarusian), it stops execution.(Citation: CrowdStrike Ryuk January 2019)
- [S1138] Gootloader: [Gootloader](https://attack.mitre.org/software/S1138) can determine if a victim's computer is running an operating system with specific language preferences.(Citation: Sophos Gootloader)
- [S0085] S-Type: [S-Type](https://attack.mitre.org/software/S0085) has attempted to determine if a compromised system was using a Japanese keyboard via the `GetKeyboardType` API call.(Citation: Cylance Dust Storm)
- [S0534] Bazar: [Bazar](https://attack.mitre.org/software/S0534) can perform a check to ensure that the operating system's keyboard and language settings are not set to Russian.(Citation: NCC Group Team9 June 2020)
- [S0616] DEATHRANSOM: Some versions of [DEATHRANSOM](https://attack.mitre.org/software/S0616) have performed language ID and keyboard layout checks; if either of these matched Russian, Kazakh, Belarusian, Ukrainian or Tatar [DEATHRANSOM](https://attack.mitre.org/software/S0616) would exit.(Citation: FireEye FiveHands April 2021)
- [S0691] Neoichor: [Neoichor](https://attack.mitre.org/software/S0691) can identify the system language on a compromised host.(Citation: Microsoft NICKEL December 2021)
- [S0611] Clop: [Clop](https://attack.mitre.org/software/S0611) has checked the keyboard language using the GetKeyboardLayout() function to avoid installation on Russian-language or other Commonwealth of Independent States-language machines; it will also check the <code>GetTextCharset</code> function.(Citation: Mcafee Clop Aug 2019)
- [S0330] Zeus Panda: [Zeus Panda](https://attack.mitre.org/software/S0330) queries the system's keyboard mapping to determine the language used on the system. It will terminate execution if it detects LANG_RUSSIAN, LANG_BELARUSIAN, LANG_KAZAK, or LANG_UKRAINIAN.(Citation: Talos Zeus Panda Nov 2017)
- [S0632] GrimAgent: [GrimAgent](https://attack.mitre.org/software/S0632) has used <code>Accept-Language</code> to identify hosts in the United Kingdom, United States, France, and Spain.(Citation: Group IB GrimAgent July 2021)
- [S0547] DropBook: [DropBook](https://attack.mitre.org/software/S0547) has checked for the presence of Arabic language in the infected machine's settings.(Citation: BleepingComputer Molerats Dec 2020)
- [S1199] LockBit 2.0: [LockBit 2.0](https://attack.mitre.org/software/S1199) can check if a targeted machine is using a set of Eastern European languages and exit without infection if so.(Citation: FBI Lockbit 2.0 FEB 2022)(Citation: Palo Alto Lockbit 2.0 JUN 2022)
- [S0496] REvil: [REvil](https://attack.mitre.org/software/S0496) can check the system language using <code>GetUserDefaultUILanguage</code> and <code>GetSystemDefaultUILanguage</code>. If the language is found in the list, the process terminates.(Citation: Kaspersky Sodin July 2019)
- [S1183] StrelaStealer: [StrelaStealer](https://attack.mitre.org/software/S1183) variants check system language settings via keyboard layout or similar mechanisms.(Citation: Fortgale StrelaStealer 2023)(Citation: IBM StrelaStealer 2024)
- [S1200] StealBit: [StealBit](https://attack.mitre.org/software/S1200) can determine system location based on the default language setting and will not execute on systems located in former Soviet countries.(Citation: Cybereason StealBit Exfiltration Tool)
- [S1202] LockBit 3.0: [LockBit 3.0](https://attack.mitre.org/software/S1202) will not affect machines with language settings matching a defined exlusion list of mainly Eastern European languages.(Citation: Joint Cybersecurity Advisory LockBit JUN 2023)(Citation: Joint Cybersecurity Advisory LockBit 3.0 MAR 2023)
- [S0242] SynAck: [SynAck](https://attack.mitre.org/software/S0242) lists all the keyboard layouts installed on the victim’s system using <code>GetKeyboardLayoutList</code> API and checks against a hardcoded language code list. If a match if found, SynAck sleeps for 300 seconds and then exits without encrypting files.(Citation: SecureList SynAck Doppelgänging May 2018)
- [S0083] Misdat: [Misdat](https://attack.mitre.org/software/S0083) has attempted to detect if a compromised host had a Japanese keyboard via the Windows API call `GetKeyboardType`.(Citation: Cylance Dust Storm)
- [S0546] SharpStage: [SharpStage](https://attack.mitre.org/software/S0546)  has been used to target Arabic-speaking users and used code that checks if the compromised machine has the Arabic language installed.(Citation: BleepingComputer Molerats Dec 2020)
- [S1180] BlackByte Ransomware: [BlackByte Ransomware](https://attack.mitre.org/software/S1180) identifies the language on the victim system.(Citation: Trustwave BlackByte 2021)
- [G1026] Malteiro: [Malteiro](https://attack.mitre.org/groups/G1026) will terminate [Mispadu](https://attack.mitre.org/software/S1122)'s infection process if the language of the victim machine is not Spanish or Portuguese.(Citation: SCILabs Malteiro 2021)


### T1615 - Group Policy Discovery

Description:

Adversaries may gather information on Group Policy settings to identify paths for privilege escalation, security measures applied within a domain, and to discover patterns in domain objects that can be manipulated or used to blend in the environment. Group Policy allows for centralized management of user and computer settings in Active Directory (AD). Group policy objects (GPOs) are containers for group policy settings made up of files stored within a predictable network path `\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\`.(Citation: TechNet Group Policy Basics)(Citation: ADSecurity GPO Persistence 2016)

Adversaries may use commands such as <code>gpresult</code> or various publicly available PowerShell functions, such as <code>Get-DomainGPO</code> and <code>Get-DomainGPOLocalGroup</code>, to gather information on Group Policy settings.(Citation: Microsoft gpresult)(Citation: Github PowerShell Empire) Adversaries may use this information to shape follow-on behaviors, including determining potential attack paths within the target network as well as opportunities to manipulate Group Policy settings (i.e. [Domain or Tenant Policy Modification](https://attack.mitre.org/techniques/T1484)) for their benefit.

Procedures:

- [S1141] LunarWeb: [LunarWeb](https://attack.mitre.org/software/S1141) can capture information on group policy settings(Citation: ESET Turla Lunar toolset May 2024)
- [C0049] Leviathan Australian Intrusions: [Leviathan](https://attack.mitre.org/groups/G0065) performed extensive Active Directory enumeration of victim environments during [Leviathan Australian Intrusions](https://attack.mitre.org/campaigns/C0049).(Citation: CISA Leviathan 2024)
- [S1159] DUSTTRAP: [DUSTTRAP](https://attack.mitre.org/software/S1159) can identify victim environment Group Policy information.(Citation: Google Cloud APT41 2024)
- [S0521] BloodHound: [BloodHound](https://attack.mitre.org/software/S0521) has the ability to collect local admin information via GPO.(Citation: GitHub Bloodhound)
- [G0010] Turla: [Turla](https://attack.mitre.org/groups/G0010) surveys a system upon check-in to discover Group Policy details using the <code>gpresult</code> command.(Citation: ESET ComRAT May 2020)
- [S0363] Empire: [Empire](https://attack.mitre.org/software/S0363) includes various modules for enumerating Group Policy.(Citation: Github PowerShell Empire)
- [S0082] Emissary: [Emissary](https://attack.mitre.org/software/S0082) has the capability to execute <code>gpresult</code>.(Citation: Emissary Trojan Feb 2016)


### T1619 - Cloud Storage Object Discovery

Description:

Adversaries may enumerate objects in cloud storage infrastructure. Adversaries may use this information during automated discovery to shape follow-on behaviors, including requesting all or specific objects from cloud storage.  Similar to [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) on a local host, after identifying available storage services (i.e. [Cloud Infrastructure Discovery](https://attack.mitre.org/techniques/T1580)) adversaries may access the contents/objects stored in cloud infrastructure.

Cloud service providers offer APIs allowing users to enumerate objects stored within cloud storage. Examples include ListObjectsV2 in AWS (Citation: ListObjectsV2) and List Blobs in Azure(Citation: List Blobs) .

Procedures:

- [S1091] Pacu: [Pacu](https://attack.mitre.org/software/S1091) can enumerate AWS storage services, such as S3 buckets and Elastic Block Store volumes.(Citation: GitHub Pacu)
- [S0683] Peirates: [Peirates](https://attack.mitre.org/software/S0683) can list AWS S3 buckets.(Citation: Peirates GitHub)


### T1622 - Debugger Evasion

Description:

Adversaries may employ various means to detect and avoid debuggers. Debuggers are typically used by defenders to trace and/or analyze the execution of potential malware payloads.(Citation: ProcessHacker Github)

Debugger evasion may include changing behaviors based on the results of the checks for the presence of artifacts indicative of a debugged environment. Similar to [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497), if the adversary detects a debugger, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for debugger artifacts before dropping secondary or additional payloads.

Specific checks will vary based on the target and/or adversary. On Windows, this may involve [Native API](https://attack.mitre.org/techniques/T1106) function calls such as <code>IsDebuggerPresent()</code> and <code> NtQueryInformationProcess()</code>, or manually checking the <code>BeingDebugged</code> flag of the Process Environment Block (PEB). On Linux, this may involve querying `/proc/self/status` for the `TracerPID` field, which indicates whether or not the process is being traced by dynamic analysis tools.(Citation: Cado Security P2PInfect 2023)(Citation: Positive Technologies Hellhounds 2023) Other checks for debugging artifacts may also seek to enumerate hardware breakpoints, interrupt assembly opcodes, time checks, or measurements if exceptions are raised in the current process (assuming a present debugger would “swallow” or handle the potential error).(Citation: hasherezade debug)(Citation: AlKhaser Debug)(Citation: vxunderground debug)

Malware may also leverage Structured Exception Handling (SEH) to detect debuggers by throwing an exception and detecting whether the process is suspended. SEH handles both hardware and software expectations, providing control over the exceptions including support for debugging. If a debugger is present, the program’s control will be transferred to the debugger, and the execution of the code will be suspended. If the debugger is not present, control will be transferred to the SEH handler, which will automatically handle the exception and allow the program’s execution to continue.(Citation: Apriorit)

Adversaries may use the information learned from these debugger checks during automated discovery to shape follow-on behaviors. Debuggers can also be evaded by detaching the process or flooding debug logs with meaningless data via messages produced by looping [Native API](https://attack.mitre.org/techniques/T1106) function calls such as <code>OutputDebugStringW()</code>.(Citation: wardle evilquest partii)(Citation: Checkpoint Dridex Jan 2021)

Procedures:

- [S1213] Lumma Stealer: [Lumma Stealer](https://attack.mitre.org/software/S1213) has checked for debugger strings by invoking `GetForegroundWindow` and looks for strings containing “x32dbg”, “x64dbg”, “windbg”, “ollydbg”, “dnspy”, “immunity debugger”, “hyperdbg”, “debug”, “debugger”, “cheat engine”, “cheatengine” and “ida”.(Citation: Fortinet LummaStealer 2024)
- [S1087] AsyncRAT: [AsyncRAT](https://attack.mitre.org/software/S1087) can use the `CheckRemoteDebuggerPresent` function to detect the presence of a debugger.(Citation: Telefonica Snip3 December 2021)
- [S1200] StealBit: [StealBit](https://attack.mitre.org/software/S1200) can detect it is being run in the context of a debugger.(Citation: Cybereason StealBit Exfiltration Tool)
- [S1183] StrelaStealer: [StrelaStealer](https://attack.mitre.org/software/S1183) variants include functionality to identify and evade debuggers.(Citation: Fortgale StrelaStealer 2023)
- [S1111] DarkGate: [DarkGate](https://attack.mitre.org/software/S1111) checks the <code>BeingDebugged</code> flag in the PEB structure during execution to identify if the malware is being debugged.(Citation: Trellix Darkgate 2023)
- [S1145] Pikabot: [Pikabot](https://attack.mitre.org/software/S1145) features several methods to evade debugging by analysts, including checks for active debuggers, the use of breakpoints during execution, and checking various system information items such as system memory and the number of processors.(Citation: Zscaler Pikabot 2023)(Citation: Elastic Pikabot 2024)(Citation: Logpoint Pikabot 2024)
- [S0240] ROKRAT: [ROKRAT](https://attack.mitre.org/software/S0240) can check for debugging tools.(Citation: Talos Group123)(Citation: NCCGroup RokRat Nov 2018)(Citation: Malwarebytes RokRAT VBA January 2021)
- [S0694] DRATzarus: [DRATzarus](https://attack.mitre.org/software/S0694) can use `IsDebuggerPresent` to detect whether a debugger is present on a victim.(Citation: ClearSky Lazarus Aug 2020)
- [S1070] Black Basta: The [Black Basta](https://attack.mitre.org/software/S1070) dropper can check system flags, CPU registers, CPU instructions, process timing, system libraries, and APIs to determine if a debugger is present.(Citation: Check Point Black Basta October 2022)
- [S1018] Saint Bot: [Saint Bot](https://attack.mitre.org/software/S1018) has used `is_debugger_present` as part of its environmental checks.(Citation: Malwarebytes Saint Bot April 2021)
- [S1207] XLoader: [XLoader](https://attack.mitre.org/software/S1207) uses anti-debugging mechanisms such as calling `NtQueryInformationProcess` with `InfoClass=7`, referencing `ProcessDebugPort`, to determine if it is being analyzed.(Citation: Google XLoader 2017)
- [S1130] Raspberry Robin: [Raspberry Robin](https://attack.mitre.org/software/S1130) leverages anti-debugging mechanisms through the use of <code>ThreadHideFromDebugger</code>.(Citation: TrendMicro RaspberryRobin 2022)
- [S1202] LockBit 3.0: [LockBit 3.0](https://attack.mitre.org/software/S1202) can check heap memory parameters for indications of a debugger and stop the flow of events to the attached debugger in order to hinder dynamic analysis.(Citation: Sentinel Labs LockBit 3.0 JUL 2022)
- [C0022] Operation Dream Job: During [Operation Dream Job](https://attack.mitre.org/campaigns/C0022), [Lazarus Group](https://attack.mitre.org/groups/G0032) used tools that used the `IsDebuggerPresent` call to detect debuggers.(Citation: ClearSky Lazarus Aug 2020)
- [S1066] DarkTortilla: [DarkTortilla](https://attack.mitre.org/software/S1066) can detect debuggers by using functions such as `DebuggerIsAttached` and `DebuggerIsLogging`. [DarkTortilla](https://attack.mitre.org/software/S1066) can also detect profilers by verifying the `COR_ENABLE_PROFILING` environment variable is present and active.(Citation: Secureworks DarkTortilla Aug 2022)
- [S1060] Mafalda: [Mafalda](https://attack.mitre.org/software/S1060) can search for debugging tools on a compromised host.(Citation: SentinelLabs Metador Technical Appendix Sept 2022)
- [S0595] ThiefQuest: [ThiefQuest](https://attack.mitre.org/software/S0595) uses a function named <code>is_debugging</code> to perform anti-debugging logic. The function invokes <code>sysctl</code> checking the returned value of <code>P_TRACED</code>. [ThiefQuest](https://attack.mitre.org/software/S0595) also calls <code>ptrace</code> with the <code>PTRACE_DENY_ATTACH</code> flag to prevent debugging.(Citation: wardle evilquest partii)
- [S1160] Latrodectus: [Latrodectus](https://attack.mitre.org/software/S1160) has the ability to check for the presence of debuggers.(Citation: Latrodectus APR 2024)
- [S1039] Bumblebee: [Bumblebee](https://attack.mitre.org/software/S1039) can search for tools used in static analysis.(Citation: Medium Ali Salem Bumblebee April 2022)


### T1652 - Device Driver Discovery

Description:

Adversaries may attempt to enumerate local device drivers on a victim host. Information about device drivers may highlight various insights that shape follow-on behaviors, such as the function/purpose of the host, present security tools (i.e. [Security Software Discovery](https://attack.mitre.org/techniques/T1518/001)) or other defenses (e.g., [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497)), as well as potential exploitable vulnerabilities (e.g., [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068)).

Many OS utilities may provide information about local device drivers, such as `driverquery.exe` and the `EnumDeviceDrivers()` API function on Windows.(Citation: Microsoft Driverquery)(Citation: Microsoft EnumDeviceDrivers) Information about device drivers (as well as associated services, i.e., [System Service Discovery](https://attack.mitre.org/techniques/T1007)) may also be available in the Registry.(Citation: Microsoft Registry Drivers)

On Linux/macOS, device drivers (in the form of kernel modules) may be visible within `/dev` or using utilities such as `lsmod` and `modinfo`.(Citation: Linux Kernel Programming)(Citation: lsmod man)(Citation: modinfo man)

Procedures:

- [S0376] HOPLIGHT: [HOPLIGHT](https://attack.mitre.org/software/S0376) can enumerate device drivers located in the registry at `HKLM\Software\WBEM\WDM`.(Citation: US-CERT HOPLIGHT Apr 2019)
- [S1139] INC Ransomware: [INC Ransomware](https://attack.mitre.org/software/S1139) can verify the presence of specific drivers on compromised hosts including Microsoft Print to PDF and Microsoft XPS Document Writer.(Citation: Cybereason INC Ransomware November 2023)
- [S0125] Remsec: [Remsec](https://attack.mitre.org/software/S0125) has a plugin to detect active drivers of some security products.(Citation: Kaspersky ProjectSauron Technical Analysis)


### T1654 - Log Enumeration

Description:

Adversaries may enumerate system and service logs to find useful data. These logs may highlight various types of valuable insights for an adversary, such as user authentication records ([Account Discovery](https://attack.mitre.org/techniques/T1087)), security or vulnerable software ([Software Discovery](https://attack.mitre.org/techniques/T1518)), or hosts within a compromised network ([Remote System Discovery](https://attack.mitre.org/techniques/T1018)).

Host binaries may be leveraged to collect system logs. Examples include using `wevtutil.exe` or [PowerShell](https://attack.mitre.org/techniques/T1059/001) on Windows to access and/or export security event information.(Citation: WithSecure Lazarus-NoPineapple Threat Intel Report 2023)(Citation: Cadet Blizzard emerges as novel threat actor) In cloud environments, adversaries may leverage utilities such as the Azure VM Agent’s `CollectGuestLogs.exe` to collect security logs from cloud hosted infrastructure.(Citation: SIM Swapping and Abuse of the Microsoft Azure Serial Console)

Adversaries may also target centralized logging infrastructure such as SIEMs. Logs may also be bulk exported and sent to adversary-controlled infrastructure for offline analysis.

In addition to gaining a better understanding of the environment, adversaries may also monitor logs in real time to track incident response procedures. This may allow them to adjust their techniques in order to maintain persistence or evade defenses.(Citation: Permiso GUI-Vil 2023)

Procedures:

- [G1023] APT5: [APT5](https://attack.mitre.org/groups/G1023) has used the BLOODMINE utility to parse and extract information from Pulse Secure Connect logs.(Citation: Mandiant Pulse Secure Update May 2021)
- [G1003] Ember Bear: [Ember Bear](https://attack.mitre.org/groups/G1003) has enumerated SECURITY and SYSTEM log files during intrusions.(Citation: CISA GRU29155 2024)
- [G1017] Volt Typhoon: [Volt Typhoon](https://attack.mitre.org/groups/G1017) has used `wevtutil.exe` and the PowerShell command `Get-EventLog security` to enumerate Windows logs to search for successful logons.(Citation: Joint Cybersecurity Advisory Volt Typhoon June 2023)(Citation: CISA AA24-038A PRC Critical Infrastructure February 2024)
- [G0143] Aquatic Panda: [Aquatic Panda](https://attack.mitre.org/groups/G0143) enumerated logs related to authentication in Linux environments prior to deleting selective entries for defense evasion purposes.(Citation: Crowdstrike HuntReport 2022)
- [S1091] Pacu: [Pacu](https://attack.mitre.org/software/S1091) can collect CloudTrail event histories and CloudWatch logs.(Citation: GitHub Pacu)
- [S1191] Megazord: [Megazord](https://attack.mitre.org/software/S1191) has the ability to print the trace, debug, error, info, and warning logs.(Citation: Palo Alto Howling Scorpius DEC 2024)
- [S1194] Akira _v2: [Akira _v2](https://attack.mitre.org/software/S1194) can enumerate the trace, debug, error, info, and warning logs on targeted systems.(Citation: Cisco Akira Ransomware OCT 2024)(Citation: Palo Alto Howling Scorpius DEC 2024)
- [S1159] DUSTTRAP: [DUSTTRAP](https://attack.mitre.org/software/S1159) can identify infected system log information.(Citation: Google Cloud APT41 2024)


### T1673 - Virtual Machine Discovery

Description:

An adversary may attempt to enumerate running virtual machines (VMs) after gaining access to a host or hypervisor. For example, adversaries may enumerate a list of VMs on an ESXi hypervisor using a [Hypervisor CLI](https://attack.mitre.org/techniques/T1059/012) such as `esxcli` or `vim-cmd` (e.g. `esxcli vm process list or vim-cmd vmsvc/getallvms`).(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021)(Citation: TrendMicro Play) Adversaries may also directly leverage a graphical user interface, such as VMware vCenter, in order to view virtual machines on a host. 

Adversaries may use the information from [Virtual Machine Discovery](https://attack.mitre.org/techniques/T1673) during discovery to shape follow-on behaviors. Subsequently discovered VMs may be leveraged for follow-on activities such as [Service Stop](https://attack.mitre.org/techniques/T1489) or [Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486).(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021)

Procedures:

- [S1096] Cheerscrypt: Cheerscrypt has leveraged `esxcli vm process list` in order to gather a list of running virtual machines to terminate them.(Citation: Trend Micro Cheerscrypt May 2022)

