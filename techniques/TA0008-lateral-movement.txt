{"technique_id":"T1021.001","technique_name":"Remote Services: Remote Desktop Protocol","description":"Adversaries may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user. Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS). Adversaries may connect to a remote system over RDP/RDS to expand access if the service is enabled and allows access to accounts with known credentials. Adversaries will likely use Credential Access techniques to acquire credentials to use with RDP. Adversaries may also use RDP in conjunction with the Accessibility Features or Terminal Services DLL for Persistence.","detection":"Use of RDP may be legitimate, depending on the network environment and how it is used. Other factors, such as access patterns and activity that occurs after a remote login, may indicate suspicious or malicious behavior with RDP. Monitor for user accounts logged into systems they would not normally access or access patterns to multiple systems over a relatively short period of time.","procedures":["[G0094] Kimsuky: Kimsuky has used RDP for direct remote point-and-click access.","[G1032] INC Ransom: INC Ransom has used RDP to move laterally.","[S0154] Cobalt Strike: Cobalt Strike can start a VNC-based remote desktop server and tunnel the connection through the already established C2 channel.","[S0262] QuasarRAT: QuasarRAT has a module for performing remote desktop access.","[G1017] Volt Typhoon: Volt Typhoon has moved laterally to the Domain Controller via RDP using a compromised account with domain administrator privileges.","[G1023] APT5: APT5 has moved laterally throughout victim environments using RDP.","[S0350] zwShell: zwShell has used RDP for lateral movement.","[G0049] OilRig: OilRig has used Remote Desktop Protocol for lateral movement. The group has also used tunneling tools to tunnel RDP into the environment.","[G0040] Patchwork: Patchwork attempted to use RDP to move laterally.","[G0061] FIN8: FIN8 has used RDP for lateral movement.","[G1043] BlackByte: BlackByte has used RDP to access other hosts within victim networks.","[S0434] Imminent Monitor: Imminent Monitor has a module for performing remote desktop access.","[S0670] WarzoneRAT: WarzoneRAT has the ability to control an infected PC using RDP.","[G0087] APT39: APT39 has been seen using RDP for lateral movement and persistence, in some cases employing the rdpwinst tool for mangement of multiple sessions.","[G0059] Magic Hound: Magic Hound has used Remote Desktop Services to copy tools on targeted systems.","[G0102] Wizard Spider: Wizard Spider has used RDP for lateral movement and to deploy ransomware interactively.","[G0143] Aquatic Panda: Aquatic Panda leveraged stolen credentials to move laterally via RDP in victim environments.","[S0030] Carbanak: Carbanak enables concurrent Remote Desktop Protocol (RDP) sessions.","[C0024] SolarWinds Compromise: During the SolarWinds Compromise, APT29 used RDP sessions from public-facing systems to internal servers.","[C0018] C0018: During C0018, the threat actors opened a variety of ports to establish RDP connections, including ports 28035, 32467, 41578, and 46892.","[C0029] Cutting Edge: During Cutting Edge, threat actors used RDP with compromised credentials for lateral movement.","[G0046] FIN7: FIN7 has used RDP to move laterally in victim environments.","[G0119] Indrik Spider: Indrik Spider has used RDP for lateral movement.","[C0032] C0032: During the C0032 campaign, TEMP.Veles utilized RDP throughout an operation.","[C0038] HomeLand Justice: During HomeLand Justice, threat actors primarily used RDP for lateral movement in the victim environment.","[G0091] Silence: Silence has used RDP for lateral movement.","[S1187] reGeorg: reGeorg can be used to tunnel RDP connections.","[S0379] Revenge RAT: Revenge RAT has a plugin to perform RDP access.","[S0382] ServHelper: ServHelper has commands for adding a remote desktop user and sending RDP traffic to the attacker through a reverse SSH tunnel.","[G1001] HEXANE: HEXANE has used remote desktop sessions for lateral movement.","[G0001] Axiom: Axiom has used RDP during operations.","[G0080] Cobalt Group: Cobalt Group has used Remote Desktop Protocol to conduct lateral movement.","[G1024] Akira: Akira has used RDP for lateral movement.","[S0461] SDBbot: SDBbot has the ability to use RDP to connect to victim's machines.","[S0250] Koadic: Koadic can enable remote desktop on the victim's machine.","[S0283] jRAT: jRAT can support RDP control.","[G1030] Agrius: Agrius tunnels RDP traffic through deployed web shells to access victim environments via compromised accounts. Agrius used the Plink tool to tunnel RDP connections for remote access and lateral movement in victim environments.","[S0385] njRAT: njRAT has a module for performing remote desktop access.","[S0583] Pysa: Pysa has laterally moved using RDP connections.","[C0051] APT28 Nearest Neighbor Campaign: During APT28 Nearest Neighbor Campaign, APT28 used RDP for lateral movement.","[S0192] Pupy: Pupy can enable/disable RDP connection and can start a remote desktop session using a browser web socket client.","[S0334] DarkComet: DarkComet can open an active screen of the victim’s machine and take control of the mouse and keyboard.","[G0037] FIN6: FIN6 used RDP to move laterally in victim networks.","[G0051] FIN10: FIN10 has used RDP to move laterally to systems in the victim environment.","[S0412] ZxShell: ZxShell has remote desktop functionality.","[G1016] FIN13: FIN13 has remotely accessed compromised environments via Remote Desktop Services (RDS) for lateral movement.","[G0108] Blue Mockingbird: Blue Mockingbird has used Remote Desktop to log on to servers interactively and manually copy files to remote hosts.","[G0045] menuPass: menuPass has used RDP connections to move across the victim network.","[C0015] C0015: During C0015, the threat actors used RDP to access specific network hosts of interest.","[G0032] Lazarus Group: Lazarus Group malware SierraCharlie uses RDP for propagation.","[G0022] APT3: APT3 enables the Remote Desktop Protocol for persistence. APT3 has also interacted with compromised systems to browse and copy files through RDP sessions.","[G0117] Fox Kitten: Fox Kitten has used RDP to log in and move laterally in the target environment.","[G0065] Leviathan: Leviathan has targeted RDP credentials and used it to move through the victim environment.","[G0035] Dragonfly: Dragonfly has moved laterally via RDP.","[G0096] APT41: APT41 used RDP for lateral movement. APT41 used NATBypass to expose local RDP ports on compromised systems to the Internet.","[G0114] Chimera: Chimera has used RDP to access targeted systems.","[G0006] APT1: The APT1 group is known to have used RDP during operations."],"tactics":"TA0008 - Lateral Movement"}
{"technique_id":"T1021.002","technique_name":"Remote Services: SMB/Windows Admin Shares","description":"Adversaries may use Valid Accounts to interact with a remote network share using Server Message Block (SMB). The adversary may then perform actions as the logged-on user. SMB is a file, printer, and serial port sharing protocol for Windows machines on the same network or domain. Adversaries may use SMB to interact with file shares, allowing them to move laterally throughout a network. Linux and macOS implementations of SMB typically use Samba. Windows systems have hidden network shares that are accessible only to administrators and provide the ability for remote file copy and other administrative functions. Example network shares include `C$`, `ADMIN$`, and `IPC$`. Adversaries may use this technique in conjunction with administrator-level Valid Accounts to remotely access a networked system over SMB, to interact with systems using remote procedure calls (RPCs), transfer files, and run transferred binaries through remote Execution. Example execution techniques that rely on authenticated sessions over SMB/RPC are Scheduled Task/Job, Service Execution, and Windows Management Instrumentation. Adversaries can also use NTLM hashes to access administrator shares on systems with Pass the Hash and certain configuration and patch levels.","detection":"Ensure that proper logging of accounts used to log into systems is turned on and centrally collected. Windows logging is able to collect success/failure for accounts that may be used to move laterally and can be collected using tools such as Windows Event Forwarding. Monitor remote login events and associated SMB activity for file transfers and remote process execution. Monitor the actions of remote users who connect to administrative shares. Monitor for use of tools and commands to connect to remote shares, such as Net, on the command-line interface and Discovery techniques that could be used to find remotely accessible systems.","procedures":["[S0575] Conti: Conti can spread via SMB and encrypts files on different hosts, potentially compromising an entire network.","[G1009] Moses Staff: Moses Staff has used batch scripts that can enable SMB on a compromised host.","[G0028] Threat Group-1314: Threat Group-1314 actors mapped network drives using net use.","[C0049] Leviathan Australian Intrusions: Leviathan used remote shares to move laterally through victim networks during Leviathan Australian Intrusions.","[S0698] HermeticWizard: HermeticWizard can use a list of hardcoded credentials to to authenticate via NTLMSSP to the SMB shares on remote systems.","[G0143] Aquatic Panda: Aquatic Panda used remote shares to enable lateral movement in victim environments.","[S0367] Emotet: Emotet has leveraged the Admin$, C$, and IPC$ shares for lateral movement.","[S0350] zwShell: zwShell has been copied over network shares to move laterally.","[S0446] Ryuk: Ryuk has used the C$ network share for lateral movement.","[S0029] PsExec: PsExec, a tool that has been used by adversaries, writes programs to the ADMIN$ network share to execute commands on remote systems.","[G0102] Wizard Spider: Wizard Spider has used SMB to drop Cobalt Strike Beacon on a domain controller for lateral movement.","[S0140] Shamoon: Shamoon accesses network share(s), enables share access to the target device, copies an executable payload to the target system, and uses a Scheduled Task/Job to execute the malware.","[G0096] APT41: APT41 has transferred implant files using Windows Admin Shares and the Server Message Block (SMB) protocol, then executes files through Windows Management Instrumentation (WMI).","[S1073] Royal: Royal can use SMB to connect to move laterally.","[G0004] Ke3chang: Ke3chang actors have been known to copy files to the network shares of other computers to move laterally.","[S0368] NotPetya: NotPetya can use PsExec, which interacts with the ADMIN$ network share to execute commands on remote systems.","[G0010] Turla: Turla used net use commands to connect to lateral systems within a network.","[S0659] Diavol: Diavol can spread throughout a network via SMB prior to encryption.","[S0089] BlackEnergy: BlackEnergy has run a plug-in on a victim to spread through the local network by using PsExec and accessing admin shares.","[C0024] SolarWinds Compromise: During the SolarWinds Compromise, APT29 used administrative accounts to connect over SMB to targeted users.","[G1016] FIN13: FIN13 has leveraged SMB to move laterally within a compromised network via application servers and SQL servers.","[G0114] Chimera: Chimera has used Windows admin shares to move laterally.","[G0117] Fox Kitten: Fox Kitten has used valid accounts to access SMB shares.","[G1040] Play: Play has used Cobalt Strike to move laterally via SMB.","[S1063] Brute Ratel C4: Brute Ratel C4 has the ability to use SMB to pivot in compromised networks.","[S0672] Zox: Zox has the ability to use SMB for communication.","[S1212] RansomHub: RansomHub can use credentials provided in its configuration to move laterally from the infected machine over SMBv2.","[S0608] Conficker: Conficker variants spread through NetBIOS share propagation.","[G0034] Sandworm Team: Sandworm Team has copied payloads to the `ADMIN$` share of remote systems and run net use to connect to network shares.","[C0014] Operation Wocao: During Operation Wocao, threat actors used Impacket's smbexec.py as well as accessing the C$ and IPC$ shares to move laterally.","[S0038] Duqu: Adversaries can instruct Duqu to spread laterally by copying itself to shares it has enumerated and for which it has obtained legitimate credentials (via keylogging or other means). The remote host is then infected by using the compromised credentials to schedule a task on remote machines that executes the malware.","[S0236] Kwampirs: Kwampirs copies itself over network shares to move laterally on a victim network.","[G1022] ToddyCat: ToddyCat has used locally mounted network shares for lateral movement through targated environments.","[G0022] APT3: APT3 will copy files over to Windows Admin Shares (like ADMIN$) as part of lateral movement.","[C0048] Operation MidnightEclipse: During Operation MidnightEclipse, threat actors used SMB to pivot internally in victim networks.","[S0039] Net: Lateral movement can be done with Net through net use commands to connect to the on remote systems.","[G0061] FIN8: FIN8 has attempted to map to C$ on enumerated hosts to test the scope of their current credentials/context. FIN8 has also used smbexec from the Impacket suite for lateral movement.","[C0038] HomeLand Justice: During HomeLand Justice, threat actors used SMB for lateral movement.","[C0029] Cutting Edge: During Cutting Edge, threat actors moved laterally using compromised credentials to connect to internal Windows systems with SMB.","[S0019] Regin: The Regin malware platform can use Windows admin shares to move laterally.","[G0108] Blue Mockingbird: Blue Mockingbird has used Windows Explorer to manually copy malicious files to remote hosts over SMB.","[G0050] APT32: APT32 used Net to use Windows' hidden network shares to copy their tools to remote machines for execution.","[S0603] Stuxnet: Stuxnet propagates to available network shares.","[G1021] Cinnamon Tempest: Cinnamon Tempest has used SMBexec for lateral movement.","[S1199] LockBit 2.0: LockBit 2.0 has the ability to move laterally via SMB.","[S0154] Cobalt Strike: Cobalt Strike can use Window admin shares (C$ and ADMIN$) for lateral movement.","[G1043] BlackByte: BlackByte used SMB file shares to distribute payloads throughout victim networks, including BlackByte ransomware variants during wormable operations.","[G1047] Velvet Ant: Velvet Ant has transferred tools within victim environments using SMB.","[S1180] BlackByte Ransomware: BlackByte Ransomware uses mapped shared folders to transfer ransomware payloads via SMB.","[S1187] reGeorg: reGeorg has the ability to tunnel SMB sessions.","[S0365] Olympic Destroyer: Olympic Destroyer uses PsExec to interact with the ADMIN$ network share to execute commands on remote systems.","[C0051] APT28 Nearest Neighbor Campaign: During APT28 Nearest Neighbor Campaign, APT28 leveraged SMB to transfer files and move laterally.","[G0071] Orangeworm: Orangeworm has copied its backdoor across open network shares, including ADMIN$, C$WINDOWS, D$WINDOWS, and E$WINDOWS.","[S1202] LockBit 3.0: LockBit 3.0 can use SMB for lateral movement.","[G0032] Lazarus Group: Lazarus Group malware SierraAlfa accesses the ADMIN$ share via SMB to conduct lateral movement.","[S0056] Net Crawler: Net Crawler uses Windows admin shares to establish authenticated sessions to remote systems over SMB as part of lateral movement.","[S0532] Lucifer: Lucifer can infect victims by brute forcing SMB.","[C0025] 2016 Ukraine Electric Power Attack: During the 2016 Ukraine Electric Power Attack, Sandworm Team utilized `net use` to connect to network shares.","[G0009] Deep Panda: Deep Panda uses net.exe to connect to network shares using net use commands with compromised credentials.","[S0504] Anchor: Anchor can support windows execution via SMB shares.","[G0087] APT39: APT39 has used SMB for lateral movement.","[G0007] APT28: APT28 has mapped network drives using Net and administrator credentials.","[G1046] Storm-1811: Storm-1811 has attempted to move laterally in victim environments via SMB using Impacket."],"tactics":"TA0008 - Lateral Movement"}
{"technique_id":"T1021.003","technique_name":"Remote Services: Distributed Component Object Model","description":"Adversaries may use Valid Accounts to interact with remote machines by taking advantage of Distributed Component Object Model (DCOM). The adversary may then perform actions as the logged-on user. The Windows Component Object Model (COM) is a component of the native Windows application programming interface (API) that enables interaction between software objects, or executable code that implements one or more interfaces. Through COM, a client object can call methods of server objects, which are typically Dynamic Link Libraries (DLL) or executables (EXE). Distributed COM (DCOM) is transparent middleware that extends the functionality of COM beyond a local computer using remote procedure call (RPC) technology. Permissions to interact with local and remote server COM objects are specified by access control lists (ACL) in the Registry. By default, only Administrators may remotely activate and launch COM objects through DCOM. Through DCOM, adversaries operating in the context of an appropriately privileged user can remotely obtain arbitrary and even direct shellcode execution through Office applications as well as other Windows objects that contain insecure methods. DCOM can also execute macros in existing documents and may also invoke Dynamic Data Exchange (DDE) execution directly through a COM created instance of a Microsoft Office application, bypassing the need for a malicious document. DCOM can be used as a method of remotely interacting with Windows Management Instrumentation.","detection":"Monitor for COM objects loading DLLs and other modules not typically associated with the application. Enumeration of COM objects, via Query Registry or PowerShell, may also proceed malicious use. Monitor for spawning of processes associated with COM objects, especially those invoked by a user different than the one currently logged on. Monitor for any influxes or abnormal increases in DCOM related Distributed Computing Environment/Remote Procedure Call (DCE/RPC) traffic (typically over port 135).","procedures":["[S0363] Empire: Empire can utilize Invoke-DCOM to leverage remote COM execution for lateral movement.","[S0692] SILENTTRINITY: SILENTTRINITY can use `System` namespace methods to execute lateral movement using DCOM.","[S0154] Cobalt Strike: Cobalt Strike can deliver Beacon payloads for lateral movement by leveraging remote COM execution."],"tactics":"TA0008 - Lateral Movement"}
{"technique_id":"T1021.004","technique_name":"Remote Services: SSH","description":"Adversaries may use Valid Accounts to log into remote machines using Secure Shell (SSH). The adversary may then perform actions as the logged-on user. SSH is a protocol that allows authorized users to open remote shells on other computers. Many Linux and macOS versions come with SSH installed by default, although typically disabled until the user enables it. On ESXi, SSH can be enabled either directly on the host (e.g., via `vim-cmd hostsvc/enable_ssh`) or via vCenter. The SSH server can be configured to use standard password authentication or public-private keypairs in lieu of or in addition to a password. In this authentication scenario, the user’s public key must be in a special file on the computer running the server that lists which keypairs are allowed to login as that user (i.e., SSH Authorized Keys).","detection":"Use of SSH may be legitimate depending on the environment and how it’s used. Other factors, such as access patterns and activity that occurs after a remote login, may indicate suspicious or malicious behavior with SSH. Monitor for user accounts logged into systems they would not normally access or access patterns to multiple systems over a relatively short period of time. On macOS systems log show --predicate 'process = \"sshd\"' can be used to review incoming SSH connection attempts for suspicious activity. The command log show --info --predicate 'process = \"ssh\" or eventMessage contains \"ssh\"' can be used to review outgoing SSH connection activity. On Linux systems SSH activity can be found in the logs located in /var/log/auth.log or /var/log/secure depending on the distro you are using.","procedures":["[G0046] FIN7: FIN7 has used SSH to move laterally through victim environments.","[G0032] Lazarus Group: Lazarus Group used SSH and the PuTTy PSCP utility to gain access to a restricted segment of a compromised network.","[G0065] Leviathan: Leviathan used ssh for internal reconnaissance.","[C0029] Cutting Edge: During Cutting Edge, threat actors used SSH for lateral movement.","[C0032] C0032: During the C0032 campaign, TEMP.Veles relied on encrypted SSH-based tunnels to transfer tools and for remote command/program execution.","[G0098] BlackTech: BlackTech has used Putty for remote access.","[S0363] Empire: Empire contains modules for executing commands over SSH as well as in-memory VNC agent injection.","[G0143] Aquatic Panda: Aquatic Panda used SSH with captured user credentials to move laterally in victim environments.","[S0154] Cobalt Strike: Cobalt Strike can SSH to a remote service.","[S1187] reGeorg: reGeorg can communicate using SSH through an HTTP tunnel.","[G0036] GCMAN: GCMAN uses Putty for lateral movement.","[S0599] Kinsing: Kinsing has used SSH for lateral movement.","[G0117] Fox Kitten: Fox Kitten has used the PuTTY and Plink tools for lateral movement.","[G0139] TeamTNT: TeamTNT has used SSH to connect back to victim machines. TeamTNT has also used SSH to transfer tools and payloads onto victim hosts and execute them.","[G1046] Storm-1811: Storm-1811 has used OpenSSH to establish an SSH tunnel to victims for persistent access.","[G1045] Salt Typhoon: Salt Typhoon has modified the loopback address on compromised switches and used them as the source of SSH connections to additional devices within the target environment, allowing them to bypass access control lists (ACLs).","[G0049] OilRig: OilRig has used Putty to access compromised systems.","[G1023] APT5: APT5 has used SSH for lateral movement in compromised environments including for enabling access to ESXi host servers.","[C0049] Leviathan Australian Intrusions: Leviathan used SSH brute force techniques to move laterally within victim environments during Leviathan Australian Intrusions.","[G1016] FIN13: FIN13 has remotely accessed compromised environments via secure shell (SSH) for lateral movement.","[G0045] menuPass: menuPass has used Putty Secure Copy Client (PSCP) to transfer data.","[G0119] Indrik Spider: Indrik Spider has used SSH for lateral movement.","[G0106] Rocke: Rocke has spread its coinminer via SSH.","[G0087] APT39: APT39 used secure shell (SSH) to move laterally among their targets."],"tactics":"TA0008 - Lateral Movement"}
{"technique_id":"T1021.005","technique_name":"Remote Services: VNC","description":"Adversaries may use Valid Accounts to remotely control machines using Virtual Network Computing (VNC). VNC is a platform-independent desktop sharing system that uses the RFB (“remote framebuffer”) protocol to enable users to remotely control another computer’s display by relaying the screen, mouse, and keyboard inputs over the network. VNC differs from Remote Desktop Protocol as VNC is screen-sharing software rather than resource-sharing software. By default, VNC uses the system's authentication, but it can be configured to use credentials specific to VNC. Adversaries may abuse VNC to perform malicious actions as the logged-on user such as opening documents, downloading files, and running arbitrary commands. An adversary could use VNC to remotely control and monitor a system to collect data and information to pivot to other systems within the network. Specific VNC libraries/implementations have also been susceptible to brute force attacks and memory usage exploitation.","detection":"Use of VNC may be legitimate depending on the environment and how it’s used. Other factors, such as access patterns and activity that occurs after a remote login, may indicate suspicious or malicious behavior using VNC. On macOS systems log show --predicate 'process = \"screensharingd\" and eventMessage contains \"Authentication:\"' can be used to review incoming VNC connection attempts for suspicious activity. Monitor for use of built-in debugging environment variables (such as those containing credentials or other sensitive information) as well as test/default users on VNC servers, as these can leave openings for adversaries to abuse.","procedures":["[S0412] ZxShell: ZxShell supports functionality for VNC sessions.","[G0047] Gamaredon Group: Gamaredon Group has used VNC tools, including UltraVNC, to remotely interact with compromised hosts.","[G0046] FIN7: FIN7 has used TightVNC to control compromised hosts.","[S1014] DanBot: DanBot can use VNC for remote access to targeted systems.","[S0484] Carberp: Carberp can start a remote VNC session by downloading a new plugin.","[G0036] GCMAN: GCMAN uses VNC for lateral movement.","[G0117] Fox Kitten: Fox Kitten has installed TightVNC server and client on compromised servers and endpoints for lateral movement.","[S0266] TrickBot: TrickBot has used a VNC module to monitor the victim and collect information to pivot to valuable systems on the network","[S0279] Proton: Proton uses VNC to connect into systems.","[S0670] WarzoneRAT: WarzoneRAT has the ability of performing remote desktop access via a VNC console.","[S1160] Latrodectus: Latrodectus has routed C2 traffic using Keyhole VNC."],"tactics":"TA0008 - Lateral Movement"}
{"technique_id":"T1021.006","technique_name":"Remote Services: Windows Remote Management","description":"Adversaries may use Valid Accounts to interact with remote systems using Windows Remote Management (WinRM). The adversary may then perform actions as the logged-on user. WinRM is the name of both a Windows service and a protocol that allows a user to interact with a remote system (e.g., run an executable, modify the Registry, modify services). It may be called with the `winrm` command or by any number of programs such as PowerShell. WinRM can be used as a method of remotely interacting with Windows Management Instrumentation.","detection":"Monitor use of WinRM within an environment by tracking service execution. If it is not normally used or is disabled, then this may be an indicator of suspicious behavior. Monitor processes created and actions taken by the WinRM process or a WinRM invoked script to correlate it with other related events. Also monitor for remote WMI connection attempts (typically over port 5985 when using HTTP and 5986 for HTTPS).","procedures":["[G1016] FIN13: FIN13 has leveraged `WMI` to move laterally within a compromised network via application servers and SQL servers.","[S1063] Brute Ratel C4: Brute Ratel C4 can use WinRM for pivoting.","[G0114] Chimera: Chimera has used WinRM for lateral movement.","[C0024] SolarWinds Compromise: During the SolarWinds Compromise, APT29 used WinRM via PowerShell to execute commands and payloads on remote hosts.","[S0154] Cobalt Strike: Cobalt Strike can use WinRM to execute a payload on a remote host.","[C0048] Operation MidnightEclipse: During Operation MidnightEclipse, threat actors used WinRM to move laterally in targeted networks.","[S0692] SILENTTRINITY: SILENTTRINITY tracks `TrustedHosts` and can move laterally to these targets via WinRM.","[G0027] Threat Group-3390: Threat Group-3390 has used WinRM to enable remote execution.","[G0102] Wizard Spider: Wizard Spider has used Window Remote Management to move laterally through a victim network."],"tactics":"TA0008 - Lateral Movement"}
{"technique_id":"T1021.007","technique_name":"Remote Services: Cloud Services","description":"Adversaries may log into accessible cloud services within a compromised environment using Valid Accounts that are synchronized with or federated to on-premises user identities. The adversary may then perform management actions or access cloud-hosted resources as the logged-on user. Many enterprises federate centrally managed user identities to cloud services, allowing users to login with their domain credentials in order to access the cloud control plane. Similarly, adversaries may connect to available cloud services through the web console or through the cloud command line interface (CLI) (e.g., Cloud API), using commands such as Connect-AZAccount for Azure PowerShell, Connect-MgGraph for Microsoft Graph PowerShell, and gcloud auth login for the Google Cloud CLI. In some cases, adversaries may be able to authenticate to these services via Application Access Token instead of a username and password.","detection":null,"procedures":["[C0027] C0027: During C0027, Scattered Spider used compromised Azure credentials for credential theft activity and lateral movement to on-premises systems.","[G0016] APT29: APT29 has leveraged compromised high-privileged on-premises accounts synced to Office 365 to move laterally into a cloud environment, including through the use of Azure AD PowerShell.","[G1015] Scattered Spider: During C0027, Scattered Spider used compromised Azure credentials for credential theft activity and lateral movement to on-premises systems. Scattered Spider has also leveraged pre-existing AWS EC2 instances for lateral movement and data collection purposes."],"tactics":"TA0008 - Lateral Movement"}
{"technique_id":"T1021.008","technique_name":"Remote Services: Direct Cloud VM Connections","description":"Adversaries may leverage Valid Accounts to log directly into accessible cloud hosted compute infrastructure through cloud native methods. Many cloud providers offer interactive connections to virtual infrastructure that can be accessed through the Cloud API, such as Azure Serial Console, AWS EC2 Instance Connect, and AWS System Manager.. Methods of authentication for these connections can include passwords, application access tokens, or SSH keys. These cloud native methods may, by default, allow for privileged access on the host with SYSTEM or root level access. Adversaries may utilize these cloud native methods to directly access virtual infrastructure and pivot through an environment. These connections typically provide direct console access to the VM rather than the execution of scripts (i.e., Cloud Administration Command).","detection":null,"procedures":null,"tactics":"TA0008 - Lateral Movement"}
{"technique_id":"T1072","technique_name":"Software Deployment Tools","description":"Adversaries may gain access to and use centralized software suites installed within an enterprise to execute commands and move laterally through the network. Configuration management and software deployment applications may be used in an enterprise network or cloud environment for routine administration purposes. These systems may also be integrated into CI/CD pipelines. Examples of such solutions include: SCCM, HBSS, Altiris, AWS Systems Manager, Microsoft Intune, Azure Arc, and GCP Deployment Manager. Access to network-wide or enterprise-wide endpoint management software may enable an adversary to achieve remote code execution on all connected systems. The access may be used to laterally move to other systems, gather information, or cause a specific effect, such as wiping the hard drives on all endpoints. SaaS-based configuration management services may allow for broad Cloud Administration Command on cloud-hosted instances, as well as the execution of arbitrary commands on on-premises endpoints. For example, Microsoft Configuration Manager allows Global or Intune Administrators to run scripts as SYSTEM on on-premises devices joined to Entra ID. Such services may also utilize Web Protocols to communicate back to adversary owned infrastructure. Network infrastructure devices may also have configuration management tools that can be similarly abused by adversaries. The permissions required for this action vary by system configuration; local credentials may be sufficient with direct access to the third-party system, or specific domain credentials may be required. However, the system may require an administrative account to log in or to access specific functionality.","detection":"Detection methods will vary depending on the type of third-party software or system and how it is typically used. The same investigation process can be applied here as with other potentially malicious activities where the distribution vector is initially unknown but the resulting activity follows a discernible pattern. Analyze the process execution trees, historical activities from the third-party application (such as what types of files are usually pushed), and the resulting activities or events from the file/binary/script pushed to systems. Often these third-party applications will have logs of their own that can be collected and correlated with other data from the environment. Ensure that third-party application logs are on-boarded to the enterprise logging system and the logs are regularly reviewed. Audit software deployment logs and look for suspicious or unauthorized activity. A system not typically used to push software to clients that suddenly is used for such a task outside of a known admin function may be suspicious. Monitor account login activity on these applications to detect suspicious/abnormal usage. Perform application deployment at regular times so that irregular deployment activity stands out. Monitor process activity that does not correlate to known good software. Monitor account login activity on the deployment system.","procedures":["[G0050] APT32: APT32 compromised McAfee ePO to move laterally by distributing malware as a software deployment task.","[G0034] Sandworm Team: Sandworm Team has used the commercially available tool RemoteExec for agentless remote code execution.","[G0091] Silence: Silence has used RAdmin, a remote software tool used to remotely control workstations and ATMs.","[S0041] Wiper: It is believed that a patch management system for an anti-virus product commonly installed among targeted companies was used to distribute the Wiper malware.","[G0028] Threat Group-1314: Threat Group-1314 actors used a victim's endpoint management platform, Altiris, for lateral movement.","[C0018] C0018: During C0018, the threat actors used PDQ Deploy to move AvosLocker and tools across the network."],"tactics":"TA0008 - Lateral Movement"}
{"technique_id":"T1080","technique_name":"Taint Shared Content","description":"Adversaries may deliver payloads to remote systems by adding content to shared storage locations, such as network drives or internal code repositories. Content stored on network drives or in other shared locations may be tainted by adding malicious programs, scripts, or exploit code to otherwise valid files. Once a user opens the shared tainted content, the malicious portion can be executed to run the adversary's code on a remote system. Adversaries may use tainted shared content to move laterally. A directory share pivot is a variation on this technique that uses several other techniques to propagate malware when users access a shared network directory. It uses Shortcut Modification of directory .LNK files that use Masquerading to look like the real directories, which are hidden through Hidden Files and Directories. The malicious .LNK-based directories have an embedded command that executes the hidden malware file in the directory and then opens the real intended directory so that the user's expected action still occurs. When used with frequently used network directories, the technique may result in frequent reinfections and broad access to systems and potentially to new and higher privileged accounts. Adversaries may also compromise shared network directories through binary infections by appending or prepending its code to the healthy binary on the shared network directory. The malware may modify the original entry point (OEP) of the healthy binary to ensure that it is executed before the legitimate code. The infection could continue to spread via the newly infected file when it is executed by a remote system. These infections may target both binary and non-binary formats that end with extensions including, but not limited to, .EXE, .DLL, .SCR, .BAT, and/or .VBS.","detection":"Processes that write or overwrite many files to a network shared directory may be suspicious. Monitor processes that are executed from removable media for malicious or abnormal activity such as network connections due to Command and Control and possible network Discovery techniques. Frequently scan shared network directories for malicious files, hidden files, .LNK files, and other file types that may not typical exist in directories used to share specific types of content.","procedures":["[S0132] H1N1: H1N1 has functionality to copy itself to network shares.","[G0012] Darkhotel: Darkhotel used a virus that propagates by infecting executables stored on shared drives.","[G1039] RedCurl: RedCurl has placed modified LNK files on network drives for lateral movement.","[S0458] Ramsay: Ramsay can spread itself by infecting other portable executable files on networks shared drives.","[G0047] Gamaredon Group: Gamaredon Group has injected malicious macros into all Word and Excel documents on mapped network drives.","[G0060] BRONZE BUTLER: BRONZE BUTLER has placed malware on file shares and given it the same name as legitimate documents on the share.","[S0260] InvisiMole: InvisiMole can replace legitimate software or documents in the compromised network with their trojanized versions, in an attempt to propagate itself within the network.","[G1021] Cinnamon Tempest: Cinnamon Tempest has deployed ransomware from a batch file in a network share.","[S0575] Conti: Conti can spread itself by infecting other remote machines via network shared drives.","[S0133] Miner-C: Miner-C copies itself into the public folder of Network Attached Storage (NAS) devices and infects new victims who open the file.","[S0603] Stuxnet: Stuxnet infects remote servers via network shares and by infecting WinCC database views with malicious code.","[S0386] Ursnif: Ursnif has copied itself to and infected files in network drives for propagation."],"tactics":"TA0008 - Lateral Movement"}
{"technique_id":"T1091","technique_name":"Replication Through Removable Media","description":"Adversaries may move onto systems, possibly those on disconnected or air-gapped networks, by copying malware to removable media and taking advantage of Autorun features when the media is inserted into a system and executes. In the case of Lateral Movement, this may occur through modification of executable files stored on removable media or by copying malware and renaming it to look like a legitimate file to trick users into executing it on a separate system. In the case of Initial Access, this may occur through manual manipulation of the media, modification of systems used to initially format the media, or modification to the media's firmware itself. Mobile devices may also be used to infect PCs with malware if connected via USB. This infection may be achieved using devices (Android, iOS, etc.) and, in some instances, USB charging cables. For example, when a smartphone is connected to a system, it may appear to be mounted similar to a USB-connected disk drive. If malware that is compatible with the connected system is on the mobile device, the malware could infect the machine (especially if Autorun features are enabled).","detection":"Monitor file access on removable media. Detect processes that execute from removable media after it is mounted or when initiated by a user. If a remote access tool is used in this manner to move laterally, then additional actions are likely to occur after execution, such as opening network connections for Command and Control and system and network information Discovery.","procedures":["[S0143] Flame: Flame contains modules to infect USB sticks and spread laterally to other Windows systems the stick is plugged into using Autorun functionality.","[S0028] SHIPSHAPE: APT30 may have used the SHIPSHAPE malware to move onto air-gapped networks. SHIPSHAPE targets removable drives to spread to other systems by modifying the drive to use Autorun to execute or by hiding legitimate document files and copying an executable to the folder with the same name as the legitimate document.","[G1014] LuminousMoth: LuminousMoth has used malicious DLLs to spread malware to connected removable USB drives on infected machines.","[S0130] Unknown Logger: Unknown Logger is capable of spreading to USB devices.","[G1007] Aoqin Dragon: Aoqin Dragon has used a dropper that employs a worm infection strategy using a removable device to breach a secure network environment.","[S0062] DustySky: DustySky searches for removable media and duplicates itself onto it.","[S0132] H1N1: H1N1 has functionality to copy itself to removable media.","[G0012] Darkhotel: Darkhotel's selective infector modifies executables stored on removable media as a method of spreading across computers.","[S0603] Stuxnet: Stuxnet can propagate via removable media using an autorun.inf file or the CVE-2010-2568 LNK vulnerability.","[G0129] Mustang Panda: Mustang Panda has used a customized PlugX variant which could spread through USB connections.","[S1130] Raspberry Robin: Raspberry Robin has historically used infected USB media to spread to new victims.","[S0092] Agent.btz: Agent.btz drops itself onto removable media devices and creates an autorun.inf file with an instruction to run that file. When the device is inserted into another system, it opens autorun.inf and loads the malware.","[S0385] njRAT: njRAT can be configured to spread via removable drives.","[S0452] USBferry: USBferry can copy its installer to attached USB storage devices.","[S0023] CHOPSTICK: Part of APT28's operation involved using CHOPSTICK modules to copy itself to air-gapped machines and using files written to USB sticks to transfer data and command traffic.","[S0115] Crimson: Crimson can spread across systems by infecting removable media.","[G0046] FIN7: FIN7 actors have mailed USB drives to potential victims containing malware that downloads and installs various backdoors, including in some cases for ransomware operations.","[S0458] Ramsay: Ramsay can spread itself by infecting other portable executable files on removable drives.","[S0650] QakBot: QakBot has the ability to use removable drives to spread through compromised networks.","[S1074] ANDROMEDA: ANDROMEDA has been spread via infected USB keys.","[S0136] USBStealer: USBStealer drops itself onto removable media and relies on Autorun to execute the malicious file when a user opens the removable media on another system.","[G0007] APT28: APT28 uses a tool to infect connected USB devices and transmit itself to air-gapped computers when the infected USB device is inserted.","[S0608] Conficker: Conficker variants used the Windows AUTORUN feature to spread through USB propagation.","[S0386] Ursnif: Ursnif has copied itself to and infected removable drives for propagation.","[G0081] Tropic Trooper: Tropic Trooper has attempted to transfer USBferry from an infected USB device by copying an Autorun function to the target machine."],"tactics":"TA0008 - Lateral Movement"}
{"technique_id":"T1210","technique_name":"Exploitation of Remote Services","description":"Adversaries may exploit remote services to gain unauthorized access to internal systems once inside of a network. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. A common goal for post-compromise exploitation of remote services is for lateral movement to enable access to a remote system. An adversary may need to determine if the remote system is in a vulnerable state, which may be done through Network Service Discovery or other Discovery methods looking for common, vulnerable software that may be deployed in the network, the lack of certain patches that may indicate vulnerabilities, or security software that may be used to detect or contain remote exploitation. Servers are likely a high value target for lateral movement exploitation, but endpoint systems may also be at risk if they provide an advantage or access to additional resources. There are several well-known vulnerabilities that exist in common services such as SMB and RDP as well as applications that may be used within internal networks such as MySQL and web server services. Additionally, there have been a number of vulnerabilities in VMware vCenter installations, which may enable threat actors to move laterally from the compromised vCenter server to virtual machines or even to ESXi hypervisors. Depending on the permissions level of the vulnerable remote service an adversary may achieve Exploitation for Privilege Escalation as a result of lateral movement exploitation as well.","detection":"Detecting software exploitation may be difficult depending on the tools available. Software exploits may not always succeed or may cause the exploited process to become unstable or crash. Also look for behavior on the endpoint system that might indicate successful compromise, such as abnormal behavior of the processes. This could include suspicious files written to disk, evidence of Process Injection for attempts to hide execution, evidence of Discovery, or other unusual network traffic that may indicate additional tools transferred to the system.","procedures":["[S0143] Flame: Flame can use MS10-061 to exploit a print spooler vulnerability in a remote system with a shared printer in order to move laterally.","[S0366] WannaCry: WannaCry uses an exploit in SMBv1 to spread itself to other remote systems on a network.","[G0102] Wizard Spider: Wizard Spider has exploited or attempted to exploit Zerologon (CVE-2020-1472) and EternalBlue (MS17-010) vulnerabilities.","[G0117] Fox Kitten: Fox Kitten has exploited known vulnerabilities in remote services including RDP.","[G1006] Earth Lusca: Earth Lusca has used Mimikatz to exploit a domain controller via the ZeroLogon exploit (CVE-2020-1472).","[S0603] Stuxnet: Stuxnet propagates using the MS10-061 Print Spooler and MS08-067 Windows Server Service vulnerabilities.","[S0650] QakBot: QakBot can move laterally using worm-like functionality through exploitation of SMB.","[S0367] Emotet: Emotet has been seen exploiting SMB via a vulnerability exploit like EternalBlue (MS17-010) to achieve lateral movement and propagation.","[S0363] Empire: Empire has a limited number of built-in modules for exploiting remote SMB, JBoss, and Jenkins servers.","[S0606] Bad Rabbit: Bad Rabbit used the EternalRomance SMB exploit to spread through victim networks.","[S0368] NotPetya: NotPetya can use two exploits in SMBv1, EternalBlue and EternalRomance, to spread itself to other remote systems on the network.","[G1003] Ember Bear: Ember Bear has used exploits for vulnerabilities such as MS17-010, also known as `Eternal Blue`, during operations.","[S0260] InvisiMole: InvisiMole can spread within a network via the BlueKeep (CVE-2019-0708) and EternalBlue (CVE-2017-0144) vulnerabilities in RDP and SMB respectively.","[G0007] APT28: APT28 exploited a Windows SMB Remote Code Execution Vulnerability to conduct lateral movement.","[S0608] Conficker: Conficker exploited the MS08-067 Windows vulnerability for remote code execution through a crafted RPC request.","[S0378] PoshC2: PoshC2 contains a module for exploiting SMB via EternalBlue.","[S0532] Lucifer: Lucifer can exploit multiple vulnerabilities including EternalBlue (CVE-2017-0144) and EternalRomance (CVE-2017-0144).","[G0131] Tonto Team: Tonto Team has used EternalBlue exploits for lateral movement.","[G0045] menuPass: menuPass has used tools to exploit the ZeroLogon vulnerability (CVE-2020-1472).","[S0266] TrickBot: TrickBot utilizes EternalBlue and EternalRomance exploits for lateral movement in the modules wormwinDll, wormDll, mwormDll, nwormDll, tabDll.","[G0035] Dragonfly: Dragonfly has exploited a Windows Netlogon vulnerability (CVE-2020-1472) to obtain access to Windows Active Directory servers.","[G0069] MuddyWater: MuddyWater has exploited the Microsoft Netlogon vulnerability (CVE-2020-1472).","[G0027] Threat Group-3390: Threat Group-3390 has exploited MS17-010 to move laterally to other systems on the network.","[G0046] FIN7: FIN7 has exploited ZeroLogon (CVE-2020-1472) against vulnerable domain controllers."],"tactics":"TA0008 - Lateral Movement"}
{"technique_id":"T1534","technique_name":"Internal Spearphishing","description":"After they already have access to accounts or systems within the environment, adversaries may use internal spearphishing to gain access to additional information or compromise other users within the same organization. Internal spearphishing is multi-staged campaign where a legitimate account is initially compromised either by controlling the user's device or by compromising the account credentials of the user. Adversaries may then attempt to take advantage of the trusted internal account to increase the likelihood of tricking more victims into falling for phish attempts, often incorporating Impersonation. For example, adversaries may leverage Spearphishing Attachment or Spearphishing Link as part of internal spearphishing to deliver a payload or redirect to an external site to capture credentials through Input Capture on sites that mimic login interfaces. Adversaries may also leverage internal chat apps, such as Microsoft Teams, to spread malicious content or engage users in attempts to capture sensitive information and/or credentials.","detection":"Network intrusion detection systems and email gateways usually do not scan internal email, but an organization can leverage the journaling-based solution which sends a copy of emails to a security service for offline analysis or incorporate service-integrated solutions using on-premise or API-based integrations to help detect internal spearphishing campaigns.","procedures":["[G0047] Gamaredon Group: Gamaredon Group has used an Outlook VBA module on infected systems to send phishing emails with malicious attachments to other employees within the organization.","[G0094] Kimsuky: Kimsuky has sent internal spearphishing emails for lateral movement after stealing victim information.","[C0022] Operation Dream Job: During Operation Dream Job, Lazarus Group conducted internal spearphishing from within a compromised organization.","[G0065] Leviathan: Leviathan has conducted internal spearphishing within the victim's environment for lateral movement.","[G1001] HEXANE: HEXANE has conducted internal spearphishing attacks against executives, HR, and IT personnel to gain information and access."],"tactics":"TA0008 - Lateral Movement"}
{"technique_id":"T1550.001","technique_name":"Use Alternate Authentication Material: Application Access Token","description":"Adversaries may use stolen application access tokens to bypass the typical authentication process and access restricted accounts, information, or services on remote systems. These tokens are typically stolen from users or services and used in lieu of login credentials. Application access tokens are used to make authorized API requests on behalf of a user or service and are commonly used to access resources in cloud, container-based applications, and software-as-a-service (SaaS). OAuth is one commonly implemented framework that issues tokens to users for access to systems. These frameworks are used collaboratively to verify the user and determine what actions the user is allowed to perform. Once identity is established, the token allows actions to be authorized, without passing the actual credentials of the user. Therefore, compromise of the token can grant the adversary access to resources of other sites through a malicious application. For example, with a cloud-based email service, once an OAuth access token is granted to a malicious application, it can potentially gain long-term access to features of the user account if a \"refresh\" token enabling background access is awarded. With an OAuth access token an adversary can use the user-granted REST API to perform functions such as email searching and contact enumeration. Compromised access tokens may be used as an initial step in compromising other services. For example, if a token grants access to a victim’s primary email, the adversary may be able to extend access to all other services which the target subscribes by triggering forgotten password routines. In AWS and GCP environments, adversaries can trigger a request for a short-lived access token with the privileges of another user account. The adversary can then use this token to request data or perform actions the original account could not. If permissions for this feature are misconfigured – for example, by allowing all users to request a token for a particular account - an adversary may be able to gain initial access to a Cloud Account or escalate their privileges. Direct API access through a token negates the effectiveness of a second authentication factor and may be immune to intuitive countermeasures like changing passwords. For example, in AWS environments, an adversary who compromises a user’s AWS API credentials may be able to use the `sts:GetFederationToken` API call to create a federated user session, which will have the same permissions as the original user but may persist even if the original user credentials are deactivated. Additionally, access abuse over an API channel can be difficult to detect even from the service provider end, as the access can still align well with a legitimate workflow.","detection":"Monitor access token activity for abnormal use and permissions granted to unusual or suspicious applications and APIs. Additionally, administrators should review logs for calls to the AWS Security Token Service (STS) and usage of GCP service accounts in order to identify anomalous actions.","procedures":["[S0683] Peirates: Peirates can use stolen service account tokens to perform its operations. It also enables adversaries to switch between valid service accounts.","[S1023] CreepyDrive: CreepyDrive can use legitimate OAuth refresh tokens to authenticate with OneDrive.","[C0024] SolarWinds Compromise: During the SolarWinds Compromise, APT29 used compromised service principals to make changes to the Office 365 environment.","[G0007] APT28: APT28 has used several malicious applications that abused OAuth access tokens to gain access to target email accounts, including Gmail and Yahoo Mail.","[G0125] HAFNIUM: HAFNIUM has abused service principals with administrative permissions for data exfiltration."],"tactics":"TA0008 - Lateral Movement"}
{"technique_id":"T1550.002","technique_name":"Use Alternate Authentication Material: Pass the Hash","description":"Adversaries may “pass the hash” using stolen password hashes to move laterally within an environment, bypassing normal system access controls. Pass the hash (PtH) is a method of authenticating as a user without having access to the user's cleartext password. This method bypasses standard authentication steps that require a cleartext password, moving directly into the portion of the authentication that uses the password hash. When performing PtH, valid password hashes for the account being used are captured using a Credential Access technique. Captured hashes are used with PtH to authenticate as that user. Once authenticated, PtH may be used to perform actions on local or remote systems. Adversaries may also use stolen password hashes to \"overpass the hash.\" Similar to PtH, this involves using a password hash to authenticate as a user but also uses the password hash to create a valid Kerberos ticket. This ticket can then be used to perform Pass the Ticket attacks.","detection":"Audit all logon and credential use events and review for discrepancies. Unusual remote logins that correlate with other suspicious activity (such as writing and executing binaries) may indicate malicious activity. NTLM LogonType 3 authentications that are not associated to a domain login and are not anonymous logins are suspicious. Event ID 4768 and 4769 will also be generated on the Domain Controller when a user requests a new ticket granting ticket or service ticket. These events combined with the above activity may be indicative of an overpass the hash attempt.","procedures":["[G0050] APT32: APT32 has used pass the hash for lateral movement.","[S0154] Cobalt Strike: Cobalt Strike can perform pass the hash.","[S0122] Pass-The-Hash Toolkit: Pass-The-Hash Toolkit can perform pass the hash.","[G0007] APT28: APT28 has used pass the hash for lateral movement.","[G0143] Aquatic Panda: Aquatic Panda used a registry edit to enable a Windows feature called RestrictedAdmin in victim environments. This change allowed Aquatic Panda to leverage \"pass the hash\" mechanisms as the alteration allows for RDP connections with a valid account name and hash only, without possessing a cleartext password value.","[G0114] Chimera: Chimera has dumped password hashes for use in pass the hash authentication attacks.","[G0006] APT1: The APT1 group is known to have used pass the hash.","[G0102] Wizard Spider: Wizard Spider has used the `Invoke-SMBExec` PowerShell cmdlet to execute the pass-the-hash technique and utilized stolen password hashes to move laterally.","[S0376] HOPLIGHT: HOPLIGHT has been observed loading several APIs associated with Pass the Hash.","[S0378] PoshC2: PoshC2 has a number of modules that leverage pass the hash for lateral movement.","[S0002] Mimikatz: Mimikatz's SEKURLSA::Pth module can impersonate a user, with only a password hash, to execute arbitrary commands.","[G0096] APT41: APT41 uses tools such as Mimikatz to enable lateral movement via captured password hashes.","[G0094] Kimsuky: Kimsuky has used pass the hash for authentication to remote access software used in C2.","[S0363] Empire: Empire can perform pass the hash attacks.","[G1016] FIN13: FIN13 has used the PowerShell utility `Invoke-SMBExec` to execute the pass the hash method for lateral movement within an compromised environment.","[G1003] Ember Bear: Ember Bear has used pass-the-hash techniques for lateral movement in victim environments.","[S1081] BADHATCH: BADHATCH can perform pass the hash on compromised machines with x64 versions.","[S0488] CrackMapExec: CrackMapExec can pass the hash to authenticate via SMB.","[C0002] Night Dragon: During Night Dragon, threat actors used pass-the-hash tools to obtain authenticated access to sensitive internal desktops and servers.","[G0093] GALLIUM: GALLIUM used dumped hashes to authenticate to other machines via pass the hash."],"tactics":"TA0008 - Lateral Movement"}
{"technique_id":"T1550.003","technique_name":"Use Alternate Authentication Material: Pass the Ticket","description":"Adversaries may “pass the ticket” using stolen Kerberos tickets to move laterally within an environment, bypassing normal system access controls. Pass the ticket (PtT) is a method of authenticating to a system using Kerberos tickets without having access to an account's password. Kerberos authentication can be used as the first step to lateral movement to a remote system. When preforming PtT, valid Kerberos tickets for Valid Accounts are captured by OS Credential Dumping. A user's service tickets or ticket granting ticket (TGT) may be obtained, depending on the level of access. A service ticket allows for access to a particular resource, whereas a TGT can be used to request service tickets from the Ticket Granting Service (TGS) to access any resource the user has privileges to access. A Silver Ticket can be obtained for services that use Kerberos as an authentication mechanism and are used to generate tickets to access that particular resource and the system that hosts the resource (e.g., SharePoint). A Golden Ticket can be obtained for the domain using the Key Distribution Service account KRBTGT account NTLM hash, which enables generation of TGTs for any account in Active Directory. Adversaries may also create a valid Kerberos ticket using other user information, such as stolen password hashes or AES keys. For example, \"overpassing the hash\" involves using a NTLM password hash to authenticate as a user (i.e. Pass the Hash) while also using the password hash to create a valid Kerberos ticket.","detection":"Audit all Kerberos authentication and credential use events and review for discrepancies. Unusual remote authentication events that correlate with other suspicious activity (such as writing and executing binaries) may indicate malicious activity. Event ID 4769 is generated on the Domain Controller when using a golden ticket after the KRBTGT password has been reset twice, as mentioned in the mitigation section. The status code 0x1F indicates the action has failed due to \"Integrity check on decrypted field failed\" and indicates misuse by a previously invalidated golden ticket.","procedures":["[S0053] SeaDuke: Some SeaDuke samples have a module to use pass the ticket with Kerberos for authentication.","[G0016] APT29: APT29 used Kerberos ticket attacks for lateral movement.","[S0002] Mimikatz: Mimikatz’s LSADUMP::DCSync and KERBEROS::PTT modules implement the three steps required to extract the krbtgt account hash and create/use Kerberos tickets.","[S0192] Pupy: Pupy can also perform pass-the-ticket.","[G0050] APT32: APT32 successfully gained remote access by using pass the ticket.","[G0060] BRONZE BUTLER: BRONZE BUTLER has created forged Kerberos Ticket Granting Ticket (TGT) and Ticket Granting Service (TGS) tickets to maintain administrative access."],"tactics":"TA0008 - Lateral Movement"}
{"technique_id":"T1550.004","technique_name":"Use Alternate Authentication Material: Web Session Cookie","description":"Adversaries can use stolen session cookies to authenticate to web applications and services. This technique bypasses some multi-factor authentication protocols since the session is already authenticated. Authentication cookies are commonly used in web applications, including cloud-based services, after a user has authenticated to the service so credentials are not passed and re-authentication does not need to occur as frequently. Cookies are often valid for an extended period of time, even if the web application is not actively used. After the cookie is obtained through Steal Web Session Cookie or Web Cookies, the adversary may then import the cookie into a browser they control and is then able to use the site or application as the user for as long as the session cookie is active. Once logged into the site, an adversary can access sensitive information, read email, or perform actions that the victim account has permissions to perform. There have been examples of malware targeting session cookies to bypass multi-factor authentication systems.","detection":"Monitor for anomalous access of websites and cloud-based applications by the same user in different locations or by different systems that do not match expected configurations.","procedures":["[G1033] Star Blizzard: Star Blizzard has bypassed multi-factor authentication on victim email accounts by using session cookies stolen using EvilGinx.","[C0024] SolarWinds Compromise: During the SolarWinds Compromise, APT29 used stolen cookies to access cloud resources and a forged `duo-sid` cookie to bypass MFA set on an email account."],"tactics":"TA0008 - Lateral Movement"}
{"technique_id":"T1563.001","technique_name":"Remote Service Session Hijacking: SSH Hijacking","description":"Adversaries may hijack a legitimate user's SSH session to move laterally within an environment. Secure Shell (SSH) is a standard means of remote access on Linux and macOS systems. It allows a user to connect to another system via an encrypted tunnel, commonly authenticating through a password, certificate or the use of an asymmetric encryption key pair. In order to move laterally from a compromised host, adversaries may take advantage of trust relationships established with other systems via public key authentication in active SSH sessions by hijacking an existing connection to another system. This may occur through compromising the SSH agent itself or by having access to the agent's socket. If an adversary is able to obtain root access, then hijacking SSH sessions is likely trivial. SSH Hijacking differs from use of SSH because it hijacks an existing SSH session rather than creating a new session using Valid Accounts.","detection":"Use of SSH may be legitimate, depending upon the network environment and how it is used. Other factors, such as access patterns and activity that occurs after a remote login, may indicate suspicious or malicious behavior with SSH. Monitor for user accounts logged into systems they would not normally access or access patterns to multiple systems over a relatively short period of time. Also monitor user SSH-agent socket files being used by different users.","procedures":null,"tactics":"TA0008 - Lateral Movement"}
{"technique_id":"T1563.002","technique_name":"Remote Service Session Hijacking: RDP Hijacking","description":"Adversaries may hijack a legitimate user’s remote desktop session to move laterally within an environment. Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS). Adversaries may perform RDP session hijacking which involves stealing a legitimate user's remote session. Typically, a user is notified when someone else is trying to steal their session. With System permissions and using Terminal Services Console, `c:\\windows\\system32\\tscon.exe [session number to be stolen]`, an adversary can hijack a session without the need for credentials or prompts to the user. This can be done remotely or locally and with active or disconnected sessions. It can also lead to Remote System Discovery and Privilege Escalation by stealing a Domain Admin or higher privileged account session. All of this can be done by using native Windows commands, but it has also been added as a feature in red teaming tools.","detection":"Consider monitoring processes for `tscon.exe` usage and monitor service creation that uses `cmd.exe /k` or `cmd.exe /c` in its arguments to detect RDP session hijacking. Use of RDP may be legitimate, depending on the network environment and how it is used. Other factors, such as access patterns and activity that occurs after a remote login, may indicate suspicious or malicious behavior with RDP.","procedures":["[S0366] WannaCry: WannaCry enumerates current remote desktop sessions and tries to execute the malware on each session.","[G0001] Axiom: Axiom has targeted victims with remote administration tools including RDP."],"tactics":"TA0008 - Lateral Movement"}
{"technique_id":"T1570","technique_name":"Lateral Tool Transfer","description":"Adversaries may transfer tools or other files between systems in a compromised environment. Once brought into the victim environment (i.e., Ingress Tool Transfer) files may then be copied from one system to another to stage adversary tools or other files over the course of an operation. Adversaries may copy files between internal victim systems to support lateral movement using inherent file sharing protocols such as file sharing over SMB/Windows Admin Shares to connected network shares or with authenticated connections via Remote Desktop Protocol. Files can also be transferred using native or otherwise present tools on the victim system, such as scp, rsync, curl, sftp, and ftp. In some cases, adversaries may be able to leverage Web Services such as Dropbox or OneDrive to copy files from one machine to another via shared, automatically synced folders.","detection":"Monitor for file creation and files transferred within a network using protocols such as SMB or FTP. Unusual processes with internal network connections creating files on-system may be suspicious. Consider monitoring for abnormal usage of utilities and command-line arguments that may be used in support of remote transfer of files. Considering monitoring for alike file hashes or characteristics (ex: filename) that are created on multiple hosts.","procedures":["[S0367] Emotet: Emotet has copied itself to remote systems using the `service.exe` filename.","[S1139] INC Ransomware: INC Ransomware can push its encryption executable to multiple endpoints within compromised infrastructure.","[S1068] BlackCat: BlackCat can replicate itself across connected servers via `psexec`.","[S1132] IPsec Helper: IPsec Helper can download additional payloads from command and control nodes and execute them.","[G0050] APT32: APT32 has deployed tools after moving laterally using administrative accounts.","[G1007] Aoqin Dragon: Aoqin Dragon has spread malware in target networks by copying modules to folders masquerading as removable devices.","[S0457] Netwalker: Operators deploying Netwalker have used psexec to copy the Netwalker payload across accessible systems.","[S0190] BITSAdmin: BITSAdmin can be used to create BITS Jobs to upload and/or download files from SMB file servers.","[G0051] FIN10: FIN10 has deployed Meterpreter stagers and SplinterRAT instances in the victim network after moving laterally.","[S0095] ftp: ftp may be abused by adversaries to transfer tools or files between systems within a compromised environment.","[S0404] esentutl: esentutl can be used to copy files to/from a remote share.","[G1003] Ember Bear: Ember Bear retrieves follow-on payloads direct from adversary-owned infrastructure for deployment on compromised hosts.","[S0532] Lucifer: Lucifer can use certutil for propagation on Windows hosts within intranets.","[G1017] Volt Typhoon: Volt Typhoon has copied web shells between servers in targeted environments.","[G1047] Velvet Ant: Velvet Ant transferred files laterally within victim networks through the Impacket toolkit.","[G0102] Wizard Spider: Wizard Spider has used stolen credentials to copy tools into the %TEMP% directory of domain controllers.","[G0010] Turla: Turla RPC backdoors can be used to transfer files to/from victim machines on the local network.","[C0018] C0018: During C0018, the threat actors transferred the SoftPerfect Network Scanner and other tools to machines in the network using AnyDesk and PDQ Deploy.","[S1180] BlackByte Ransomware: BlackByte Ransomware spreads itself laterally by writing the JavaScript launcher file to mapped shared folders.","[C0025] 2016 Ukraine Electric Power Attack: During the 2016 Ukraine Electric Power Attack, Sandworm Team used `move` to transfer files to a network share.","[S0361] Expand: Expand can be used to download or upload a file over a network share.","[G1043] BlackByte: BlackByte transfered tools such as Cobalt Strike and the AnyDesk remote access tool during operations using SMB shares.","[G0114] Chimera: Chimera has copied tools between compromised hosts using SMB.","[S0365] Olympic Destroyer: Olympic Destroyer attempts to copy itself to remote machines on the network.","[C0014] Operation Wocao: During Operation Wocao, threat actors used SMB to copy files to and from target systems.","[C0034] 2022 Ukraine Electric Power Attack: During the 2022 Ukraine Electric Power Attack, Sandworm Team used a Group Policy Object (GPO) to copy CaddyWiper's executable `msserver.exe` from a staging server to a local hard drive before deployment.","[G0093] GALLIUM: GALLIUM has used PsExec to move laterally between hosts in the target network.","[S0140] Shamoon: Shamoon attempts to copy itself to remote machines on the network.","[G1046] Storm-1811: Storm-1811 has used the Impacket toolset to move and remotely execute payloads to other hosts in victim networks.","[G0059] Magic Hound: Magic Hound has copied tools within a compromised network using RDP.","[G1032] INC Ransom: INC Ransom has used a rapid succession of copy commands to install a file encryption executable across multiple endpoints within compromised infrastructure.","[S0029] PsExec: PsExec can be used to download or upload a file over a network share.","[S0698] HermeticWizard: HermeticWizard can copy files to other machines on a compromised network.","[S0062] DustySky: DustySky searches for network drives and removable media and duplicates itself onto them.","[C0038] HomeLand Justice: During HomeLand Justice, threat actors initiated a process named Mellona.exe to spread the ROADSWEEP file encryptor and a persistence script to a list of internal machines.","[S0357] Impacket: Impacket has used its `wmiexec` command, leveraging Windows Management Instrumentation, to remotely stage and execute payloads in victim networks.","[G0034] Sandworm Team: Sandworm Team has used `move` to transfer files to a network share and has copied payloads--such as Prestige ransomware--to an Active Directory Domain Controller and distributed via the Default Domain Group Policy Object. Additionally, Sandworm Team has transferred an ISO file into the OT network to gain initial access.","[C0028] 2015 Ukraine Electric Power Attack: During the 2015 Ukraine Electric Power Attack, Sandworm Team moved their tools laterally within the corporate network and between the ICS and corporate network.","[S1017] OutSteel: OutSteel can download the Saint Bot malware for follow-on execution.","[G1030] Agrius: Agrius downloaded some payloads for follow-on execution from legitimate filesharing services such as ufile.io and easyupload.io.","[S0372] LockerGoga: LockerGoga has been observed moving around the victim network via SMB, indicating the actors behind this ransomware are manually copying files form computer to computer instead of self-propagating.","[S0603] Stuxnet: Stuxnet uses an RPC server that contains a file dropping routine and support for payload version updates for P2P communications within a victim network.","[C0015] C0015: During C0015, the threat actors used WMI to load Cobalt Strike onto additional hosts within a compromised network.","[G0096] APT41: APT41 uses remote shares to move and remotely execute payloads during lateral movemement.","[S0106] cmd: cmd can be used to copy files to/from a remotely connected internal system.","[S0366] WannaCry: WannaCry attempts to copy itself to remote computers after gaining access via an SMB exploit."],"tactics":"TA0008 - Lateral Movement"}