{"technique_id":"T1007","technique_name":"System Service Discovery","description":"Adversaries may try to gather information about registered local system services. Adversaries may obtain information about services using tools as well as OS utility commands such as sc query, tasklist /svc, systemctl --type=service, and net start. Adversaries may use the information from System Service Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.","detection":"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained. Monitor processes and command-line arguments for actions that could be taken to gather system information related to services. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.","procedures":["[S0386] Ursnif: Ursnif has gathered information about running services.","[G0060] BRONZE BUTLER: BRONZE BUTLER has used TROJ_GETVERSION to discover system services.","[S0018] Sykipot: Sykipot may use net start to display running services.","[S0244] Comnie: Comnie runs the command: net start >> %TEMP%\\info.dat on a victim.","[S0663] SysUpdate: SysUpdate can collect a list of services on a victim machine.","[S0039] Net: The net start command can be used in Net to find information about Windows services.","[G0139] TeamTNT: TeamTNT has searched for services such as Alibaba Cloud Security's aliyun service and BMC Helix Cloud Security's bmc-agent service in order to disable them.","[S0081] Elise: Elise executes net start after initial communication is made to the remote server.","[S0378] PoshC2: PoshC2 can enumerate service and service permission information.","[G0119] Indrik Spider: Indrik Spider has used the win32_service WMI class to retrieve a list of services from the system.","[S0533] SLOTHFULMEDIA: SLOTHFULMEDIA has the capability to enumerate services.","[S0236] Kwampirs: Kwampirs collects a list of running services with the command tasklist /svc.","[S0057] Tasklist: Tasklist can be used to discover services running on a system.","[S0283] jRAT: jRAT can list local services.","[S0241] RATANKBA: RATANKBA uses tasklist /svc to display running tasks.","[G0049] OilRig: OilRig has used sc query on a victim to gather information about services.","[G0010] Turla: Turla surveys a system upon check-in to discover running services and associated processes using the tasklist /svc command.","[S0127] BBSRAT: BBSRAT can query service configuration information.","[S0629] RainyDay: RainyDay can create and register a service for execution.","[S0154] Cobalt Strike: Cobalt Strike can enumerate services on compromised hosts.","[S0180] Volgmer: Volgmer queries the system to identify existing services.","[S0582] LookBack: LookBack can enumerate services on the victim machine.","[S1027] Heyoka Backdoor: Heyoka Backdoor can check if it is running as a service on a compromised host.","[G0143] Aquatic Panda: Aquatic Panda has attempted to discover services for third party EDR products.","[G0033] Poseidon Group: After compromising a victim, Poseidon Group discovers all running services.","[G0094] Kimsuky: Kimsuky has used an instrumentor script to gather the names of all services running on a victim's system.","[S0572] Caterpillar WebShell: Caterpillar WebShell can obtain a list of the services from a system.","[G0114] Chimera: Chimera has used net start and net use for system service discovery.","[G0004] Ke3chang: Ke3chang performs service discovery using net start commands.","[S0260] InvisiMole: InvisiMole can obtain running services on the victim.","[S0342] GreyEnergy: GreyEnergy enumerates all Windows services.","[S0559] SUNBURST: SUNBURST collected a list of service names that were hashed using a FNV-1a + XOR algorithm to check against similarly-hashed hardcoded blocklists.","[S0398] HyperBro: HyperBro can list all services and their configurations.","[S1070] Black Basta: Black Basta can check whether the service name `FAX` is present.","[S0203] Hydraq: Hydraq creates a backdoor through which remote attackers can monitor services.","[S0237] GravityRAT: GravityRAT has a feature to list the available services on the system.","[S0496] REvil: REvil can enumerate active services.","[S0625] Cuba: Cuba can query service status using QueryServiceStatusEx function.","[S0242] SynAck: SynAck enumerates all running services.","[S1085] Sardonic: Sardonic has the ability to execute the `net start` command.","[S0431] HotCroissant: HotCroissant has the ability to retrieve a list of services on the infected host.","[G1006] Earth Lusca: Earth Lusca has used Tasklist to obtain information from a compromised host.","[S0085] S-Type: S-Type runs the command net start on a victim.","[G1017] Volt Typhoon: Volt Typhoon has used `net start` to list running services.","[S0049] GeminiDuke: GeminiDuke collects information on programs and services on the victim that are configured to automatically run at startup.","[C0014] Operation Wocao: During Operation Wocao, threat actors used the `tasklist` command to search for one of its backdoors.","[S0086] ZLib: ZLib has the ability to discover and manipulate Windows services.","[S1066] DarkTortilla: DarkTortilla can retrieve information about a compromised system's running services.","[S0082] Emissary: Emissary has the capability to execute the command net start to interact with services.","[S0638] Babuk: Babuk can enumerate all services running on a compromised host.","[S0015] Ixeshe: Ixeshe can list running services.","[S0615] SombRAT: SombRAT can enumerate services on a victim machine.","[S0219] WINERACK: WINERACK can enumerate services.","[S0091] Epic: Epic uses the tasklist /svc command to list the services on the system.","[S0570] BitPaymer: BitPaymer can enumerate existing Windows services on the host that are configured to run as LocalSystem.","[S0266] TrickBot: TrickBot collects a list of install programs and services on the system’s machine.","[S0201] JPIN: JPIN can list running services.","[G0018] admin@338: admin@338 actors used the following command following exploitation of a machine with LOWBALL malware to obtain information about services: net start >> %temp%\\download","[C0012] Operation CuckooBees: During Operation CuckooBees, the threat actors used the `net start` command as part of their initial reconnaissance.","[S0024] Dyre: Dyre has the ability to identify running services on a compromised host.","[G0006] APT1: APT1 used the commands net start and tasklist to get a listing of the services on the system.","[S0412] ZxShell: ZxShell can check the services on the system.","[S0692] SILENTTRINITY: SILENTTRINITY can search for modifiable services that could be used for privilege escalation."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1010","technique_name":"Application Window Discovery","description":"Adversaries may attempt to get a listing of open application windows. Window listings could convey information about how the system is used. For example, information about application windows could be used identify potential data to collect as well as identifying security tooling (Security Software Discovery) to evade. Adversaries typically abuse system features for this type of enumeration. For example, they may gather information through native system features such as Command and Scripting Interpreter commands and Native API functions.","detection":"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities based on the information obtained. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.","procedures":["[S0438] Attor: Attor can obtain application window titles and then determines which windows to perform Screen Capture on.","[S0033] NetTraveler: NetTraveler reports window names along with keylogger information to provide application context.","[S0454] Cadelspy: Cadelspy has the ability to identify open windows on the compromised host.","[S0696] Flagpro: Flagpro can check the name of the window displayed on the system.","[S0385] njRAT: njRAT gathers information about opened windows during the initial infection.","[G0032] Lazarus Group: Lazarus Group malware IndiaIndia obtains and sends to its C2 server the title of the window for each running process. The KilaAlfa keylogger also reports the title of the window in the foreground.","[S0094] Trojan.Karagany: Trojan.Karagany can monitor the titles of open windows to identify specific keywords.","[S1111] DarkGate: DarkGate will search for cryptocurrency wallets by examining application window names for specific strings. DarkGate extracts information collected via NirSoft tools from the hosting process's memory by first identifying the window through the FindWindow API function.","[S0673] DarkWatchman: DarkWatchman reports window names along with keylogger information to provide application context.","[S0139] PowerDuke: PowerDuke has a command to get text of the current foreground window.","[S0260] InvisiMole: InvisiMole can enumerate windows and child windows on a compromised host.","[S0456] Aria-body: Aria-body has the ability to identify the titles of running windows on a compromised host.","[S0531] Grandoreiro: Grandoreiro can identify installed security tools based on window names.","[S0219] WINERACK: WINERACK can enumerate active windows.","[S0409] Machete: Machete saves the window names.","[S1090] NightClub: NightClub can use `GetForegroundWindow` to enumerate the active window.","[S0198] NETWIRE: NETWIRE can discover and close windows on controlled systems.","[S0265] Kazuar: Kazuar gathers information about opened windows.","[S0375] Remexi: Remexi has a command to capture active windows on the machine and retrieve window titles.","[S1159] DUSTTRAP: DUSTTRAP can enumerate running application windows.","[S0157] SOUNDBITE: SOUNDBITE is capable of enumerating application windows.","[S0038] Duqu: The discovery modules used with Duqu can collect information on open windows.","[G1017] Volt Typhoon: Volt Typhoon has collected window title information from compromised systems.","[S0431] HotCroissant: HotCroissant has the ability to list the names of all open windows on the infected host.","[S0455] Metamorfo: Metamorfo can enumerate all windows on the victim’s machine.","[S0240] ROKRAT: ROKRAT can use the `GetForegroundWindow` and `GetWindowText` APIs to discover where the user is typing.","[S0692] SILENTTRINITY: SILENTTRINITY can enumerate the active Window during keylogging through execution of `GetActiveWindowTitle`.","[S0261] Catchamas: Catchamas obtains application windows titles and then determines which windows to perform Screen Capture on.","[S0650] QakBot: QakBot has the ability to enumerate windows on a compromised host.","[G1001] HEXANE: HEXANE has used a PowerShell-based keylogging tool to capture the window title.","[S0435] PLEAD: PLEAD has the ability to list open windows on the compromised host.","[S0012] PoisonIvy: PoisonIvy captures window titles.","[S1044] FunnyDream: FunnyDream has the ability to discover application windows via execution of `EnumWindows`."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1012","technique_name":"Query Registry","description":"Adversaries may interact with the Windows Registry to gather information about the system, configuration, and installed software. The Registry contains a significant amount of information about the operating system, configuration, software, and security. Information can easily be queried using the Reg utility, though other means to access the Registry exist. Some of the information may help adversaries to further their operation within a network. Adversaries may use the information from Query Registry during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.","detection":"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained. Interaction with the Windows Registry may come from the command line using utilities such as Reg or through running malware that may interact with the Registry through an API. Command-line invocation of utilities used to query the Registry may be detected through process and command-line monitoring. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.","procedures":["[C0014] Operation Wocao: During Operation Wocao, the threat actors executed `/c cd /d c:\\windows\\temp\\ & reg query HKEY_CURRENT_USER\\Software\\\\PuTTY\\Sessions\\` to detect recent PuTTY sessions, likely to further lateral movement.","[S0091] Epic: Epic uses the rem reg query command to obtain values from Registry keys.","[S1159] DUSTTRAP: DUSTTRAP can enumerate Registry items.","[S0589] Sibot: Sibot has queried the registry for proxy server information.","[S0512] FatDuke: FatDuke can get user agent strings for the default browser from HKCU\\Software\\Classes\\http\\shell\\open\\command.","[S0203] Hydraq: Hydraq creates a backdoor through which remote attackers can retrieve system information, such as CPU speed, from Registry keys.","[S1064] SVCReady: SVCReady can search for the `HKEY_LOCAL_MACHINE\\HARDWARE\\DESCRIPTION\\System` Registry key to gather system information.","[G0128] ZIRCONIUM: ZIRCONIUM has used a tool to query the Registry for proxy settings.","[S0560] TEARDROP: TEARDROP checked that HKU\\SOFTWARE\\Microsoft\\CTF existed before decoding its embedded payload.","[S0376] HOPLIGHT: A variant of HOPLIGHT hooks lsass.exe, and lsass.exe then checks the Registry for the data value 'rdpproto' under the key SYSTEM\\CurrentControlSet\\Control\\Lsa Name.","[S1019] Shark: Shark can query `HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography MachineGuid` to retrieve the machine GUID.","[S1180] BlackByte Ransomware: BlackByte Ransomware enumerates the Registry, specifically the `HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options` key.","[S0344] Azorult: Azorult can check for installed software on the system under the Registry key Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall.","[S0660] Clambling: Clambling has the ability to enumerate Registry keys, including KEY_CURRENT_USER\\Software\\Bitcoin\\Bitcoin-Qt\\strDataDir to search for a bitcoin wallet.","[S0180] Volgmer: Volgmer checks the system for certain Registry keys.","[S0385] njRAT: njRAT can read specific registry values.","[S0240] ROKRAT: ROKRAT can access the HKLM\\System\\CurrentControlSet\\Services\\mssmbios\\Data\\SMBiosData Registry key to obtain the System manufacturer value to identify the machine type.","[S0140] Shamoon: Shamoon queries several Registry keys to identify hard disk partitions to overwrite.","[S0414] BabyShark: BabyShark has executed the reg query command for HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default.","[S0354] Denis: Denis queries the Registry for keys and values.","[S0194] PowerSploit: PowerSploit contains a collection of Privesc-PowerUp modules that can query Registry keys for potential opportunities.","[S0517] Pillowmint: Pillowmint has used shellcode which reads code stored in the registry keys \\REGISTRY\\SOFTWARE\\Microsoft\\DRM using the native Windows API as well as read HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces as part of its C2.","[G0027] Threat Group-3390: A Threat Group-3390 tool can read and decrypt stored Registry values.","[S0335] Carbon: Carbon enumerates values in the Registry.","[G0032] Lazarus Group: Lazarus Group malware IndiaIndia checks Registry keys within HKCU and HKLM to determine if certain applications are present, including SecureCRT, Terminal Services, RealVNC, TightVNC, UltraVNC, Radmin, mRemote, TeamViewer, FileZilla, pcAnyware, and Remote Desktop. Another Lazarus Group malware sample checks for the presence of the following Registry key:HKEY_CURRENT_USER\\Software\\Bitcoin\\Bitcoin-Qt.","[S0030] Carbanak: Carbanak checks the Registry key HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings for proxy configurations information.","[S0496] REvil: REvil can query the Registry to get random file extensions to append to encrypted files.","[S0680] LitePower: LitePower can query the Registry for keys added to execute COM hijacking.","[S0201] JPIN: JPIN can enumerate Registry keys.","[G0050] APT32: APT32's backdoor can query the Windows Registry to gather system information.","[S0155] WINDSHIELD: WINDSHIELD can gather Registry values.","[S0013] PlugX: PlugX can enumerate and query for information contained within the Windows Registry.","[G0035] Dragonfly: Dragonfly has queried the Registry to identify victim information.","[S1013] ZxxZ: ZxxZ can search the registry of a compromised host.","[S0267] FELIXROOT: FELIXROOT queries the Registry for specific keys for potential privilege escalation and proxy information. FELIXROOT has also used WMI to query the Windows Registry.","[G0010] Turla: Turla surveys a system upon check-in to discover information in the Windows Registry with the reg query command. Turla has also retrieved PowerShell payloads hidden in Registry keys as well as checking keys associated with null session named pipes .","[S0186] DownPaper: DownPaper searches and reads the value of the Windows Update Registry Run key.","[S0075] Reg: Reg may be used to gather details from the Windows Registry of a local or remote system at the command-line interface.","[S0031] BACKSPACE: BACKSPACE is capable of enumerating and making modifications to an infected system's Registry.","[S0513] LiteDuke: LiteDuke can query the Registry to check for the presence of HKCU\\Software\\KasperskyLab.","[S0412] ZxShell: ZxShell can query the netsvc group value data located in the svchost group Registry key.","[S0011] Taidoor: Taidoor can query the Registry on compromised hosts using RegQueryValueExA.","[S1018] Saint Bot: Saint Bot has used `check_registry_keys` as part of its environmental checks.","[S0165] OSInfo: OSInfo queries the registry to look for information about Terminal Services.","[G0094] Kimsuky: Kimsuky has obtained specific Registry keys and values on a compromised host.","[S0242] SynAck: SynAck enumerates Registry keys associated with event logs.","[S0022] Uroburos: Uroburos can query the Registry, typically `HKLM:\\SOFTWARE\\Classes\\.wav\\OpenWithProgIds`, to find the key and path to decrypt and load its kernel driver and kernel driver loader.","[S0567] Dtrack: Dtrack can collect the RegisteredOwner, RegisteredOrganization, and InstallDate registry values.","[S1015] Milan: Milan can query `HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography MachineGuid` to retrieve the machine GUID.","[G0038] Stealth Falcon: Stealth Falcon malware attempts to determine the installed version of .NET by querying the Registry.","[S0534] Bazar: Bazar can query Windows\\CurrentVersion\\Uninstall for installed applications.","[S0692] SILENTTRINITY: SILENTTRINITY can use the `GetRegValue` function to check Registry keys within `HKCU\\Software\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated` and `HKLM\\Software\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated`. It also contains additional modules that can check software AutoRun values and use the Win32 namespace to get values from HKCU, HKLM, HKCR, and HKCC hives.","[S0239] Bankshot: Bankshot searches for certain Registry keys to be configured before executing the payload.","[S0673] DarkWatchman: DarkWatchman can query the Registry to determine if it has already been installed on the system.","[S0182] FinFisher: FinFisher queries Registry values as part of its anti-sandbox checks.","[S1060] Mafalda: Mafalda can enumerate Registry keys with all subkeys and values.","[S0570] BitPaymer: BitPaymer can use the RegEnumKeyW to iterate through Registry keys.","[S0032] gh0st RAT: gh0st RAT has checked for the existence of a Service key to determine if it has already been installed on the system.","[S0348] Cardinal RAT: Cardinal RAT contains watchdog functionality that periodically ensures HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\Load is set to point to its executable.","[S1044] FunnyDream: FunnyDream can check `Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings` to extract the `ProxyServer` string.","[S0484] Carberp: Carberp has searched the Image File Execution Options registry key for \"Debugger\" within every subkey.","[S0154] Cobalt Strike: Cobalt Strike can query HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\\\Excel\\Security\\AccessVBOM\\ to determine if the security setting for restricting default programmatic access is enabled.","[S0579] Waterbear: Waterbear can query the Registry key \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\MSDTC\\MTxOCI\" to see if the value `OracleOcilib` exists.","[S0612] WastedLocker: WastedLocker checks for specific registry keys related to the UCOMIEnumConnections and IActiveScriptParseProcedure32 interfaces.","[S0574] BendyBear: BendyBear can query the host's Registry key at HKEY_CURRENT_USER\\Console\\QuickEdit to retrieve data.","[G1043] BlackByte: BlackByte queried registry values to determine system language settings.","[S1047] Mori: Mori can read data from the Registry including from `HKLM\\Software\\NFC\\IPA` and `HKLM\\Software\\NFC\\`.","[S0145] POWERSOURCE: POWERSOURCE queries Registry keys in preparation for setting Run keys to achieve persistence.","[S1190] Kapeka: Kapeka queries registry values for stored configuration information.","[S0045] ADVSTORESHELL: ADVSTORESHELL can enumerate registry keys.","[S1050] PcShare: PcShare can search the registry files of a compromised host.","[S0386] Ursnif: Ursnif has used Reg to query the Registry for installed programs.","[S0268] Bisonal: Bisonal has used the RegQueryValueExA function to retrieve proxy information in the Registry.","[S0252] Brave Prince: Brave Prince gathers information about the Registry.","[S1039] Bumblebee: Bumblebee can check the Registry for specific keys.","[S0476] Valak: Valak can use the Registry for code updates and to collect credentials.","[S0668] TinyTurla: TinyTurla can query the Registry for its configuration information.","[S0126] ComRAT: ComRAT can check the default browser by querying HKCR\\http\\shell\\open\\command.","[S0380] StoneDrill: StoneDrill has looked in the registry to find the default browser path.","[G0117] Fox Kitten: Fox Kitten has accessed Registry hives ntuser.dat and UserClass.dat.","[S1148] Raccoon Stealer: Raccoon Stealer queries the Windows Registry to fingerprint the infected host via the `HKLM:\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid` key.","[S0241] RATANKBA: RATANKBA uses the command reg query “HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\InternetSettings”.","[S1201] TRANSLATEXT: TRANSLATEXT has queried the following registry key to check for installed Chrome extensions: ` HKCU\\Software\\Policies\\Google\\Chrome\\ExtensionInstallForcelist `.","[S0269] QUADAGENT: QUADAGENT checks if a value exists within a Registry key in the HKCU hive whose name is the same as the scheduled task it has created.","[G0087] APT39: APT39 has used various strains of malware to query the Registry.","[S1099] Samurai: Samurai can query `SOFTWARE\\Microsoft\\.NETFramework\\policy\\v2.0` for discovery.","[G0114] Chimera: Chimera has queried Registry keys using reg query \\\\\\HKU\\\\SOFTWARE\\Microsoft\\Terminal Server Client\\Servers and reg query \\\\\\HKU\\\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings.","[S0251] Zebrocy: Zebrocy executes the reg query command to obtain information in the Registry.","[S0666] Gelsemium: Gelsemium can open random files and Registry keys to obscure malware behavior from sandbox analysis.","[S0603] Stuxnet: Stuxnet searches the Registry for indicators of security programs.","[S0238] Proxysvc: Proxysvc gathers product names from the Registry key: HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion ProductName and the processor description from the Registry key HKLM\\HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\0 ProcessorNameString.","[S0559] SUNBURST: SUNBURST collected the registry value HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid from compromised hosts.","[S0184] POWRUNER: POWRUNER may query the Registry by running reg query on a victim.","[S0330] Zeus Panda: Zeus Panda checks for the existence of a Registry key and if it contains certain values.","[G0096] APT41: APT41 queried registry values to determine items such as configured RDP ports and network configurations.","[G1034] Daggerfly: Daggerfly used Reg to dump the Security Account Manager (SAM), System, and Security Windows registry hives from victim machines.","[S0448] Rising Sun: Rising Sun has identified the OS product name from a compromised host by searching the registry for `SOFTWARE\\MICROSOFT\\Windows NT\\ CurrentVersion | ProductName`.","[G1017] Volt Typhoon: Volt Typhoon has queried the Registry on compromised systems, `reg query hklm\\software\\`, for information on installed software including PuTTY.","[S0115] Crimson: Crimson can check the Registry for the presence of HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\last_edate to determine how long it has been installed on a host.","[G0049] OilRig: OilRig has used reg query “HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default” on a victim to query the Registry.","[G0119] Indrik Spider: Indrik Spider has used a service account to extract copies of the `Security` Registry hive.","[S1065] Woody RAT: Woody RAT can search registry keys to identify antivirus programs on an compromised host.","[S1076] QUIETCANARY: QUIETCANARY has the ability to retrieve information from the Registry.","[S0627] SodaMaster: SodaMaster has the ability to query the Registry to detect a key specific to VMware.","[S0021] Derusbi: Derusbi is capable of enumerating Registry keys and values.","[S0674] CharmPower: CharmPower has the ability to enumerate `Uninstall` registry values.","[S0172] Reaver: Reaver queries the Registry to determine the correct Startup path to use for persistence.","[S0023] CHOPSTICK: CHOPSTICK provides access to the Windows Registry, which can be used to gather information.","[S0604] Industroyer: Industroyer has a data wiper component that enumerates keys in the Registry HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services.","[S0249] Gold Dragon: Gold Dragon enumerates registry keys with the command regkeyenum and obtains information for the Registry key HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run.","[S0532] Lucifer: Lucifer can check for existing stratum cryptomining information in HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\spreadCpuXmr – %stratum info%.","[S0438] Attor: Attor has opened the registry and performed query searches.","[S0260] InvisiMole: InvisiMole can enumerate Registry values, keys, and data.","[G0030] Lotus Blossom: Lotus Blossom has run commands such as `reg query HKLM\\SYSTEM\\CurrentControlSet\\Services\\[service name]\\Parameters` to verify if installed implants are running as a service."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1016.001","technique_name":"System Network Configuration Discovery: Internet Connection Discovery","description":"Adversaries may check for Internet connectivity on compromised systems. This may be performed during automated discovery and can be accomplished in numerous ways such as using Ping, tracert, and GET requests to websites. Adversaries may use the results and responses from these requests to determine if the system is capable of communicating with their C2 servers before attempting to connect to them. The results may also be used to identify routes, redirectors, and proxy servers.","detection":"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Command and Control, based on the information obtained. Monitor processes and command-line arguments for actions that could be taken to check Internet connectivity.","procedures":["[S0597] GoldFinder: GoldFinder performed HTTP GET requests to check internet connectivity and identify HTTP proxy servers and other redirectors that an HTTP request traveled through.","[S0284] More_eggs: More_eggs has used HTTP GET requests to check internet connectivity.","[S0691] Neoichor: Neoichor can check for Internet connectivity by contacting bing[.]com with the request format `bing[.]com?id=`.","[C0024] SolarWinds Compromise: During the SolarWinds Compromise, APT29 used GoldFinder to perform HTTP GET requests to check internet connectivity and identify HTTP proxy servers and other redirectors that an HTTP request travels through.","[G0059] Magic Hound: Magic Hound has conducted a network call out to a specific website as part of their initial discovery activity.","[S1049] SUGARUSH: SUGARUSH has checked for internet connectivity from an infected host before attempting to establish a new TCP connection.","[S1107] NKAbuse: NKAbuse utilizes external services such as ifconfig.me to identify the victim machine's IP address.","[G1001] HEXANE: HEXANE has used tools including BITSAdmin to test internet connectivity from compromised hosts.","[S0650] QakBot: QakBot can measure the download speed on a targeted host.","[G0016] APT29: APT29 has ensured web servers in a victim environment are Internet accessible before copying tools or malware to it.","[S0686] QuietSieve: QuietSieve can check C2 connectivity with a `ping` to 8.8.8.8 (Google public DNS).","[G0047] Gamaredon Group: Gamaredon Group has tested connectivity between a compromised machine and a C2 server using Ping with commands such as `CSIDL_SYSTEM\\cmd.exe /c ping -n 1`.","[S0663] SysUpdate: SysUpdate can contact the DNS server operated by Google as part of its C2 establishment process.","[G1018] TA2541: TA2541 has run scripts to check internet connectivity from compromised hosts.","[C0014] Operation Wocao: During Operation Wocao, threat actors used a Visual Basic script that checked for internet connectivity.","[G0030] Lotus Blossom: Lotus Blossom has performed checks to determine if a victim machine is able to access the Internet.","[S1066] DarkTortilla: DarkTortilla can check for internet connectivity by issuing HTTP GET requests.","[S1065] Woody RAT: Woody RAT can make `Ping` GET HTTP requests to its C2 server at regular intervals for network connectivity checks.","[G1016] FIN13: FIN13 has used `Ping` and `tracert` for network reconnaissance efforts.","[S0448] Rising Sun: Rising Sun can test a connection to a specified network IP address over a specified port number.","[G0125] HAFNIUM: HAFNIUM has checked for network connectivity from a compromised host using `ping`, including attempts to contact `google[.]com`.","[G0010] Turla: Turla has used tracert to check internet connectivity.","[G1017] Volt Typhoon: Volt Typhoon has employed Ping to check network connectivity.","[G0061] FIN8: FIN8 has used the Ping command to check connectivity to actor-controlled C2 servers."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1016.002","technique_name":"System Network Configuration Discovery: Wi-Fi Discovery","description":"Adversaries may search for information about Wi-Fi networks, such as network names and passwords, on compromised systems. Adversaries may use Wi-Fi information as part of Account Discovery, Remote System Discovery, and other discovery or Credential Access activity to support both ongoing and future campaigns. Adversaries may collect various types of information about Wi-Fi networks from hosts. For example, on Windows names and passwords of all Wi-Fi networks a device has previously connected to may be available through `netsh wlan show profiles` to enumerate Wi-Fi names and then `netsh wlan show profile “Wi-Fi name” key=clear` to show a Wi-Fi network’s corresponding password. Additionally, names and other details of locally reachable Wi-Fi networks can be discovered using calls to `wlanAPI.dll` Native API functions. On Linux, names and passwords of all Wi-Fi-networks a device has previously connected to may be available in files under ` /etc/NetworkManager/system-connections/`. On macOS, the password of a known Wi-Fi may be identified with ` security find-generic-password -wa wifiname` (requires admin username/password).","detection":"This type of attack technique cannot be easily mitigated with preventive controls since it is based on the abuse of system features.","procedures":["[G0059] Magic Hound: Magic Hound has collected names and passwords of all Wi-Fi networks to which a device has previously connected.","[C0051] APT28 Nearest Neighbor Campaign: During APT28 Nearest Neighbor Campaign, APT28 collected information on wireless interfaces within range of a compromised system.","[S0331] Agent Tesla: Agent Tesla can collect names and passwords of all Wi-Fi networks to which a device has previously connected.","[S0367] Emotet: Emotet can extract names of all locally reachable Wi-Fi networks and then perform a brute-force attack to spread to new networks."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1018","technique_name":"Remote System Discovery","description":"Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. Functionality could exist within remote access tools to enable this, but utilities available on the operating system could also be used such as Ping, net view using Net, or, on ESXi servers, `esxcli network diag ping`. Adversaries may also analyze data from local host files (ex: C:\\Windows\\System32\\Drivers\\etc\\hosts or /etc/hosts) or other passive means (such as local Arp cache entries) in order to discover the presence of remote systems in an environment. Adversaries may also target discovery of network infrastructure as well as leverage Network Device CLI commands on network devices to gather detailed information about systems within a network (e.g. show cdp neighbors, show arp).","detection":"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained. Normal, benign system and network events related to legitimate remote system discovery may be uncommon, depending on the environment and how they are used. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell. Monitor for processes that can be used to discover remote systems, such as ping.exe and tracert.exe, especially when executed in quick succession.","procedures":["[G1003] Ember Bear: Ember Bear has used tools such as Nmap and MASSCAN for remote service discovery.","[G0045] menuPass: menuPass uses scripts to enumerate IP ranges on the victim network. menuPass has also issued the command net view /domain to a PlugX implant to gather information about remote systems on the network.","[S0233] MURKYTOP: MURKYTOP has the capability to identify remote hosts on connected networks.","[S0586] TAINTEDSCRIBE: The TAINTEDSCRIBE command and execution module can perform target system enumeration.","[S0684] ROADTools: ROADTools can enumerate Azure AD systems and devices.","[S0570] BitPaymer: BitPaymer can use net view to discover remote systems.","[S0650] QakBot: QakBot can identify remote systems through the net view command.","[C0012] Operation CuckooBees: During Operation CuckooBees, the threat actors used the `net view` and `ping` commands as part of their advanced reconnaissance.","[C0014] Operation Wocao: During Operation Wocao, threat actors used `nbtscan` and `ping` to discover remote systems, as well as `dsquery subnet` on a domain controller to retrieve all subnets in the Active Directory.","[G0117] Fox Kitten: Fox Kitten has used Angry IP Scanner to detect remote systems.","[S0452] USBferry: USBferry can use net view to gather information about remote systems.","[S0534] Bazar: Bazar can enumerate remote systems using Net View.","[S1081] BADHATCH: BADHATCH can use a PowerShell object such as, `System.Net.NetworkInformation.Ping` to ping a computer.","[G1030] Agrius: Agrius used the tool NBTscan to scan for remote, accessible hosts in victim environments.","[S1068] BlackCat: BlackCat can broadcasts NetBIOS Name Service (NBNC) messages to search for servers connected to compromised networks.","[G0019] Naikon: Naikon has used a netbios scanner for remote machine identification.","[G0009] Deep Panda: Deep Panda has used ping to identify other machines of interest.","[G1006] Earth Lusca: Earth Lusca used the command powershell “Get-EventLog -LogName security -Newest 500 | where {$_.EventID -eq 4624} | format-list - property * | findstr “Address”” to find the network information of successfully logged-in accounts to discovery addresses of other machines. Earth Lusca has also used multiple scanning tools to discover other machines within the same compromised network.","[G0096] APT41: APT41 has used MiPing to discover active systems in the victim network.","[S0039] Net: Commands such as net view can be used in Net to gather information about available remote systems.","[S1070] Black Basta: Black Basta can use LDAP queries to connect to AD and iterate over connected workstations.","[S0248] yty: yty uses the net view command for discovery.","[C0007] FunnyDream: During FunnyDream, the threat actors used several tools and batch files to map victims' internal networks.","[G0053] FIN5: FIN5 has used the open source tool Essential NetTools to map the network and build a list of targets.","[G1017] Volt Typhoon: Volt Typhoon has used multiple methods, including Ping, to enumerate systems on compromised networks.","[G0034] Sandworm Team: Sandworm Team has used a tool to query Active Directory using LDAP, discovering information about computers listed in AD.","[G1040] Play: Play has used tools such as AdFind, Nltest, and BloodHound to enumerate shares and hostnames on compromised networks.","[S0385] njRAT: njRAT can identify remote hosts on connected networks.","[S0604] Industroyer: Industroyer can enumerate remote computers in the compromised network.","[S0125] Remsec: Remsec can ping or traceroute a remote host.","[C0049] Leviathan Australian Intrusions: Leviathan performed extensive remote host enumeration to build their own map of victim networks during Leviathan Australian Intrusions.","[G1024] Akira: Akira uses software such as Advanced IP Scanner and MASSCAN to identify remote hosts within victim networks.","[S1198] Gomir: Gomir probes arbitrary network endpoints for TCP connectivity.","[C0028] 2015 Ukraine Electric Power Attack: During the 2015 Ukraine Electric Power Attack, Sandworm Team remotely discovered systems over LAN connections. OT systems were visible from the IT network as well, giving adversaries the ability to discover operational assets.","[G0004] Ke3chang: Ke3chang has used network scanning and enumeration tools, including Ping.","[S0488] CrackMapExec: CrackMapExec can discover active IP addresses, along with the machine name, within a targeted network.","[S0428] PoetRAT: PoetRAT used Nmap for remote system discovery.","[G1001] HEXANE: HEXANE has used `net view` to enumerate domain machines.","[S1212] RansomHub: RansomHub can enumerate all accessible machines from the infected system.","[S0091] Epic: Epic uses the net view command on the victim’s machine.","[S0236] Kwampirs: Kwampirs collects a list of available servers with the command net view.","[S1044] FunnyDream: FunnyDream can collect information about hosts on the victim network.","[C0024] SolarWinds Compromise: During the SolarWinds Compromise, APT29 used AdFind to enumerate remote systems.","[S0244] Comnie: Comnie runs the net view command","[S0366] WannaCry: WannaCry scans its local network segment for remote systems to try to exploit and copy itself to.","[G0027] Threat Group-3390: Threat Group-3390 has used the net view command.","[S0018] Sykipot: Sykipot may use net view /domain to display hostnames of available systems on a network.","[S0154] Cobalt Strike: Cobalt Strike uses the native Windows Network Enumeration APIs to interrogate and discover targets in a Windows Active Directory network.","[S0692] SILENTTRINITY: SILENTTRINITY can enumerate and collect the properties of domain computers.","[S0521] BloodHound: BloodHound can enumerate and collect the properties of domain computers, including domain controllers.","[S0694] DRATzarus: DRATzarus can search for other machines connected to compromised host and attempt to map the network.","[S0165] OSInfo: OSInfo performs a connection test to discover remote systems in the network","[S0696] Flagpro: Flagpro has been used to execute net view on a targeted system.","[G1022] ToddyCat: ToddyCat has used `ping %REMOTE_HOST%` for post exploit discovery.","[S0698] HermeticWizard: HermeticWizard can find machines on the local network by gathering known local IP addresses through `DNSGetCacheDataTable`, `GetIpNetTable`,`WNetOpenEnumW(RESOURCE_GLOBALNET, RESOURCETYPE_ANY)`,`NetServerEnum`,`GetTcpTable`, and `GetAdaptersAddresses.`","[G0030] Lotus Blossom: Lotus Blossom has used Ping to identify remote systems.","[G0060] BRONZE BUTLER: BRONZE BUTLER typically use ping and Net to enumerate systems.","[G0087] APT39: APT39 has used NBTscan and custom tools to discover remote systems.","[S0097] Ping: Ping can be used to identify remote systems within a network.","[S0575] Conti: Conti has the ability to discover hosts on a target network.","[S0241] RATANKBA: RATANKBA runs the net view /domain and net view commands.","[S0063] SHOTPUT: SHOTPUT has a command to list all servers in the domain, as well as one to locate domain controllers on a domain.","[S1146] MgBot: MgBot includes modules for performing ARP scans of local connected systems.","[G0050] APT32: APT32 has enumerated DC servers using the command net group \"Domain Controllers\" /domain. The group has also used the ping command.","[G0091] Silence: Silence has used Nmap to scan the corporate network, build a network topology, and identify vulnerable hosts.","[S0335] Carbon: Carbon uses the net view command.","[S0599] Kinsing: Kinsing has used a script to parse files like /etc/hosts and SSH known_hosts to discover remote systems.","[G0037] FIN6: FIN6 used publicly available tools (including Microsoft's built-in SQL querying tool, osql.exe) to map the internal network and conduct reconnaissance against Active Directory, Structured Query Language (SQL) servers, and NetBIOS.","[S0659] Diavol: Diavol can use the ARP table to find remote hosts to scan.","[S0266] TrickBot: TrickBot can enumerate computers and network devices.","[G0119] Indrik Spider: Indrik Spider has used PowerView to enumerate all Windows Server, Windows Server 2003, and Windows 7 instances in the Active Directory database.","[S0646] SpicyOmelette: SpicyOmelette can identify payment systems, payment gateways, and ATM systems in compromised environments.","[G0010] Turla: Turla surveys a system upon check-in to discover remote systems on a local network using the net view and net view /DOMAIN commands. Turla has also used net group \"Domain Computers\" /domain, net group \"Domain Controllers\" /domain, and net group \"Exchange Servers\" /domain to enumerate domain computers, including the organization's DC and Exchange Server.","[S0099] Arp: Arp can be used to display a host's ARP cache, which may include address resolutions for remote systems.","[S0590] NBTscan: NBTscan can list NetBIOS computer names.","[G0106] Rocke: Rocke has looked for IP addresses in the known_hosts file on the infected system and attempted to SSH into them.","[G0077] Leafminer: Leafminer used Microsoft’s Sysinternals tools to gather detailed information about remote systems.","[S0365] Olympic Destroyer: Olympic Destroyer uses Windows Management Instrumentation to enumerate all systems in the network.","[G0059] Magic Hound: Magic Hound has used Ping for discovery on targeted networks.","[S0359] Nltest: Nltest may be used to enumerate remote domain controllers using options such as /dclist and /dsgetdc.","[G1015] Scattered Spider: Scattered Spider can enumerate remote systems, such as VMware vCenter infrastructure.","[G0114] Chimera: Chimera has utilized various scans and queries to find domain controllers and remote services in the target environment.","[C0025] 2016 Ukraine Electric Power Attack: During the 2016 Ukraine Electric Power Attack, Sandworm Team checked for connectivity to resources within the network and used LDAP to query Active Directory, discovering information about computers listed in AD.","[G0125] HAFNIUM: HAFNIUM has enumerated domain controllers using `net group \"Domain computers\"` and `nltest /dclist`.","[G0102] Wizard Spider: Wizard Spider has used networkdll for network discovery and psfin specifically for financial and point of sale indicators. Wizard Spider has also used AdFind, nltest/dclist, and PowerShell script Get-DataInfo.ps1 to enumerate domain computers, including the domain controller.","[S0552] AdFind: AdFind has the ability to query Active Directory for computers.","[S0140] Shamoon: Shamoon scans the C-class subnet of the IPs on the victim's interfaces.","[S1159] DUSTTRAP: DUSTTRAP can use `ping` to identify remote hosts within the victim network.","[G0022] APT3: APT3 has a tool that can detect the existence of remote systems.","[C0015] C0015: During C0015, the threat actors used the commands `net view /all /domain` and `ping` to discover remote systems. They also used PowerView's PowerShell Invoke-ShareFinder script for file share enumeration.","[G0093] GALLIUM: GALLIUM used a modified version of NBTscan to identify available NetBIOS name servers over the network as well as ping to identify remote systems.","[G1043] BlackByte: BlackByte used tools such as Arp to identify remotely-connected devices.","[G0061] FIN8: FIN8 has used dsquery and other Active Directory utilities to enumerate hosts; they have also used nltest.exe /dclist to retrieve a list of domain controllers.","[S0093] Backdoor.Oldrea: Backdoor.Oldrea can enumerate and map ICS-specific systems in victim environments.","[G0035] Dragonfly: Dragonfly has likely obtained a list of hosts in the victim environment."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1033","technique_name":"System Owner/User Discovery","description":"Adversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system. They may do this, for example, by retrieving account usernames or by using OS Credential Dumping. The information may be collected in a number of different ways using other Discovery techniques, because user and username details are prevalent throughout a system and include running process ownership, file/directory ownership, session information, and system logs. Adversaries may use the information from System Owner/User Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Various utilities and commands may acquire this information, including whoami. In macOS and Linux, the currently logged in user can be identified with w and who. On macOS the dscl . list /Users | grep -v '_' command can also be used to enumerate user accounts. Environment variables, such as %USERNAME% and $USER, may also be used to access this information. On network devices, Network Device CLI commands such as `show users` and `show ssh` can be used to display users currently logged into the device.","detection":"`System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities based on the information obtained. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell. For network infrastructure devices, collect AAA logging to monitor `show` commands being run by non-standard users from non-standard locations.","procedures":["[S0094] Trojan.Karagany: Trojan.Karagany can gather information about the user on a compromised host.","[S0428] PoetRAT: PoetRAT sent username, computer name, and the previously generated UUID in reply to a \"who\" command from C2.","[S0379] Revenge RAT: Revenge RAT gathers the username from the system.","[S0694] DRATzarus: DRATzarus can obtain a list of users from an infected machine.","[S0266] TrickBot: TrickBot can identify the user and groups the user belongs to on a compromised host.","[S0596] ShadowPad: ShadowPad has collected the username of the victim system.","[S1030] Squirrelwaffle: Squirrelwaffle can collect the user name from a compromised host.","[S0367] Emotet: Emotet has enumerated all users connected to network shares.","[G0082] APT38: APT38 has identified primary users, currently logged in users, sets of users that commonly use a system, or inactive users.","[S0590] NBTscan: NBTscan can list active users on the system.","[S0272] NDiskMonitor: NDiskMonitor obtains the victim username and encrypts the information to send over its C2 channel.","[S0414] BabyShark: BabyShark has executed the whoami command.","[S0514] WellMess: WellMess can collect the username on the victim machine to send to C2.","[G1036] Moonstone Sleet: Moonstone Sleet deployed various malware such as YouieLoader that can perform system user discovery actions.","[S1016] MacMa: MacMa can collect the username from the compromised machine.","[S0058] SslMM: SslMM sends the logged-on username to its hard-coded C2.","[S0657] BLUELIGHT: BLUELIGHT can collect the username on a compromised host.","[S1146] MgBot: MgBot includes modules for identifying local users and administrators on victim machines.","[S1034] StrifeWater: StrifeWater can collect the user name from the victim's machine.","[S1039] Bumblebee: Bumblebee has the ability to identify the user name.","[S1153] Cuckoo Stealer: Cuckoo Stealer can discover and send the username from a compromised host to C2.","[S0024] Dyre: Dyre has the ability to identify the users on a compromised host.","[S1065] Woody RAT: Woody RAT can retrieve a list of user accounts and usernames from an infected machine.","[S0659] Diavol: Diavol can collect the username from a compromised host.","[S0091] Epic: Epic collects the user name from the victim’s machine.","[S0223] POWERSTATS: POWERSTATS has the ability to identify the username on the compromised host.","[G0061] FIN8: FIN8 has executed the command `quser` to display the session details of a compromised machine.","[S0085] S-Type: S-Type has run tests to determine the privilege level of the compromised user.","[S0652] MarkiRAT: MarkiRAT can retrieve the victim’s username.","[G0004] Ke3chang: Ke3chang has used implants capable of collecting the signed-in username.","[S0256] Mosquito: Mosquito runs whoami on the victim’s machine.","[S0130] Unknown Logger: Unknown Logger can obtain information about the victim usernames.","[S0344] Azorult: Azorult can collect the username from the victim’s machine.","[S1148] Raccoon Stealer: Raccoon Stealer gathers information on the infected system owner and user.","[S1059] metaMain: metaMain can collect the username from a compromised host.","[G0046] FIN7: FIN7 has used the command `cmd.exe /C quser` to collect user session information.","[S1029] AuTo Stealer: AuTo Stealer has the ability to collect the username from an infected host.","[G0125] HAFNIUM: HAFNIUM has used `whoami` to gather user information.","[C0017] C0017: During C0017, APT41 used `whoami` to gather information from victim machines.","[S0401] Exaramel for Linux: Exaramel for Linux can run whoami to identify the system owner.","[S0663] SysUpdate: SysUpdate can collect the username from a compromised host.","[G1035] Winter Vivern: Winter Vivern PowerShell scripts execute `whoami` to identify the executing user.","[S0241] RATANKBA: RATANKBA runs the whoami and query user commands.","[S0381] FlawedAmmyy: FlawedAmmyy enumerates the current user during the initial infection.","[S0448] Rising Sun: Rising Sun can detect the username of the infected host.","[S0275] UPPERCUT: UPPERCUT has the capability to collect the current logged on user’s username from a machine.","[S0219] WINERACK: WINERACK can gather information on the victim username.","[S1160] Latrodectus: Latrodectus can discover the username of an infected host.","[S0242] SynAck: SynAck gathers user names from infected hosts.","[S0161] XAgentOSX: XAgentOSX contains the getInfoOSX function to return the OS X version as well as the current user.","[S0155] WINDSHIELD: WINDSHIELD can gather the victim user name.","[S0250] Koadic: Koadic can identify logged in users across the domain and views user sessions.","[S0680] LitePower: LitePower can determine if the current user has admin privileges.","[G0073] APT19: APT19 used an HTTP malware variant and a Port 22 malware variant to collect the victim’s username.","[S0340] Octopus: Octopus can collect the username from the victim’s machine.","[S0610] SideTwist: SideTwist can collect the username on a targeted system.","[S0374] SpeakUp: SpeakUp uses the whoami command.","[S0632] GrimAgent: GrimAgent can identify the user id on a target machine.","[S0348] Cardinal RAT: Cardinal RAT can collect the username from a victim machine.","[S0192] Pupy: Pupy can enumerate local information for Linux hosts and find currently logged on users for Windows hosts.","[S0447] Lokibot: Lokibot has the ability to discover the username on the infected host.","[G0051] FIN10: FIN10 has used Meterpreter to enumerate users on remote systems.","[S0331] Agent Tesla: Agent Tesla can collect the username from the victim’s machine.","[S0459] MechaFlounder: MechaFlounder has the ability to identify the username and hostname on a compromised host.","[G0050] APT32: APT32 collected the victim's username and executed the whoami command on the victim's machine. APT32 executed shellcode to collect the username on the victim's machine.","[S0356] KONNI: KONNI can collect the username from the victim’s machine.","[S0249] Gold Dragon: Gold Dragon collects the endpoint victim's username and uses it as a basis for downloading additional components from the C2 server.","[C0014] Operation Wocao: During Operation Wocao, threat actors enumerated sessions and users on a remote host, and identified privileged users logged into a targeted system.","[S0532] Lucifer: Lucifer has the ability to identify the username on a compromised host.","[S0171] Felismus: Felismus collects the current username and sends it to the C2 server.","[G0087] APT39: APT39 used Remexi to collect usernames from the system.","[S1015] Milan: Milan can identify users registered to a targeted machine.","[S0251] Zebrocy: Zebrocy gets the username from the system.","[S0650] QakBot: QakBot can identify the user name on a compromised system.","[S0351] Cannon: Cannon can gather the username from the system.","[S0533] SLOTHFULMEDIA: SLOTHFULMEDIA has collected the username from a victim machine.","[S0647] Turian: Turian can retrieve usernames.","[S0627] SodaMaster: SodaMaster can identify the username on a compromised host.","[G0067] APT37: APT37 identifies the victim username.","[S1130] Raspberry Robin: Raspberry Robin determines whether it is successfully running on a victim system by querying the running account information to determine if it is running in Session 0, indicating running with elevated privileges.","[G0032] Lazarus Group: Various Lazarus Group malware enumerates logged-on users.","[C0002] Night Dragon: During Night Dragon, threat actors used password cracking and pass-the-hash tools to discover usernames and passwords.","[S0184] POWRUNER: POWRUNER may collect information about the currently logged in user by running whoami on a victim.","[S0260] InvisiMole: InvisiMole lists local users and session information.","[S0456] Aria-body: Aria-body has the ability to identify the username on a compromised host.","[S1087] AsyncRAT: AsyncRAT can check if the current user of a compromised system is an administrator.","[S0531] Grandoreiro: Grandoreiro can collect the username from the victim's machine.","[G0081] Tropic Trooper: Tropic Trooper used letmein to scan for saved usernames on the target system.","[G0027] Threat Group-3390: Threat Group-3390 has used `whoami` to collect system user information.","[S0631] Chaes: Chaes has collected the username and UID from the infected machine.","[S0476] Valak: Valak can gather information regarding the user.","[C0018] C0018: During C0018, the threat actors collected `whoami` information via PowerShell scripts.","[S1081] BADHATCH: BADHATCH can obtain logged user information from a compromised machine and can execute the command `whoami.exe`.","[S0139] PowerDuke: PowerDuke has commands to get the current user's name and SID.","[G1006] Earth Lusca: Earth Lusca collected information on user accounts via the whoami command.","[S0262] QuasarRAT: QuasarRAT can enumerate the username and account type.","[S0270] RogueRobin: RogueRobin collects the victim’s username and whether that user is an admin.","[S0391] HAWKBALL: HAWKBALL can collect the user name of the system.","[S0236] Kwampirs: Kwampirs collects registered owner details by using the commands systeminfo and net config workstation.","[S0412] ZxShell: ZxShell can collect the owner and organization information from the target workstation.","[S0339] Micropsia: Micropsia collects the username from the victim’s machine.","[S0569] Explosive: Explosive has collected the username from the infected host.","[S0092] Agent.btz: Agent.btz obtains the victim username and saves it to a file.","[S1064] SVCReady: SVCReady can collect the username from an infected host.","[S0115] Crimson: Crimson can identify the user on a targeted system.","[S0186] DownPaper: DownPaper collects the victim username and sends it to the C2 server.","[S0439] Okrum: Okrum can collect the victim username.","[S0214] HAPPYWORK: can collect the victim user name.","[S0681] Lizar: Lizar can collect the username from the system.","[S0162] Komplex: The OsInfo function in Komplex collects the current running username.","[S0615] SombRAT: SombRAT can execute getinfo to identify the username on a compromised host.","[S0265] Kazuar: Kazuar gathers information on users.","[C0012] Operation CuckooBees: During Operation CuckooBees, the threat actors used the `query user` and `whoami` commands as part of their advanced reconnaissance.","[S0515] WellMail: WellMail can identify the current username on the victim system.","[S0521] BloodHound: BloodHound can collect information on user sessions.","[S0201] JPIN: JPIN can obtain the victim user name.","[G0059] Magic Hound: Magic Hound malware has obtained the victim username and sent it to the C2 server.","[G0128] ZIRCONIUM: ZIRCONIUM has used a tool to capture the username on a compromised host in order to register it with C2.","[S1037] STARWHALE: STARWHALE can gather the username from an infected host.","[S0433] Rifdoor: Rifdoor has the ability to identify the username on the compromised host.","[S0691] Neoichor: Neoichor can collect the user name from a victim's machine.","[S0477] Goopy: Goopy has the ability to enumerate the infected system's user name.","[S0149] MoonWind: MoonWind obtains the victim username.","[S1149] CHIMNEYSWEEP: CHIMNEYSWEEP has included the victim's computer name and username in C2 messages sent to actor-owned infrastructure.","[S1044] FunnyDream: FunnyDream has the ability to gather user information from the targeted system using `whoami/upn&whoami/fqdn&whoami/logonid&whoami/all`.","[S1035] Small Sieve: Small Sieve can obtain the id of a logged in user.","[S0554] Egregor: Egregor has used tools to gather information about users.","[S0385] njRAT: njRAT enumerates the current user during the initial infection.","[G0114] Chimera: Chimera has used the quser command to show currently logged on users.","[S0649] SMOKEDHAM: SMOKEDHAM has used whoami commands to identify system owners.","[S0248] yty: yty collects the victim’s username.","[S0662] RCSession: RCSession can gather system owner information, including user and administrator privileges.","[S1106] NGLite: NGLite will run the whoami command to gather system information and return this to the command and control server.","[G0040] Patchwork: Patchwork collected the victim username and whether it was running as admin, then sent the information to its C2 server.","[S1124] SocGholish: SocGholish can use `whoami` to obtain the username from a compromised host.","[G0038] Stealth Falcon: Stealth Falcon malware gathers the registered user and primary owner name via WMI.","[S1021] DnsSystem: DnsSystem can use the Windows user name to create a unique identification for infected users and systems.","[G1017] Volt Typhoon: Volt Typhoon has used public tools and executed the PowerShell command `Get-EventLog security -instanceid 4624` to identify associated user and computer account names.","[S0362] Linux Rabbit: Linux Rabbit opens a socket on port 22 and if it receives a response it attempts to obtain the machine's hostname and Top-Level Domain.","[S0666] Gelsemium: Gelsemium has the ability to distinguish between a standard user and an administrator on a compromised host.","[G1014] LuminousMoth: LuminousMoth has used a malicious DLL to collect the username from compromised hosts.","[G0143] Aquatic Panda: Aquatic Panda gathers information on recently logged-in users on victim devices.","[S0543] Spark: Spark has run the whoami command and has a built-in command to identify the user logged in.","[S0353] NOKKI: NOKKI can collect the username from the victim’s machine.","[S0461] SDBbot: SDBbot has the ability to identify the user on a compromised host.","[S0696] Flagpro: Flagpro has been used to run the whoami command on the system.","[S0084] Mis-Type: Mis-Type runs tests to determine the privilege level of the compromised user.","[S1060] Mafalda: Mafalda can collect the username from a compromised host.","[G0047] Gamaredon Group: A Gamaredon Group file stealer can gather the victim's username to send to a C2 server.","[S0098] T9000: T9000 gathers and beacons the username of the logged in account during installation. It will also gather the username of running processes to determine if it is running as SYSTEM.","[G0093] GALLIUM: GALLIUM used whoami and query user to obtain information about the victim user.","[S0148] RTM: RTM can obtain the victim username and permissions.","[S0382] ServHelper: ServHelper will attempt to enumerate the username of the victim.","[G0102] Wizard Spider: Wizard Spider has used \"whoami\" to identify the local user and their privileges.","[S0258] RGDoor: RGDoor executes the whoami on the victim’s machine.","[G0096] APT41: APT41 has executed whoami commands, including using the WMIEXEC utility to execute this on remote machines.","[S1169] Mango: Mango can collect the user name from a compromised system which is used to create a unique victim identifier.","[S0021] Derusbi: A Linux version of Derusbi checks if the victim user ID is anything other than zero (normally used for root), and the malware will not execute if it does not have root privileges. Derusbi also gathers the username of the victim.","[S0059] WinMM: WinMM uses NetUser-GetInfo to identify that it is running under an “Admin” account on the local system.","[G0049] OilRig: OilRig has run whoami on a victim.","[S0354] Denis: Denis enumerates and collects the username from the victim’s machine.","[S0534] Bazar: Bazar can identify the username of the infected user.","[S0568] EVILNUM: EVILNUM can obtain the username from the victim's machine.","[G1001] HEXANE: HEXANE has run `whoami` on compromised machines to identify the current user.","[S0350] zwShell: zwShell can obtain the name of the logged-in user on the victim.","[S0153] RedLeaves: RedLeaves can obtain information about the logged on user both locally and for Remote Desktop sessions.","[S0237] GravityRAT: GravityRAT collects the victim username along with other account information (account type, description, full name, SID and status).","[S0431] HotCroissant: HotCroissant has the ability to collect the username on the infected host.","[S0572] Caterpillar WebShell: Caterpillar WebShell can obtain a list of user accounts from a victim's machine.","[S1032] PyDCrypt: PyDCrypt has probed victim machines with whoami and has collected the username from the machine.","[S0441] PowerShower: PowerShower has the ability to identify the current user on the infected host.","[S0240] ROKRAT: ROKRAT can collect the username from a compromised host.","[S0644] ObliqueRAT: ObliqueRAT can check for blocklisted usernames on infected endpoints.","[G0112] Windshift: Windshift has used malware to identify the username on a compromised host.","[S0280] MirageFox: MirageFox can gather the username from the victim’s machine.","[S1207] XLoader: XLoader can identify the username from a victim machine.","[S0455] Metamorfo: Metamorfo has collected the username from the victim's machine.","[S0125] Remsec: Remsec can obtain information about the current user.","[G0069] MuddyWater: MuddyWater has used malware that can collect the victim’s username.","[S0635] BoomBox: BoomBox can enumerate the username on a compromised host.","[S0168] Gazer: Gazer obtains the current user's security identifier.","[S0093] Backdoor.Oldrea: Backdoor.Oldrea collects the current username from the victim.","[S0513] LiteDuke: LiteDuke can enumerate the account name on a targeted system.","[S0460] Get2: Get2 has the ability to identify the current username of an infected host.","[S1172] OilBooster: OilBooster can identify the compromised system's username which is then used as part of a unique identifier.","[S0559] SUNBURST: SUNBURST collected the username from a compromised host.","[S1013] ZxxZ: ZxxZ can collect the username from a compromised host.","[S1025] Amadey: Amadey has collected the user name from a compromised host using `GetUserNameA`.","[S0267] FELIXROOT: FELIXROOT collects the username from the victim’s machine.","[S0486] Bonadan: Bonadan has discovered the username of the user running the backdoor.","[S0660] Clambling: Clambling can identify the username on a compromised host.","[S1147] Nightdoor: Nightdoor gathers information on victim system users and usernames.","[S0015] Ixeshe: Ixeshe collects the username from the victim’s machine.","[S1018] Saint Bot: Saint Bot can collect the username from a compromised host.","[S0172] Reaver: Reaver collects the victim's username.","[S0257] VERMIN: VERMIN gathers the username from the victim’s machine.","[G0035] Dragonfly: Dragonfly used the command query user on victim hosts.","[S0498] Cryptoistic: Cryptoistic can gather data on the user of a compromised host.","[S1028] Action RAT: Action RAT has the ability to collect the username from an infected host.","[S0667] Chrommme: Chrommme can retrieve the username from a targeted system.","[S0334] DarkComet: DarkComet gathers the username from the victim’s machine.","[S1141] LunarWeb: LunarWeb can collect user information from the targeted host.","[S0017] BISCUIT: BISCUIT has a command to gather the username from the system.","[S0692] SILENTTRINITY: SILENTTRINITY can gather a list of logged on users.","[G0034] Sandworm Team: Sandworm Team has collected the username from a compromised host.","[G1046] Storm-1811: Storm-1811 has used `whoami.exe` to determine if the active user on a compromised system is an administrator.","[S1024] CreepySnail: CreepySnail can execute `getUsername` on compromised systems.","[S0284] More_eggs: More_eggs has the capability to gather the username from the victim's machine.","[S0673] DarkWatchman: DarkWatchman has collected the username from a victim machine.","[C0001] Frankenstein: During Frankenstein, the threat actors used Empire to enumerate hosts and gather username, machine name, and administrative permissions information.","[S0450] SHARPSTATS: SHARPSTATS has the ability to identify the username on the compromised host.","[S0228] NanHaiShu: NanHaiShu collects the username from the victim.","[S0363] Empire: Empire can enumerate the username on targeted hosts.","[S1075] KOPILUWAK: KOPILUWAK can conduct basic network reconnaissance on the victim machine with `whoami`, to get user details.","[S1068] BlackCat: BlackCat can utilize `net use` commands to discover the user name on a compromised host.","[G0121] Sidewinder: Sidewinder has used tools to identify the user of a compromised host.","[S0269] QUADAGENT: QUADAGENT gathers the victim username.","[S0113] Prikormka: A module in Prikormka collects information from the victim about the current user name.","[G0022] APT3: An APT3 downloader uses the Windows command \"cmd.exe\" /C whoami to verify that it is running with the elevated privileges of “System.”","[S0060] Sys10: Sys10 collects the account name of the logged-in user and sends it to the C2."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1040","technique_name":"Network Sniffing","description":"Adversaries may passively sniff network traffic to capture information about an environment, including authentication material passed over the network. Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection. An adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data. Data captured via this technique may include user credentials, especially those sent over an insecure, unencrypted protocol. Techniques for name service resolution poisoning, such as LLMNR/NBT-NS Poisoning and SMB Relay, can also be used to capture credentials to websites, proxies, and internal systems by redirecting traffic to an adversary. Network sniffing may reveal configuration details, such as running services, version numbers, and other network characteristics (e.g. IP addresses, hostnames, VLAN IDs) necessary for subsequent Lateral Movement and/or Defense Evasion activities. Adversaries may likely also utilize network sniffing during Adversary-in-the-Middle (AiTM) to passively gain additional knowledge about the environment. In cloud-based environments, adversaries may still be able to use traffic mirroring services to sniff network traffic from virtual machines. For example, AWS Traffic Mirroring, GCP Packet Mirroring, and Azure vTap allow users to define specified instances to collect traffic from and specified targets to send collected traffic to. Often, much of this traffic will be in cleartext due to the use of TLS termination at the load balancer level to reduce the strain of encrypting and decrypting traffic. The adversary can then use exfiltration techniques such as Transfer Data to Cloud Account in order to access the sniffed traffic. On network devices, adversaries may perform network captures using Network Device CLI commands such as `monitor capture`.","detection":"Detecting the events leading up to sniffing network traffic may be the best method of detection. From the host level, an adversary would likely need to perform a Adversary-in-the-Middle attack against other devices on a wired network in order to capture traffic that was not to or from the current compromised system. This change in the flow of information is detectable at the enclave network level. Monitor for ARP spoofing and gratuitous ARP broadcasts. Detecting compromised network devices is a bit more challenging. Auditing administrator logins, configuration changes, and device images is required to detect malicious changes. In cloud-based environments, monitor for the creation of new traffic mirrors or modification of existing traffic mirrors. For network infrastructure devices, collect AAA logging to monitor for the capture of network traffic.","procedures":["[G0034] Sandworm Team: Sandworm Team has used intercepter-NG to sniff passwords in network traffic.","[G0094] Kimsuky: Kimsuky has used the Nirsoft SniffPass network sniffer to obtain passwords sent over non-secure protocols.","[S0357] Impacket: Impacket can be used to sniff network traffic via an interface or raw socket.","[S0590] NBTscan: NBTscan can dump and print whole packet content.","[S0443] MESSAGETAP: MESSAGETAP uses the libpcap library to listen to all traffic and parses network protocols starting with Ethernet and IP layers. It continues parsing protocol layers including SCTP, SCCP, and TCAP and finally extracts SMS message data and routing metadata.","[S1206] JumbledPath: JumbledPath has the ability to perform packet capture on remote devices via actor-defined jump-hosts.","[G1047] Velvet Ant: Velvet Ant has used a custom tool, \"VELVETTAP\", to perform packet capture from compromised F5 BIG-IP devices.","[G1045] Salt Typhoon: Salt Typhoon has used a variety of tools and techniques to capture packet data between network interfaces.","[C0028] 2015 Ukraine Electric Power Attack: During the 2015 Ukraine Electric Power Attack, Sandworm Team used BlackEnergy’s network sniffer module to discover user credentials being sent over the network between the local LAN and the power grid’s industrial control systems.","[S0587] Penquin: Penquin can sniff network traffic to look for packets matching specific conditions.","[S0661] FoggyWeb: FoggyWeb can configure custom listeners to passively monitor all incoming HTTP GET and POST requests sent to the AD FS server from the intranet/internet and intercept HTTP requests that match the custom URI patterns defined by the actor.","[S0363] Empire: Empire can be used to conduct packet captures on target hosts.","[S0174] Responder: Responder captures hashes and credentials that are sent to the system after the name services have been poisoned.","[S0367] Emotet: Emotet has been observed to hook network APIs to monitor network traffic.","[C0046] ArcaneDoor: ArcaneDoor included network packet capture and sniffing for data collection in victim environments.","[G0064] APT33: APT33 has used SniffPass to collect credentials by sniffing network traffic.","[S1204] cd00r: cd00r can use the libpcap library to monitor captured packets for specifc sequences.","[S1186] Line Dancer: Line Dancer can create and exfiltrate packet captures from compromised environments.","[G0105] DarkVishnya: DarkVishnya used network sniffing to obtain login data.","[G0007] APT28: APT28 deployed the open source tool Responder to conduct NetBIOS Name Service poisoning, which captured usernames and hashed passwords that allowed access to legitimate credentials. APT28 close-access teams have used Wi-Fi pineapples to intercept Wi-Fi signals and user credentials.","[S1203] J-magic: J-magic has a pcap listener function that can create an Extended Berkley Packet Filter (eBPF) on designated interfaces and ports.","[S0378] PoshC2: PoshC2 contains a module for taking packet captures on compromised hosts.","[S1154] VersaMem: VersaMem hooked the Catalina application filter chain `doFilter` on compromised systems to monitor all inbound requests to the local Tomcat web server, inspecting them for parameters like passwords and follow-on Java modules.","[S0019] Regin: Regin appears to have functionality to sniff for credentials passed over HTTP, SMTP, and SMB."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1046","technique_name":"Network Service Discovery","description":"Adversaries may attempt to get a listing of services running on remote hosts and local network infrastructure devices, including those that may be vulnerable to remote software exploitation. Common methods to acquire this information include port, vulnerability, and/or wordlist scans using tools that are brought onto a system. Within cloud environments, adversaries may attempt to discover services running on other cloud hosts. Additionally, if the cloud environment is connected to a on-premises environment, adversaries may be able to identify services running on non-cloud systems as well. Within macOS environments, adversaries may use the native Bonjour application to discover services running on other macOS hosts within a network. The Bonjour mDNSResponder daemon automatically registers and advertises a host’s registered services on the network. For example, adversaries can use a mDNS query (such as dns-sd -B _ssh._tcp .) to find other systems broadcasting the ssh service.","detection":"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained. Normal, benign system and network events from legitimate remote service scanning may be uncommon, depending on the environment and how they are used. Legitimate open port and vulnerability scanning may be conducted within the environment and will need to be deconflicted with any detection capabilities developed. Network intrusion detection systems can also be used to identify scanning activity. Monitor for process use of the networks and inspect intra-network flows to detect port scans.","procedures":["[S0192] Pupy: Pupy has a built-in module for port scanning.","[G1017] Volt Typhoon: Volt Typhoon has used commercial tools, LOTL utilities, and appliances already present on the system for network service discovery.","[G0087] APT39: APT39 has used CrackMapExec and a custom port scanner known as BLUETORCH for network scanning.","[C0004] CostaRicto: During CostaRicto, the threat actors employed nmap and pscan to scan target environments.","[G0098] BlackTech: BlackTech has used the SNScan tool to find other potential targets on victim networks.","[G1043] BlackByte: BlackByte has used tools such as NetScan to enumerate network services in victim environments.","[G0045] menuPass: menuPass has used tcping.exe, similar to Ping, to probe port status on systems of interest.","[S0093] Backdoor.Oldrea: Backdoor.Oldrea can use a network scanning module to identify ICS-related ports.","[G0027] Threat Group-3390: Threat Group-3390 actors use the Hunter tool to conduct network service discovery for vulnerable systems.","[S0604] Industroyer: Industroyer uses a custom port scanner to map out a network.","[S0363] Empire: Empire can perform port scans from an infected host.","[G1030] Agrius: Agrius used the open-source port scanner WinEggDrop to perform detailed scans of hosts of interest in victim networks.","[G1016] FIN13: FIN13 has utilized `nmap` for reconnaissance efforts. FIN13 has also scanned for internal MS-SQL servers in a compromised network.","[S0458] Ramsay: Ramsay can scan for systems that are vulnerable to the EternalBlue exploit.","[C0038] HomeLand Justice: During HomeLand Justice, threat actors executed the Advanced Port Scanner tool on compromised systems.","[G0105] DarkVishnya: DarkVishnya performed port scanning to obtain the list of active services.","[G0049] OilRig: OilRig has used the publicly available tool SoftPerfect Network Scanner as well as a custom tool called GOLDIRONY to conduct network scanning.","[G0032] Lazarus Group: Lazarus Group has used nmap from a router VM to scan ports on systems within the restricted segment of an enterprise network.","[G0077] Leafminer: Leafminer scanned network services to search for vulnerabilities in the victim system.","[S1073] Royal: Royal can scan the network interfaces of targeted systems.","[S0374] SpeakUp: SpeakUp checks for availability of specific ports on servers.","[S0089] BlackEnergy: BlackEnergy has conducted port scans on a host.","[S0601] Hildegard: Hildegard has used masscan to look for kubelets in the internal Kubernetes network.","[G0081] Tropic Trooper: Tropic Trooper used pr and an openly available tool to scan for open ports on target systems.","[G0019] Naikon: Naikon has used the LadonGo scanner to scan target networks.","[G0059] Magic Hound: Magic Hound has used KPortScan 3.0 to perform SMB, RDP, and LDAP scanning.","[G0106] Rocke: Rocke conducted scanning for exposed TCP port 7001 as well as SSH and Redis servers.","[C0027] C0027: During C0027, used RustScan to scan for open ports on targeted ESXi appliances.","[S0590] NBTscan: NBTscan can be used to scan IP networks.","[G0050] APT32: APT32 performed network scanning on the network to search for open ports, services, OS finger-printing, and other vulnerabilities.","[G1032] INC Ransom: INC Ransom has used NETSCAN.EXE for internal reconnaissance.","[S0683] Peirates: Peirates can initiate a port scan against a given IP address.","[S1081] BADHATCH: BADHATCH can check for open ports on a computer by establishing a TCP connection.","[S0412] ZxShell: ZxShell can launch port scans.","[S0250] Koadic: Koadic can scan for open TCP ports on the target network.","[S0020] China Chopper: China Chopper's server component can spider authentication portals.","[C0018] C0018: During C0018, the threat actors used the SoftPerfect Network Scanner for network scanning.","[S1144] FRP: As part of load balancing FRP can set `healthCheck.type = \"tcp\"` or `healthCheck.type = \"http\"` to check service status on specific hosts with TCPing or an HTTP request.","[G0114] Chimera: Chimera has used the get -b -e -p command for network scanning as well as a custom Python tool packed into a Windows executable named Get.exe to scan IP ranges for HTTP.","[S0692] SILENTTRINITY: SILENTTRINITY can scan for open ports on a compromised machine.","[G0096] APT41: APT41 used a malware variant called WIDETONE to conduct port scans on specified subnets.","[S1180] BlackByte Ransomware: BlackByte Ransomware identifies remote systems via active directory queries for hostnames prior to launching remote ransomware payloads.","[S0341] Xbash: Xbash can perform port scanning of TCP and UDP ports.","[S0154] Cobalt Strike: Cobalt Strike can perform port scans from an infected host.","[G0039] Suckfly: Suckfly the victim's internal network for hosts with ports 8080, 5900, and 40 open.","[S1063] Brute Ratel C4: Brute Ratel C4 can conduct port scanning against targeted systems.","[S0598] P.A.S. Webshell: P.A.S. Webshell can scan networks for open ports and listening services.","[S0117] XTunnel: XTunnel is capable of probing the network for open ports.","[S0698] HermeticWizard: HermeticWizard has the ability to scan ports on a compromised network.","[G0037] FIN6: FIN6 used publicly available tools (including Microsoft's built-in SQL querying tool, osql.exe) to map the internal network and conduct reconnaissance against Active Directory, Structured Query Language (SQL) servers, and NetBIOS.","[G0139] TeamTNT: TeamTNT has used masscan to search for open Docker API ports and Kubernetes clusters. TeamTNT has also used malware that utilizes zmap and zgrab to search for vulnerable services in cloud environments.","[S1146] MgBot: MgBot includes modules for performing HTTP and server service scans.","[C0014] Operation Wocao: During Operation Wocao, threat actors scanned for open ports and used nbtscan to find NETBIOS nameservers.","[G0135] BackdoorDiplomacy: BackdoorDiplomacy has used SMBTouch, a vulnerability scanner, to determine whether a target is vulnerable to EternalBlue malware.","[S1185] LightSpy: To collect data on the host's Wi-Fi connection history, LightSpy reads the `/Library/Preferences/SystemConfiguration/com.apple.airport.preferences.plist file`.It also utilizes Apple's CWWiFiClient API to scan for nearby Wi-Fi networks and obtain data on the SSID, security type, and RSSI (signal strength) values.","[S0608] Conficker: Conficker scans for other machines to infect.","[G0030] Lotus Blossom: Lotus Blossom has used port scanners to enumerate services on remote hosts.","[S0061] HDoor: HDoor scans to identify open ports on the victim.","[S0233] MURKYTOP: MURKYTOP has the capability to scan for open ports on hosts in a connected network.","[G0117] Fox Kitten: Fox Kitten has used tools including NMAP to conduct broad scanning to identify open ports.","[S0260] InvisiMole: InvisiMole can scan the network for open ports and vulnerable instances of RDP and SMB protocols.","[S0378] PoshC2: PoshC2 can perform port scans from an infected host.","[S0125] Remsec: Remsec has a plugin that can perform ARP scanning as well as port scanning.","[S0532] Lucifer: Lucifer can scan for open ports including TCP ports 135 and 1433.","[G0080] Cobalt Group: Cobalt Group leveraged an open-source tool called SoftPerfect Network Scanner to perform network scanning.","[S0572] Caterpillar WebShell: Caterpillar WebShell has a module to use a port scanner on a system.","[G1039] RedCurl: RedCurl has used netstat to check if port 4119 is open.","[S0583] Pysa: Pysa can perform network reconnaissance using the Advanced Port Scanner tool.","[G1003] Ember Bear: Ember Bear has used tools such as NMAP for remote system discovery and enumeration in victim environments."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1049","technique_name":"System Network Connections Discovery","description":"Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network. An adversary who gains access to a system that is part of a cloud-based environment may map out Virtual Private Clouds or Virtual Networks in order to determine what systems and services are connected. The actions performed are likely the same types of discovery techniques depending on the operating system, but the resulting information may include details about the networked cloud environment relevant to the adversary's goals. Cloud providers may have different ways in which their virtual networks operate. Similarly, adversaries who gain access to network devices may also perform similar discovery activities to gather information about connected systems and services. Utilities and commands that acquire this information include netstat, \"net use,\" and \"net session\" with Net. In Mac and Linux, netstat and lsof can be used to list current connections. who -a and w can be used to show which users are currently logged in, similar to \"net session\". Additionally, built-in features native to network devices and Network Device CLI may be used (e.g. show ip sockets, show tcp brief). On ESXi servers, the command `esxi network ip connection list` can be used to list active network connections.","detection":"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Further, Network Device CLI commands may also be used to gather system and network information with built-in features native to the network device platform. Monitor CLI activity for unexpected or unauthorized use commands being run by non-standard users from non-standard locations. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.","procedures":["[S0532] Lucifer: Lucifer can identify the IP and port numbers for all remote connections from the compromised host.","[S0094] Trojan.Karagany: Trojan.Karagany can use netstat to collect a list of network connections.","[S0638] Babuk: Babuk can use “WNetOpenEnumW” and “WNetEnumResourceW” to enumerate files in network resources for encryption.","[G0082] APT38: APT38 installed a port monitoring tool, MAPMAKER, to print the active TCP connections on the local system.","[G0045] menuPass: menuPass has used net use to conduct connectivity checks to machines.","[S0445] ShimRatReporter: ShimRatReporter used the Windows function GetExtendedUdpTable to detect connected UDP endpoints.","[S0251] Zebrocy: Zebrocy uses netstat -aon to gather network connection information.","[S0378] PoshC2: PoshC2 contains an implementation of netstat to enumerate TCP and UDP connections.","[G0033] Poseidon Group: Poseidon Group obtains and saves information about victim network interfaces and addresses.","[S0125] Remsec: Remsec can obtain a list of active connections and open ports.","[C0014] Operation Wocao: During Operation Wocao, threat actors collected a list of open connections on the infected system using `netstat` and checks whether it has an internet connection.","[S0237] GravityRAT: GravityRAT uses the netstat command to find open ports on the victim’s machine.","[S0104] netstat: netstat can be used to enumerate local network connections, including active TCP connections and other network statistics.","[S0356] KONNI: KONNI has used net session on the victim's machine.","[G0139] TeamTNT: TeamTNT has run netstat -anp to search for rival malware connections. TeamTNT has also used `libprocesshider` to modify /etc/ld.so.preload.","[G0138] Andariel: Andariel has used the netstat -naop tcp command to display TCP connections on a victim's machine.","[G0129] Mustang Panda: Mustang Panda has used netstat -ano to determine network connection information.","[S0488] CrackMapExec: CrackMapExec can discover active sessions for a targeted system.","[S0449] Maze: Maze has used the \"WNetOpenEnumW\", \"WNetEnumResourceW”, “WNetCloseEnum” and “WNetAddConnection2W” functions to enumerate the network resources on the infected machine.","[S0241] RATANKBA: RATANKBA uses netstat -ano to search for specific IP address ranges.","[G0010] Turla: Turla surveys a system upon check-in to discover active local network connections using the netstat -an, net use, net file, and net session commands. Turla RPC backdoors have also enumerated the IPv4 TCP connection table via the GetTcpTable2 API call.","[S0335] Carbon: Carbon uses the netstat -r and netstat -an commands.","[S0409] Machete: Machete uses the netsh wlan show networks mode=bssid and netsh wlan show interfaces commands to list all nearby WiFi networks and connected interfaces.","[S0678] Torisma: Torisma can use `WTSEnumerateSessionsW` to monitor remote desktop connections.","[S0154] Cobalt Strike: Cobalt Strike can produce a sessions report from compromised hosts.","[S0039] Net: Commands such as net use and net session can be used in Net to gather information about network connections from a particular host.","[G0022] APT3: APT3 has a tool that can enumerate current network connections.","[S0089] BlackEnergy: BlackEnergy has gathered information about local network connections using netstat.","[G0030] Lotus Blossom: Lotus Blossom has used commands such as `netstat` to identify system network connections.","[S0567] Dtrack: Dtrack can collect network and active connection information.","[G1017] Volt Typhoon: Volt Typhoon has used `netstat -ano` on compromised hosts to enumerate network connections.","[G0034] Sandworm Team: Sandworm Team had gathered user, IP address, and server data related to RDP sessions on a compromised host. It has also accessed network diagram files useful for understanding how a host's network was configured.","[G1047] Velvet Ant: Velvet Ant has enumerated existing network connections on victim devices.","[S0091] Epic: Epic uses the net use, net session, and netstat commands to gather information on network connections.","[S0244] Comnie: Comnie executes the netstat -ano command.","[S1091] Pacu: Once inside a Virtual Private Cloud, Pacu can attempt to identify DirectConnect, VPN, or VPC Peering.","[S0554] Egregor: Egregor can enumerate all connected drives.","[S1141] LunarWeb: LunarWeb can enumerate system network connections.","[S1060] Mafalda: Mafalda can use the GetExtendedTcpTable function to retrieve information about established TCP connections.","[S0625] Cuba: Cuba can use the function GetIpNetTable to recover the last connections to the victim's machine.","[S0198] NETWIRE: NETWIRE can capture session logon details from a compromised host.","[S0165] OSInfo: OSInfo enumerates the current network connections similar to net use .","[S0018] Sykipot: Sykipot may use netstat -ano to display active network connections.","[S1032] PyDCrypt: PyDCrypt has used netsh to find RPC connections on remote machines.","[G0006] APT1: APT1 used the net use command to get a listing on network connections.","[S0579] Waterbear: Waterbear can use API hooks on `GetExtendedTcpTable` to retrieve a table containing a list of TCP endpoints available to the application.","[S0013] PlugX: PlugX has a module for enumerating TCP and UDP network connections and associated processes using the netstat command.","[S1144] FRP: FRP can use a dashboard and U/I to display the status of connections from the FRP client and server.","[G0049] OilRig: OilRig has used netstat -an on a victim to get a listing of network connections.","[G1022] ToddyCat: ToddyCat has used `netstat -anop tcp` to discover TCP connections to compromised hosts.","[S0038] Duqu: The discovery modules used with Duqu can collect information on network connections.","[G0059] Magic Hound: Magic Hound has used quser.exe to identify existing RDP connections.","[S0102] nbtstat: nbtstat can be used to discover current NetBIOS sessions.","[G0114] Chimera: Chimera has used netstat -ano | findstr EST to discover network connections.","[G0069] MuddyWater: MuddyWater has used a PowerShell backdoor to check for Skype connections on the target machine.","[S0533] SLOTHFULMEDIA: SLOTHFULMEDIA can enumerate open ports on a victim machine.","[G0018] admin@338: admin@338 actors used the following command following exploitation of a machine with LOWBALL malware to display network connections: netstat -ano >> %temp%\\download","[G0093] GALLIUM: GALLIUM used netstat -oan to obtain information about the victim network connections.","[S0674] CharmPower: CharmPower can use `netsh wlan show profiles` to list specific Wi-Fi profile details.","[S0063] SHOTPUT: SHOTPUT uses netstat to list TCP connection status.","[G0096] APT41: APT41 has enumerated IP addresses of network resources and used the netstat command as part of network reconnaissance. The group has also used a malware variant, HIGHNOON, to enumerate active RDP sessions.","[S0575] Conti: Conti can enumerate routine network connections from a compromised host.","[S0443] MESSAGETAP: After loading the keyword and phone data files, MESSAGETAP begins monitoring all network connections to and from the victim server.","[C0012] Operation CuckooBees: During Operation CuckooBees, the threat actors used the `net session`, `net use`, and `netstat` commands as part of their advanced reconnaissance.","[S0236] Kwampirs: Kwampirs collects a list of active and listening connections by using the command netstat -nao as well as a list of available network mappings with net use.","[S0363] Empire: Empire can enumerate the current network connections of a host.","[C0007] FunnyDream: During FunnyDream, the threat actors used netstat to discover network connections on remote systems.","[S1075] KOPILUWAK: KOPILUWAK can use netstat, Arp, and Net to discover current TCP connections.","[G1001] HEXANE: HEXANE has used netstat to monitor connections to specific ports.","[S0589] Sibot: Sibot has retrieved a GUID associated with a present LAN connection on a compromised machine.","[S0374] SpeakUp: SpeakUp uses the arp -a command.","[G1023] APT5: APT5 has used the BLOODMINE utility to collect data on web requests from Pulse Secure Connect logs.","[G0135] BackdoorDiplomacy: BackdoorDiplomacy has used NetCat and PortQry to enumerate network connections and display the status of related TCP and UDP ports.","[S0439] Okrum: Okrum was seen using NetSess to discover NetBIOS sessions.","[G0050] APT32: APT32 used the netstat -anpo tcp command to display TCP connections on the victim's machine.","[G1006] Earth Lusca: Earth Lusca employed a PowerShell script called RDPConnectionParser to read and filter the Windows event log “Microsoft-Windows-TerminalServices-RDPClient/Operational” (Event ID 1024) to obtain network information from RDP connections. Earth Lusca has also used netstat from a compromised system to obtain network connection information.","[G0081] Tropic Trooper: Tropic Trooper has tested if the localhost network is available and other connection capability on an infected system using command scripts.","[S0184] POWRUNER: POWRUNER may collect active network connections by running netstat -an on a victim.","[S0452] USBferry: USBferry can use netstat and nbtstat to detect active network connections.","[S0696] Flagpro: Flagpro has been used to execute netstat -ano on a compromised host.","[S0650] QakBot: QakBot can use netstat to enumerate current network connections.","[G0004] Ke3chang: Ke3chang performs local network connection discovery using netstat.","[S1081] BADHATCH: BADHATCH can execute `netstat.exe -f` on a compromised machine.","[S0192] Pupy: Pupy has a built-in utility command for netstat, can do net session through PowerView, and has an interactive shell which can be used to discover additional information.","[S0283] jRAT: jRAT can list network connections.","[S0458] Ramsay: Ramsay can use netstat to enumerate network connections.","[S0153] RedLeaves: RedLeaves can enumerate drives and Remote Desktop sessions.","[S0180] Volgmer: Volgmer can gather information about TCP connection state.","[S1085] Sardonic: Sardonic has the ability to execute the `netstat` command.","[G0032] Lazarus Group: Lazarus Group has used net use to identify and establish a network connection with a remote host.","[G1016] FIN13: FIN13 has used `netstat` and other net commands for network reconnaissance efforts.","[S0633] Sliver: Sliver can collect network connection information.","[G1032] INC Ransom: INC Ransom has used RDP to test network connections.","[G0027] Threat Group-3390: Threat Group-3390 has used `net use` and `netstat` to conduct internal discovery of systems. The group has also used `quser.exe` to identify existing RDP sessions on a victim.","[S0456] Aria-body: Aria-body has the ability to gather TCP and UDP table status listings.","[S0681] Lizar: Lizar has a plugin to retrieve information about all active network sessions on the infected server."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1057","technique_name":"Process Discovery","description":"Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network. Administrator or otherwise elevated access may provide better process details. Adversaries may use the information from Process Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. In Windows environments, adversaries could obtain details on running processes using the Tasklist utility via cmd or Get-Process via PowerShell. Information about processes can also be extracted from the output of Native API calls such as CreateToolhelp32Snapshot. In Mac and Linux, this is accomplished with the ps command. Adversaries may also opt to enumerate processes via `/proc`. ESXi also supports use of the `ps` command, as well as `esxcli system process list`. On network devices, Network Device CLI commands such as `show processes` can be used to display current running processes.","detection":"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained. Normal, benign system and network events that look like process discovery may be uncommon, depending on the environment and how they are used. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell. For network infrastructure devices, collect AAA logging to monitor for `show` commands being run by non-standard users from non-standard locations.","procedures":["[S0091] Epic: Epic uses the tasklist /v command to obtain a list of processes.","[S0670] WarzoneRAT: WarzoneRAT can obtain a list of processes on a compromised host.","[S0267] FELIXROOT: FELIXROOT collects a list of running processes.","[C0001] Frankenstein: During Frankenstein, the threat actors used Empire to obtain a list of all running processes.","[G0112] Windshift: Windshift has used malware to enumerate active processes.","[S0562] SUNSPOT: SUNSPOT monitored running processes for instances of MsBuild.exe by hashing the name of each running process and comparing it to the corresponding value 0x53D525. It also extracted command-line arguments and individual arguments from the running MsBuild.exe process to identify the directory path of the Orion software Visual Studio solution.","[S0142] StreamEx: StreamEx has the ability to enumerate processes.","[S0456] Aria-body: Aria-body has the ability to enumerate loaded modules for a process..","[G1017] Volt Typhoon: Volt Typhoon has enumerated running processes on targeted systems including through the use of Tasklist.","[S0149] MoonWind: MoonWind has a command to return a list of running processes.","[S0251] Zebrocy: Zebrocy uses the tasklist and wmic process get Capture, ExecutablePath commands to gather the processes running on the system.","[S0581] IronNetInjector: IronNetInjector can identify processes via C# methods such as GetProcessesByName and running Tasklist with the Python os.popen function.","[S0277] FruitFly: FruitFly has the ability to list processes on the system.","[S0351] Cannon: Cannon can obtain a list of processes running on the system.","[S0451] LoudMiner: LoudMiner used the ps command to monitor the running processes on the system.","[S0059] WinMM: WinMM sets a WH_CBT Windows hook to collect information on process creation.","[S1013] ZxxZ: ZxxZ has created a snapshot of running processes using `CreateToolhelp32Snapshot`.","[S0531] Grandoreiro: Grandoreiro can identify installed security tools based on process names.","[S0271] KEYMARBLE: KEYMARBLE can obtain a list of running processes on the system.","[S0219] WINERACK: WINERACK can enumerate processes.","[S0034] NETEAGLE: NETEAGLE can send process listings over the C2 channel.","[G0081] Tropic Trooper: Tropic Trooper is capable of enumerating the running processes on the system using pslist.","[S0615] SombRAT: SombRAT can use the getprocesslist command to enumerate processes on a compromised host.","[S0446] Ryuk: Ryuk has called CreateToolhelp32Snapshot to enumerate all running processes.","[S0044] JHUHUGIT: JHUHUGIT obtains a list of running processes on the victim.","[S1107] NKAbuse: NKAbuse will check victim systems to ensure only one copy of the malware is running.","[C0024] SolarWinds Compromise: During the SolarWinds Compromise, APT29 used multiple command-line utilities to enumerate running processes.","[S0268] Bisonal: Bisonal can obtain a list of running processes on the victim’s machine.","[S1114] ZIPLINE: ZIPLINE can identify running processes and their names.","[S0476] Valak: Valak has the ability to enumerate running processes on a compromised host.","[S0436] TSCookie: TSCookie has the ability to list processes on the infected host.","[S1050] PcShare: PcShare can obtain a list of running processes on a compromised host.","[S0015] Ixeshe: Ixeshe can list running processes.","[S0482] Bundlore: Bundlore has used the ps command to list processes.","[G0121] Sidewinder: Sidewinder has used tools to identify running processes on the victim's machine.","[S0516] SoreFang: SoreFang can enumerate processes on a victim machine through use of Tasklist.","[S0229] Orz: Orz can gather a process list from the victim.","[G0009] Deep Panda: Deep Panda uses the Microsoft Tasklist utility to list processes running on systems.","[S1160] Latrodectus: Latrodectus can enumerate running processes including process grandchildren on targeted hosts.","[S0532] Lucifer: Lucifer can identify the process that owns remote connections.","[S1185] LightSpy: If sent the command `16002`, LightSpy uses the `NSWorkspace runningApplications()` method to collect the process ID, path to the executable, bundle information, and the filename of the executable for all running applications.","[S1132] IPsec Helper: IPsec Helper can identify the process it is currently running under and its number, and pass this back to a command and control node.","[S0409] Machete: Machete has a component to check for running processes to look for web browsers.","[S1133] Apostle: Apostle retrieves a list of all running processes on a victim host, and stops all services containing the string \"sql,\" likely to propagate ransomware activity to database files.","[S0201] JPIN: JPIN can list running processes.","[S1081] BADHATCH: BADHATCH can retrieve a list of running processes from a compromised machine.","[S1147] Nightdoor: Nightdoor can collect information on installed applications via Windows registry keys, as well as collecting information on running processes.","[S0663] SysUpdate: SysUpdate can collect information about running processes.","[S0662] RCSession: RCSession can identify processes based on PID.","[S0605] EKANS: EKANS looks for processes from a hard-coded list.","[S0089] BlackEnergy: BlackEnergy has gathered a process list by using Tasklist.exe.","[S0252] Brave Prince: Brave Prince lists the running processes.","[S0410] Fysbis: Fysbis can collect information about running processes.","[S0125] Remsec: Remsec can obtain a process list from the victim.","[S1105] COATHANGER: COATHANGER will query running process information to determine subsequent program execution flow.","[S0659] Diavol: Diavol has used `CreateToolhelp32Snapshot`, `Process32First`, and `Process32Next` API calls to enumerate the running processes in the system.","[S0057] Tasklist: Tasklist can be used to discover processes running on a system.","[S0572] Caterpillar WebShell: Caterpillar WebShell can gather a list of processes running on the machine.","[S0049] GeminiDuke: GeminiDuke collects information on running processes and environment variables from the victim.","[S0373] Astaroth: Astaroth searches for different processes on the system.","[S1065] Woody RAT: Woody RAT can call `NtQuerySystemProcessInformation` with `SystemProcessInformation` to enumerate all running processes, including associated information such as PID, parent PID, image name, and owner.","[S0239] Bankshot: Bankshot identifies processes and collects the process ids.","[G0006] APT1: APT1 gathered a list of running processes on the system using tasklist /v.","[S1059] metaMain: metaMain can enumerate the processes that run on the platform.","[S0330] Zeus Panda: Zeus Panda checks for running processes on the victim’s machine.","[S0038] Duqu: The discovery modules used with Duqu can collect information on process details.","[S0244] Comnie: Comnie uses the tasklist to view running processes on the victim’s machine.","[S0497] Dacls: Dacls can collect data on running and parent processes.","[S0184] POWRUNER: POWRUNER may collect process information by running tasklist on a victim.","[S0586] TAINTEDSCRIBE: TAINTEDSCRIBE can execute ProcessList for process discovery.","[S0386] Ursnif: Ursnif has gathered information about running processes.","[S0331] Agent Tesla: Agent Tesla can list the current running processes on the system.","[S0355] Final1stspy: Final1stspy obtains a list of running processes.","[S0018] Sykipot: Sykipot may gather a list of running processes by running tasklist /v.","[S0434] Imminent Monitor: Imminent Monitor has a \"Process Watcher\" feature to monitor processes in case the client ever crashes or gets closed.","[S0441] PowerShower: PowerShower has the ability to deploy a reconnaissance module to retrieve a list of the active processes.","[G0125] HAFNIUM: HAFNIUM has used `tasklist` to enumerate processes.","[G0012] Darkhotel: Darkhotel malware can collect a list of running processes on a system.","[C0035] KV Botnet Activity: Scripts associated with KV Botnet Activity initial deployment can identify processes related to security tools and other botnet families for follow-on disabling during installation.","[S0081] Elise: Elise enumerates processes via the tasklist command.","[S0622] AppleSeed: AppleSeed can enumerate the current process on a compromised host.","[S0473] Avenger: Avenger has the ability to use Tasklist to identify running processes.","[G1040] Play: Play has used the information stealer Grixba to check for a list of security processes.","[S0013] PlugX: PlugX has a module to list the processes running on a machine.","[S1159] DUSTTRAP: DUSTTRAP can enumerate running processes.","[S0345] Seasalt: Seasalt has a command to perform a process listing.","[S0088] Kasidet: Kasidet has the ability to search for a given process name in processes currently running in the system.","[G0038] Stealth Falcon: Stealth Falcon malware gathers a list of running processes.","[G0139] TeamTNT: TeamTNT has searched for rival malware and removes it if found. TeamTNT has also searched for running processes containing the strings aliyun or liyun to identify machines running Alibaba Cloud Security tools.","[S0528] Javali: Javali can monitor processes for open browsers and custom banking applications.","[S0094] Trojan.Karagany: Trojan.Karagany can use Tasklist to collect a list of running tasks.","[G0007] APT28: An APT28 loader Trojan will enumerate the victim's processes searching for explorer.exe if its current process does not have necessary permissions.","[S0240] ROKRAT: ROKRAT can list the current running processes on the system.","[S0208] Pasam: Pasam creates a backdoor through which remote attackers can retrieve lists of running processes.","[S0414] BabyShark: BabyShark has executed the tasklist command.","[S0237] GravityRAT: GravityRAT lists the running processes on the system.","[S0141] Winnti for Windows: Winnti for Windows can check if the explorer.exe process is responsible for calling its install function.","[S0278] iKitten: iKitten lists the current processes running.","[S0626] P8RAT: P8RAT can check for specific processes associated with virtual environments.","[S0472] down_new: down_new has the ability to list running processes on a compromised host.","[G0114] Chimera: Chimera has used tasklist to enumerate processes.","[S1063] Brute Ratel C4: Brute Ratel C4 can enumerate all processes and locate specific process IDs (PIDs).","[S0695] Donut: Donut includes subprojects that enumerate and identify information about Process Injection candidates.","[S1153] Cuckoo Stealer: Cuckoo Stealer can use `ps aux` to enumerate running processes.","[S0069] BLACKCOFFEE: BLACKCOFFEE has the capability to discover processes.","[C0015] C0015: During C0015, the threat actors used the `tasklist /s` command as well as `taskmanager` to obtain a list of running processes.","[S0640] Avaddon: Avaddon has collected information about running processes.","[S0170] Helminth: Helminth has used Tasklist to get information on processes.","[S0248] yty: yty gets an output of running processes using the tasklist command.","[S1210] Sagerunex: Sagerunex identifies the `explorer.exe` process on the executing system.","[S0666] Gelsemium: Gelsemium can enumerate running processes.","[S0265] Kazuar: Kazuar obtains a list of running processes through WMI querying and the ps command.","[S1044] FunnyDream: FunnyDream has the ability to discover processes, including `Bka.exe` and `BkavUtil.exe`.","[S0460] Get2: Get2 has the ability to identify running processes on an infected host.","[S0151] HALFBAKED: HALFBAKED can obtain information about running processes on the victim.","[S0139] PowerDuke: PowerDuke has a command to list the victim's processes.","[S1075] KOPILUWAK: KOPILUWAK can enumerate current running processes on the targeted machine.","[G0138] Andariel: Andariel has used tasklist to enumerate processes and find a specific string.","[S0031] BACKSPACE: BACKSPACE may collect information about running processes.","[S0582] LookBack: LookBack can list running processes.","[S0045] ADVSTORESHELL: ADVSTORESHELL can list running processes.","[S0629] RainyDay: RainyDay can enumerate processes on a target system.","[S0412] ZxShell: ZxShell has a command, ps, to obtain a listing of processes on the system.","[G0032] Lazarus Group: Several Lazarus Group malware families gather a list of running processes on a victim system and send it to their C2 server. A Destover-like variant used by Lazarus Group also gathers process times.","[S1060] Mafalda: Mafalda can enumerate running processes on a machine.","[S0030] Carbanak: Carbanak lists running processes.","[S0650] QakBot: QakBot has the ability to check running processes.","[S0661] FoggyWeb: FoggyWeb's loader can enumerate all Common Language Runtimes (CLRs) and running Application Domains in the compromised AD FS server's Microsoft.IdentityServer.ServiceHost.exe process.","[S0534] Bazar: Bazar can identity the current process on a compromised host.","[G0021] Molerats: Molerats actors obtained a list of active processes on the victim and sent them to C2 servers.","[S0630] Nebulae: Nebulae can enumerate processes on a target system.","[G1006] Earth Lusca: Earth Lusca has used Tasklist to obtain information from a compromised host.","[S0079] MobileOrder: MobileOrder has a command to upload information about all running processes to its C2 server.","[S0198] NETWIRE: NETWIRE can discover processes on compromised hosts.","[S0606] Bad Rabbit: Bad Rabbit can enumerate all running processes to compare hashes.","[S0065] 4H RAT: 4H RAT has the capability to obtain a listing of running processes (including loaded modules).","[S0356] KONNI: KONNI has used the command cmd /c tasklist to get a snapshot of the current processes on the target machine.","[S0512] FatDuke: FatDuke can list running processes on the localhost.","[S1027] Heyoka Backdoor: Heyoka Backdoor can gather process information.","[S0607] KillDisk: KillDisk has called GetCurrentProcess.","[S1199] LockBit 2.0: LockBit 2.0 can determine if a running process has administrative privileges and terminate processes that interfere with encryption or exfiltration.","[S0064] ELMER: ELMER is capable of performing process listings.","[S0393] PowerStallion: PowerStallion has been used to monitor process lists.","[S1130] Raspberry Robin: Raspberry Robin can identify processes running on the victim machine, such as security software, during execution.","[S0664] Pandora: Pandora can monitor processes on a compromised host.","[S0283] jRAT: jRAT can query and kill system processes.","[S0334] DarkComet: DarkComet can list active processes running on the victim’s machine.","[S0467] TajMahal: TajMahal has the ability to identify running processes and associated plugins on an infected host.","[S0611] Clop: Clop can enumerate all processes on the victim's machine.","[S1066] DarkTortilla: DarkTortilla can enumerate a list of running processes on a compromised system.","[S0180] Volgmer: Volgmer can gather a list of processes.","[S0249] Gold Dragon: Gold Dragon checks the running processes on the victim’s machine.","[S1072] Industroyer2: Industroyer2 has the ability to cyclically enumerate running processes such as PServiceControl.exe, PService_PDD.exe, and other targets supplied through a hardcoded configuration.","[S0115] Crimson: Crimson contains a command to list processes.","[S0241] RATANKBA: RATANKBA lists the system’s processes.","[G0129] Mustang Panda: Mustang Panda has used tasklist /v to determine active process information.","[S1149] CHIMNEYSWEEP: CHIMNEYSWEEP can check if a process name contains “creensaver.”","[S0517] Pillowmint: Pillowmint can iterate through running processes every six seconds collecting a list of processes to capture from later.","[S0448] Rising Sun: Rising Sun can enumerate all running processes and process information on an infected machine.","[S0687] Cyclops Blink: Cyclops Blink can enumerate the process it is currently running under.","[S1111] DarkGate: DarkGate performs various checks for running processes, including security software by looking for hard-coded process name values.","[S0468] Skidmap: Skidmap has monitored critical processes to ensure resiliency.","[S0458] Ramsay: Ramsay can gather a list of running processes by using Tasklist.","[G1022] ToddyCat: ToddyCat has run `cmd /c start /b tasklist` to enumerate processes.","[S1141] LunarWeb: LunarWeb has used shell commands to list running processes.","[S0501] PipeMon: PipeMon can iterate over the running processes to find a suitable injection target.","[S1016] MacMa: MacMa can enumerate running processes.","[S0254] PLAINTEE: PLAINTEE performs the tasklist command to list running processes.","[S0211] Linfo: Linfo creates a backdoor through which remote attackers can retrieve a list of running processes.","[S0596] ShadowPad: ShadowPad has collected the PID of a malicious process.","[S0017] BISCUIT: BISCUIT has a command to enumerate running processes and identify their owners.","[S0256] Mosquito: Mosquito runs tasklist to obtain running processes.","[S0559] SUNBURST: SUNBURST collected a list of process names that were hashed using a FNV-1a + XOR algorithm to check against similarly-hashed hardcoded blocklists.","[S0162] Komplex: The OsInfo function in Komplex collects a running process list.","[S0266] TrickBot: TrickBot uses module networkDll for process list discovery.","[G1023] APT5: APT5 has used Windows-based utilities to carry out tasks including tasklist.exe.","[C0007] FunnyDream: During FunnyDream, the threat actors used Tasklist on targeted systems.","[S0657] BLUELIGHT: BLUELIGHT can collect process filenames and SID authority level.","[G0010] Turla: Turla surveys a system upon check-in to discover running processes using the tasklist /v command. Turla RPC backdoors have also enumerated processes associated with specific open ports or named pipes.","[G0069] MuddyWater: MuddyWater has used malware to obtain a list of running processes on the system.","[S0346] OceanSalt: OceanSalt can collect the name and ID for every process running on the system.","[G0106] Rocke: Rocke can detect a running process's PID on the infected machine.","[G0059] Magic Hound: Magic Hound malware can list running processes.","[S0032] gh0st RAT: gh0st RAT has the capability to list processes.","[S1085] Sardonic: Sardonic has the ability to execute the `tasklist` command.","[S0431] HotCroissant: HotCroissant has the ability to list running processes on the infected host.","[S0674] CharmPower: CharmPower has the ability to list running processes through the use of `tasklist`.","[S0203] Hydraq: Hydraq creates a backdoor through which remote attackers can monitor processes.","[S1212] RansomHub: RansomHub can stop processes associated with files currently in use to maximize the impact of encryption.","[S0617] HELLOKITTY: HELLOKITTY can search for specific processes to terminate.","[G0067] APT37: APT37's Freenki malware lists running processes using the Microsoft Windows API.","[S0428] PoetRAT: PoetRAT has the ability to list all running processes.","[S0694] DRATzarus: DRATzarus can enumerate and examine running processes to determine if a debugger is present.","[S0672] Zox: Zox has the ability to list processes.","[S1122] Mispadu: Mispadu can enumerate the running processes on a compromised host.","[S0652] MarkiRAT: MarkiRAT can search for different processes on a system.","[S0477] Goopy: Goopy has checked for the Google Updater process to ensure Goopy was loaded properly.","[S0660] Clambling: Clambling can enumerate processes on a targeted system.","[S1146] MgBot: MgBot includes a module for establishing a process watchdog for itself, identifying if the MgBot process is still running.","[S1191] Megazord: Megazord can terminate a list of specified services and processes.","[S0464] SYSCON: SYSCON has the ability to use Tasklist to list running processes.","[S0093] Backdoor.Oldrea: Backdoor.Oldrea collects information about running processes.","[S0503] FrameworkPOS: FrameworkPOS can enumerate and exclude selected processes on a compromised host to speed execution of memory scraping.","[S0127] BBSRAT: BBSRAT can list running processes.","[S0247] NavRAT: NavRAT uses tasklist /v to check running processes.","[G0094] Kimsuky: Kimsuky can gather a list of all processes running on a victim's machine.","[S0161] XAgentOSX: XAgentOSX contains the getProcessList function to run ps aux to get running processes.","[S1018] Saint Bot: Saint Bot has enumerated running processes on a compromised host to determine if it is running under the process name `dfrgui.exe`.","[S0567] Dtrack: Dtrack’s dropper can list all running processes.","[S1100] Ninja: Ninja can enumerate processes on a targeted host.","[S0452] USBferry: USBferry can use tasklist to gather information about the process running on the infected system.","[S1124] SocGholish: SocGholish can list processes on targeted hosts.","[S0236] Kwampirs: Kwampirs collects a list of running services with the command tasklist /v.","[S1039] Bumblebee: Bumblebee can identify processes associated with analytical tools.","[S0194] PowerSploit: PowerSploit's Get-ProcessTokenPrivilege Privesc-PowerUp module can enumerate privileges for a given process.","[S0625] Cuba: Cuba can enumerate processes running on a victim's machine.","[S0270] RogueRobin: RogueRobin checks the running processes for evidence it may be running in a sandbox environment. It specifically enumerates processes for Wireshark and Sysinternals.","[S1202] LockBit 3.0: LockBit 3.0 can identify and terminate specific services.","[S0238] Proxysvc: Proxysvc lists processes running on the system.","[S1090] NightClub: NightClub has the ability to use `GetWindowThreadProcessId` to identify the process behind a specified window.","[S0449] Maze: Maze has gathered all of the running system processes.","[S0644] ObliqueRAT: ObliqueRAT can check for blocklisted process names on a compromised host.","[S1064] SVCReady: SVCReady can collect a list of running processes from an infected host.","[G0126] Higaisa: Higaisa’s shellcode attempted to find the process ID of the current process.","[G0033] Poseidon Group: After compromising a victim, Poseidon Group lists all running processes.","[S1164] UPSTYLE: UPSTYLE has the ability to read `/proc/self/cmdline` to see if it is running as a monitored process.","[G0004] Ke3chang: Ke3chang performs process discovery using tasklist commands.","[S0595] ThiefQuest: ThiefQuest obtains a list of running processes using the function kill_unwanted.","[S0063] SHOTPUT: SHOTPUT has a command to obtain a process listing.","[S0627] SodaMaster: SodaMaster can search a list of running processes.","[G1001] HEXANE: HEXANE has enumerated processes on targeted systems.","[S0533] SLOTHFULMEDIA: SLOTHFULMEDIA has enumerated processes by ID, name, or privileges.","[S0638] Babuk: Babuk has the ability to check running processes on a targeted system.","[G0100] Inception: Inception has used a reconnaissance module to identify active processes and other associated loaded modules.","[S0011] Taidoor: Taidoor can use GetCurrentProcessId for process discovery.","[S0461] SDBbot: SDBbot can enumerate a list of running processes on a compromised machine.","[S0216] POORAIM: POORAIM can enumerate processes.","[S1129] Akira: Akira verifies the deletion of volume shadow copies by checking for the existence of the process ID related to the process created to delete these items.","[S0385] njRAT: njRAT can search a list of running processes for Tr.exe.","[S1087] AsyncRAT: AsyncRAT can examine running processes to determine if a debugger is present.","[S0182] FinFisher: FinFisher checks its parent process for indications that it is running in a sandbox setup.","[G0049] OilRig: OilRig has run tasklist on a victim's machine and used infostealers to capture processes.","[S0579] Waterbear: Waterbear can identify the process for a specific security product.","[S0242] SynAck: SynAck enumerates all running processes.","[G0022] APT3: APT3 has a tool that can list out currently running processes.","[S1078] RotaJakiro: RotaJakiro can monitor the `/proc/[PID]` directory of known RotaJakiro processes as a part of its persistence when executing with non-root permissions. If the process is found dead, it resurrects the process. RotaJakiro processes can be matched to an associated Advisory Lock, in the `/proc/locks` folder, to ensure it doesn't spawn more than one process.","[S0022] Uroburos: Uroburos can use its `Process List` command to enumerate processes on compromised hosts.","[S0435] PLEAD: PLEAD has the ability to list processes on the compromised host.","[S0491] StrongPity: StrongPity can determine if a user is logged in by checking to see if explorer.exe is running.","[S0599] Kinsing: Kinsing has used ps to list processes.","[G0047] Gamaredon Group: Gamaredon Group has used tools to enumerate processes on target hosts including Process Explorer.","[S0692] SILENTTRINITY: SILENTTRINITY can enumerate processes, including properties to determine if they have the Common Language Runtime (CLR) loaded.","[C0006] Operation Honeybee: During Operation Honeybee, the threat actors obtained a list of running processes on a victim machine using `cmd /c tasklist > %temp%\\temp.ini`.","[S0396] EvilBunny: EvilBunny has used EnumProcesses() to identify how many process are running in the environment.","[S0333] UBoatRAT: UBoatRAT can list running processes on the system.","[S0367] Emotet: Emotet has been observed enumerating local processes.","[C0012] Operation CuckooBees: During Operation CuckooBees, the threat actors used the `tasklist` command as part of their advanced reconnaissance.","[S0335] Carbon: Carbon can list the processes on the victim’s machine.","[S0144] ChChes: ChChes collects its process identifier (PID) on the victim.","[S1017] OutSteel: OutSteel can identify running processes on a compromised host.","[G0044] Winnti Group: Winnti Group looked for a specific process running on infected servers.","[S0681] Lizar: Lizar has a plugin designed to obtain a list of processes.","[S0455] Metamorfo: Metamorfo has performed process name checks and has monitored applications.","[S0575] Conti: Conti can enumerate through all open processes to search for any that have the string “sql” in their process name.","[S0260] InvisiMole: InvisiMole can obtain a list of running processes.","[S0273] Socksbot: Socksbot can list all running processes.","[S0154] Cobalt Strike: Cobalt Strike's Beacon payload can collect information on process details.","[S0348] Cardinal RAT: Cardinal RAT contains watchdog functionality that ensures its process is always running, else spawns a new instance.","[S0363] Empire: Empire can find information about processes running on local and remote systems.","[S0693] CaddyWiper: CaddyWiper can obtain a list of current processes.","[S0021] Derusbi: Derusbi collects current and parent process IDs.","[S0688] Meteor: Meteor can check if a specific process is running, such as Kaspersky's `avp.exe`.","[S1073] Royal: Royal can use `GetCurrentProcess` to enumerate processes.","[S0148] RTM: RTM can obtain information about process integrity levels.","[S0696] Flagpro: Flagpro has been used to run the tasklist command on a compromised system.","[S1048] macOS.OSAMiner: macOS.OSAMiner has used `ps ax | grep | grep -v grep | ...` and `ps ax | grep -E...` to conduct process discovery.","[S1139] INC Ransomware: INC Ransomware can use the Microsoft Win32 Restart Manager to kill processes with a specific handle or that are accessing resources it wants to encrypt.","[S0062] DustySky: DustySky collects information about running processes from victims.","[G0082] APT38: APT38 leveraged Sysmon to understand the processes, services in the organization.","[S0344] Azorult: Azorult can collect a list of running processes by calling CreateToolhelp32Snapshot.","[S0486] Bonadan: Bonadan can use the ps command to discover other cryptocurrency miners active on the system.","[S0257] VERMIN: VERMIN can get a list of the processes and running tasks on the system.","[S1178] ShrinkLocker: ShrinkLocker checks whether the Bitlocker Drive Encryption Tools service is running.","[S0445] ShimRatReporter: ShimRatReporter listed all running processes on the machine.","[S0484] Carberp: Carberp has collected a list of running processes.","[S1053] AvosLocker: AvosLocker has discovered system processes by calling `RmGetList`.","[S0192] Pupy: Pupy can list the running processes and get the process ID and parent process’s ID.","[S0600] Doki: Doki has searched for the current process’s PID.","[C0014] Operation Wocao: During Operation Wocao, the threat actors used `tasklist` to collect a list of running processes on an infected system.","[S0223] POWERSTATS: POWERSTATS has used get_tasklist to discover processes on the compromised host."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1069.001","technique_name":"Permission Groups Discovery: Local Groups","description":"Adversaries may attempt to find local system groups and permission settings. The knowledge of local system permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as the users found within the local administrators group. Commands such as net localgroup of the Net utility, dscl . -list /Groups on macOS, and groups on Linux can list local groups.","detection":"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.","procedures":["[G0010] Turla: Turla has used net localgroup and net localgroup Administrators to enumerate group information, including members of the local administrators group.","[S0201] JPIN: JPIN can obtain the permissions of the victim user.","[S0060] Sys10: Sys10 collects the group name of the logged-in user and sends it to the C2.","[S0521] BloodHound: BloodHound can collect information about local groups and members.","[S0692] SILENTTRINITY: SILENTTRINITY can obtain a list of local groups and members.","[S1179] Exbyte: Exbyte checks whether the process is running with privileged local access during execution.","[G0131] Tonto Team: Tonto Team has used the ShowLocalGroupDetails command to identify administrator, user, and guest accounts on a compromised host.","[S0184] POWRUNER: POWRUNER may collect local group information by running net localgroup administrators or a series of other commands on a victim.","[C0015] C0015: During C0015, the threat actors used the command `net localgroup \"adminstrator\" ` to identify accounts with local administrator rights.","[G1001] HEXANE: HEXANE has run `net localgroup` to enumerate local groups.","[C0014] Operation Wocao: During Operation Wocao, threat actors used the command `net localgroup administrators` to list all administrators part of a local group.","[S0650] QakBot: QakBot can use net localgroup to enable discovery of local groups.","[S0154] Cobalt Strike: Cobalt Strike can use net localgroup to list local groups on a system.","[S0039] Net: Commands such as net group and net localgroup can be used in Net to gather information about and manipulate groups.","[S0378] PoshC2: PoshC2 contains modules, such as Get-LocAdm for enumerating permission groups.","[S0265] Kazuar: Kazuar gathers information about local groups and members.","[G0018] admin@338: admin@338 actors used the following command following exploitation of a machine with LOWBALL malware to list local groups: net localgroup administrator >> %temp%\\download","[S0082] Emissary: Emissary has the capability to execute the command net localgroup administrators.","[S0696] Flagpro: Flagpro has been used to execute the net localgroup administrators command on a targeted system.","[C0012] Operation CuckooBees: During Operation CuckooBees, the threat actors used the `net group` command as part of their advanced reconnaissance.","[G0114] Chimera: Chimera has used net localgroup administrators to identify accounts with local administrative rights.","[S0572] Caterpillar WebShell: Caterpillar WebShell can obtain a list of local groups of users from a system.","[S1141] LunarWeb: LunarWeb can discover local group memberships.","[S0170] Helminth: Helminth has checked the local administrators group.","[S0091] Epic: Epic gathers information on local group names.","[S0165] OSInfo: OSInfo has enumerated the local administrators group.","[G1017] Volt Typhoon: Volt Typhoon has run `net localgroup administrators` in compromised environments to enumerate accounts.","[G0049] OilRig: OilRig has used net localgroup administrators to find local administrators on compromised systems.","[S1198] Gomir: Gomir checks the effective group ID of its process when initially executed to determine if it is in group 0, denoting superuser privileges in Linux environments.","[S0381] FlawedAmmyy: FlawedAmmyy enumerates the privilege level of the victim during the initial infection.","[S0236] Kwampirs: Kwampirs collects a list of users belonging to the local users and administrators groups with the commands net localgroup administrators and net localgroup users."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1069.002","technique_name":"Permission Groups Discovery: Domain Groups","description":"Adversaries may attempt to find domain-level groups and permission settings. The knowledge of domain-level permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as domain administrators. Commands such as net group /domain of the Net utility, dscacheutil -q group on macOS, and ldapsearch on Linux can list domain-level groups.","detection":"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.","procedures":["[S0236] Kwampirs: Kwampirs collects a list of domain groups with the command net localgroup /domain.","[G1004] LAPSUS$: LAPSUS$ has used the AD Explorer tool to enumerate groups on a victim's network.","[S0039] Net: Commands such as net group /domain can be used in Net to gather information about and manipulate groups.","[S0521] BloodHound: BloodHound can collect information about domain groups and members.","[S0692] SILENTTRINITY: SILENTTRINITY can use `System.DirectoryServices` namespace to retrieve domain group information.","[C0024] SolarWinds Compromise: During the SolarWinds Compromise, APT29 used AdFind to enumerate domain groups.","[S1138] Gootloader: Gootloader can determine if a targeted system is part of an Active Directory domain by expanding the %USERDNSDOMAIN% environment variable.","[G1022] ToddyCat: ToddyCat has executed `net group \"domain admins\" /dom` for discovery on compromised machines.","[S0417] GRIFFON: GRIFFON has used a reconnaissance module that can be used to retrieve Windows domain membership information.","[G1017] Volt Typhoon: Volt Typhoon has run `net group` in compromised environments to discover domain groups.","[G0049] OilRig: OilRig has used net group /domain, net group “domain admins” /domain, and net group “Exchange Trusted Subsystem” /domain to find domain group permission settings.","[S0552] AdFind: AdFind can enumerate domain groups.","[S0154] Cobalt Strike: Cobalt Strike can identify targets by querying account groups on a domain contoller.","[G0046] FIN7: FIN7 has used the command `net group \"domain admins\" /domain` to enumerate domain groups.","[S0184] POWRUNER: POWRUNER may collect domain group information by running net group /domain or a series of other commands on a victim.","[C0015] C0015: During C0015, the threat actors use the command `net group \"domain admins\" /dom` to enumerate domain groups.","[S1068] BlackCat: BlackCat can determine if a user on a compromised host has domain admin privileges.","[S1063] Brute Ratel C4: Brute Ratel C4 can use `net group` for discovery on targeted domains.","[S0516] SoreFang: SoreFang can enumerate domain groups by executing net.exe group /domain.","[S0165] OSInfo: OSInfo specifically looks for Domain Admins and power users within the domain.","[S0514] WellMess: WellMess can identify domain group membership for the current user.","[S0554] Egregor: Egregor can conduct Active Directory reconnaissance using tools such as Sharphound or AdFind.","[G1032] INC Ransom: INC Ransom has enumerated domain groups on targeted hosts.","[S1081] BADHATCH: BADHATCH can use `net.exe group \"domain admins\" /domain` to identify Domain Administrators.","[G0004] Ke3chang: Ke3chang performs discovery of permission groups net group /domain.","[G0010] Turla: Turla has used net group \"Domain Admins\" /domain to identify domain administrators.","[G0100] Inception: Inception has used specific malware modules to gather domain membership.","[G0035] Dragonfly: Dragonfly has used batch scripts to enumerate administrators and users in the domain.","[S0170] Helminth: Helminth has checked for the domain admin group and Exchange Trusted Subsystem groups using the commands net group Exchange Trusted Subsystem /domain and net group domain admins /domain.","[S1160] Latrodectus: Latrodectus can identify domain groups through `cmd.exe /c net group \"Domain Admins\" /domain`.","[S0488] CrackMapExec: CrackMapExec can gather the user accounts within domain groups.","[S0496] REvil: REvil can identify the domain membership of a compromised host.","[S0105] dsquery: dsquery can be used to gather information on permission groups within a domain."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1069.003","technique_name":"Permission Groups Discovery: Cloud Groups","description":"Adversaries may attempt to find cloud groups and permission settings. The knowledge of cloud permission groups can help adversaries determine the particular roles of users and groups within an environment, as well as which users are associated with a particular group. With authenticated access there are several tools that can be used to find permissions groups. The Get-MsolRole PowerShell cmdlet can be used to obtain roles and permissions groups for Exchange and Office 365 accounts . Azure CLI (AZ CLI) and the Google Cloud Identity Provider API also provide interfaces to obtain permissions groups. The command az ad user get-member-groups will list groups associated to a user account for Azure while the API endpoint GET lists group resources available to a user for Google. In AWS, the commands `ListRolePolicies` and `ListAttachedRolePolicies` allow users to enumerate the policies attached to a role. Adversaries may attempt to list ACLs for objects to determine the owner and other accounts with access to the object, for example, via the AWS GetBucketAcl API . Using this information an adversary can target accounts with permissions to a given object or leverage accounts they have already compromised to access the object.","detection":"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Activity and account logs for the cloud services can also be monitored for suspicious commands that are anomalous compared to a baseline of normal activity.","procedures":["[C0027] C0027: During C0027, Scattered Spider accessed Azure AD to download bulk lists of group members and their Active Directory attributes.","[S0684] ROADTools: ROADTools can enumerate Azure AD groups.","[S0677] AADInternals: AADInternals can enumerate Azure AD groups.","[S1091] Pacu: Pacu can enumerate IAM permissions."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1082","technique_name":"System Information Discovery","description":"An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from System Information Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Tools such as Systeminfo can be used to gather detailed system information. If running with privileged access, a breakdown of system data can be gathered through the systemsetup configuration tool on macOS. As an example, adversaries with user-level access can execute the df -aH command to obtain currently mounted disks and associated freely available space. Adversaries may also leverage a Network Device CLI on network devices to gather detailed system information (e.g. show version). On ESXi servers, threat actors may gather system information from various esxcli utilities, such as `system hostname get`, `system version get`, and `storage filesystem list` (to list storage volumes). Infrastructure as a Service (IaaS) cloud providers such as AWS, GCP, and Azure allow access to instance and virtual machine information via APIs. Successful authenticated API calls can return data such as the operating system platform and status of a particular instance or the model view of a virtual machine. System Information Discovery combined with information gathered from other forms of discovery and reconnaissance can drive payload development and concealment.","detection":"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities based on the information obtained. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Further, Network Device CLI commands may also be used to gather detailed system information with built-in features native to the network device platform. Monitor CLI activity for unexpected or unauthorized use commands being run by non-standard users from non-standard locations. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell. In cloud-based systems, native logging can be used to identify access to certain APIs and dashboards that may contain system information. Depending on how the environment is used, that data alone may not be useful due to benign use during normal operations.","procedures":["[S0339] Micropsia: Micropsia gathers the hostname and OS version from the victim’s machine.","[S0385] njRAT: njRAT enumerates the victim operating system and computer name during the initial infection.","[S1111] DarkGate: DarkGate uses the Delphi methods Sysutils::DiskSize and GlobalMemoryStatusEx to collect disk size and physical memory as part of the malware's anti-analysis checks for running in a virtualized environment. DarkGate will gather various system information such as domain, display adapter description, operating system type and version, processor type, and RAM amount.","[S0266] TrickBot: TrickBot gathers the OS version, machine name, CPU type, amount of RAM available, and UEFI/BIOS firmware information from the victim’s machine.","[S0553] MoleNet: MoleNet can collect information about the about the system.","[S0388] YAHOYAH: YAHOYAH checks for the system’s Windows OS version and hostname.","[S0464] SYSCON: SYSCON has the ability to use Systeminfo to identify system information.","[S0130] Unknown Logger: Unknown Logger can obtain information about the victim computer name, physical memory, country, and date.","[S1151] ZeroCleare: ZeroCleare can use the `IOCTL_DISK_GET_DRIVE_GEOMETRY_EX`, `IOCTL_DISK_GET_DRIVE_GEOMETRY`, and `IOCTL_DISK_GET_LENGTH_INFO` system calls to compute disk size.","[S1039] Bumblebee: Bumblebee can enumerate the OS version and domain on a targeted system.","[S0237] GravityRAT: GravityRAT collects the MAC address, computer name, and CPU information.","[S0211] Linfo: Linfo creates a backdoor through which remote attackers can retrieve system information.","[S0250] Koadic: Koadic can obtain the OS version and build, computer name, and processor architecture from a compromised host.","[S0634] EnvyScout: EnvyScout can determine whether the ISO payload was received by a Windows or iOS device.","[S0674] CharmPower: CharmPower can enumerate the OS version and computer name on a targeted system.","[S0625] Cuba: Cuba can enumerate local drives, disk type, and disk free space.","[S0603] Stuxnet: Stuxnet collects system information including computer and domain names, OS version, and S7P paths.","[G0124] Windigo: Windigo has used a script to detect which Linux distribution and version is currently installed on the system.","[S0254] PLAINTEE: PLAINTEE collects general system enumeration data about the infected machine and checks the OS version.","[S0045] ADVSTORESHELL: ADVSTORESHELL can run Systeminfo to gather information about the victim.","[G1043] BlackByte: BlackByte used various system commands and tools to pull system information during operations.","[S0374] SpeakUp: SpeakUp uses the cat /proc/cpuinfo | grep -c “cpu family” 2>&1 command to gather system information.","[S0462] CARROTBAT: CARROTBAT has the ability to determine the operating system of the compromised host and whether Windows is being run with x86 or x64 architecture.","[S0678] Torisma: Torisma can use `GetlogicalDrives` to get a bitmask of all drives available on a compromised system. It can also use `GetDriveType` to determine if a new drive is a CD-ROM drive.","[S0387] KeyBoy: KeyBoy can gather extended system information, such as information about the operating system, disks, and memory.","[G0049] OilRig: OilRig has run hostname and systeminfo on a victim.","[S0449] Maze: Maze has checked the language of the infected system using the \"GetUSerDefaultUILanguage\" function.","[S0433] Rifdoor: Rifdoor has the ability to identify the Windows version on the compromised host.","[S1129] Akira: Akira uses the GetSystemInfo Windows function to determine the number of processors on a victim machine.","[S0381] FlawedAmmyy: FlawedAmmyy can collect the victim's operating system and computer name during the initial infection.","[G0128] ZIRCONIUM: ZIRCONIUM has used a tool to capture the processor architecture of a compromised host in order to register it with C2.","[S1070] Black Basta: Black Basta can enumerate volumes and collect system boot configuration and CPU information.","[S1141] LunarWeb: LunarWeb can use WMI queries and shell commands such as systeminfo.exe to collect the operating system, BIOS version, and domain name of the targeted system.","[S0252] Brave Prince: Brave Prince collects hard drive content and system configuration information.","[S1030] Squirrelwaffle: Squirrelwaffle has gathered victim computer information and configurations.","[G0096] APT41: APT41 uses multiple built-in commands such as systeminfo and `net config Workstation` to enumerate victim system basic configuration information.","[S1156] Manjusaka: Manjusaka performs basic system profiling actions to fingerprint and register the victim system with the C2 controller.","[S0284] More_eggs: More_eggs has the capability to gather the OS version and computer name.","[S1130] Raspberry Robin: Raspberry Robin performs several system checks as part of anti-analysis mechanisms, including querying the operating system build number, processor vendor and type, video controller, and CPU temperature.","[C0017] C0017: During C0017, APT41 issued `ping -n 1 ((cmd /c dir c:\\|findstr Number).split()[-1]+` commands to find the volume serial number of compromised systems.","[S0564] BlackMould: BlackMould can enumerate local drives on a compromised host.","[S0520] BLINDINGCAN: BLINDINGCAN has collected from a victim machine the system name, processor information, OS version, and disk information, including type and free space available.","[S1037] STARWHALE: STARWHALE can gather the computer name of an infected host.","[S0218] SLOWDRIFT: SLOWDRIFT collects and sends system information to its C2.","[S1085] Sardonic: Sardonic has the ability to collect the computer name, CPU manufacturer name, and C:\\ drive serial number from a compromised machine. Sardonic also has the ability to execute the `ver` and `systeminfo` commands.","[S0482] Bundlore: Bundlore will enumerate the macOS version to determine which follow-on behaviors to execute using /usr/bin/sw_vers -productVersion.","[S0513] LiteDuke: LiteDuke can enumerate the CPUID and BIOS version on a compromised system.","[S0081] Elise: Elise executes systeminfo after initial communication is made to the remote server.","[S0559] SUNBURST: SUNBURST collected hostname and OS version.","[S0493] GoldenSpy: GoldenSpy has gathered operating system information.","[S0472] down_new: down_new has the ability to identify the system volume information of a compromised host.","[S1016] MacMa: MacMa can collect information about a compromised computer, including: Hardware UUID, Mac serial number, macOS version, and disk sizes.","[S0046] CozyCar: A system info module in CozyCar gathers information on the victim host’s configuration.","[S0031] BACKSPACE: During its initial execution, BACKSPACE extracts operating system information from the infected host.","[S1013] ZxxZ: ZxxZ has collected the host name and operating system product name from a compromised machine.","[S0356] KONNI: KONNI can gather the OS version, architecture information, connected drives, hostname, RAM size, and disk space information from the victim’s machine and has used cmd /c systeminfo command to get a snapshot of the current system state of the target machine.","[S0441] PowerShower: PowerShower has collected system information on the infected host.","[S0467] TajMahal: TajMahal has the ability to identify hardware information, the computer name, and OS information on an infected host.","[C0001] Frankenstein: During Frankenstein, the threat actors used Empire to obtain the compromised machine's name.","[S1124] SocGholish: SocGholish has the ability to enumerate system information including the victim computer name.","[S1178] ShrinkLocker: ShrinkLocker uses WMI queries to gather various information about the victim machine and operating system.","[S0567] Dtrack: Dtrack can collect the victim's computer name, hostname and adapter information to create a unique identifier.","[G0108] Blue Mockingbird: Blue Mockingbird has collected hardware details for the victim's system, including CPU and memory information.","[S0457] Netwalker: Netwalker can determine the system architecture it is running on to choose which version of the DLL to use.","[S0657] BLUELIGHT: BLUELIGHT has collected the computer name and OS version from victim machines.","[S1015] Milan: Milan can enumerate the targeted machine's name and GUID.","[G1001] HEXANE: HEXANE has collected the hostname of a compromised machine.","[S0139] PowerDuke: PowerDuke has commands to get information about the victim's name, build, version, serial number, and memory usage.","[C0012] Operation CuckooBees: During Operation CuckooBees, the threat actors used the `systeminfo` command to gather details about a compromised system.","[S0412] ZxShell: ZxShell can collect the local hostname, operating system details, CPU speed, and total physical memory.","[S1073] Royal: Royal can use `GetNativeSystemInfo` and `GetLogicalDrives` to enumerate system processors and logical drives.","[S1019] Shark: Shark can collect the GUID of a targeted machine.","[S0630] Nebulae: Nebulae can discover logical drive information including the drive type, free space, and volume information.","[S0607] KillDisk: KillDisk retrieves the hard disk name by calling the CreateFileA to \\\\.\\PHYSICALDRIVE0 API.","[S0233] MURKYTOP: MURKYTOP has the capability to retrieve information about the OS.","[S0504] Anchor: Anchor can determine the hostname and linux version on a compromised host.","[S0229] Orz: Orz can gather the victim OS version and whether it is 64 or 32 bit.","[S0501] PipeMon: PipeMon can collect and send OS version and computer name as a part of its C2 beacon.","[S0140] Shamoon: Shamoon obtains the victim's operating system version and keyboard layout and sends the information to the C2 server.","[S0065] 4H RAT: 4H RAT sends an OS version identifier in its beacons.","[S0354] Denis: Denis collects OS information and the computer name from the victim’s machine.","[S0373] Astaroth: Astaroth collects the machine name and keyboard language from the system.","[S1020] Kevin: Kevin can enumerate the OS version and hostname of a targeted machine.","[S1172] OilBooster: OilBooster can identify the compromised system's hostname which is used to create a unique identifier.","[G0012] Darkhotel: Darkhotel has collected the hostname, OS version, service pack version, and the processor architecture from the victim’s machine.","[S1081] BADHATCH: BADHATCH can obtain current system information from a compromised machine such as the `SHELL PID`, `PSVERSION`, `HOSTNAME`, `LOGONSERVER`, `LASTBOOTUP`, drive information, OS type/version, bitness, and hostname.","[S1190] Kapeka: Kapeka utilizes WinAPI calls and registry queries to gather system information.","[S0059] WinMM: WinMM collects the system name, OS version including service pack, and system install date and sends the information to the C2 server.","[S1052] DEADEYE: DEADEYE can enumerate a victim computer's volume serial number and host name.","[G1018] TA2541: TA2541 has collected system information prior to downloading malware on the targeted host.","[S1065] Woody RAT: Woody RAT can retrieve the following information from an infected machine: OS, architecture, computer name, OS build version, environment variables, and storage drives.","[S0051] MiniDuke: MiniDuke can gather the hostname on a compromised machine.","[G1016] FIN13: FIN13 has collected local host information by utilizing Windows commands `systeminfo`, `fsutil`, and `fsinfo`. FIN13 has also utilized a compromised Symantex Altiris console and LanDesk account to retrieve host information.","[S0086] ZLib: ZLib has the ability to enumerate system information.","[G0106] Rocke: Rocke has used uname -m to collect the name and information about the infected system's kernel.","[S0259] InnaputRAT: InnaputRAT gathers volume drive information and system information.","[S0486] Bonadan: Bonadan has discovered the OS version, CPU model, and RAM size of the system it has been installed on.","[S0687] Cyclops Blink: Cyclops Blink has the ability to query device information.","[S0180] Volgmer: Volgmer can gather system information, the computer name, OS version, drive and serial information from the victim's machine.","[G0047] Gamaredon Group: A Gamaredon Group file stealer can gather the victim's computer name and drive serial numbers to send to a C2 server.","[S0670] WarzoneRAT: WarzoneRAT can collect compromised host information, including OS version, PC name, RAM size, and CPU details.","[S0186] DownPaper: DownPaper collects the victim host name and serial number, and then sends the information to the C2 server.","[S0363] Empire: Empire can enumerate host system information like OS, architecture, domain name, applied patches, and more.","[S1068] BlackCat: BlackCat can obtain the computer name and UUID, and enumerate local drives.","[C0049] Leviathan Australian Intrusions: Leviathan performed host enumeration and data gathering operations on victim machines during Leviathan Australian Intrusions.","[S0391] HAWKBALL: HAWKBALL can collect the OS version, architecture information, and computer name.","[S0242] SynAck: SynAck gathers computer names, OS version info, and also checks installed keyboard layouts to estimate if it has been launched from a certain list of countries.","[G0067] APT37: APT37 collects the computer name, the BIOS model, and execution path.","[S0568] EVILNUM: EVILNUM can obtain the computer name from the victim's system.","[S0217] SHUTTERSPEED: SHUTTERSPEED can collect system information.","[S0156] KOMPROGO: KOMPROGO is capable of retrieving information about the infected system.","[G0050] APT32: APT32 has collected the OS version and computer name from victims. One of the group's backdoors can also query the Windows Registry to gather system information, and another macOS backdoor performs a fingerprint of the machine on its first connection to the C&C server. APT32 executed shellcode to identify the name of the infected host.","[S1087] AsyncRAT: AsyncRAT can check the disk size through the values obtained with `DeviceInfo.`","[S0646] SpicyOmelette: SpicyOmelette can identify the system name of a compromised host.","[S0280] MirageFox: MirageFox can collect CPU and architecture information from the victim’s machine.","[S0262] QuasarRAT: QuasarRAT can gather system information from the victim’s machine including the OS type.","[S0098] T9000: T9000 gathers and beacons the operating system build number and CPU Architecture (32-bit/64-bit) during installation.","[S1066] DarkTortilla: DarkTortilla can obtain system information by querying the `Win32_ComputerSystem`, `Win32_BIOS`, `Win32_MotherboardDevice`, `Win32_PnPEntity`, and `Win32_DiskDrive` WMI objects.","[S0690] Green Lambert: Green Lambert can use `uname` to identify the operating system name, version, and processor type.","[S0088] Kasidet: Kasidet has the ability to obtain a victim's system name and operating system version.","[S1169] Mango: Mango can collect the machine name of a compromised system which is later used as part of a unique victim identifier.","[S0082] Emissary: Emissary has the capability to execute ver and systeminfo commands.","[S0649] SMOKEDHAM: SMOKEDHAM has used the systeminfo command on a compromised host.","[G0100] Inception: Inception has used a reconnaissance module to gather information about the operating system and hardware on the infected host.","[S0267] FELIXROOT: FELIXROOT collects the victim’s computer name, processor architecture, OS version, volume serial number, and system type.","[S0203] Hydraq: Hydraq creates a backdoor through which remote attackers can retrieve information such as computer name, OS version, processor speed, memory size, and CPU speed.","[S0115] Crimson: Crimson contains a command to collect the victim PC name, disk drive information, and operating system.","[S1122] Mispadu: Mispadu collects the OS version, computer name, and language ID.","[S1031] PingPull: PingPull can retrieve the hostname of a compromised host.","[S0283] jRAT: jRAT collects information about the OS (version, build type, install date) as well as system up-time upon receiving a connection from a backdoor.","[S0223] POWERSTATS: POWERSTATS can retrieve OS name/architecture and computer/domain name information from compromised hosts.","[S1018] Saint Bot: Saint Bot can identify the OS version, CPU, and other details from a victim's machine.","[G0032] Lazarus Group: Several Lazarus Group malware families collect information on the type and version of the victim OS, as well as the victim computer name and CPU information. A Destover-like variant used by Lazarus Group also collects disk space information and sends it to its C2 server.","[S0512] FatDuke: FatDuke can collect the user name, Windows version, computer name, and available space on discs from a compromised host.","[C0047] RedDelta Modified PlugX Infection Chain Operations: Mustang Panda captured victim operating system type via User Agent analysis during RedDelta Modified PlugX Infection Chain Operations.","[G1017] Volt Typhoon: Volt Typhoon has discovered file system types, drive names, size, and free space on compromised systems.","[S0337] BadPatch: BadPatch collects the OS system, OS version, MAC address, and the computer name from the victim’s machine.","[S0667] Chrommme: Chrommme has the ability to list drives and obtain the computer name of a compromised host.","[S0137] CORESHELL: CORESHELL collects hostname, volume serial number and OS version data from the victim and sends the information to its C2 server.","[G1009] Moses Staff: Moses Staff collected information about the infected host, including the machine names and OS architecture.","[S0665] ThreatNeedle: ThreatNeedle can collect system profile information from a compromised host.","[S0060] Sys10: Sys10 collects the computer name, OS versioning information, and OS install date and sends the information to the C2.","[S0239] Bankshot: Bankshot gathers system information, network addresses, disk type, disk free space, and the operation system version.","[S0669] KOCTOPUS: KOCTOPUS has checked the OS version using `wmic.exe` and the `find` command.","[S0271] KEYMARBLE: KEYMARBLE has the capability to collect the computer name, language settings, the OS version, CPU information, disk devices, and time elapsed since system start.","[S0352] OSX_OCEANLOTUS.D: OSX_OCEANLOTUS.D collects processor information, memory information, computer name, hardware UUID, serial number, and operating system version. OSX_OCEANLOTUS.D has used the ioreg command to gather some of this information.","[S0496] REvil: REvil can identify the username, machine name, system language, keyboard layout, OS version, and system drive information on a compromised host.","[S0378] PoshC2: PoshC2 contains modules, such as Get-ComputerInfo, for enumerating common system information.","[S0094] Trojan.Karagany: Trojan.Karagany can capture information regarding the victim's OS, security, and hardware configuration.","[S0448] Rising Sun: Rising Sun can detect the computer name, operating system, and drive information, including drive type, total number of bytes on disk, total number of free bytes on disk, and name of a specified volume.","[S0157] SOUNDBITE: SOUNDBITE is capable of gathering system information.","[S0021] Derusbi: Derusbi gathers the name of the local host, version of GNU Compiler Collection (GCC), and the system information about the CPU, machine, and operating system.","[S0181] FALLCHILL: FALLCHILL can collect operating system (OS) version information, processor information, system name, and information about installed disks from the victim.","[S0514] WellMess: WellMess can identify the computer name of a compromised host.","[S0015] Ixeshe: Ixeshe collects the computer name of the victim's system during the initial infection.","[S0350] zwShell: zwShell can obtain the victim PC name and OS version.","[S0382] ServHelper: ServHelper will attempt to enumerate Windows version and system architecture.","[S0456] Aria-body: Aria-body has the ability to identify the hostname, computer name, Windows version, processor speed, machine GUID, and disk information on a compromised host.","[S0251] Zebrocy: Zebrocy collects the OS version, computer name and serial number for the storage volume C:\\. Zebrocy also runs the systeminfo command to gather system information.","[S0334] DarkComet: DarkComet can collect the computer name, RAM used, and operating system version from the victim’s machine.","[S0642] BADFLICK: BADFLICK has captured victim computer name, memory space, and CPU details.","[G0126] Higaisa: Higaisa collected the system volume serial number, GUID, and computer name.","[S1199] LockBit 2.0: LockBit 2.0 can enumerate system information including hostname, domain information, and local drive configuration.","[G1012] CURIUM: CURIUM deploys information gathering tools focused on capturing IP configuration, running application, system information, and network connectivity information.","[S0091] Epic: Epic collects the OS version, hardware information, computer name, available system memory status, disk space information, and system and user language settings.","[S0417] GRIFFON: GRIFFON has used a reconnaissance module that can be used to retrieve information about a victim's computer, including the resolution of the workstation .","[S0379] Revenge RAT: Revenge RAT collects the CPU information, OS information, and system language.","[S0214] HAPPYWORK: can collect system information, including computer name, system manufacturer, IsDebuggerPresent state, and execution path.","[S1139] INC Ransomware: INC Ransomware can discover and mount hidden drives to encrypt them.","[S0531] Grandoreiro: Grandoreiro can collect the computer name and OS version from a compromised host.","[S1027] Heyoka Backdoor: Heyoka Backdoor can enumerate drives on a compromised host.","[S0627] SodaMaster: SodaMaster can enumerate the host name and OS version on a target system.","[S1155] Covenant: Covenant implants can gather basic information on infected systems.","[S0017] BISCUIT: BISCUIT has a command to collect the processor type, operation system, computer name, and whether the system is a laptop or PC.","[S0264] OopsIE: OopsIE checks for information on the CPU fan, temperature, mouse, hard disk, and motherboard as part of its anti-VM checks.","[S0693] CaddyWiper: CaddyWiper can use `DsRoleGetPrimaryDomainInformation` to determine the role of the infected machine. CaddyWiper can also halt execution if the compromised host is identified as a domain controller.","[G1026] Malteiro: Malteiro collects the machine information, system architecture, the OS version, computer name, and Windows product name.","[S1185] LightSpy: LightSpy's second stage implant uses the `DeviceInformation` class to collect system information, including CPU usage, battery statistics, memory allocations, screen size, etc.","[S1086] Snip3: Snip3 has the ability to query `Win32_ComputerSystem` for system information.","[S0487] Kessel: Kessel has collected the system architecture, OS version, and MAC address information.","[S1107] NKAbuse: NKAbuse conducts multiple system checks and includes these in subsequent \"heartbeat\" messages to the malware's command and control server.","[S0439] Okrum: Okrum can collect computer name, locale information, and information about the OS and architecture.","[S1100] Ninja: Ninja can obtain the computer name and information on the OS and physical drives from targeted hosts.","[S0468] Skidmap: Skidmap has the ability to check whether the infected system’s OS is Debian or RHEL/CentOS to determine which cryptocurrency miner it should use.","[S0584] AppleJeus: AppleJeus has collected the victim host information after infection.","[S0205] Naid: Naid collects a unique identifier (UID) from a compromised host.","[S0395] LightNeuron: LightNeuron gathers the victim computer name using the Win32 API call GetComputerName.","[S1145] Pikabot: Pikabot performs a variety of system checks and gathers system information, including commands such as whoami.","[S1048] macOS.OSAMiner: macOS.OSAMiner can gather the device serial number and has checked to ensure there is enough disk space using the Unix utility `df`.","[S0149] MoonWind: MoonWind can obtain the victim hostname, Windows version, RAM amount, number of drives, and screen resolution.","[S0155] WINDSHIELD: WINDSHIELD can gather the victim computer name.","[S0106] cmd: cmd can be used to find information about the operating system.","[S0165] OSInfo: OSInfo discovers information about the infected machine.","[S0340] Octopus: Octopus can collect system drive information, the computer name, the size of the disk, OS version, and OS architecture information.","[S0516] SoreFang: SoreFang can collect the hostname, operating system configuration, product ID, and disk space on victim machines by executing Systeminfo.","[S0585] Kerrdown: Kerrdown has the ability to determine if the compromised host is running a 32 or 64 bit OS architecture.","[S0635] BoomBox: BoomBox can enumerate the hostname, domain, and IP of a compromised host.","[S1152] IMAPLoader: IMAPLoader uses WMI queries to gather information about the victim machine.","[S0428] PoetRAT: PoetRAT has the ability to gather information about the compromised host.","[S0142] StreamEx: StreamEx has the ability to enumerate system information.","[S0622] AppleSeed: AppleSeed can identify the OS version of a targeted system.","[S0644] ObliqueRAT: ObliqueRAT has the ability to check for blocklisted computer names on infected endpoints.","[S0272] NDiskMonitor: NDiskMonitor obtains the victim computer name and encrypts the information to send over its C2 channel.","[S0652] MarkiRAT: MarkiRAT can obtain the computer name from a compromised host.","[S0113] Prikormka: A module in Prikormka collects information from the victim about Windows OS version, computer name, battery info, and physical memory.","[S0376] HOPLIGHT: HOPLIGHT has been observed collecting victim machine information like OS version, volume information, and more.","[S0048] PinchDuke: PinchDuke gathers system configuration information.","[S0476] Valak: Valak can determine the Windows version and computer name on a compromised host.","[S0230] ZeroT: ZeroT gathers the victim's computer name, Windows version, and system language, and then sends it to its C2 server.","[S0192] Pupy: Pupy can grab a system’s information including the OS version, architecture, etc.","[S1210] Sagerunex: Sagerunex gathers information from the infected system such as hostname.","[S1138] Gootloader: Gootloader can inspect the User-Agent string in GET request header information to determine the operating system of targeted systems.","[S0543] Spark: Spark can collect the hostname, keyboard layout, and language from the system.","[S0085] S-Type: The initial beacon packet for S-Type contains the operating system version and file system of the victim.","[S1180] BlackByte Ransomware: BlackByte Ransomware gathers victim system information to generate a unique victim identifier.","[S0601] Hildegard: Hildegard has collected the host's OS, CPU, and memory information.","[G0142] Confucius: Confucius has used a file stealer that can examine system drives, including those other than the C drive.","[S0458] Ramsay: Ramsay can detect system information--including disk names, total space, and remaining space--to create a hardware profile GUID which acts as a system identifier for operators.","[S0410] Fysbis: Fysbis has used the command ls /etc | egrep -e\"fedora\\*|debian\\*|gentoo\\*|mandriva\\*|mandrake\\*|meego\\*|redhat\\*|lsb-\\*|sun-\\*|SUSE\\*|release\" to determine which Linux OS version is running.","[S0355] Final1stspy: Final1stspy obtains victim Microsoft Windows version information and CPU architecture.","[S0461] SDBbot: SDBbot has the ability to identify the OS version, OS bit information and computer name.","[S0556] Pay2Key: Pay2Key has the ability to gather the hostname of the victim machine.","[S1167] AcidPour: AcidPour can identify various system locations and mapped devices on Linux systems as a precursor to wiping activity.","[G1039] RedCurl: RedCurl has collected information about the target system, such as system information and list of network connections.","[S0666] Gelsemium: Gelsemium can determine the operating system and whether a targeted machine has a 32 or 64 bit architecture.","[G0082] APT38: APT38 has attempted to get detailed information about a compromised host, including the operating system, version, patches, hotfixes, and service packs.","[S0215] KARAE: KARAE can collect system information.","[S0475] BackConfig: BackConfig has the ability to gather the victim's computer name.","[S0697] HermeticWiper: HermeticWiper can determine the OS version, bitness, and enumerate physical drives on a targeted host.","[S0083] Misdat: The initial beacon packet for Misdat contains the operating system version of the victim.","[S1078] RotaJakiro: RotaJakiro executes a set of commands to collect device information, including `uname`. Another example is the `cat /etc/*release | uniq` command used to collect the current OS distribution.","[G0129] Mustang Panda: Mustang Panda has gathered system information using systeminfo.","[S0245] BADCALL: BADCALL collects the computer name and host name on the compromised system.","[S0346] OceanSalt: OceanSalt can collect the computer name from the system.","[S0663] SysUpdate: SysUpdate can collect a system's architecture, operating system version, hostname, and drive information.","[S0247] NavRAT: NavRAT uses systeminfo on a victim’s machine.","[S0455] Metamorfo: Metamorfo has collected the hostname and operating system version from the compromised host.","[S0660] Clambling: Clambling can discover the hostname, computer name, and Windows version of a targeted machine.","[C0006] Operation Honeybee: During Operation Honeybee, the threat actors collected the computer name, OS, and other system information using `cmd /c systeminfo > %temp%\\ temp.ini`.","[S0265] Kazuar: Kazuar gathers information on the system and local drives.","[S0453] Pony: Pony has collected the Service Pack, language, and region information to send to the C2.","[S1166] Solar: Solar can send basic information about the infected host to C2.","[S0275] UPPERCUT: UPPERCUT has the capability to gather the system’s hostname and OS version.","[S0141] Winnti for Windows: Winnti for Windows can determine if the OS on a compromised host is newer than Windows XP.","[S0414] BabyShark: BabyShark has executed the ver command.","[S0260] InvisiMole: InvisiMole can gather information on the mapped drives, OS version, computer name, DEP policy, memory size, and system volume serial number.","[S1060] Mafalda: Mafalda can collect the computer name and enumerate all drives on a compromised host.","[S1202] LockBit 3.0: LockBit 3.0 can enumerate system hostname, domain, and local drive configuration.","[S0380] StoneDrill: StoneDrill has the capability to discover the system OS, Windows version, architecture and environment.","[S0238] Proxysvc: Proxysvc collects the OS version, country name, MAC address, computer name, physical memory statistics, and volume information for all drives on the system.","[G0094] Kimsuky: Kimsuky has enumerated drives, OS type, OS version, and other information using a script or the \"systeminfo\" command.","[S1029] AuTo Stealer: AuTo Stealer has the ability to collect the hostname and OS information from an infected host.","[S1200] StealBit: StealBit can enumerate the computer name and domain membership of the compromised system.","[S0617] HELLOKITTY: HELLOKITTY can enumerate logical drives on a target system.","[S0125] Remsec: Remsec can obtain the OS version information, computer name, processor architecture, machine role, and OS edition.","[S1034] StrifeWater: StrifeWater can collect the OS version, architecture, and machine name to create a unique token for the infected host.","[S0460] Get2: Get2 has the ability to identify the computer name and Windows version of an infected host.","[G0069] MuddyWater: MuddyWater has used malware that can collect the victim’s OS version and machine name.","[S0446] Ryuk: Ryuk has called GetLogicalDrives to emumerate all mounted drives, and GetDriveTypeW to determine the drive type.","[S0402] OSX/Shlayer: OSX/Shlayer has collected the IOPlatformUUID, session UID, and the OS version using the command sw_vers -productVersion.","[S0384] Dridex: Dridex has collected the computer name and OS architecture information from the system.","[S0451] LoudMiner: LoudMiner has monitored CPU usage.","[S0546] SharpStage: SharpStage has checked the system settings to see if Arabic is the configured language.","[S0199] TURNEDUP: TURNEDUP is capable of gathering system information.","[S0171] Felismus: Felismus collects the system information, including hostname and OS version, and sends it to the C2 server.","[S0079] MobileOrder: MobileOrder has a command to upload to its C2 server victim mobile device information, including IMEI, IMSI, SIM card serial number, phone number, Android version, and other information.","[S0144] ChChes: ChChes collects the victim hostname, window resolution, and Microsoft Windows version.","[S0022] Uroburos: Uroburos has the ability to gather basic system information and run the POSIX API `gethostbyname`.","[S1168] SampleCheck5000: SampleCheck5000 can create unique victim identifiers by using the compromised system’s volume ID or computer name.","[S1150] ROADSWEEP: ROADSWEEP can enumerate logical drives on targeted devices.","[G0139] TeamTNT: TeamTNT has searched for system version, architecture, disk partition, logical volume, and hostname information.","[S1025] Amadey: Amadey has collected the computer name and OS version from a compromised machine.","[S0491] StrongPity: StrongPity can identify the hard disk volume serial number on a compromised host.","[S0471] build_downer: build_downer has the ability to send system volume information to C2.","[S1196] Troll Stealer: Troll Stealer can collect local system information.","[S0184] POWRUNER: POWRUNER may collect information about the system by running hostname and systeminfo on a victim.","[S0236] Kwampirs: Kwampirs collects OS version information such as registered owner details, manufacturer details, processor type, available storage, installed patches, hostname, version info, system date, and other system information by using the commands systeminfo, net config workstation, hostname, ver, set, and date /t.","[S0153] RedLeaves: RedLeaves can gather extended system information including the hostname, OS version number, platform, memory information, time elapsed since system startup, and CPU information.","[S0447] Lokibot: Lokibot has the ability to discover the computer name and Windows product name/version.","[S0681] Lizar: Lizar can collect the computer name from the machine,.","[S0248] yty: yty gathers the computer name, the serial number of the main disk volume, CPU information, Microsoft Windows version, and runs the command systeminfo.","[S1160] Latrodectus: Latrodectus can gather operating system information.","[S0201] JPIN: JPIN can obtain system information such as OS version and disk space.","[C0044] Juicy Mix: During Juicy Mix, OilRig used a script to send the name of the compromised host via HTTP `POST` to register it with C2.","[S0532] Lucifer: Lucifer can collect the computer name, system architecture, default language, and processor frequency of a compromised host.","[S0084] Mis-Type: The initial beacon packet for Mis-Type contains the operating system version and file system of the victim.","[S0032] gh0st RAT: gh0st RAT has gathered system architecture, processor, OS configuration, and installed hardware information.","[G0022] APT3: APT3 has a tool that can obtain information about the local system.","[C0024] SolarWinds Compromise: During the SolarWinds Compromise, APT29 used `fsutil` to check available free space before executing actions that might create large files on disk.","[S0253] RunningRAT: RunningRAT gathers the OS version, logical drives information, processor information, and volume information.","[S0244] Comnie: Comnie collects the hostname of the victim machine.","[G0121] Sidewinder: Sidewinder has used tools to collect the computer name, OS version, installed hotfixes, as well as information regarding the memory and processor on a compromised host.","[S1075] KOPILUWAK: KOPILUWAK can discover logical drive information on compromised hosts.","[S0234] Bandook: Bandook can collect information about the drives available on the system.","[S0331] Agent Tesla: Agent Tesla can collect the system's computer name and also has the capability to collect information on the processor, memory, OS, and video card from the system.","[S0689] WhisperGate: WhisperGate has the ability to enumerate fixed logical drives on a targeted system.","[G0059] Magic Hound: Magic Hound malware has used a PowerShell command to check the victim system architecture to determine if it is an x64 machine. Other malware has obtained the OS version, UUID, and computer/host name to send to the C2 server.","[G1034] Daggerfly: Daggerfly utilizes victim machine operating system information to create custom User Agent strings for subsequent command and control communication.","[S1142] LunarMail: LunarMail can capture environmental variables on compromised hosts.","[S0572] Caterpillar WebShell: Caterpillar WebShell has a module to gather information from the compromised asset, including the computer version, computer name, IIS version, and more.","[S0386] Ursnif: Ursnif has used Systeminfo to gather system information.","[G1040] Play: Play has leveraged tools to enumerate system information.","[S1182] MagicRAT: MagicRAT collects basic system information from victim machines.","[C0014] Operation Wocao: During Operation Wocao, threat actors discovered the local disks attached to the system and their hardware information including manufacturer and model, as well as the OS versions of systems connected to a targeted network.","[S0672] Zox: Zox can enumerate attached drives.","[S1064] SVCReady: SVCReady has the ability to collect information such as computer name, computer manufacturer, BIOS, operating system, and firmware, including through the use of `systeminfo.exe`.","[S0062] DustySky: DustySky extracts basic information about the operating system.","[S0569] Explosive: Explosive has collected the computer name from the infected host.","[S0096] Systeminfo: Systeminfo can be used to gather information about the operating system.","[S0691] Neoichor: Neoichor can collect the OS version and computer name from a compromised host.","[S1089] SharpDisco: SharpDisco can use a plugin to enumerate system drives.","[G1044] APT42: APT42 has used malware, such as GHAMBAR and POWERPOST, to collect system information.","[S0249] Gold Dragon: Gold Dragon collects endpoint information using the systeminfo command.","[S0024] Dyre: Dyre has the ability to identify the computer name, OS version, and hardware configuration on a compromised host.","[G1008] SideCopy: SideCopy has identified the OS version of a compromised host.","[C0029] Cutting Edge: During Cutting Edge, threat actors used the ENUM4LINUX Perl script for discovery on Windows and Samba hosts.","[G0114] Chimera: Chimera has used `fsutil fsinfo drives`, `systeminfo`, and `vssadmin list shadows` for system information including shadow volumes and drive information.","[S0688] Meteor: Meteor has the ability to discover the hostname of a compromised host.","[G0073] APT19: APT19 collected system architecture information. APT19 used an HTTP malware variant and a Port 22 malware variant to gather the hostname and CPU information from the victim’s machine.","[S0488] CrackMapExec: CrackMapExec can enumerate the system drives and associated system name.","[S1184] BOLDMOVE: BOLDMOVE performs system survey actions following initial execution.","[G0026] APT18: APT18 can collect system information from the victim’s machine.","[S0208] Pasam: Pasam creates a backdoor through which remote attackers can retrieve information such as hostname and free disk space.","[S0348] Cardinal RAT: Cardinal RAT can collect the hostname, Microsoft Windows version, and processor architecture from a victim machine.","[S0679] Ferocious: Ferocious can use GET.WORKSPACE in Microsoft Excel to determine the OS version of the compromised host.","[S0445] ShimRatReporter: ShimRatReporter gathered the operating system name and specific Windows version of an infected machine.","[S0148] RTM: RTM can obtain the computer name, OS version, and default language identifier.","[S1028] Action RAT: Action RAT has the ability to collect the hostname, OS version, and OS architecture of an infected host.","[G0061] FIN8: FIN8 has used PowerShell Scripts to check the architecture of a compromised machine before the selection of a 32-bit or 64-bit version of a malicious .NET loader.","[S1022] IceApple: The IceApple Server Variable Dumper module iterates over all server variables present for the current request and returns them to the adversary.","[S0658] XCSSET: XCSSET identifies the macOS version and uses ioreg to determine serial number.","[S1207] XLoader: XLoader can collect system information and supported language information from the victim machine.","[S0659] Diavol: Diavol can collect the computer name and OS version from the system.","[G0081] Tropic Trooper: Tropic Trooper has detected a target system’s OS version and system volume information.","[S0268] Bisonal: Bisonal has used commands and API calls to gather system information.","[G0143] Aquatic Panda: Aquatic Panda has used native OS commands to understand privilege levels and system details.","[S0240] ROKRAT: ROKRAT can gather the hostname and the OS version to ensure it doesn’t run on a Windows XP or Windows Server 2003 systems.","[S0604] Industroyer: Industroyer collects the victim machine’s Windows GUID.","[G1035] Winter Vivern: Winter Vivern script execution includes basic victim information gathering steps which are then transmitted to command and control servers.","[S0263] TYPEFRAME: TYPEFRAME can gather the disk volume information.","[S0596] ShadowPad: ShadowPad has discovered system information including memory status, CPU frequency, OS versions, and volume serial numbers.","[S1198] Gomir: Gomir collects information on infected systems such as hostname, username, CPU, and RAM information.","[S1026] Mongall: Mongall can identify drives on compromised hosts and retrieve the hostname via `gethostbyname`.","[S0650] QakBot: QakBot can collect system information including the OS version and domain on a compromised host.","[S0151] HALFBAKED: HALFBAKED can obtain information about the OS, processor, and BIOS.","[S0610] SideTwist: SideTwist can collect the computer name of a targeted system.","[S0662] RCSession: RCSession can gather system information from a compromised host.","[S0454] Cadelspy: Cadelspy has the ability to discover information about the compromised host.","[S0409] Machete: Machete collects the hostname of the target computer.","[S0270] RogueRobin: RogueRobin gathers BIOS versions and manufacturers, the number of CPU cores, the total physical memory, and the computer name.","[S1159] DUSTTRAP: DUSTTRAP reads the value of the infected system's `HKLM\\SYSTEM\\Microsoft\\Cryptography\\MachineGUID` value.","[S0647] Turian: Turian can retrieve system information including OS version, memory usage, local hostname, and system adapter information.","[S0330] Zeus Panda: Zeus Panda collects the OS version, system architecture, computer name, product ID, install date, and information on the keyboard mapping to determine the language used on the system.","[S0484] Carberp: Carberp has collected the operating system version from the infected system.","[S0182] FinFisher: FinFisher checks if the victim OS is 32 or 64-bit.","[S0526] KGH_SPY: KGH_SPY can collect drive information from a compromised host.","[S0450] SHARPSTATS: SHARPSTATS has the ability to identify the IP address, machine name, and OS of the compromised host.","[S1183] StrelaStealer: StrelaStealer variants collect victim system information for exfiltration.","[S0638] Babuk: Babuk can enumerate disk volumes, get disk information, and query service status.","[G1020] Mustard Tempest: Mustard Tempest has used implants to perform system reconnaissance on targeted systems.","[S1147] Nightdoor: Nightdoor gathers information on the victim system such as CPU and Computer name as well as device drivers. Nightdoor can also collect information about disk drives, their total and free space, and file system type.","[S0547] DropBook: DropBook has checked for the presence of Arabic language in the infected machine's settings.","[S0044] JHUHUGIT: JHUHUGIT obtains a build identifier as well as victim hard drive information from Windows registry key HKLM\\SYSTEM\\CurrentControlSet\\Services\\Disk\\Enum. Another JHUHUGIT variant gathers the victim storage volume serial number and the storage device name.","[S0586] TAINTEDSCRIBE: TAINTEDSCRIBE can use DriveList to retrieve drive information.","[G0054] Sowbug: Sowbug obtained OS version and hardware configuration from a victim.","[G0102] Wizard Spider: Wizard Spider has used Systeminfo and similar commands to acquire detailed configuration information of a victim's machine. Wizard Spider has also utilized the PowerShell cmdlet `Get-ADComputer` to collect DNS hostnames, last logon dates, and operating system information from Active Directory.","[G0010] Turla: Turla surveys a system upon check-in to discover operating system configuration details using the systeminfo and set commands.","[C0046] ArcaneDoor: ArcaneDoor included collection of victim device configuration information.","[S0587] Penquin: Penquin can report the file system type and disk space of a compromised host to C2.","[S0198] NETWIRE: NETWIRE can discover and collect victim system information.","[S0431] HotCroissant: HotCroissant has the ability to determine if the current user is an administrator, Windows product name, processor name, screen resolution, and physical RAM of the infected host.","[C0035] KV Botnet Activity: KV Botnet Activity includes use of native system tools, such as uname, to obtain information about victim device architecture, as well as gathering other system information such as the victim's hosts file and CPU utilization.","[S0344] Azorult: Azorult can collect the machine information, system architecture, the OS version, computer name, Windows product name, the number of CPU cores, video card information, and the system language.","[S1186] Line Dancer: Line Dancer can gather system configuration information by running the native `show configuration` command.","[S1148] Raccoon Stealer: Raccoon Stealer gathers information on infected systems such as operating system, processor information, RAM, and display information.","[S0616] DEATHRANSOM: DEATHRANSOM can enumerate logical drives on a target system.","[G0040] Patchwork: Patchwork collected the victim computer name, OS version, and architecture type and sent the information to its C2 server. Patchwork also enumerated all available drives on the victim's machine.","[G0112] Windshift: Windshift has used malware to identify the computer name of a compromised host.","[S0043] BUBBLEWRAP: BUBBLEWRAP collects system information, including the operating system version and hostname.","[S0257] VERMIN: VERMIN collects the OS name, machine name, and architecture information.","[G0018] admin@338: admin@338 actors used the following commands after exploiting a machine with LOWBALL malware to obtain information about the OS: ver >> %temp%\\download systeminfo >> %temp%\\download","[S0161] XAgentOSX: XAgentOSX contains the getInstalledAPP function to run ls -la /Applications to gather what applications are installed.","[S0228] NanHaiShu: NanHaiShu can gather the victim computer name and serial number.","[S0196] PUNCHBUGGY: PUNCHBUGGY can gather system information such as computer names.","[S0673] DarkWatchman: DarkWatchman can collect the OS version, system architecture, and computer name.","[S0219] WINERACK: WINERACK can gather information about the host.","[S0124] Pisloader: Pisloader has a command to collect victim system information, including the system name and OS version.","[S0172] Reaver: Reaver collects system information from the victim, including CPU speed, computer name, volume serial number, ANSI code page, OEM code page identifier for the OS, Microsoft Windows version, and memory information.","[S0631] Chaes: Chaes has collected system information, including the machine name and OS version.","[S1153] Cuckoo Stealer: Cuckoo Stealer can gather information about the OS version and hardware on compromised hosts.","[S0632] GrimAgent: GrimAgent can collect the OS, and build version on a compromised host.","[S0353] NOKKI: NOKKI can gather information on drives and the operating system on the victim’s machine.","[S0089] BlackEnergy: BlackEnergy has used Systeminfo to gather the OS version, as well as information on the system configuration, BIOS, the motherboard, and the processor.","[G1022] ToddyCat: ToddyCat has collected information on bootable drives including model, vendor, and serial numbers.","[G0038] Stealth Falcon: Stealth Falcon malware gathers system information via WMI, including the system directory, build number, serial number, version, manufacturer, model, and total physical memory.","[S0641] Kobalos: Kobalos can record the hostname and kernel version of the target machine.","[S0554] Egregor: Egregor can perform a language check of the infected system and can query the CPU information (cupid).","[S1044] FunnyDream: FunnyDream can enumerate all logical drives on a targeted machine.","[S0216] POORAIM: POORAIM can identify system information, including battery status.","[S0093] Backdoor.Oldrea: Backdoor.Oldrea collects information about the OS and computer name.","[S0483] IcedID: IcedID has the ability to identify the computer name and OS version on a compromised host.","[S0241] RATANKBA: RATANKBA gathers information about the OS architecture, OS name, and OS version/Service pack.","[S1121] LITTLELAMB.WOOLTEA: LITTLELAMB.WOOLTEA can check the type of Ivanti VPN device it is running on by executing `first_run()` to identify the first four bytes of the motherboard serial number.","[S1212] RansomHub: RansomHub can retrieve information about virtual machines.","[G1036] Moonstone Sleet: Moonstone Sleet has gathered information on victim systems.","[S0534] Bazar: Bazar can fingerprint architecture, computer name, and OS version on the compromised host. Bazar can also check if the Russian language is installed on the infected machine and terminate if it is found.","[G0034] Sandworm Team: Sandworm Team used a backdoor to enumerate information about the infected system's operating system.","[G0004] Ke3chang: Ke3chang performs operating system information discovery using systeminfo and has used implants to identify the system language and computer name.","[S0533] SLOTHFULMEDIA: SLOTHFULMEDIA has collected system name, OS version, adapter information, memory usage, and disk information from a victim machine.","[S0680] LitePower: LitePower has the ability to list local drives and enumerate the OS architecture.","[S0351] Cannon: Cannon can gather system information from the victim’s machine such as the OS version, machine name, and drive information.","[S0105] dsquery: dsquery has the ability to enumerate various information, such as the operating system and host name, for systems within a domain.","[S0438] Attor: Attor monitors the free disk space on the system.","[S0692] SILENTTRINITY: SILENTTRINITY can collect information related to a compromised host, including OS version and a list of drives.","[S0058] SslMM: SslMM sends information to its hard-coded C2, including OS version, service pack information, processor speed, system name, and OS install date.","[S0473] Avenger: Avenger has the ability to identify the host volume ID and the OS architecture on a compromised host.","[S1059] metaMain: metaMain can collect the computer name from a compromised host.","[C0007] FunnyDream: During FunnyDream, the threat actors used Systeminfo to collect information on targeted hosts.","[S0176] Wingbird: Wingbird checks the victim OS version after executing to determine where to drop files based on whether the victim is 32-bit or 64-bit.","[S1213] Lumma Stealer: Lumma Stealer has gathered various system information from victim machines.","[S0615] SombRAT: SombRAT can execute getinfo to enumerate the computer name and OS version of a compromised system."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1083","technique_name":"File and Directory Discovery","description":"Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system. Adversaries may use the information from File and Directory Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Many command shell utilities can be used to obtain this information. Examples include dir, tree, ls, find, and locate. Custom tools may also be used to gather file and directory information and interact with the Native API. Adversaries may also leverage a Network Device CLI on network devices to gather file and directory information (e.g. dir, show flash, and/or nvram). Some files and directories may require elevated or specific user permissions to access.","detection":"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Collection and Exfiltration, based on the information obtained. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell. Further, Network Device CLI commands may also be used to gather file and directory information with built-in features native to the network device platform. Monitor CLI activity for unexpected or unauthorized use of commands being run by non-standard users from non-standard locations.","procedures":["[S0069] BLACKCOFFEE: BLACKCOFFEE has the capability to enumerate files.","[S0229] Orz: Orz can gather victim drive information.","[S0438] Attor: Attor has a plugin that enumerates files with specific extensions on all hard disk drives and stores file information in encrypted log files.","[S0136] USBStealer: USBStealer searches victim drives for files matching certain extensions (“.skr”,“.pkr” or “.key”) or names.","[S0461] SDBbot: SDBbot has the ability to get directory listings or drive information on a compromised host.","[S0599] Kinsing: Kinsing has used the find command to search for specific files.","[S1025] Amadey: Amadey has searched for folders associated with antivirus software.","[S1065] Woody RAT: Woody RAT can list all files and their associated attributes, including filename, type, owner, creation time, last access time, last write time, size, and permissions.","[S0013] PlugX: PlugX has a module to enumerate drives and find files recursively.","[S1129] Akira: Akira examines files prior to encryption to determine if they meet requirements for encryption and can be encrypted by the ransomware. These checks are performed through native Windows functions such as GetFileAttributesW.","[S0180] Volgmer: Volgmer can list directories on a victim.","[G1017] Volt Typhoon: Volt Typhoon has enumerated directories containing vulnerability testing and cyber related content and facilities data such as construction drawings.","[S0598] P.A.S. Webshell: P.A.S. Webshell has the ability to list files and file characteristics including extension, size, ownership, and permissions.","[S0534] Bazar: Bazar can enumerate the victim's desktop.","[S0115] Crimson: Crimson contains commands to list files and directories, as well as search for files matching certain extensions from a defined list.","[S0242] SynAck: SynAck checks its directory location in an attempt to avoid launching in a sandbox.","[G0040] Patchwork: A Patchwork payload has searched all fixed drives on the victim for files matching a specified list of extensions.","[G0054] Sowbug: Sowbug identified and extracted all Word documents on a server by using a command containing * .doc and *.docx. The actors also searched for documents based on a specific date range and attempted to identify all installed software on a victim.","[S0248] yty: yty gathers information on victim’s drives and has a plugin for document listing.","[S0586] TAINTEDSCRIBE: TAINTEDSCRIBE can use DirectoryList to enumerate files in a specified directory.","[S0064] ELMER: ELMER is capable of performing directory listings.","[S1042] SUGARDUMP: SUGARDUMP can search for and collect data from specific Chrome, Opera, Microsoft Edge, and Firefox files, including any folders that have the string `Profile` in its name.","[C0015] C0015: During C0015, the threat actors conducted a file listing discovery against multiple hosts to ensure locker encryption was successful.","[S0410] Fysbis: Fysbis has the ability to search for files.","[S0125] Remsec: Remsec is capable of listing contents of folders on the victim. Remsec also searches for custom network encryption software on victims.","[S0607] KillDisk: KillDisk has used the FindNextFile command as part of its file deletion process.","[C0006] Operation Honeybee: During Operation Honeybee, the threat actors used a malicious DLL to search for files with specific keywords.","[S0059] WinMM: WinMM sets a WH_CBT Windows hook to search for and capture files on the victim.","[G0047] Gamaredon Group: Gamaredon Group macros can scan for Microsoft Word and Excel files to inject with additional malicious macros. Gamaredon Group has also used its backdoors to automatically list interesting files (such as Office documents) found on a system.","[S0647] Turian: Turian can search for specific files and list directories.","[S0216] POORAIM: POORAIM can conduct file browsing.","[S0339] Micropsia: Micropsia can perform a recursive directory listing for all volume drives available on the victim's machine and can also fetch specific files by their paths.","[S0083] Misdat: Misdat is capable of running commands to obtain a list of files and directories, as well as enumerating logical drives.","[S0141] Winnti for Windows: Winnti for Windows can check for the presence of specific files prior to moving to the next phase of execution.","[S0049] GeminiDuke: GeminiDuke collects information from the victim, including installed drivers, programs previously executed by users, programs and services configured to automatically run at startup, files and folders present in any user's home folder, files and folders present in any user's My Documents, programs installed to the Program Files folder, and recently accessed files, folders, and programs.","[S0651] BoxCaon: BoxCaon has searched for files on the system, such as documents located in the desktop folder.","[C0012] Operation CuckooBees: During Operation CuckooBees, the threat actors used `dir c:\\\\` to search for files.","[S0385] njRAT: njRAT can browse file systems using a file manager module.","[S0048] PinchDuke: PinchDuke searches for files created within a certain timeframe and whose file extension matches a predefined list.","[S0466] WindTail: WindTail has the ability to enumerate the users home directory and the path to its own application bundle.","[G0035] Dragonfly: Dragonfly has used a batch script to gather folder and file names from victim hosts.","[S0347] AuditCred: AuditCred can search through folders and files on the system.","[S0659] Diavol: Diavol has a command to traverse the files and directories in a given path.","[S0633] Sliver: Sliver can enumerate files on a target system.","[S0139] PowerDuke: PowerDuke has commands to get the current directory name as well as the size of a file. It also has commands to obtain information about logical drives, drive type, and free space.","[S0475] BackConfig: BackConfig has the ability to identify folders and files related to previous infections.","[S0239] Bankshot: Bankshot searches for files on the victim's machine.","[S1031] PingPull: PingPull can enumerate storage volumes and folder contents of a compromised host.","[S0065] 4H RAT: 4H RAT has the capability to obtain file and directory listings.","[S0181] FALLCHILL: FALLCHILL can search files on a victim.","[S0652] MarkiRAT: MarkiRAT can look for files carrying specific extensions such as: .rtf, .doc, .docx, .xls, .xlsx, .ppt, .pptx, .pps, .ppsx, .txt, .gpg, .pkr, .kdbx, .key, and .jpb.","[S0091] Epic: Epic recursively searches for all .doc files on the system and collects a directory listing of the Desktop, %TEMP%, and %WINDOWS%\\Temp directories.","[S0660] Clambling: Clambling can browse directories on a compromised host.","[S0472] down_new: down_new has the ability to list the directories on a compromised host.","[S0446] Ryuk: Ryuk has enumerated files and folders on all mounted drives.","[S0650] QakBot: QakBot can identify whether it has been run previously on a host by checking for a specified folder.","[S0428] PoetRAT: PoetRAT has the ability to list files upon receiving the ls command from C2.","[S0689] WhisperGate: WhisperGate can locate files based on hardcoded file extensions.","[S0106] cmd: cmd can be used to find files and directories with native functionality such as dir commands.","[S0345] Seasalt: Seasalt has the capability to identify the drive type on a victim.","[G0082] APT38: APT38 have enumerated files and directories, or searched in specific locations within a compromised host.","[G0007] APT28: APT28 has used Forfiles to locate PDF, Excel, and Word documents during collection. The group also searched a compromised DCCC computer for specific terms.","[S0271] KEYMARBLE: KEYMARBLE has a command to search for files on the victim’s machine.","[S0063] SHOTPUT: SHOTPUT has a command to obtain a directory listing.","[S0219] WINERACK: WINERACK can enumerate files and directories.","[S0348] Cardinal RAT: Cardinal RAT checks its current working directory upon execution and also contains watchdog functionality that ensures its executable is located in the correct path (else it will rewrite the payload).","[S0072] OwaAuth: OwaAuth has a command to list its directory and logical drives.","[S0055] RARSTONE: RARSTONE obtains installer properties from Uninstall Registry Key entries to obtain information about installed applications and how to uninstall certain applications.","[S0437] Kivars: Kivars has the ability to list drives on the infected host.","[S0089] BlackEnergy: BlackEnergy gathers a list of installed apps from the uninstall program Registry. It also gathers registered mail, browser, and instant messaging clients from the Registry. BlackEnergy has searched for given file types.","[S1090] NightClub: NightClub can use a file monitor to identify .lnk, .doc, .docx, .xls, .xslx, and .pdf files.","[S1141] LunarWeb: LunarWeb has the ability to retrieve directory listings.","[S0366] WannaCry: WannaCry searches for variety of user files by file extension before encrypting them using RSA and AES, including Office, PDF, image, audio, video, source code, archive/compression format, and key and certificate files.","[S0516] SoreFang: SoreFang has the ability to list directories.","[S0129] AutoIt backdoor: AutoIt backdoor is capable of identifying documents on the victim with the following extensions: .doc; .pdf, .csv, .ppt, .docx, .pst, .xls, .xlsx, .pptx, and .jpeg.","[S0572] Caterpillar WebShell: Caterpillar WebShell can search for files in directories.","[G0100] Inception: Inception used a file listing plugin to collect information about file and directories both on local and remote drives.","[S0452] USBferry: USBferry can detect the victim's file or folder list.","[S0640] Avaddon: Avaddon has searched for specific files prior to encryption.","[S1040] Rclone: Rclone can list files and directories with the `ls`, `lsd`, and `lsl` commands.","[S0610] SideTwist: SideTwist has the ability to search for specific files.","[S0632] GrimAgent: GrimAgent has the ability to enumerate files and directories on a compromised host.","[S0468] Skidmap: Skidmap has checked for the existence of specific files including /usr/sbin/setenforce and /etc/selinux/config. It also has the ability to monitor the cryptocurrency miner file and process.","[G1039] RedCurl: RedCurl has searched for and collected files on local and network drives.","[S0350] zwShell: zwShell can browse the file system.","[S0412] ZxShell: ZxShell has a command to open a file manager and explorer on the system.","[S1149] CHIMNEYSWEEP: CHIMNEYSWEEP has the ability to enumerate directories for files that match a set list.","[S0547] DropBook: DropBook can collect the names of all files and folders in the Program Files directories.","[S0436] TSCookie: TSCookie has the ability to discover drive information on the infected host.","[G1047] Velvet Ant: Velvet Ant has enumerated local files and folders on victim devices.","[S0236] Kwampirs: Kwampirs collects a list of files and directories in C:\\ with the command dir /s /a c:\\ >> \"C:\\windows\\TEMP\\[RANDOM].tmp\".","[S1100] Ninja: Ninja has the ability to enumerate directory content.","[S0201] JPIN: JPIN can enumerate drives and their types. It can also change file permissions using cacls.exe.","[S0086] ZLib: ZLib has the ability to enumerate files and drives.","[S0036] FLASHFLOOD: FLASHFLOOD searches for interesting files (either a default or customized set of file extensions) on the local system and removable media.","[S0447] Lokibot: Lokibot can search for specific files on an infected host.","[S0376] HOPLIGHT: HOPLIGHT has been observed enumerating system drives and partitions.","[G0114] Chimera: Chimera has utilized multiple commands to identify data of interest in file and directory listings.","[S1169] Mango: Mango can enumerate the contents of current working or other specified directories.","[S0337] BadPatch: BadPatch searches for files with specific file extensions.","[S0034] NETEAGLE: NETEAGLE allows adversaries to enumerate and modify the infected host's file system. It supports searching for directories, creating directories, listing directory contents, reading and writing to files, retrieving file attributes, and retrieving volume information.","[S0663] SysUpdate: SysUpdate can search files on a compromised host.","[S1160] Latrodectus: Latrodectus can collect desktop filenames.","[S1202] LockBit 3.0: LockBit 3.0 can exclude files associated with core system functions from encryption.","[S0414] BabyShark: BabyShark has used dir to search for \"programfiles\" and \"appdata\".","[G0018] admin@338: admin@338 actors used the following commands after exploiting a machine with LOWBALL malware to obtain information about files and directories: dir c:\\ >> %temp%\\download dir \"c:\\Documents and Settings\" >> %temp%\\download dir \"c:\\Program Files\\\" >> %temp%\\download dir d:\\ >> %temp%\\download","[S0149] MoonWind: MoonWind has a command to return a directory listing for a specified directory.","[G0004] Ke3chang: Ke3chang uses command-line interaction to search files and directories.","[S0576] MegaCortex: MegaCortex can parse the available drives and directories to determine which files to encrypt.","[S1153] Cuckoo Stealer: Cuckoo Stealer can search for files associated with specific applications.","[S0147] Pteranodon: Pteranodon identifies files matching certain file extension and copies them to subdirectories it created.","[S0492] CookieMiner: CookieMiner has looked for files in the user's home directory with \"wallet\" in their name using find.","[S0235] CrossRAT: CrossRAT can list all files on a system.","[S0616] DEATHRANSOM: DEATHRANSOM can use loop operations to enumerate directories on a compromised host.","[S0259] InnaputRAT: InnaputRAT enumerates directories and obtains file attributes on a system.","[S0559] SUNBURST: SUNBURST had commands to enumerate files and directories.","[S1184] BOLDMOVE: BOLDMOVE can list information of all files in the system recursively from the root directory or from a specified directory.","[S0625] Cuba: Cuba can enumerate files by using a variety of functions.","[S0211] Linfo: Linfo creates a backdoor through which remote attackers can list contents of drives and search for files.","[S0050] CosmicDuke: CosmicDuke searches attached and mounted drives for file extensions and keywords that match a predefined list.","[G0034] Sandworm Team: Sandworm Team has enumerated files on a compromised host.","[S1140] Spica: Spica can list filesystem contents on targeted systems.","[S0265] Kazuar: Kazuar finds a specified directory, lists the files and metadata about those files.","[S0161] XAgentOSX: XAgentOSX contains the readFiles function to return a detailed listing (sometimes recursive) of a specified directory. XAgentOSX contains the showBackupIosFolder function to check for IOS device backups by running ls -la ~/Library/Application\\ Support/MobileSync/Backup/.","[S0697] HermeticWiper: HermeticWiper can enumerate common folders such as My Documents, Desktop, and AppData.","[S0687] Cyclops Blink: Cyclops Blink can use the Linux API `statvfs` to enumerate the current working directory.","[S0618] FIVEHANDS: FIVEHANDS has the ability to enumerate files on a compromised host in order to encrypt files with specific extensions.","[S1070] Black Basta: Black Basta can enumerate specific files for encryption.","[S0154] Cobalt Strike: Cobalt Strike can explore files on a compromised system.","[S0673] DarkWatchman: DarkWatchman has the ability to enumerate file and folder names.","[S0604] Industroyer: Industroyer’s data wiper component enumerates specific files on all the Windows drives.","[S0252] Brave Prince: Brave Prince gathers file and directory information from the victim’s machine.","[S0346] OceanSalt: OceanSalt can extract drive information from the endpoint and search files on the system.","[S0198] NETWIRE: NETWIRE has the ability to search for files on the compromised host.","[S1156] Manjusaka: Manjusaka can gather information about specific files on the victim system.","[G0121] Sidewinder: Sidewinder has used malware to collect information on files and directories.","[S0131] TINYTYPHON: TINYTYPHON searches through the drive containing the OS, then all drive letters C through to Z, for documents matching certain extensions.","[S0340] Octopus: Octopus can collect information on the Windows directory and searches for compressed RAR files on the host.","[S0562] SUNSPOT: SUNSPOT enumerated the Orion software Visual Studio solution directory path.","[S0672] Zox: Zox can enumerate files on a compromised host.","[S0081] Elise: A variant of Elise executes dir C:\\progra~1 when initially run.","[S0268] Bisonal: Bisonal can retrieve a file listing from the system.","[S0051] MiniDuke: MiniDuke can enumerate local drives.","[S0575] Conti: Conti can discover files on a local system.","[S0533] SLOTHFULMEDIA: SLOTHFULMEDIA can enumerate files and directories.","[S0045] ADVSTORESHELL: ADVSTORESHELL can list files and directories.","[S0182] FinFisher: FinFisher enumerates directories and scans for certain files.","[S1179] Exbyte: Exbyte enumerates all document files on an infected machine, then creates a summary of these items including filename and directory location prior to exfiltration to cloud hosting services.","[S1102] Pcexter: Pcexter has the ability to search for files in specified directories.","[S1101] LoFiSe: LoFiSe can monitor the file system to identify files less than 6.4 MB in size with file extensions including .doc, .docx, .xls, .xlsx, .ppt, .pptx, .pdf, .rtf, .tif, .odt, .ods, .odp, .eml, and .msg.","[S0473] Avenger: Avenger has the ability to browse files in directories such as Program Files and the Desktop.","[S1105] COATHANGER: COATHANGER will survey the contents of system files during installation.","[S0674] CharmPower: CharmPower can enumerate drives and list the contents of the C: drive on a victim's computer.","[S0496] REvil: REvil has the ability to identify specific files and directories that are not to be encrypted.","[C0024] SolarWinds Compromise: During the SolarWinds Compromise, APT29 obtained information about the configured Exchange virtual directory using `Get-WebServicesVirtualDirectory`.","[S0363] Empire: Empire includes various modules for finding files of interest on hosts and network shares.","[S0192] Pupy: Pupy can walk through directories and recursively search for strings in files.","[G1015] Scattered Spider: Scattered Spider Spider enumerates a target organization for files and directories of interest, including source code.","[S1185] LightSpy: LightSpy uses the `NSFileManager` to move, create and delete files. LightSpy can also use the assembly `bt` instruction to determine a file's executable permissions.","[S0666] Gelsemium: Gelsemium can retrieve data from specific Windows directories, as well as open random files as part of Virtualization/Sandbox Evasion.","[G1007] Aoqin Dragon: Aoqin Dragon has run scripts to identify file formats including Microsoft Word.","[S0238] Proxysvc: Proxysvc lists files in directories.","[S1199] LockBit 2.0: LockBit 2.0 can exclude files associated with core system functions from encryption.","[G0081] Tropic Trooper: Tropic Trooper has monitored files' modified time.","[G0070] Dark Caracal: Dark Caracal collected file listings of all default Windows directories.","[S0237] GravityRAT: GravityRAT collects the volumes mapped on the system, and also steals files with the following extensions: .docx, .doc, .pptx, .ppt, .xlsx, .xls, .rtf, and .pdf.","[S0234] Bandook: Bandook has a command to list files on a system.","[G0069] MuddyWater: MuddyWater has used malware that checked if the ProgramData folder had folders or files with the keywords \"Kasper,\" \"Panda,\" or \"ESET.\"","[S0094] Trojan.Karagany: Trojan.Karagany can enumerate files and directories on a compromised host.","[S0378] PoshC2: PoshC2 can enumerate files on the local file system and includes a module for enumerating recently accessed files.","[S0066] 3PARA RAT: 3PARA RAT has a command to retrieve metadata for files on disk as well as a command to list the current working directory.","[S1159] DUSTTRAP: DUSTTRAP can enumerate files and directories.","[S0368] NotPetya: NotPetya searches for files ending with dozens of different file extensions prior to encryption.","[S0665] ThreatNeedle: ThreatNeedle can obtain file and directory information.","[S0635] BoomBox: BoomBox can search for specific files and directories on a machine.","[S1099] Samurai: Samurai can use a specific module for file enumeration.","[S0283] jRAT: jRAT can browse file systems.","[S0611] Clop: Clop has searched folders and subfolders for files to encrypt.","[S0493] GoldenSpy: GoldenSpy has included a program \"ExeProtector\", which monitors for the existence of GoldenSpy on the infected system and redownloads if necessary.","[S1017] OutSteel: OutSteel can search for specific file extensions, including zipped files.","[S0628] FYAnti: FYAnti can search the C:\\Windows\\Microsoft.NET\\ directory for files of a specified size.","[S0642] BADFLICK: BADFLICK has searched for files on the infected host.","[S0693] CaddyWiper: CaddyWiper can enumerate all files and directories on a compromised host.","[S0603] Stuxnet: Stuxnet uses a driver to scan for specific filesystem driver objects.","[S0023] CHOPSTICK: An older version of CHOPSTICK has a module that monitors all mounted volumes for files with the extensions .doc, .docx, .pgp, .gpg, .m2f, or .m2o.","[S0251] Zebrocy: Zebrocy searches for files that are 60mb and less and contain the following extensions: .doc, .docx, .xls, .xlsx, .ppt, .pptx, .exe, .zip, and .rar. Zebrocy also runs the echo %APPDATA% command to list the contents of the directory. Zebrocy can obtain the current execution path as well as perform drive enumeration.","[S1053] AvosLocker: AvosLocker has searched for files and directories on a compromised network.","[G0059] Magic Hound: Magic Hound malware can list a victim's logical drives and the type, as well the total/free space of the fixed devices. Other malware can list a directory's contents.","[S0435] PLEAD: PLEAD has the ability to list drives and files on the compromised host.","[S0439] Okrum: Okrum has used DriveLetterView to enumerate drive information.","[S0644] ObliqueRAT: ObliqueRAT has the ability to recursively enumerate files on an infected endpoint.","[S0127] BBSRAT: BBSRAT can list file and directory information.","[S0491] StrongPity: StrongPity can parse the hard drive on a compromised host to identify specific file extensions.","[S1196] Troll Stealer: Troll Stealer can enumerate and collect items from local drives and folders.","[S0686] QuietSieve: QuietSieve can search files on the target host by extension, including doc, docx, xls, rtf, odt, txt, jpg, pdf, rar, zip, and 7z.","[S0240] ROKRAT: ROKRAT has the ability to gather a list of files and directories on the infected system.","[G0139] TeamTNT: TeamTNT has used a script that checks `/proc/*/environ` for environment variables related to AWS.","[S1170] ODAgent: ODAgent can identify the current working directory.","[S0431] HotCroissant: HotCroissant has the ability to retrieve a list of files in a given directory as well as drives and drive types.","[S1130] Raspberry Robin: Raspberry Robin will check to see if the initial executing script is located on the user's Desktop as an anti-analysis check.","[S0643] Peppy: Peppy can identify specific files for exfiltration.","[S0078] Psylo: Psylo has commands to enumerate all storage devices and to find all files that start with a particular string.","[S0600] Doki: Doki has resolved the path of a process PID to use as a script argument.","[S1114] ZIPLINE: ZIPLINE can find and append specific files on Ivanti Connect Secure VPNs based upon received commands.","[G0030] Lotus Blossom: Lotus Blossom has used commands such as `dir` to examine the local filesystem of victim machines.","[S0250] Koadic: Koadic can obtain a list of directories.","[S0564] BlackMould: BlackMould has the ability to find files on the targeted system.","[S1023] CreepyDrive: CreepyDrive can specify the local file path to upload files from.","[G1014] LuminousMoth: LuminousMoth has used malware that scans for files in the Documents, Desktop, and Download folders and in other drives.","[C0014] Operation Wocao: During Operation Wocao, threat actors gathered a recursive directory listing to find files and directories of interest.","[S0184] POWRUNER: POWRUNER may enumerate user directories on a victim.","[S0387] KeyBoy: KeyBoy has a command to launch a file browser or explorer on the system.","[S0567] Dtrack: Dtrack can list files on available disk volumes.","[S0031] BACKSPACE: BACKSPACE allows adversaries to search for files.","[S0255] DDKONG: DDKONG lists files on the victim’s machine.","[S0354] Denis: Denis has several commands to search directories for files.","[S1142] LunarMail: LunarMail can search its staging directory for output files it has produced.","[S1139] INC Ransomware: INC Ransomware can receive command line arguments to encrypt specific files and directories.","[S0402] OSX/Shlayer: OSX/Shlayer has used the command appDir=\"$(dirname $(dirname \"$currentDir\"))\" and $(dirname \"$(pwd -P)\") to construct installation paths.","[S1027] Heyoka Backdoor: Heyoka Backdoor has the ability to search the compromised host for files.","[S0193] Forfiles: Forfiles can be used to locate certain types of files/directories in a system.(ex: locate all files with a specific extension, name, and/or age)","[S0498] Cryptoistic: Cryptoistic can scan a directory to identify files for deletion.","[S1111] DarkGate: Some versions of DarkGate search for the hard-coded folder C:\\Program Files\\e Carte Bleue.","[S1212] RansomHub: RansomHub has the ability to only encrypt specific files.","[S0212] CORALDECK: CORALDECK searches for specified files.","[S0070] HTTPBrowser: HTTPBrowser is capable of listing files, folders, and drives on a victim.","[C0022] Operation Dream Job: During Operation Dream Job, Lazarus Group conducted word searches within documents on a compromised host in search of security and financial matters.","[S0144] ChChes: ChChes collects the victim's %TEMP% directory path and version of Internet Explorer.","[G0022] APT3: APT3 has a tool that looks for files and directories on the local file system.","[G0050] APT32: APT32's backdoor possesses the capability to list files and directories on a machine.","[G0129] Mustang Panda: Mustang Panda has searched the entire target system for DOC, DOCX, PPT, PPTX, XLS, XLSX, and PDF files.","[S0208] Pasam: Pasam creates a backdoor through which remote attackers can retrieve lists of files.","[S1059] metaMain: metaMain can recursively enumerate files in an operator-provided directory.","[S0629] RainyDay: RainyDay can use a file exfiltration tool to collect recently changed files with specific extensions.","[S0260] InvisiMole: InvisiMole can list information about files in a directory and recently opened or used documents. InvisiMole can also search for specific files by supplied file mask.","[C0002] Night Dragon: During Night Dragon, threat actors used zwShell to establish full remote control of the connected machine and browse the victim file system.","[S0249] Gold Dragon: Gold Dragon lists the directories for Desktop, program files, and the user’s recently accessed files.","[S1162] Playcrypt: Playcrypt can avoid encrypting files with a .PLAY, .exe, .msi, .dll, .lnk, or .sys file extension.","[S0622] AppleSeed: AppleSeed has the ability to search for .txt, .ppt, .hwp, .pdf, and .doc files in specified directories.","[S0488] CrackMapExec: CrackMapExec can discover specified filetypes and log files on a targeted system.","[S0661] FoggyWeb: FoggyWeb's loader can check for the FoggyWeb backdoor .pri file on a compromised AD FS server.","[S0351] Cannon: Cannon can obtain victim drive information as well as a list of folders in C:\\Program Files.","[S0526] KGH_SPY: KGH_SPY can enumerate files and directories on a compromised host.","[S1122] Mispadu: Mispadu searches for various filesystem paths to determine what banking applications are installed on the victim’s machine.","[S0612] WastedLocker: WastedLocker can enumerate files and directories just prior to encryption.","[S0272] NDiskMonitor: NDiskMonitor can obtain a list of all files and directories as well as logical drives.","[S0015] Ixeshe: Ixeshe can list file and directory information.","[S1194] Akira _v2: Akira _v2 can target specific files and folders for encryption.","[S0093] Backdoor.Oldrea: Backdoor.Oldrea collects information about available drives, default browser, desktop file list, My Documents, Internet history, program files, and root of available drives. It also searches for ICS-related software files.","[S0021] Derusbi: Derusbi is capable of obtaining directory, file, and drive listings.","[S0623] Siloscape: Siloscape searches for the Kubernetes config file and other related files using a regular expression.","[G0087] APT39: APT39 has used tools with the ability to search for files on a compromised host.","[G1022] ToddyCat: ToddyCat has run scripts to enumerate recently modified documents having either a .pdf, .doc, .docx, .xls or .xlsx extension.","[S1034] StrifeWater: StrifeWater can enumerate files on a compromised host.","[S0079] MobileOrder: MobileOrder has a command to upload to its C2 server information about files on the victim mobile device, including SD card size, installed app list, SMS content, contacts, and calling history.","[S0657] BLUELIGHT: BLUELIGHT can enumerate files and collect associated metadata.","[S1043] ccf32: ccf32 can parse collected files to identify specific file extensions.","[G0032] Lazarus Group: Lazarus Group malware can use a common function to identify target files by their extension, and some also enumerate files and directories, including a Destover-like variant that lists files and gathers information for all drives.","[S0692] SILENTTRINITY: SILENTTRINITY has several modules, such as `ls.py`, `pwd.py`, and `recentFiles.py`, to enumerate directories and files.","[G0012] Darkhotel: Darkhotel has used malware that searched for files with specific patterns.","[S0467] TajMahal: TajMahal has the ability to index files from drives, user profiles, and removable drives.","[S1058] Prestige: Prestige can traverse the file system to discover files to encrypt by identifying specific extensions defined in a hardcoded list.","[S1198] Gomir: Gomir collects information about directory and file structures, including total number of subdirectories, total number of files, and total size of files on infected systems.","[G1040] Play: Play has used the Grixba information stealer to list security files and processes.","[S0157] SOUNDBITE: SOUNDBITE is capable of enumerating and manipulating files and directories.","[S0592] RemoteUtilities: RemoteUtilities can enumerate files and directories on a target machine.","[S0203] Hydraq: Hydraq creates a backdoor through which remote attackers can check for the existence of files, including its own components, as well as retrieve a list of logical drives.","[S0142] StreamEx: StreamEx has the ability to enumerate drive types.","[S0011] Taidoor: Taidoor can search for specific files.","[G0045] menuPass: menuPass has searched compromised systems for folders of interest including those related to HR, audit and expense, and meeting memos.","[S0520] BLINDINGCAN: BLINDINGCAN can search, read, write, move, and execute files.","[S0266] TrickBot: TrickBot searches the system for all of the following file extensions: .avi, .mov, .mkv, .mpeg, .mpeg4, .mp4, .mp3, .wav, .ogg, .jpeg, .jpg, .png, .bmp, .gif, .tiff, .ico, .xlsx, and .zip. It can also obtain browsing history, cookies, and plug-in information.","[S0332] Remcos: Remcos can search for files on the infected machine.","[S1060] Mafalda: Mafalda can search for files and directories.","[S0582] LookBack: LookBack can retrieve file listings from the victim machine.","[S0456] Aria-body: Aria-body has the ability to gather metadata from a file and to search for file and directory names.","[S0088] Kasidet: Kasidet has the ability to search for a given filename on a victim.","[G0094] Kimsuky: Kimsuky has the ability to enumerate all files and directories on an infected system.","[S0458] Ramsay: Ramsay can collect directory and file lists.","[S1022] IceApple: The IceApple Directory Lister module can list information about files and directories including creation time, last write time, name, and size.","[S1028] Action RAT: Action RAT has the ability to collect drive and file information on an infected machine.","[G0125] HAFNIUM: HAFNIUM has searched file contents on a compromised host.","[S0448] Rising Sun: Rising Sun can enumerate information about files from the infected system, including file size, attributes, creation time, last access time, and write time. Rising Sun can enumerate the compilation timestamp of Windows executable files.","[S0035] SPACESHIP: SPACESHIP identifies files and directories for collection by searching for specific file extensions or file modification time.","[S0587] Penquin: Penquin can use the command code do_vslist to send file names, size, and status to C2.","[S0409] Machete: Machete produces file listings in order to search for files to be exfiltrated.","[S1150] ROADSWEEP: ROADSWEEP can enumerate files on infected devices and avoid encrypting files with .exe, .dll, .sys, .lnk, or . lck extensions.","[S0148] RTM: RTM can check for specific files and directories associated with virtualization and malware analysis.","[S0356] KONNI: A version of KONNI searches for filenames created with a previous version of the malware, suggesting different versions targeted the same victims and the versions may work together.","[S0153] RedLeaves: RedLeaves can enumerate and search for files and directories.","[G0142] Confucius: Confucius has used a file stealer that checks the Document, Downloads, Desktop, and Picture folders for documents and images with specific extensions.","[S0670] WarzoneRAT: WarzoneRAT can enumerate directories on a compromise host.","[S1167] AcidPour: AcidPour can identify specific files and directories within the Linux operating system corresponding with storage devices for follow-on wiping activity, similar to AcidRain.","[G0096] APT41: APT41 has executed file /bin/pwd on exploited victims, perhaps to return architecture related information.","[G0044] Winnti Group: Winnti Group has used a program named ff.exe to search for specific documents on compromised hosts.","[S1125] AcidRain: AcidRain identifies specific files and directories in the Linux operating system associated with storage devices.","[S1018] Saint Bot: Saint Bot can search a compromised host for specific files.","[S0630] Nebulae: Nebulae can list files and directories on a compromised host.","[S0277] FruitFly: FruitFly looks for specific files and file types.","[S0658] XCSSET: XCSSET has used `mdfind` to enumerate a list of apps known to grant screen sharing permissions and leverages a module to run the command `ls -la ~/Desktop`.","[S0344] Azorult: Azorult can recursively search for files in folders and collects files from the desktop with certain extensions.","[C0035] KV Botnet Activity: KV Botnet Activity gathers a list of filenames from the following locations during execution of the final botnet stage: \\/usr\\/sbin\\/, \\/usr\\/bin\\/, \\/sbin\\/, \\/pfrm2.0\\/bin\\/, \\/usr\\/local\\/bin\\/.","[S1109] PACEMAKER: PACEMAKER can parse `/proc/\"process_name\"/cmdline` to look for the string `dswsd` within the command line.","[S0375] Remexi: Remexi searches for files on the system.","[G1035] Winter Vivern: Winter Vivern delivered malicious JavaScript payloads capable of listing folders and emails in exploited email servers.","[G0124] Windigo: Windigo has used a script to check for the presence of files created by OpenSSH backdoors.","[S0615] SombRAT: SombRAT can execute enum to enumerate files in storage on a compromised system.","[S1135] MultiLayer Wiper: MultiLayer Wiper generates a list of all files and paths on the fixed drives of an infected system, enumerating all files on the system except specific folders defined in a hardcoded list.","[S1096] Cheerscrypt: Cheerscrypt can search for log and VMware-related files with .log, .vmdk, .vmem, .vswp, and .vmsn extensions.","[G0026] APT18: APT18 can list files information for specific directories.","[S0113] Prikormka: A module in Prikormka collects information about the paths, size, and creation time of files with specific file extensions, but not the actual content of the file.","[S0497] Dacls: Dacls can scan directories on a compromised host.","[S0434] Imminent Monitor: Imminent Monitor has a dynamic debugging feature to check whether it is located in the %TEMP% directory, otherwise it copies itself there.","[S0330] Zeus Panda: Zeus Panda searches for specific directories on the victim’s machine.","[S0090] Rover: Rover automatically searches for files on local drives based on a predefined list of file extensions.","[S0512] FatDuke: FatDuke can enumerate directories on target machines.","[S0444] ShimRat: ShimRat can list directories.","[S0124] Pisloader: Pisloader has commands to list drives on the victim machine and to list file information for a given directory.","[G1023] APT5: APT5 has used the BLOODMINE utility to discover files with .css, .jpg, .png, .gif, .ico, .js, and .jsp extensions in Pulse Secure Connect logs.","[S1148] Raccoon Stealer: Raccoon Stealer identifies target files and directories for collection based on a configuration file.","[S1121] LITTLELAMB.WOOLTEA: LITTLELAMB.WOOLTEA can monitor for system upgrade events by checking for the presence of `/tmp/data/root/dev`.","[G0117] Fox Kitten: Fox Kitten has used WizTree to obtain network files and directory listings.","[S1016] MacMa: MacMa can search for a specific file on the compromised computer and can enumerate files in Desktop, Downloads, and Documents folders.","[S1073] Royal: Royal can identify specific files and directories to exclude from the encryption process.","[S0455] Metamorfo: Metamorfo has searched the Program Files directories for specific folders and has searched for strings related to its mutexes.","[S1191] Megazord: Megazord can ignore specified directories for encryption.","[S1089] SharpDisco: SharpDisco can identify recently opened files by using an LNK format parser to extract the original file path from LNK files found in either `%USERPROFILE%\\Recent` (Windows XP) or `%APPDATA%\\Microsoft\\Windows\\Recent` (newer Windows versions) .","[S1068] BlackCat: BlackCat can enumerate files for encryption.","[S0226] Smoke Loader: Smoke Loader recursively searches through directories for files.","[S0275] UPPERCUT: UPPERCUT has the capability to gather the victim's current directory.","[S0128] BADNEWS: BADNEWS identifies files with certain extensions from USB devices, then copies them to a predefined directory.","[G0077] Leafminer: Leafminer used a tool called MailSniper to search for files on the desktop and another utility called Sobolsoft to extract attachments from EML files.","[S0062] DustySky: DustySky scans the victim for files that contain certain keywords and document types including PDF, DOC, DOCX, XLS, and XLSX, from a list that is obtained from the C2 as a text file. It can also identify logical drives for the infected machine.","[G1016] FIN13: FIN13 has used the Windows `dir` command to enumerate files and directories in a victim's network.","[S0443] MESSAGETAP: MESSAGETAP checks for the existence of two configuration files (keyword_parm.txt and parm.txt) and attempts to read the files every 30 seconds.","[G0010] Turla: Turla surveys a system upon check-in to discover files in specific locations on the hard disk %TEMP% directory, the current user's desktop, the Program Files directory, and Recent. Turla RPC backdoors have also searched for files matching the lPH*.dll pattern.","[S0638] Babuk: Babuk has the ability to enumerate files on a targeted system.","[S0020] China Chopper: China Chopper's server component can list directory contents.","[S1044] FunnyDream: FunnyDream can identify files with .doc, .docx, .ppt, .pptx, .xls, .xlsx, and .pdf extensions and specific timestamps for collection.","[G0060] BRONZE BUTLER: BRONZE BUTLER has collected a list of files from the victim and uploaded it to its C2 server, and then created a new list of specific files to steal.","[S0022] Uroburos: Uroburos can search for specific files on a compromised system.","[S0263] TYPEFRAME: TYPEFRAME can search directories for files on the victim’s machine.","[S1200] StealBit: StealBit can be configured to exfiltrate specific file types."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1087.001","technique_name":"Account Discovery: Local Account","description":"Adversaries may attempt to get a listing of local system accounts. This information can help adversaries determine which local accounts exist on a system to aid in follow-on behavior. Commands such as net user and net localgroup of the Net utility and id and groups on macOS and Linux can list local users and groups. On Linux, local users can also be enumerated through the use of the /etc/passwd file. On macOS, the dscl . list /Users command can be used to enumerate local accounts. On ESXi servers, the `esxcli system account list` command can list local user accounts.","detection":"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell. Monitor for processes that can be used to enumerate user accounts, such as net.exe and net1.exe, especially when executed in quick succession.","procedures":["[S0452] USBferry: USBferry can use net user to gather information about local accounts.","[S0331] Agent Tesla: Agent Tesla can collect account information from the victim’s machine.","[S0236] Kwampirs: Kwampirs collects a list of accounts with the command net users.","[G0004] Ke3chang: Ke3chang performs account discovery using commands such as net localgroup administrators and net group \"REDACTED\" /domain on specific permissions groups.","[S0039] Net: Commands under net user can be used in Net to gather information about and manipulate user accounts.","[G1009] Moses Staff: Moses Staff has collected the administrator username from a compromised host.","[S0196] PUNCHBUGGY: PUNCHBUGGY can gather user names.","[S1146] MgBot: MgBot includes modules for identifying local administrator accounts on victim systems.","[S0223] POWERSTATS: POWERSTATS can retrieve usernames from compromised hosts.","[S0038] Duqu: The discovery modules used with Duqu can collect information on accounts and permissions.","[S0049] GeminiDuke: GeminiDuke collects information on local user accounts from the victim.","[S0165] OSInfo: OSInfo enumerates local and domain users","[S0063] SHOTPUT: SHOTPUT has a command to retrieve information about connected users.","[G0049] OilRig: OilRig has run net user, net user /domain, net group “domain admins” /domain, and net group “Exchange Trusted Subsystem” /domain to get account listings on a victim.","[S0378] PoshC2: PoshC2 can enumerate local and domain user account information.","[S0244] Comnie: Comnie uses the net user command.","[G0096] APT41: APT41 used built-in net commands to enumerate local administrator groups.","[G0030] Lotus Blossom: Lotus Blossom has used commands such as `net` to profile local system users.","[S1159] DUSTTRAP: DUSTTRAP can enumerate local user accounts.","[G0050] APT32: APT32 enumerated administrative users using the commands net localgroup administrators.","[S0521] BloodHound: BloodHound can identify users with local administrator rights.","[G1017] Volt Typhoon: Volt Typhoon has executed `net user` and `quser` to enumerate local account information.","[S1145] Pikabot: Pikabot will retrieve the name of the user associated with the thread under which the malware is executing.","[C0012] Operation CuckooBees: During Operation CuckooBees, the threat actors used the `net user` command to gather account information.","[S0266] TrickBot: TrickBot collects the users of the system.","[G1044] APT42: APT42 has used the PowerShell-based POWERPOST script to collect local account names from the victim machine.","[S0241] RATANKBA: RATANKBA uses the net user command.","[G1039] RedCurl: RedCurl has collected information about local accounts.","[G0114] Chimera: Chimera has used net user for account discovery.","[G0010] Turla: Turla has used net user to enumerate local accounts on the system.","[G0117] Fox Kitten: Fox Kitten has accessed ntuser.dat and UserClass.dat on compromised hosts.","[S0091] Epic: Epic gathers a list of all user accounts, privilege classes, and time of last logon.","[S0516] SoreFang: SoreFang can collect usernames from the local system via net.exe user.","[G0022] APT3: APT3 has used a tool that can obtain info about local and global group users, power users, and administrators.","[S0125] Remsec: Remsec can obtain a list of users.","[S0084] Mis-Type: Mis-Type may create a file containing the results of the command cmd.exe /c net user {Username}.","[S0239] Bankshot: Bankshot gathers domain and account names/information through process monitoring.","[S0260] InvisiMole: InvisiMole has a command to list account information on the victim’s machine.","[S1015] Milan: Milan has run `C:\\Windows\\system32\\cmd.exe /c cmd /c dir c:\\users\\ /s 2>&1` to discover local accounts.","[G0027] Threat Group-3390: Threat Group-3390 has used net user to conduct internal discovery of systems.","[S0603] Stuxnet: Stuxnet enumerates user accounts of the local host.","[S0194] PowerSploit: PowerSploit's Get-ProcessTokenGroup Privesc-PowerUp module can enumerate all SIDs associated with its current token.","[G0033] Poseidon Group: Poseidon Group searches for administrator accounts on both the local victim machine and the network.","[S0363] Empire: Empire can acquire local and domain user account information.","[S0192] Pupy: Pupy uses PowerView and Pywerview to perform discovery commands such as net user, net group, net local group, etc.","[G0018] admin@338: admin@338 actors used the following commands following exploitation of a machine with LOWBALL malware to enumerate user accounts: net user >> %temp%\\download net user /domain >> %temp%\\download","[S0537] HyperStack: HyperStack can enumerate all account names on a remote share.","[S0081] Elise: Elise executes net user after initial communication is made to the remote server.","[S0534] Bazar: Bazar can identify administrator accounts on an infected host.","[G0006] APT1: APT1 used the commands net localgroup,net user, and net group to find accounts on the system.","[S1148] Raccoon Stealer: Raccoon Stealer checks the privileges of running processes to determine if the running user is equivalent to `NT Authority\\System`.","[S0570] BitPaymer: BitPaymer can enumerate the sessions for each user logged onto the infected host.","[S0453] Pony: Pony has used the NetUserEnum function to enumerate local accounts.","[S0476] Valak: Valak has the ability to enumerate local admin accounts.","[S0265] Kazuar: Kazuar gathers information on local groups and members on the victim’s machine.","[S0649] SMOKEDHAM: SMOKEDHAM has used net.exe user and net.exe users to enumerate local accounts on a compromised host.","[S0233] MURKYTOP: MURKYTOP has the capability to retrieve information about users on remote hosts.","[S0598] P.A.S. Webshell: P.A.S. Webshell can display the /etc/passwd file on a compromised host.","[S0085] S-Type: S-Type has run the command `net user` on a victim."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1087.002","technique_name":"Account Discovery: Domain Account","description":"Adversaries may attempt to get a listing of domain accounts. This information can help adversaries determine which domain accounts exist to aid in follow-on behavior such as targeting specific accounts which possess particular privileges. Commands such as net user /domain and net group /domain of the Net utility, dscacheutil -q group on macOS, and ldapsearch on Linux can list domain users and groups. PowerShell cmdlets including Get-ADUser and Get-ADGroupMember may enumerate members of Active Directory groups.","detection":"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.","procedures":["[S1159] DUSTTRAP: DUSTTRAP can enumerate domain accounts.","[C0024] SolarWinds Compromise: During the SolarWinds Compromise, APT29 used PowerShell to discover domain accounts by exectuing `Get-ADUser` and `Get-ADGroupMember`.","[S0516] SoreFang: SoreFang can enumerate domain accounts via net.exe user /domain.","[S0039] Net: Net commands used with the /domain flag can be used to gather information about and manipulate user accounts on the current domain.","[G1016] FIN13: FIN13 can identify user accounts associated with a Service Principal Name and query Service Principal Names within the domain by utilizing the following scripts: `GetUserSPNs.vbs` and `querySpn.vbs`.","[S0534] Bazar: Bazar has the ability to identify domain administrator accounts.","[G0037] FIN6: FIN6 has used Metasploit’s PsExec NTDSGRAB module to obtain a copy of the victim's Active Directory database.","[S0488] CrackMapExec: CrackMapExec can enumerate the domain user accounts on a targeted system.","[S1146] MgBot: MgBot includes modules for collecting information on Active Directory domain accounts.","[G0096] APT41: APT41 used built-in net commands to enumerate domain administrator users.","[G0004] Ke3chang: Ke3chang performs account discovery using commands such as net localgroup administrators and net group \"REDACTED\" /domain on specific permissions groups.","[G1015] Scattered Spider: Scattered Spider leverages legitimate domain accounts to gain access to the target environment.","[S0018] Sykipot: Sykipot may use net group \"domain admins\" /domain to display accounts in the \"domain admins\" permissions group and net localgroup \"administrators\" to list local system administrator group membership.","[S0635] BoomBox: BoomBox has the ability to execute an LDAP query to enumerate the distinguished name, SAM account name, and display name for all domain users.","[G0030] Lotus Blossom: Lotus Blossom has used `net` commands and tools such as AdFind to profile domain accounts associated with victim machines and make Active Directory queries.","[G0069] MuddyWater: MuddyWater has used cmd.exe net user /domain to enumerate domain users.","[S0105] dsquery: dsquery can be used to gather information on user accounts within a domain.","[G1032] INC Ransom: INC Ransom has scanned for domain admin accounts in compromised environments.","[S1068] BlackCat: BlackCat can utilize `net use` commands to identify domain users.","[S0521] BloodHound: BloodHound can collect information about domain users, including identification of domain admin accounts.","[G1004] LAPSUS$: LAPSUS$ has used the AD Explorer tool to enumerate users on a victim's network.","[G0114] Chimera: Chimera has has used net user /dom and net user Administrator to enumerate domain accounts including administrator accounts.","[S0363] Empire: Empire can acquire local and domain user account information.","[G0045] menuPass: menuPass has used the Microsoft administration tool csvde.exe to export Active Directory data.","[G0049] OilRig: OilRig has run net user, net user /domain, net group “domain admins” /domain, and net group “Exchange Trusted Subsystem” /domain to get account listings on a victim.","[S0378] PoshC2: PoshC2 can enumerate local and domain user account information.","[S0184] POWRUNER: POWRUNER may collect user account information by running net user /domain or a series of other commands on a victim.","[G1022] ToddyCat: ToddyCat has run `net user %USER% /dom` for account discovery.","[G0010] Turla: Turla has used net user /domain to enumerate domain accounts.","[G1043] BlackByte: BlackByte has used tools such as AdFind to identify and enumerate domain accounts.","[C0012] Operation CuckooBees: During Operation CuckooBees, the threat actors used the `dsquery` and `dsget` commands to get domain environment information and to query users in administrative groups.","[S0692] SILENTTRINITY: SILENTTRINITY can use `System.Security.AccessControl` namespaces to retrieve domain user information.","[G0102] Wizard Spider: Wizard Spider has identified domain admins through the use of `net group \"Domain admins\" /DOMAIN`. Wizard Spider has also leveraged the PowerShell cmdlet `Get-ADComputer` to collect account names from Active Directory data.","[G0117] Fox Kitten: Fox Kitten has used the Softerra LDAP browser to browse documentation on service accounts.","[S0603] Stuxnet: Stuxnet enumerates user accounts of the domain.","[C0014] Operation Wocao: During Operation Wocao, threat actors used the `net` command to retrieve information about domain accounts.","[C0022] Operation Dream Job: During Operation Dream Job, Lazarus Group queried compromised victim's active directory servers to obtain the list of employees including administrator accounts.","[S0154] Cobalt Strike: Cobalt Strike can determine if the user on an infected machine is in the admin or domain admin group.","[S0483] IcedID: IcedID can query LDAP and can use built-in `net` commands to identify additional users on the network to infect.","[S1063] Brute Ratel C4: Brute Ratel C4 can use LDAP queries, `net group \"Domain Admins\" /domain` and `net user /domain` for discovery.","[G0033] Poseidon Group: Poseidon Group searches for administrator accounts on both the local victim machine and the network.","[S0165] OSInfo: OSInfo enumerates local and domain users","[S0239] Bankshot: Bankshot gathers domain and account names/information through process monitoring.","[G1039] RedCurl: RedCurl has collected information about domain accounts using SysInternal’s AdExplorer functionality .","[G1046] Storm-1811: Storm-1811 has performed domain account enumeration during intrusions.","[S0476] Valak: Valak has the ability to enumerate domain admin accounts.","[S1022] IceApple: The IceApple Active Directory Querier module can perform authenticated requests against an Active Directory server.","[G1017] Volt Typhoon: Volt Typhoon has run `net group /dom` and `net group \"Domain Admins\" /dom` in compromised environments for account discovery.","[S1160] Latrodectus: Latrodectus can run `C:\\Windows\\System32\\cmd.exe /c net group \"Domain Admins\" /domain` to identify domain administrator accounts.","[G0034] Sandworm Team: Sandworm Team has used a tool to query Active Directory using LDAP, discovering information about usernames listed in AD.","[G0060] BRONZE BUTLER: BRONZE BUTLER has used net user /domain to identify account information.","[G0035] Dragonfly: Dragonfly has used batch scripts to enumerate users on a victim domain controller.","[S0552] AdFind: AdFind can enumerate domain users."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1087.003","technique_name":"Account Discovery: Email Account","description":"Adversaries may attempt to get a listing of email addresses and accounts. Adversaries may try to dump Exchange address lists such as global address lists (GALs). In on-premises Exchange and Exchange Online, the Get-GlobalAddressList PowerShell cmdlet can be used to obtain email addresses and accounts from a domain using an authenticated session. In Google Workspace, the GAL is shared with Microsoft Outlook users through the Google Workspace Sync for Microsoft Outlook (GWSMO) service. Additionally, the Google Workspace Directory allows for users to get a listing of other users within the organization.","detection":"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.","procedures":["[G0092] TA505: TA505 has used the tool EmailStealer to steal and send lists of e-mail addresses to a remote server.","[G0059] Magic Hound: Magic Hound has used Powershell to discover email accounts.","[S0531] Grandoreiro: Grandoreiro can parse Outlook .pst files to extract e-mail addresses.","[G1039] RedCurl: RedCurl has collected information about email accounts.","[G0034] Sandworm Team: Sandworm Team used malware to enumerate email settings, including usernames and passwords, from the M.E.Doc application.","[C0027] C0027: During C0027, Scattered Spider accessed Azure AD to identify email addresses.","[S0093] Backdoor.Oldrea: Backdoor.Oldrea collects address book information from Outlook.","[S0266] TrickBot: TrickBot collects email addresses from Outlook.","[S0681] Lizar: Lizar can collect email accounts from Microsoft Outlook and Mozilla Thunderbird.","[S0358] Ruler: Ruler can be used to enumerate Exchange users and dump the GAL.","[S0413] MailSniper: MailSniper can be used to obtain account names from Exchange and Office 365 using the Get-GlobalAddressList cmdlet.","[S0367] Emotet: Emotet has been observed leveraging a module that can scrape email addresses from Outlook.","[C0038] HomeLand Justice: During HomeLand Justice, threat actors used compromised Exchange accounts to search mailboxes for administrator accounts.","[S0635] BoomBox: BoomBox can execute an LDAP query to discover e-mail accounts for domain users."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1087.004","technique_name":"Account Discovery: Cloud Account","description":"Adversaries may attempt to get a listing of cloud accounts. Cloud accounts are those created and configured by an organization for use by users, remote support, services, or for administration of resources within a cloud service provider or SaaS application. With authenticated access there are several tools that can be used to find accounts. The Get-MsolRoleMember PowerShell cmdlet can be used to obtain account names given a role or permissions group in Office 365. The Azure CLI (AZ CLI) also provides an interface to obtain user accounts with authenticated access to a domain. The command az ad user list will list all users within a domain. The AWS command aws iam list-users may be used to obtain a list of users in the current account while aws iam list-roles can obtain IAM roles that have a specified path prefix. In GCP, gcloud iam service-accounts list and gcloud projects get-iam-policy may be used to obtain a listing of service accounts and users in a project.","detection":"Monitor processes, command-line arguments, and logs for actions that could be taken to gather information about cloud accounts, including the use of calls to cloud APIs that perform account discovery. System and network discovery techniques normally occur throughout an operation as an adversary learns the environment, and also to an extent in normal network operations. Therefore discovery data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.","procedures":["[C0027] C0027: During C0027, Scattered Spider accessed Azure AD to download bulk lists of group members and to identify privileged users, along with the email addresses and AD attributes.","[S0684] ROADTools: ROADTools can enumerate Azure AD users.","[S0677] AADInternals: AADInternals can enumerate Azure AD users.","[G0016] APT29: APT29 has conducted enumeration of Azure AD accounts.","[S1091] Pacu: Pacu can enumerate IAM users, roles, and groups."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1120","technique_name":"Peripheral Device Discovery","description":"Adversaries may attempt to gather information about attached peripheral devices and components connected to a computer system. Peripheral devices could include auxiliary resources that support a variety of functionalities such as keyboards, printers, cameras, smart card readers, or removable storage. The information may be used to enhance their awareness of the system and network environment or may be used for further actions.","detection":"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities based on the information obtained. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.","procedures":["[S1139] INC Ransomware: INC Ransomware can identify external USB and hard drives for encryption and printers to print ransom notes.","[G0020] Equation: Equation has used tools with the functionality to search for specific information about the attached hard drive that could be used to identify and overwrite the firmware.","[C0012] Operation CuckooBees: During Operation CuckooBees, the threat actors used the `fsutil fsinfo drives` command as part of their advanced reconnaissance.","[G0067] APT37: APT37 has a Bluetooth device harvester, which uses Windows Bluetooth APIs to find information on connected Bluetooth devices.","[S0283] jRAT: jRAT can map UPnP ports.","[S0538] Crutch: Crutch can monitor for removable drives being plugged into the compromised machine.","[S1044] FunnyDream: The FunnyDream FilepakMonitor component can detect removable drive insertion.","[S1149] CHIMNEYSWEEP: CHIMNEYSWEEP can monitor for removable drives.","[S0385] njRAT: njRAT will attempt to detect if the victim system has a camera during the initial infection. njRAT can also detect any removable drives connected to the system.","[S1026] Mongall: Mongall can identify removable media attached to compromised hosts.","[S0113] Prikormka: A module in Prikormka collects information on available printers and disk drives.","[S0366] WannaCry: WannaCry contains a thread that will attempt to scan for new attached drives every few seconds. If one is identified, it will encrypt the files on the attached device.","[S0251] Zebrocy: Zebrocy enumerates information about connected storage devices.","[S0148] RTM: RTM can obtain a list of smart card readers attached to the victim.","[S0644] ObliqueRAT: ObliqueRAT can discover pluggable/removable drives to extract files from.","[S0234] Bandook: Bandook can detect USB devices.","[S1167] AcidPour: AcidPour includes functionality to identify MMC and SD cards connected to the victim device.","[S0458] Ramsay: Ramsay can scan for removable media which may contain documents for collection.","[G0007] APT28: APT28 uses a module to receive a notification every time a USB mass storage device is inserted into a victim.","[S0452] USBferry: USBferry can check for connected USB devices.","[S0149] MoonWind: MoonWind obtains the number of removable drives from the victim.","[S0062] DustySky: DustySky can detect connected USB devices.","[S0438] Attor: Attor has a plugin that collects information about inserted storage devices, modems, and phone devices.","[S1064] SVCReady: SVCReady can check for the number of devices plugged into an infected host.","[S0679] Ferocious: Ferocious can run GET.WORKSPACE in Microsoft Excel to check if a mouse is present.","[S1199] LockBit 2.0: LockBit 2.0 has the ability to identify mounted external storage devices.","[S0089] BlackEnergy: BlackEnergy can gather very specific information about attached USB devices, to include device instance ID and drive geometry.","[G0010] Turla: Turla has used fsutil fsinfo drives to list connected drives.","[G0049] OilRig: OilRig has used tools to identify if a mouse is connected to a targeted system.","[S0115] Crimson: Crimson has the ability to discover pluggable/removable drives to extract files from.","[S0603] Stuxnet: Stuxnet enumerates removable drives for infection.","[S0381] FlawedAmmyy: FlawedAmmyy will attempt to detect if a usable smart card is current inserted into a card reader.","[S0045] ADVSTORESHELL: ADVSTORESHELL can list connected devices.","[S0612] WastedLocker: WastedLocker can enumerate removable drives prior to the encryption process.","[S0686] QuietSieve: QuietSieve can identify and search removable drives for specific file name extensions.","[S0650] QakBot: QakBot can identify peripheral devices on targeted systems.","[C0014] Operation Wocao: During Operation Wocao, threat actors discovered removable disks attached to a system.","[S0409] Machete: Machete detects the insertion of new devices by listening for the WM_DEVICECHANGE window message.","[S1150] ROADSWEEP: ROADSWEEP can identify removable drives attached to the victim's machine.","[G0139] TeamTNT: TeamTNT has searched for attached VGA devices using lspci.","[G1017] Volt Typhoon: Volt Typhoon has obtained victim's screen dimension and display device information.","[S1090] NightClub: NightClub has the ability to monitor removable drives.","[G0047] Gamaredon Group: Gamaredon Group tools have contained an application to check performance of USB flash drives. Gamaredon Group has also used malware to scan for removable drives.","[S1202] LockBit 3.0: LockBit 3.0 has the ability to discover external storage devices.","[G0135] BackdoorDiplomacy: BackdoorDiplomacy has used an executable to detect removable media, such as USB flash drives.","[S1027] Heyoka Backdoor: Heyoka Backdoor can identify removable media attached to victim's machines.","[S0454] Cadelspy: Cadelspy has the ability to steal information about printers and the documents sent to printers.","[S0481] Ragnar Locker: Ragnar Locker may attempt to connect to removable drives and mapped network drives.","[S0098] T9000: T9000 searches through connected drives for removable storage devices.","[S0467] TajMahal: TajMahal has the ability to identify connected Apple devices.","[S1089] SharpDisco: SharpDisco has dropped a plugin to monitor external drives to `C:\\Users\\Public\\It3.exe`.","[S0647] Turian: Turian can scan for removable media to collect data.","[S0136] USBStealer: USBStealer monitors victims for insertion of removable drives. When dropped onto a second victim, it also enumerates drives connected to the system.","[S0128] BADNEWS: BADNEWS checks for new hard drives on the victim, such as USB devices, by listening for the WM_DEVICECHANGE window message.","[S0673] DarkWatchman: DarkWatchman can list signed PnP drivers for smartcard readers."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1124","technique_name":"System Time Discovery","description":"An adversary may gather the system time and/or time zone settings from a local or remote system. The system time is set and stored by services, such as the Windows Time Service on Windows or systemsetup on macOS. These time settings may also be synchronized between systems and services in an enterprise network, typically accomplished with a network time server within a domain. System time information may be gathered in a number of ways, such as with Net on Windows by performing net time \\\\hostname to gather the system time on a remote system. The victim's time zone may also be inferred from the current system time or gathered by using w32tm /tz. In addition, adversaries can discover device uptime through functions such as GetTickCount() to determine how long it has been since the system booted up. On network devices, Network Device CLI commands such as `show clock detail` can be used to see the current time configuration. On ESXi servers, `esxcli system clock get` can be used for the same purpose. In addition, system calls – such as time() – have been used to collect the current time on Linux devices. On macOS systems, adversaries may use commands such as systemsetup -gettimezone or timeIntervalSinceNow to gather current time zone information or current date and time. This information could be useful for performing other techniques, such as executing a file with a Scheduled Task/Job, or to discover locality information based on time zone to assist in victim targeting (i.e. System Location Discovery). Adversaries may also use knowledge of system time as part of a time bomb, or delaying execution until a specified date/time.","detection":"Command-line interface monitoring may be useful to detect instances of net.exe or other command-line utilities being used to gather system time or time zone. Methods of detecting API use for gathering this information are likely less useful due to how often they may be used by legitimate software. For network infrastructure devices, collect AAA logging to monitor `show` commands being run by non-standard users from non-standard locations.","procedures":["[S0140] Shamoon: Shamoon obtains the system time and will only activate if it is greater than a preset date.","[S1178] ShrinkLocker: ShrinkLocker retrieves a system timestamp that is used in generating an encryption key.","[S0373] Astaroth: Astaroth collects the timestamp from the infected machine.","[S0251] Zebrocy: Zebrocy gathers the current time zone and date information from the system.","[S0596] ShadowPad: ShadowPad has collected the current date and time of the victim system.","[S0011] Taidoor: Taidoor can use GetLocalTime and GetSystemTime to collect system time.","[S0396] EvilBunny: EvilBunny has used the API calls NtQuerySystemTime, GetSystemTimeAsFileTime, and GetTickCount to gather time metrics as part of its checks to see if the malware is running in a sandbox.","[S0098] T9000: T9000 gathers and beacons the system time during installation.","[S1051] KEYPLUG: KEYPLUG can obtain the current tick count of an infected computer.","[G0121] Sidewinder: Sidewinder has used tools to obtain the current system time.","[S0039] Net: The net time command can be used in Net to determine the local or remote system time.","[S0615] SombRAT: SombRAT can execute getinfo to discover the current time on a compromised host.","[S0091] Epic: Epic uses the net time command to get the system time from the machine and collect the current date and time zone information.","[S0678] Torisma: Torisma can collect the current time on a victim machine.","[C0012] Operation CuckooBees: During Operation CuckooBees, the threat actors used the `net time` command as part of their advanced reconnaissance.","[S0275] UPPERCUT: UPPERCUT has the capability to obtain the time zone information and current timestamp of the victim’s machine.","[S0588] GoldMax: GoldMax can check the current date-time value of the compromised system, comparing it to the hardcoded execution trigger and can send the current timestamp to the C2 server.","[S0608] Conficker: Conficker uses the current UTC victim system date for domain generation and connects to time servers to determine the current date.","[C0014] Operation Wocao: During Operation Wocao, threat actors used the `time` command to retrieve the current time of a compromised system.","[S0237] GravityRAT: GravityRAT can obtain the date and time of a system.","[S0331] Agent Tesla: Agent Tesla can collect the timestamp from the victim’s machine.","[S1043] ccf32: ccf32 can determine the local time on targeted machines.","[S1081] BADHATCH: BADHATCH can obtain the `DATETIME` and `UPTIME` from a compromised machine.","[S0417] GRIFFON: GRIFFON has used a reconnaissance module that can be used to retrieve the date and time of the system.","[G1017] Volt Typhoon: Volt Typhoon has obtained the victim's system timezone.","[S0650] QakBot: QakBot can identify the system time on a targeted host.","[S0335] Carbon: Carbon uses the command net time \\\\127.0.0.1 to get information the system’s time.","[G0126] Higaisa: Higaisa used a function to gather the current time.","[S0554] Egregor: Egregor contains functionality to query the local/system time.","[S0115] Crimson: Crimson has the ability to determine the date and time on a compromised host.","[S0455] Metamorfo: Metamorfo uses JavaScript to get the system time.","[S0148] RTM: RTM can obtain the victim time zone.","[S0353] NOKKI: NOKKI can collect the current timestamp of the victim's machine.","[S0531] Grandoreiro: Grandoreiro can determine the time on the victim machine via IPinfo.","[S0673] DarkWatchman: DarkWatchman can collect time zone information and system `UPTIME`.","[S0694] DRATzarus: DRATzarus can use the `GetTickCount` and `GetSystemTimeAsFileTime` API calls to inspect system time.","[S0380] StoneDrill: StoneDrill can obtain the current date and time of the victim machine.","[S0559] SUNBURST: SUNBURST collected device `UPTIME`.","[S0471] build_downer: build_downer has the ability to determine the local time to ensure malware installation only happens during the hours that the infected system is active.","[G0128] ZIRCONIUM: ZIRCONIUM has used a tool to capture the time on a compromised host in order to register it with C2.","[S1148] Raccoon Stealer: Raccoon Stealer gathers victim machine timezone information.","[S0467] TajMahal: TajMahal has the ability to determine local time on a compromised host.","[S1033] DCSrv: DCSrv can compare the current time on an infected host with a configuration value to determine when to start the encryption process.","[S0692] SILENTTRINITY: SILENTTRINITY can collect start time information from a compromised host.","[S0139] PowerDuke: PowerDuke has commands to get the time the machine was built, the time, and the time zone.","[G0060] BRONZE BUTLER: BRONZE BUTLER has used net time to check the local time on a target system.","[S0534] Bazar: Bazar can collect the time on the compromised host.","[S0149] MoonWind: MoonWind obtains the victim's current time.","[S0017] BISCUIT: BISCUIT has a command to collect the system `UPTIME`.","[G1012] CURIUM: CURIUM deployed mechanisms to check system time information following strategic website compromise attacks.","[S1044] FunnyDream: FunnyDream can check system time to help determine when changes were made to specified files.","[G0010] Turla: Turla surveys a system upon check-in to discover the system time by using the net time command.","[S0267] FELIXROOT: FELIXROOT gathers the time zone information from the victim’s machine.","[S1034] StrifeWater: StrifeWater can collect the time zone from the victim's machine.","[S1147] Nightdoor: Nightdoor can identify the system local time information.","[G0012] Darkhotel: Darkhotel malware can obtain system time from a compromised host.","[S1064] SVCReady: SVCReady can collect time zone information.","[S0330] Zeus Panda: Zeus Panda collects the current system time (UTC) and sends it back to the C2 server.","[S0501] PipeMon: PipeMon can send time zone information from a compromised host to C2.","[G0114] Chimera: Chimera has used time /t and net time \\\\ip/hostname for system time discovery.","[S0344] Azorult: Azorult can collect the time zone information from the system.","[S0351] Cannon: Cannon can collect the current time zone information from the victim’s machine.","[S1111] DarkGate: DarkGate creates a log file for capturing keylogging, clipboard, and related data using the victim host's current date for the filename. DarkGate queries victim system epoch time during execution. DarkGate captures system time information as part of automated profiling on initial installation.","[S1134] DEADWOOD: DEADWOOD will set a timestamp value to determine when wiping functionality starts. When the timestamp is met on the system, a trigger file is created on the operating system allowing for execution to proceed. If the timestamp is in the past, the wiper will execute immediately.","[S0660] Clambling: Clambling can determine the current time.","[S1159] DUSTTRAP: DUSTTRAP reads the infected system's current time and writes it to a log file during execution.","[S0586] TAINTEDSCRIBE: TAINTEDSCRIBE can execute GetLocalTime for time discovery.","[C0015] C0015: During C0015, the threat actors used the command `net view /all time` to gather the local time of a compromised network.","[S0126] ComRAT: ComRAT has checked the victim system's date and time to perform tasks during business hours (9 to 5, Monday to Friday).","[S0574] BendyBear: BendyBear has the ability to determine local time on a compromised host.","[S0603] Stuxnet: Stuxnet collects the time and date of a system when it is infected.","[G0032] Lazarus Group: A Destover-like implant used by Lazarus Group can obtain the current system time and send it to the C2 server.","[S0376] HOPLIGHT: HOPLIGHT has been observed collecting system time from victim machines.","[S0657] BLUELIGHT: BLUELIGHT can collect the local time on a compromised host.","[S0238] Proxysvc: As part of the data reconnaissance phase, Proxysvc grabs the system time to send back to the control server.","[S0264] OopsIE: OopsIE checks to see if the system is configured with \"Daylight\" time and checks for a specific region to be set for the timezone.","[S0260] InvisiMole: InvisiMole gathers the local system time from the victim’s machine.","[S0450] SHARPSTATS: SHARPSTATS has the ability to identify the current date and time on the compromised host.","[S0690] Green Lambert: Green Lambert can collect the date and time from a compromised host.","[S0439] Okrum: Okrum can obtain the date and time of the compromised system.","[S0268] Bisonal: Bisonal can check the system time set on the infected host.","[S0622] AppleSeed: AppleSeed can pull a timestamp from the victim's machine.","[S1053] AvosLocker: AvosLocker has checked the system time before and after encryption.","[G0089] The White Company: The White Company has checked the current date on the victim system.","[S0466] WindTail: WindTail has the ability to generate the current date and time."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1135","technique_name":"Network Share Discovery","description":"Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement. Networks often contain shared network drives and folders that enable users to access file directories on various systems across a network. File sharing over a Windows network occurs over the SMB protocol. Net can be used to query a remote system for available shared drives using the net view \\\\\\\\remotesystem command. It can also be used to query shared drives on the local system using net share. For macOS, the sharing -l command lists all shared points used for smb services.","detection":"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained. Normal, benign system and network events related to legitimate remote system discovery may be uncommon, depending on the environment and how they are used. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.","procedures":["[S1081] BADHATCH: BADHATCH can check a user's access to the C$ share on a compromised machine.","[S1180] BlackByte Ransomware: BlackByte Ransomware can identify network shares connected to the victim machine.","[S0458] Ramsay: Ramsay can scan for network drives which may contain documents for collection.","[C0015] C0015: During C0015, the threat actors executed the PowerView ShareFinder module to identify open shares.","[S0575] Conti: Conti can enumerate remote open SMB network shares using NetShareEnum().","[G0131] Tonto Team: Tonto Team has used tools such as NBTscan to enumerate network shares.","[S0192] Pupy: Pupy can list local and remote shared drives and folders over SMB.","[S0534] Bazar: Bazar can enumerate shared drives on the domain.","[S1160] Latrodectus: Latrodectus can run `C:\\Windows\\System32\\cmd.exe /c net view /all` to discover network shares.","[S0625] Cuba: Cuba can discover shared resources using the NetShareEnum API call.","[S0236] Kwampirs: Kwampirs collects a list of network shares with the command net share.","[S0650] QakBot: QakBot can use net share to identify network shares for use in lateral movement.","[G0087] APT39: APT39 has used the post exploitation tool CrackMapExec to enumerate network shares.","[S0692] SILENTTRINITY: SILENTTRINITY can enumerate shares on a compromised host.","[S0659] Diavol: Diavol has a `ENMDSKS` command to enumerates available network shares.","[G0105] DarkVishnya: DarkVishnya scanned the network for public shared folders.","[S0039] Net: The net view \\\\remotesystem and net share commands in Net can be used to find shared drives and directories on remote and local systems respectively.","[S1141] LunarWeb: LunarWeb can identify shared resources in compromised environments.","[G0050] APT32: APT32 used the net view command to show all shares available, including the administrative shares such as C$ and ADMIN$.","[S0618] FIVEHANDS: FIVEHANDS can enumerate network shares and mounted drives on a network.","[S0367] Emotet: Emotet has enumerated non-hidden network shares using `WNetEnumResourceW`.","[G0096] APT41: APT41 used the net share command as part of network reconnaissance.","[S1085] Sardonic: Sardonic has the ability to execute the `net view` command.","[S0013] PlugX: PlugX has a module to enumerate network shares.","[S0488] CrackMapExec: CrackMapExec can enumerate the shared folders and associated permissions for a targeted network.","[S0570] BitPaymer: BitPaymer can search for network shares on the domain or workgroup using net view .","[S1139] INC Ransomware: INC Ransomware has the ability to check for shared network drives to encrypt.","[S0363] Empire: Empire can find shared drives on the local system.","[G0114] Chimera: Chimera has used net share and net view to identify network shares of interest.","[S0606] Bad Rabbit: Bad Rabbit enumerates open SMB shares on internal victim networks.","[S1181] BlackByte 2.0 Ransomware: BlackByte 2.0 Ransomware can identify network shares connected to the victim machine.","[S0266] TrickBot: TrickBot module shareDll/mshareDll discovers network shares via the WNetOpenEnumA API.","[C0014] Operation Wocao: During Operation Wocao, threat actors discovered network disks mounted to the system using netstat.","[S1075] KOPILUWAK: KOPILUWAK can use netstat and Net to discover network shares.","[S1129] Akira: Akira can identify remote file shares for encryption.","[S1199] LockBit 2.0: LockBit 2.0 can discover remote shares.","[G0082] APT38: APT38 has enumerated network shares on a compromised host.","[S1073] Royal: Royal can enumerate the shared resources of a given IP addresses using the API call `NetShareEnum`.","[S0689] WhisperGate: WhisperGate can enumerate connected remote logical drives.","[S0617] HELLOKITTY: HELLOKITTY has the ability to enumerate network resources.","[S0660] Clambling: Clambling has the ability to enumerate network shares.","[S1202] LockBit 3.0: LockBit 3.0 can identify network shares on compromised systems.","[S1068] BlackCat: BlackCat has the ability to discover network shares on compromised networks.","[C0049] Leviathan Australian Intrusions: Leviathan scanned and enumerated remote network shares in victim environments during Leviathan Australian Intrusions.","[S0154] Cobalt Strike: Cobalt Strike can query shared drives on the local system.","[S0640] Avaddon: Avaddon has enumerated shared folders and mapped volumes.","[G1043] BlackByte: BlackByte enumerated network shares on victim devices.","[S0696] Flagpro: Flagpro has been used to execute `net view` to discover mapped network shares.","[S0611] Clop: Clop can enumerate network shares.","[S0483] IcedID: IcedID has used the `net view /all` command to show available shares.","[S0638] Babuk: Babuk has the ability to enumerate network shares.","[G1016] FIN13: FIN13 has executed net view commands for enumeration of open shares on compromised machines.","[G0081] Tropic Trooper: Tropic Trooper used netview to scan target systems for shared resources.","[S1212] RansomHub: RansomHub has the ability to target specific network shares for encryption.","[S0612] WastedLocker: WastedLocker can identify network adjacent and accessible drives.","[S0365] Olympic Destroyer: Olympic Destroyer will attempt to enumerate mapped network shares to later attempt to wipe all files on those shares.","[G1032] INC Ransom: INC Ransom has used Internet Explorer to view folders on other systems.","[G0054] Sowbug: Sowbug listed remote shared drives that were accessible from a victim.","[S0233] MURKYTOP: MURKYTOP has the capability to retrieve information about shares on remote hosts.","[S0165] OSInfo: OSInfo discovers shares on the network","[S0603] Stuxnet: Stuxnet enumerates the directories of a network resource.","[S0444] ShimRat: ShimRat can enumerate connected drives for infected host machines.","[G0035] Dragonfly: Dragonfly has identified and browsed file servers in the victim network, sometimes , viewing files pertaining to ICS or Supervisory Control and Data Acquisition (SCADA) systems.","[S1053] AvosLocker: AvosLocker has enumerated shared drives on a compromised network.","[C0012] Operation CuckooBees: During Operation CuckooBees, the threat actors used the `net share` command as part of their advanced reconnaissance.","[G0006] APT1: APT1 listed connected network shares.","[S0260] InvisiMole: InvisiMole can gather network share information.","[S0251] Zebrocy: Zebrocy identifies network drives when they are added to victim systems.","[G0102] Wizard Spider: Wizard Spider has used the “net view” command to locate mapped network shares.","[S0250] Koadic: Koadic can scan local network for open SMB.","[S0616] DEATHRANSOM: DEATHRANSOM has the ability to use loop operations to enumerate network resources.","[S0686] QuietSieve: QuietSieve can identify and search networked drives for specific file name extensions.","[S1159] DUSTTRAP: DUSTTRAP can identify and enumerate victim system network shares."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1201","technique_name":"Password Policy Discovery","description":"Adversaries may attempt to access detailed information about the password policy used within an enterprise network or cloud environment. Password policies are a way to enforce complex passwords that are difficult to guess or crack through Brute Force. This information may help the adversary to create a list of common passwords and launch dictionary and/or brute force attacks which adheres to the policy (e.g. if the minimum password length should be 8, then not trying passwords such as 'pass123'; not checking for more than 3-4 passwords per account if the lockout is set to 6 as to not lock out accounts). Password policies can be set and discovered on Windows, Linux, and macOS systems via various command shell utilities such as net accounts (/domain), Get-ADDefaultDomainPasswordPolicy, chage -l , cat /etc/pam.d/common-password, and pwpolicy getaccountpolicies . Adversaries may also leverage a Network Device CLI on network devices to discover password policy information (e.g. show aaa, show aaa common-criteria policy all). Password policies can be discovered in cloud environments using available APIs such as GetAccountPasswordPolicy in AWS .","detection":"Monitor logs and processes for tools and command line arguments that may indicate they're being used for password policy discovery. Correlate that activity with other suspicious activity from the originating system to reduce potential false positives from valid user or administrator activity. Adversaries will likely attempt to find the password policy early in an operation and the activity is likely to happen with other Discovery activity.","procedures":["[S0039] Net: The net accounts and net accounts /domain commands with Net can be used to obtain password policy information.","[S0488] CrackMapExec: CrackMapExec can discover the password policies applied to the target system.","[C0012] Operation CuckooBees: During Operation CuckooBees, the threat actors used the `net accounts` command as part of their advanced reconnaissance.","[G0049] OilRig: OilRig has used net.exe in a script with net accounts /domain to find the password policy of a domain.","[G0114] Chimera: Chimera has used the NtdsAudit utility to collect information related to accounts and passwords.","[S0236] Kwampirs: Kwampirs collects password policy information with the command net accounts.","[G0010] Turla: Turla has used net accounts and net accounts /domain to acquire password policy information.","[S0378] PoshC2: PoshC2 can use Get-PassPol to enumerate the domain password policy."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1217","technique_name":"Browser Information Discovery","description":"Adversaries may enumerate information about browsers to learn more about compromised environments. Data saved by browsers (such as bookmarks, accounts, and browsing history) may reveal a variety of personal information about users (e.g., banking sites, relationships/interests, social media, etc.) as well as details about internal network resources such as servers, tools/dashboards, or other related infrastructure. Browser information may also highlight additional targets after an adversary has access to valid credentials, especially Credentials In Files associated with logins cached by a browser. Specific storage locations vary based on platform and/or application, but browser information is typically stored in local files and databases (e.g., `%APPDATA%/Google/Chrome`).","detection":"Monitor processes and command-line arguments for actions that could be taken to gather browser bookmark information. Remote access tools with built-in features may interact directly using APIs to gather information. Information may also be acquired through system management tools such as Windows Management Instrumentation and PowerShell. System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Collection and Exfiltration, based on the information obtained.","procedures":["[S0274] Calisto: Calisto collects information on bookmarks from Google Chrome.","[S0681] Lizar: Lizar can retrieve browser history and database files.","[C0044] Juicy Mix: During Juicy Mix, OilRig used the CDumper (Chrome browser) and EDumper (Edge browser) data stealers to collect cookies, browsing history, and credentials.","[S0409] Machete: Machete retrieves the user profile data (e.g., browsers) from Chrome and Firefox browsers.","[C0042] Outer Space: During Outer Space, OilRig used a Chrome data dumper named MKG.","[S1122] Mispadu: Mispadu can monitor browser activity for online banking actions and display full-screen overlay images to block user access to the intended site or present additional data fields.","[S1012] PowerLess: PowerLess has a browser info stealer module that can read Chrome and Edge browser database files.","[S0567] Dtrack: Dtrack can retrieve browser history.","[G0117] Fox Kitten: Fox Kitten has used Google Chrome bookmarks to identify internal resources and assets.","[G1017] Volt Typhoon: Volt Typhoon has targeted the browsing history of network administrators.","[G0082] APT38: APT38 has collected browser bookmark information to learn more about compromised hosts, obtain personal information about users, and acquire details about internal network resources.","[S0673] DarkWatchman: DarkWatchman can retrieve browser history.","[S1060] Mafalda: Mafalda can collect the contents of the `%USERPROFILE%\\AppData\\Local\\Google\\Chrome\\User Data\\LocalState` file.","[S0363] Empire: Empire has the ability to gather browser data such as bookmarks and visited sites.","[S1185] LightSpy: To collect data on the host's Wi-Fi connection history, LightSpy reads the `/Library/Preferences/SystemConfiguration/com.apple.airport.preferences.plist` file. It also utilizes Apple's `CWWiFiClient` API to scan for nearby Wi-Fi networks and obtain data on the SSID, security type, and RSSI (signal strength) values.","[S1042] SUGARDUMP: SUGARDUMP has collected browser bookmark and history information.","[S1196] Troll Stealer: Troll Stealer collects information from Chromium-based browsers and Firefox such as cookies, history, downloads, and extensions.","[G1015] Scattered Spider: Scattered Spider retrieves browser histories via infostealer malware such as Raccoon Stealer.","[S0079] MobileOrder: MobileOrder has a command to upload to its C2 server victim browser bookmarks.","[S1213] Lumma Stealer: Lumma Stealer has identified and gathered information from two-factor authentication extensions for multiple browsers.","[G1036] Moonstone Sleet: Moonstone Sleet deployed malware such as YouieLoader capable of capturing victim system browser information.","[G0114] Chimera: Chimera has used type \\\\\\c$\\Users\\\\Favorites\\Links\\Bookmarks bar\\Imported From IE\\*citrix* for bookmark discovery.","[S1153] Cuckoo Stealer: Cuckoo Stealer can collect bookmarks, cookies, and history from Safari."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1482","technique_name":"Domain Trust Discovery","description":"Adversaries may attempt to gather information on domain trust relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments. Domain trusts provide a mechanism for a domain to allow access to resources based on the authentication procedures of another domain. Domain trusts allow the users of the trusted domain to access resources in the trusting domain. The information discovered may help the adversary conduct SID-History Injection, Pass the Ticket, and Kerberoasting. Domain trusts can be enumerated using the `DSEnumerateDomainTrusts()` Win32 API call, .NET methods, and LDAP. The Windows utility Nltest is known to be used by adversaries to enumerate domain trusts.","detection":"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation but as part of a chain of behavior that could lead to other activities based on the information obtained. Monitor processes and command-line arguments for actions that could be taken to gather system and network information, such as `nltest /domain_trusts`. Remote access tools with built-in features may interact directly with the Windows API to gather information. Look for the `DSEnumerateDomainTrusts()` Win32 API call to spot activity associated with Domain Trust Discovery. Information may also be acquired through Windows system management tools such as PowerShell. The .NET method `GetAllTrustRelationships()` can be an indicator of Domain Trust Discovery.","procedures":["[S0363] Empire: Empire has modules for enumerating domain trusts.","[G1043] BlackByte: BlackByte enumerated Active Directory information and trust relationships during operations.","[S0534] Bazar: Bazar can use Nltest tools to obtain information about the domain.","[S0483] IcedID: IcedID used Nltest during initial discovery.","[S1145] Pikabot: Pikabot will gather information concerning the Windows Domain the victim machine is a member of during execution.","[S0552] AdFind: AdFind can gather information about organizational units (OUs) and domain trusts from Active Directory.","[S1071] Rubeus: Rubeus can gather information about domain trusts.","[G1024] Akira: Akira uses the built-in Nltest utility or tools such as AdFind to enumerate Active Directory trusts in victim environments.","[G0114] Chimera: Chimera has nltest /domain_trusts to identify domain trust relationships.","[S1124] SocGholish: SocGholish can profile compromised systems to identify domain trust relationships.","[C0049] Leviathan Australian Intrusions: Leviathan performed Active Directory enumeration of victim environments during Leviathan Australian Intrusions.","[G0030] Lotus Blossom: Lotus Blossom has used tools such as AdFind to make Active Directory queries.","[S1146] MgBot: MgBot includes modules for collecting information on local domain users and permissions.","[S0359] Nltest: Nltest may be used to enumerate trusted domains by using commands such as nltest /domain_trusts.","[S0650] QakBot: QakBot can run nltest /domain_trusts /all_trusts for domain trust discovery.","[G1006] Earth Lusca: Earth Lusca has used Nltest to obtain information about domain controllers.","[S1063] Brute Ratel C4: Brute Ratel C4 can use LDAP queries and `nltest /domain_trusts` for domain trust discovery.","[S0521] BloodHound: BloodHound has the ability to map domain trusts and identify misconfigurations for potential abuse.","[S1160] Latrodectus: Latrodectus can run `C:\\Windows\\System32\\cmd.exe /c nltest /domain_trusts` to discover domain trusts.","[S1081] BADHATCH: BADHATCH can use `nltest.exe /domain_trusts` to discover domain trust relationships on a compromised machine.","[S1159] DUSTTRAP: DUSTTRAP can identify Active Directory information and related items.","[S0378] PoshC2: PoshC2 has modules for enumerating domain trusts.","[G1046] Storm-1811: Storm-1811 has enumerated domain accounts and access during intrusions.","[C0024] SolarWinds Compromise: During the SolarWinds Compromise, APT29 used the `Get-AcceptedDomain` PowerShell cmdlet to enumerate accepted domains through an Exchange Management Shell. They also used AdFind to enumerate domains and to discover trust between federated domains.","[G0059] Magic Hound: Magic Hound has used a web shell to execute `nltest /trusted_domains` to identify trust relationships.","[S0105] dsquery: dsquery can be used to gather information on domain trusts with dsquery * -filter \"(objectClass=trustedDomain)\" -attr *.","[S0194] PowerSploit: PowerSploit has modules such as Get-NetDomainTrust and Get-NetForestTrust to enumerate domain and forest trusts.","[S0266] TrickBot: TrickBot can gather information about domain trusts by utilizing Nltest.","[G0061] FIN8: FIN8 has retrieved a list of trusted domains by using nltest.exe /domain_trusts.","[C0015] C0015: During C0015, the threat actors used the command `nltest /domain_trusts /all_trusts` to enumerate domain trusts."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1497.001","technique_name":"Virtualization/Sandbox Evasion: System Checks","description":"Adversaries may employ various system checks to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for VME artifacts before dropping secondary or additional payloads. Adversaries may use the information learned from Virtualization/Sandbox Evasion during automated discovery to shape follow-on behaviors. Specific checks will vary based on the target and/or adversary, but may involve behaviors such as Windows Management Instrumentation, PowerShell, System Information Discovery, and Query Registry to obtain system information and search for VME artifacts. Adversaries may search for VME artifacts in memory, processes, file system, hardware, and/or the Registry. Adversaries may use scripting to automate these checks into one script and then have the program exit if it determines the system to be a virtual environment. Checks could include generic system properties such as host/domain name and samples of network traffic. Adversaries may also check the network adapters addresses, CPU core count, and available memory/drive size. Once executed, malware may also use File and Directory Discovery to check if it was saved in a folder or file with unexpected or even analysis-related naming artifacts such as `malware`, `sample`, or `hash`. Other common checks may enumerate services running that are unique to these applications, installed programs on the system, manufacturer/product fields for strings relating to virtual machine applications, and VME-specific hardware/processor instructions. In applications like VMWare, adversaries can also use a special I/O port to send commands and receive output. Hardware checks, such as the presence of the fan, temperature, and audio devices, could also be used to gather evidence that can be indicative a virtual environment. Adversaries may also query for specific readings from these devices.","detection":"Virtualization/sandbox related system checks will likely occur in the first steps of an operation but may also occur throughout as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as lateral movement, based on the information obtained. Detecting actions related to virtualization and sandbox identification may be difficult depending on the adversary's implementation and monitoring required. Monitoring for suspicious processes being spawned that gather a variety of system information or perform other forms of Discovery, especially in a short period of time, may aid in detection.","procedures":["[S0650] QakBot: QakBot can check the compromised host for the presence of multiple executables associated with analysis tools and halt execution if any are found.","[S0354] Denis: Denis ran multiple system checks, looking for processor and register characteristics, to evade emulation and analysis.","[S0627] SodaMaster: SodaMaster can check for the presence of the Registry key HKEY_CLASSES_ROOT\\\\Applications\\\\VMwareHostOpen.exe before proceeding to its main functionality.","[S0439] Okrum: Okrum's loader can check the amount of physical memory and terminates itself if the host has less than 1.5 Gigabytes of physical memory in total.","[S0260] InvisiMole: InvisiMole can check for artifacts of VirtualBox, Virtual PC and VMware environment, and terminate itself if they are detected.","[G0120] Evilnum: Evilnum has used a component called TerraLoader to check certain hardware and file information to detect sandboxed environments.","[S0024] Dyre: Dyre can detect sandbox analysis environments by inspecting the process list and Registry.","[C0022] Operation Dream Job: During Operation Dream Job, Lazarus Group used tools that conducted a variety of system checks to detect sandboxes or VMware services.","[S0438] Attor: Attor can detect whether it is executed in some virtualized or emulated environment by searching for specific artifacts, such as communication with I/O ports and using VM-specific instructions.","[S1039] Bumblebee: Bumblebee has the ability to search for designated file paths and Registry keys that indicate a virtualized environment from multiple products.","[S0182] FinFisher: FinFisher obtains the hardware device list and checks if the MD5 of the vendor ID is equal to a predefined list in order to check for sandbox/virtualized environments.","[S0373] Astaroth: Astaroth can check for Windows product ID's used by sandboxes and usernames and disk serial numbers associated with analyst environments.","[S0242] SynAck: SynAck checks its directory location in an attempt to avoid launching in a sandbox.","[S0576] MegaCortex: MegaCortex has checked the number of CPUs in the system to avoid being run in a sandbox or emulator.","[S0352] OSX_OCEANLOTUS.D: OSX_OCEANLOTUS.D checks a number of system parameters to see if it is being run on real hardware or in a virtual machine environment, such as `sysctl hw.model` and the kernel boot time.","[S1048] macOS.OSAMiner: macOS.OSAMiner can parse the output of the native `system_profiler` tool to determine if the machine is running with 4 cores.","[S0226] Smoke Loader: Smoke Loader scans processes to perform anti-VM checks.","[S0561] GuLoader: GuLoader has the ability to perform anti-VM and anti-sandbox checks using string hashing, the API call EnumWindows, and checking for Qemu guest agent.","[S0396] EvilBunny: EvilBunny's dropper has checked the number of processes and the length and strings of its own file name to identify if the malware is in a sandbox environment.","[S0248] yty: yty has some basic anti-sandbox detection that tries to detect Virtual PC, Sandboxie, and VMware.","[S0532] Lucifer: Lucifer can check for specific usernames, computer names, device drivers, DLL's, and virtual devices associated with sandboxed environments and can enter an infinite loop and stop itself if any are detected.","[G1017] Volt Typhoon: Volt Typhoon has run system checks to determine if they were operating in a virtualized environment.","[S0237] GravityRAT: GravityRAT uses WMI to check the BIOS and manufacturer information for strings like \"VMWare\", \"Virtual\", and \"XEN\" and another WMI request to get the current temperature of the hardware to determine if it's a virtual machine environment.","[S1213] Lumma Stealer: Lumma Stealer has queried system resources on the victim device to identify if it is executing in a sandbox or virtualized environments, checking usernames, conducting WMI queries for system details, checking for files commonly found in virtualized environments, searching system services, and inspecting process names. Lumma Stealer has checked system GPU configurations for sandbox detection.","[S0337] BadPatch: BadPatch attempts to detect if it is being run in a Virtual Machine (VM) using a WMI query for disk drive name, BIOS, and motherboard information.","[S0428] PoetRAT: PoetRAT checked the size of the hard drive to determine if it was being run in a sandbox environment. In the event of sandbox detection, it would delete itself by overwriting the malware scripts with the contents of \"License.txt\" and exiting.","[S0612] WastedLocker: WastedLocker checked if UCOMIEnumConnections and IActiveScriptParseProcedure32 Registry keys were detected as part of its anti-analysis technique.","[S0264] OopsIE: OopsIE performs several anti-VM and sandbox checks on the victim's machine. One technique the group has used was to perform a WMI query SELECT * FROM MSAcpi_ThermalZoneTemperature to check the temperature to see if it’s running in a virtual environment.","[S1066] DarkTortilla: DarkTortilla can search a compromised system's running processes and services to detect Hyper-V, QEMU, Virtual PC, Virtual Box, and VMware, as well as Sandboxie.","[S0333] UBoatRAT: UBoatRAT checks for virtualization software such as VMWare, VirtualBox, or QEmu on the compromised machine.","[S0689] WhisperGate: WhisperGate can stop its execution when it recognizes the presence of certain monitoring tools.","[S1087] AsyncRAT: AsyncRAT can identify strings such as Virtual, vmware, or VirtualBox to detect virtualized environments.","[S1018] Saint Bot: Saint Bot has run several virtual machine and sandbox checks, including checking if `Sbiedll.dll` is present in a list of loaded modules, comparing the machine name to `HAL9TH` and the user name to `JohnDoe`, and checking the BIOS version for known virtual machine identifiers.","[G0012] Darkhotel: Darkhotel malware has used a series of checks to determine if it's being analyzed; checks include the length of executable names, if a filename ends with .Md5.exe, and if the program is executed from the root of the C:\\ drive, as well as checks for sandbox-related libraries.","[S0013] PlugX: PlugX checks if VMware tools is running in the background by searching for any process named \"vmtoolsd\".","[S1019] Shark: Shark can stop execution if the screen width of the targeted machine is not over 600 pixels.","[S0192] Pupy: Pupy has a module that checks a number of indicators on the system to determine if its running on a virtual machine.","[S0626] P8RAT: P8RAT can check the compromised host for processes associated with VMware or VirtualBox environments.","[S0531] Grandoreiro: Grandoreiro can detect VMWare via its I/O port and Virtual PC via the vpcext instruction.","[S0240] ROKRAT: ROKRAT can check for VMware-related files and DLLs related to sandboxes.","[S0332] Remcos: Remcos searches for Sandboxie and VMware on the system.","[S1147] Nightdoor: Nightdoor embeds code from the public `al-khaser` project, a repository that works to detect virtual machines, sandboxes, and malware analysis environments.","[S1070] Black Basta: Black Basta can check system flags and libraries, process timing, and API's to detect code emulation or sandboxing.","[C0001] Frankenstein: During Frankenstein, the threat actors used a script that ran WMI queries to check if a VM or sandbox was running, including VMWare and Virtualbox. The script would also call WMI to determine the number of cores allocated to the system; if less than two the script would stop execution.","[S0270] RogueRobin: RogueRobin uses WMI to check BIOS version for VBOX, bochs, qemu, virtualbox, and vm to check for evidence that the script might be executing within an analysis environment.","[S0644] ObliqueRAT: ObliqueRAT can halt execution if it identifies processes belonging to virtual machine software or analysis tools.","[S0637] NativeZone: NativeZone has checked if Vmware or VirtualBox VM is running on a compromised host.","[S0094] Trojan.Karagany: Trojan.Karagany can detect commonly used and generic virtualization platforms based primarily on drivers and file paths.","[S0657] BLUELIGHT: BLUELIGHT can check to see if the infected machine has VM tools running.","[S1122] Mispadu: Mispadu can run checks to verify if it is running within a virtualized environments including Hyper-V, VirtualBox or VMWare and will terminate execution if the computer name is “JOHN-PC.”","[S1207] XLoader: XLoader performs timing checks using the Read-Time Stamp Counter (RDTSC) instruction on the victim CPU.","[S1064] SVCReady: SVCReady has the ability to determine if its runtime environment is virtualized.","[S0679] Ferocious: Ferocious can run anti-sandbox checks using the Microsoft Excel 4.0 function GET.WORKSPACE to determine the OS version, if there is a mouse present, and if the host is capable of playing sounds.","[S0559] SUNBURST: SUNBURST checked the domain name of the compromised host to verify it was running in a real environment.","[S1086] Snip3: Snip3 has the ability to detect Windows Sandbox, VMWare, or VirtualBox by querying `Win32_ComputerSystem` to extract the `Manufacturer` string.","[S1130] Raspberry Robin: Raspberry Robin performs a variety of system environment checks to determine if it is running in a virtualized or sandboxed environment, such as querying CPU temperature information and network card MAC address information.","[S0588] GoldMax: GoldMax will check if it is being run in a virtualized environment by comparing the collected MAC address to c8:27:cc:c2:37:5a.","[S1160] Latrodectus: Latrodectus can determine if it is running in a virtualized environment by checking the OS version, checking the number of running processes, ensuring a 64-bit application is running on a 64-bit host, and checking if the host has a valid MAC address.","[S0527] CSPY Downloader: CSPY Downloader can search loaded modules, PEB structure, file paths, Registry keys, and memory to determine if it is being debugged or running in a virtual environment.","[S1111] DarkGate: DarkGate queries system resources on an infected machine to identify if it is executing in a sandbox or virtualized environment.","[G0049] OilRig: OilRig has used macros to verify if a mouse is connected to a compromised machine.","[S1179] Exbyte: Exbyte performs various checks to determine if it is running in a sandboxed environment to prevent analysis.","[S1145] Pikabot: Pikabot performs a variety of system checks to determine if it is running in an analysis environment or sandbox, such as checking the number of processors (must be greater than two), and the amount of RAM (must be greater than 2GB).","[S1180] BlackByte Ransomware: BlackByte Ransomware checks for files related to known sandboxes.","[S1159] DUSTTRAP: DUSTTRAP decryption relies on the infected machine's `HKLM\\SOFTWARE\\Microsoft\\Cryptography\\MachineGUID` value."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1497.002","technique_name":"Virtualization/Sandbox Evasion: User Activity Based Checks","description":"Adversaries may employ various user activity checks to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for VME artifacts before dropping secondary or additional payloads. Adversaries may use the information learned from Virtualization/Sandbox Evasion during automated discovery to shape follow-on behaviors. Adversaries may search for user activity on the host based on variables such as the speed/frequency of mouse movements and clicks , browser history, cache, bookmarks, or number of files in common directories such as home or the desktop. Other methods may rely on specific user interaction with the system before the malicious code is activated, such as waiting for a document to close before activating a macro or waiting for a user to double click on an embedded image to activate.","detection":"User activity-based checks will likely occur in the first steps of an operation but may also occur throughout as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as lateral movement, based on the information obtained. Detecting actions related to virtualization and sandbox identification may be difficult depending on the adversary's implementation and monitoring required. Monitoring for suspicious processes being spawned that gather a variety of system information or perform other forms of Discovery, especially in a short period of time, may aid in detection.","procedures":["[G0012] Darkhotel: Darkhotel has used malware that repeatedly checks the mouse cursor position to determine if a real user is on the system.","[S0439] Okrum: Okrum loader only executes the payload after the left mouse button has been pressed at least three times, in order to avoid being executed within virtualized or emulated environments.","[G0046] FIN7: FIN7 used images embedded into document lures that only activate the payload when a user double clicks to avoid sandboxes.","[S0543] Spark: Spark has used a splash screen to check whether an user actively clicks on the screen before running malicious code."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1497.003","technique_name":"Virtualization/Sandbox Evasion: Time Based Evasion","description":"Adversaries may employ various time-based methods to detect and avoid virtualization and analysis environments. This may include enumerating time-based properties, such as uptime or the system clock, as well as the use of timers or other triggers to avoid a virtual machine environment (VME) or sandbox, specifically those that are automated or only operate for a limited amount of time. Adversaries may employ various time-based evasions, such as delaying malware functionality upon initial execution using programmatic sleep commands or native system scheduling functionality (ex: Scheduled Task/Job). Delays may also be based on waiting for specific victim conditions to be met (ex: system time, events, etc.) or employ scheduled Multi-Stage Channels to avoid analysis and scrutiny. Benign commands or other operations may also be used to delay malware execution. Loops or otherwise needless repetitions of commands, such as Pings, may be used to delay malware execution and potentially exceed time thresholds of automated analysis environments. Another variation, commonly referred to as API hammering, involves making various calls to Native API functions in order to delay execution (while also potentially overloading analysis environments with junk data). Adversaries may also use time as a metric to detect sandboxes and analysis environments, particularly those that attempt to manipulate time mechanisms to simulate longer elapses of time. For example, an adversary may be able to identify a sandbox accelerating time by sampling and calculating the expected value for an environment's timestamp before and after execution of a sleep function.","detection":"Time-based evasion will likely occur in the first steps of an operation but may also occur throughout as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as lateral movement, based on the information obtained. Detecting actions related to virtualization and sandbox identification may be difficult depending on the adversary's implementation and monitoring required. Monitoring for suspicious processes being spawned that gather a variety of system information or perform other forms of Discovery, especially in a short period of time, may aid in detection.","procedures":["[S0565] Raindrop: After initial installation, Raindrop runs a computation to delay execution.","[S0626] P8RAT: P8RAT has the ability to \"sleep\" for a specified time to evade detection.","[S0559] SUNBURST: SUNBURST remained dormant after initial access for a period of up to two weeks.","[S0574] BendyBear: BendyBear can check for analysis environments and signs of debugging using the Windows API kernel32!GetTickCountKernel32 call.","[S0554] Egregor: Egregor can perform a long sleep (greater than or equal to 3 minutes) to evade detection.","[S0611] Clop: Clop has used the sleep command to avoid sandbox detection.","[S0627] SodaMaster: SodaMaster has the ability to put itself to \"sleep\" for a specified time.","[S0660] Clambling: Clambling can wait 30 minutes before initiating contact with C2.","[S0386] Ursnif: Ursnif has used a 30 minute delay after execution to evade sandbox monitoring tools.","[S0439] Okrum: Okrum's loader can detect presence of an emulator by using two calls to GetTickCount API, and checking whether the time has been accelerated.","[S0512] FatDuke: FatDuke can turn itself on or off at random intervals.","[S1066] DarkTortilla: DarkTortilla can implement the `kernel32.dll` Sleep function to delay execution for up to 300 seconds before implementing persistence or processing an addon package.","[S1141] LunarWeb: LunarWeb can pause for a number of hours before entering its C2 communication loop.","[S1039] Bumblebee: Bumblebee has the ability to set a hardcoded and randomized sleep interval.","[S0115] Crimson: Crimson can determine when it has been installed on a host for at least 15 days before downloading the final payload.","[S1138] Gootloader: Gootloader can designate a sleep period of more than 22 seconds between stages of infection.","[S1018] Saint Bot: Saint Bot has used the command `timeout 20` to pause the execution of its initial loader.","[C0022] Operation Dream Job: During Operation Dream Job, Lazarus Group used tools that collected `GetTickCount` and `GetSystemTimeAsFileTime` data to detect sandbox or VMware services.","[S0671] Tomiris: Tomiris has the ability to sleep for at least nine minutes to evade sandbox-based analysis systems.","[S0697] HermeticWiper: HermeticWiper has the ability to receive a command parameter to sleep prior to carrying out destructive actions on a targeted host.","[S0447] Lokibot: Lokibot has performed a time-based anti-debug check before downloading its third stage.","[S1086] Snip3: Snip3 can execute `WScript.Sleep` to delay execution of its second stage.","[S1212] RansomHub: RansomHub can sleep for a set number of minutes before beginning execution.","[S0268] Bisonal: Bisonal has checked if the malware is running in a virtual environment with the anti-debug function GetTickCount() to compare the timing.","[S1034] StrifeWater: StrifeWater can modify its sleep time responses from the default of 20-22 seconds.","[S0453] Pony: Pony has delayed execution using a built-in function to avoid detection and analysis.","[S1132] IPsec Helper: IPsec Helper will sleep for a random number of seconds, iterating 200 times over sleeps between one to three seconds, before continuing execution flow.","[S0266] TrickBot: TrickBot has used printf and file I/O loops to delay process execution as part of API hammering.","[S1059] metaMain: metaMain has delayed execution for five to six minutes during its persistence establishment process.","[S0650] QakBot: The QakBot dropper can delay dropping the payload to evade detection.","[S0513] LiteDuke: LiteDuke can wait 30 seconds before executing additional code if security software is detected.","[S0632] GrimAgent: GrimAgent can sleep for 195 - 205 seconds after payload execution and before deleting its task.","[S0534] Bazar: Bazar can use a timer to delay execution of core functionality.","[S0396] EvilBunny: EvilBunny has used time measurements from 3 different APIs before and after performing sleep operations to check and abort if the malware is running in a sandbox.","[S0642] BADFLICK: BADFLICK has delayed communication to the actor-controlled IP address by 5 minutes.","[S0493] GoldenSpy: GoldenSpy's installer has delayed installation of GoldenSpy for two hours after it reaches a victim system.","[S0689] WhisperGate: WhisperGate can pause for 20 seconds to bypass antivirus solutions.","[S0694] DRATzarus: DRATzarus can use the `GetTickCount` and `GetSystemTimeAsFileTime` API calls to measure function timing. DRATzarus can also remotely shut down into sleep mode under specific conditions to evade detection.","[S0588] GoldMax: GoldMax has set an execution trigger date and time, stored as an ASCII Unix/Epoch time value.","[S0561] GuLoader: GuLoader has the ability to perform anti-debugging based on time checks, API calls, and CPUID.","[S1064] SVCReady: SVCReady can enter a sleep stage for 30 minutes to evade detection.","[S1063] Brute Ratel C4: Brute Ratel C4 can call `NtDelayExecution` to pause execution.","[S0658] XCSSET: Using the machine's local time, XCSSET waits 43200 seconds (12 hours) from the initial creation timestamp of a specific file, .report. After the elapsed time, XCSSET executes additional modules.","[S0595] ThiefQuest: ThiefQuest invokes time call to check the system's time, executes a sleep command, invokes a second time call, and then compares the time difference between the two time calls and the amount of time the system slept to identify the sandbox.","[S0584] AppleJeus: AppleJeus has waited a specified time before downloading a second stage payload."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1518.001","technique_name":"Software Discovery: Security Software Discovery","description":"Adversaries may attempt to get a listing of security software, configurations, defensive tools, and sensors that are installed on a system or in a cloud environment. This may include things such as cloud monitoring agents and anti-virus. Adversaries may use the information from Security Software Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Example commands that can be used to obtain security software information are netsh, reg query with Reg, dir with cmd, and Tasklist, but other indicators of discovery behavior may be more specific to the type of software or security system the adversary is looking for. It is becoming more common to see macOS malware perform checks for LittleSnitch and KnockKnock software. Adversaries may also utilize the Cloud API to discover cloud-native security software installed on compute infrastructure, such as the AWS CloudWatch agent, Azure VM Agent, and Google Cloud Monitor agent. These agents may collect metrics and logs from the VM, which may be centrally aggregated in a cloud-based monitoring platform.","detection":"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as lateral movement, based on the information obtained. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell. In cloud environments, additionally monitor logs for the usage of APIs that may be used to gather information about security software configurations within the environment.","procedures":["[G0012] Darkhotel: Darkhotel has searched for anti-malware strings and anti-virus processes running on the system.","[S1130] Raspberry Robin: Raspberry Robin attempts to identify security software running on the victim machine, such as BitDefender, Avast, and Kaspersky.","[S0611] Clop: Clop can search for processes with antivirus and antimalware product names.","[S0469] ABK: ABK has the ability to identify the installed anti-virus product on the compromised host.","[C0014] Operation Wocao: During Operation Wocao, threat actors used scripts to detect security software.","[G0121] Sidewinder: Sidewinder has used the Windows service winmgmts:\\\\.\\root\\SecurityCenter2 to check installed antivirus products.","[S0455] Metamorfo: Metamorfo collects a list of installed antivirus software from the victim’s system.","[S0650] QakBot: QakBot can identify the installed antivirus product on a targeted system.","[S0339] Micropsia: Micropsia searches for anti-virus software and firewall products installed on the victim’s machine using WMI.","[G1008] SideCopy: SideCopy uses a loader DLL file to collect AV product names from an infected host.","[S0115] Crimson: Crimson contains a command to collect information about anti-virus software on the victim.","[S0330] Zeus Panda: Zeus Panda checks to see if anti-virus, anti-spyware, or firewall products are installed in the victim’s environment.","[G0112] Windshift: Windshift has used malware to identify installed AV and commonly used forensic and malware analysis tools.","[G0082] APT38: APT38 has identified security software, configurations, defensive tools, and sensors installed on a compromised system.","[G0061] FIN8: FIN8 has used Registry keys to detect and avoid executing in potential sandboxes.","[G1044] APT42: APT42 has used Windows Management Instrumentation (WMI) to check for anti-virus products.","[S1025] Amadey: Amadey has checked for a variety of antivirus products.","[G1018] TA2541: TA2541 has used tools to search victim systems for security products such as antivirus and firewall software.","[S0244] Comnie: Comnie attempts to detect several anti-virus products.","[G0089] The White Company: The White Company has checked for specific antivirus products on the target’s computer, including Kaspersky, Quick Heal, AVG, BitDefender, Avira, Sophos, Avast!, and ESET.","[G0019] Naikon: Naikon uses commands such as netsh advfirewall firewall to discover local firewall settings.","[S0534] Bazar: Bazar can identify the installed antivirus engine.","[G0080] Cobalt Group: Cobalt Group used a JavaScript backdoor that is capable of collecting a list of the security solutions installed on the victim's machine.","[S0046] CozyCar: The main CozyCar dropper checks whether the victim has an anti-virus product installed. If the installed product is on a predetermined list, the dropper will exit.","[S1213] Lumma Stealer: Lumma Stealer has detected antivirus processes using commands such as “tasklist” and “findstr.”","[S1013] ZxxZ: ZxxZ can search a compromised host to determine if it is running Windows Defender or Kasperky antivirus.","[S0196] PUNCHBUGGY: PUNCHBUGGY can gather AVs registered in the system.","[S1066] DarkTortilla: DarkTortilla can check for the Kaspersky Anti-Virus suite.","[S0223] POWERSTATS: POWERSTATS has detected security tools.","[S0267] FELIXROOT: FELIXROOT checks for installed security software like antivirus and firewall.","[S0467] TajMahal: TajMahal has the ability to identify which anti-virus products, firewalls, and anti-spyware products are in use.","[S0256] Mosquito: Mosquito's installer searches the Registry and system to see if specific antivirus tools are installed on the system.","[S0257] VERMIN: VERMIN uses WMI to check for anti-virus software installed on the system.","[S0476] Valak: Valak can determine if a compromised host has security products installed.","[S0468] Skidmap: Skidmap has the ability to check if /usr/sbin/setenforce exists. This file controls what mode SELinux is in.","[S0143] Flame: Flame identifies security software such as antivirus through the Security module.","[S0373] Astaroth: Astaroth checks for the presence of Avast antivirus in the C:\\Program\\Files\\ folder.","[S1039] Bumblebee: Bumblebee can identify specific analytical tools based on running processes.","[S0473] Avenger: Avenger has the ability to identify installed anti-virus products on a compromised host.","[S0184] POWRUNER: POWRUNER may collect information on the victim's anti-virus software.","[C0001] Frankenstein: During Frankenstein, the threat actors used WMI queries to determine if analysis tools were running on a compromised system.","[S0657] BLUELIGHT: BLUELIGHT can collect a list of anti-virus products installed on a machine.","[S1065] Woody RAT: Woody RAT can detect Avast Software, Doctor Web, Kaspersky, AVG, ESET, and Sophos antivirus programs.","[S0368] NotPetya: NotPetya determines if specific antivirus programs are running on an infected host machine.","[S0388] YAHOYAH: YAHOYAH checks for antimalware solution processes on the system.","[G0102] Wizard Spider: Wizard Spider has used WMI to identify anti-virus products installed on a victim's machine.","[S1159] DUSTTRAP: DUSTTRAP can identify security software.","[S0457] Netwalker: Netwalker can detect and terminate active security software-related processes on infected systems.","[G0040] Patchwork: Patchwork scanned the “Program Files” directories for a directory with the string “Total Security” (the installation path of the “360 Total Security” antivirus tool).","[S0652] MarkiRAT: MarkiRAT can check for running processes on the victim’s machine to look for Kaspersky and Bitdefender antivirus products.","[G0069] MuddyWater: MuddyWater has used malware to check running processes against a hard-coded list of security tools often used by malware researchers.","[S0679] Ferocious: Ferocious has checked for AV software as part of its persistence process.","[S0531] Grandoreiro: Grandoreiro can list installed security products including the Trusteer and Diebold Warsaw GAS Tecnologia online banking protections.","[S0098] T9000: T9000 performs checks for various antivirus and security products during installation.","[S0023] CHOPSTICK: CHOPSTICK checks for antivirus and forensics software.","[S0472] down_new: down_new has the ability to detect anti-virus products and processes on a compromised host.","[S0471] build_downer: build_downer has the ability to detect if the infected host is running an anti-virus process.","[S0381] FlawedAmmyy: FlawedAmmyy will attempt to detect anti-virus products during the initial infection.","[S0689] WhisperGate: WhisperGate can recognize the presence of monitoring tools on a target system.","[S0491] StrongPity: StrongPity can identify if ESET or BitDefender antivirus are installed before dropping its payload.","[S0380] StoneDrill: StoneDrill can check for antivirus and antimalware programs.","[S0483] IcedID: IcedID can identify AV products on an infected host using the following command: ` WMIC.exe WMIC /Node:localhost /Namespace:\\\\root\\SecurityCenter2 Path AntiVirusProduct Get * /Format:List`.","[S0057] Tasklist: Tasklist can be used to enumerate security software currently running on a system by process name of known products.","[S0484] Carberp: Carberp has queried the infected system's registry searching for specific registry keys associated with antivirus products.","[S1063] Brute Ratel C4: Brute Ratel C4 can detect EDR userland hooks.","[S1179] Exbyte: Exbyte checks for the presence of various security software products during execution.","[G0143] Aquatic Panda: Aquatic Panda has attempted to discover third party endpoint detection and response (EDR) tools on compromised systems.","[S0653] xCaon: xCaon has checked for the existence of Kaspersky antivirus software on the system.","[S0171] Felismus: Felismus checks for processes associated with anti-virus vendors.","[G0094] Kimsuky: Kimsuky has checked for the presence of antivirus software with powershell Get-CimInstance -Namespace root/securityCenter2 – classname antivirusproduct.","[S0666] Gelsemium: Gelsemium can check for the presence of specific security products.","[G0139] TeamTNT: TeamTNT has searched for security products on infected machines.","[S0283] jRAT: jRAT can list security software, such as by using WMIC to identify anti-virus products installed on the victim’s machine and to obtain firewall details.","[G1026] Malteiro: Malteiro collects the installed antivirus on the victim machine.","[S0088] Kasidet: Kasidet has the ability to identify any anti-virus installed on the infected system.","[S0113] Prikormka: A module in Prikormka collects information from the victim about installed anti-virus software.","[S0270] RogueRobin: RogueRobin enumerates running processes to search for Wireshark and Windows Sysinternals suite.","[S0579] Waterbear: Waterbear can find the presence of a specific security software.","[S0603] Stuxnet: Stuxnet enumerates the currently running processes related to a variety of security products.","[S1122] Mispadu: Mispadu can list installed security products in the victim’s environment.","[S0201] JPIN: JPIN checks for the presence of certain security-related processes and deletes its installer/uninstaller component if it identifies any of them.","[S0062] DustySky: DustySky checks for the existence of anti-virus.","[G0010] Turla: Turla has obtained information on security software, including security logging information that may indicate whether their malware has been detected.","[S1160] Latrodectus: Latrodectus has the ability to identify installed antivirus products.","[S1149] CHIMNEYSWEEP: CHIMNEYSWEEP is capable of checking whether a compromised device is running DeepFreeze by Faronics.","[S0176] Wingbird: Wingbird checks for the presence of Bitdefender security software.","[G1022] ToddyCat: ToddyCat can determine is Kaspersky software is running on an endpoint by running `cmd /c wmic process where name=\"avp.exe\"`.","[S1111] DarkGate: DarkGate looks for various security products by process name using hard-coded values in the malware. DarkGate will not execute its keylogging thread if a process name associated with Trend Micro anti-virus is identified, or if runtime checks identify the presence of Kaspersky anti-virus. DarkGate will initiate a new thread if certain security products are identified on the victim, and recreate any malicious files associated with it if it determines they were removed by security software in a new system location.","[S0681] Lizar: Lizar can search for processes associated with an anti-virus product from list.","[S0658] XCSSET: XCSSET searches firewall configuration files located in /Library/Preferences/ and uses csrutil status to determine if System Integrity Protection is enabled.","[S0284] More_eggs: More_eggs can obtain information on installed anti-malware programs.","[S0363] Empire: Empire can enumerate antivirus software on the target.","[S0492] CookieMiner: CookieMiner has checked for the presence of \"Little Snitch\", macOS network monitoring and application firewall software, stopping and exiting if it is found.","[S0513] LiteDuke: LiteDuke has the ability to check for the presence of Kaspersky security software.","[S0337] BadPatch: BadPatch uses WMI to enumerate installed security products in the victim’s environment.","[G1040] Play: Play has used the information-stealing tool Grixba to scan for anti-virus software.","[S1060] Mafalda: Mafalda can search for a variety of security software programs, EDR systems, and malware analysis tools.","[G0081] Tropic Trooper: Tropic Trooper can search for anti-virus software running on the system.","[S0568] EVILNUM: EVILNUM can search for anti-virus products on the system.","[S0559] SUNBURST: SUNBURST checked for a variety of antivirus/endpoint detection agents prior to execution.","[S1193] TAMECAT: TAMECAT has used Windows Management Instrumentation (WMI) to check for anti-virus products.","[S0595] ThiefQuest: ThiefQuest uses the kill_unwanted function to get a list of running processes, compares each process with an encrypted list of “unwanted” security related programs, and kills the processes for security related programs.","[S0091] Epic: Epic searches for anti-malware services running on the victim’s machine and terminates itself if it finds them.","[S0148] RTM: RTM can obtain information about security software on the victim.","[S0673] DarkWatchman: DarkWatchman can search for anti-virus products on the system.","[S0182] FinFisher: FinFisher probes the system to check for antimalware processes.","[S0260] InvisiMole: InvisiMole can check for the presence of network sniffers, AV, and BitDefender firewall.","[S0249] Gold Dragon: Gold Dragon checks for anti-malware products and processes.","[S0142] StreamEx: StreamEx has the ability to scan for security tools such as firewalls and antivirus tools.","[S1029] AuTo Stealer: AuTo Stealer has the ability to collect information about installed AV products from an infected host.","[S0688] Meteor: Meteor has the ability to search for Kaspersky Antivirus on a victim's machine.","[G1043] BlackByte: BlackByte enumerated installed security products during operations.","[S1028] Action RAT: Action RAT can identify AV products on an infected host using the following command: `cmd.exe WMIC /Node:localhost /Namespace:\\\\root\\SecurityCenter2 Path AntiVirusProduct Get displayName /Format:List`.","[S0396] EvilBunny: EvilBunny has been observed querying installed antivirus software.","[S0646] SpicyOmelette: SpicyOmelette can check for the presence of 29 different antivirus tools.","[S0125] Remsec: Remsec has a plugin detect security products via active drivers.","[S1091] Pacu: Pacu can enumerate AWS security services, including WAF rules and GuardDuty detectors.","[S1044] FunnyDream: FunnyDream can identify the processes for Bkav antivirus.","[S0553] MoleNet: MoleNet can use WMI commands to check the system for firewall and antivirus software.","[S0108] netsh: netsh can be used to discover system firewall settings.","[S1180] BlackByte Ransomware: BlackByte Ransomware looks for security software products prior to full execution.","[S0692] SILENTTRINITY: SILENTTRINITY can determine if an anti-virus product is installed through the resolution of the service's virtual SID.","[S0501] PipeMon: PipeMon can check for the presence of ESET and Kaspersky security software.","[S0680] LitePower: LitePower can identify installed AV software.","[C0035] KV Botnet Activity: KV Botnet Activity involved removal of security tools, as well as other identified IOT malware, from compromised devices.","[G0106] Rocke: Rocke used scripts which detected and uninstalled antivirus software.","[S1141] LunarWeb: LunarWeb has run shell commands to obtain a list of installed security products."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1526","technique_name":"Cloud Service Discovery","description":"An adversary may attempt to enumerate the cloud services running on a system after gaining access. These methods can differ from platform-as-a-service (PaaS), to infrastructure-as-a-service (IaaS), or software-as-a-service (SaaS). Many services exist throughout the various cloud providers and can include Continuous Integration and Continuous Delivery (CI/CD), Lambda Functions, Entra ID, etc. They may also include security services, such as AWS GuardDuty and Microsoft Defender for Cloud, and logging services, such as AWS CloudTrail and Google Cloud Audit Logs. Adversaries may attempt to discover information about the services enabled throughout the environment. Azure tools and APIs, such as the Microsoft Graph API and Azure Resource Manager API, can enumerate resources and services, including applications, management groups, resources and policy definitions, and their relationships that are accessible by an identity. For example, Stormspotter is an open source tool for enumerating and constructing a graph for Azure resources and services, and Pacu is an open source AWS exploitation framework that supports several methods for discovering cloud services. Adversaries may use the information gained to shape follow-on behaviors, such as targeting data or credentials from enumerated services or evading identified defenses through Disable or Modify Tools or Disable or Modify Cloud Logs.","detection":"Cloud service discovery techniques will likely occur throughout an operation where an adversary is targeting cloud-based systems and services. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities based on the information obtained. Normal, benign system and network events that look like cloud service discovery may be uncommon, depending on the environment and how they are used. Monitor cloud service usage for anomalous behavior that may indicate adversarial presence within the environment.","procedures":["[S0677] AADInternals: AADInternals can enumerate information about a variety of cloud services, such as Office 365 and Sharepoint instances or OpenID Configurations.","[S0684] ROADTools: ROADTools can enumerate Azure AD applications and service principals.","[S1091] Pacu: Pacu can enumerate AWS services, such as CloudTrail and CloudWatch."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1538","technique_name":"Cloud Service Dashboard","description":"An adversary may use a cloud service dashboard GUI with stolen credentials to gain useful information from an operational cloud environment, such as specific services, resources, and features. For example, the GCP Command Center can be used to view all assets, review findings of potential security risks, and run additional queries, such as finding public IP addresses and open ports. Depending on the configuration of the environment, an adversary may be able to enumerate more information via the graphical dashboard than an API. This also allows the adversary to gain information without manually making any API requests.","detection":"Monitor account activity logs to see actions performed and activity associated with the cloud service management console. Some cloud providers, such as AWS, provide distinct log events for login attempts to the management console.","procedures":["[G1015] Scattered Spider: Scattered Spider abused AWS Systems Manager Inventory to identify targets on the compromised network prior to lateral movement."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1580","technique_name":"Cloud Infrastructure Discovery","description":"An adversary may attempt to discover infrastructure and resources that are available within an infrastructure-as-a-service (IaaS) environment. This includes compute service resources such as instances, virtual machines, and snapshots as well as resources of other services including the storage and database services. Cloud providers offer methods such as APIs and commands issued through CLIs to serve information about infrastructure. For example, AWS provides a DescribeInstances API within the Amazon EC2 API that can return information about one or more instances within an account, the ListBuckets API that returns a list of all buckets owned by the authenticated sender of the request, the HeadBucket API to determine a bucket’s existence along with access permissions of the request sender, or the GetPublicAccessBlock API to retrieve access block configuration for a bucket. Similarly, GCP's Cloud SDK CLI provides the gcloud compute instances list command to list all Google Compute Engine instances in a project , and Azure's CLI command az vm list lists details of virtual machines. In addition to API commands, adversaries can utilize open source tools to discover cloud storage infrastructure through Wordlist Scanning. An adversary may enumerate resources using a compromised user's access keys to determine which are available to that user. The discovery of these available resources may help adversaries determine their next steps in the Cloud environment, such as establishing Persistence.An adversary may also use this information to change the configuration to make the bucket publicly accessible, allowing data to be accessed without authentication. Adversaries have also may use infrastructure discovery APIs such as DescribeDBInstances to determine size, owner, permissions, and network ACLs of database resources. Adversaries can use this information to determine the potential value of databases and discover the requirements to access them. Unlike in Cloud Service Discovery, this technique focuses on the discovery of components of the provided services rather than the services themselves.","detection":"Establish centralized logging for the activity of cloud infrastructure components. Monitor logs for actions that could be taken to gather information about cloud infrastructure, including the use of discovery API calls by new or unexpected users and enumerations from unknown or malicious IP addresses. To reduce false positives, valid change management procedures could introduce a known identifier that is logged with the change (e.g., tag or header) if supported by the cloud provider, to help distinguish valid, expected actions from malicious ones.","procedures":["[G1015] Scattered Spider: Scattered Spider enumerates cloud environments to identify server and backup management infrastructure, resource access, databases and storage containers.","[S1091] Pacu: Pacu can enumerate AWS infrastructure, such as EC2 instances."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1613","technique_name":"Container and Resource Discovery","description":"Adversaries may attempt to discover containers and other resources that are available within a containers environment. Other resources may include images, deployments, pods, nodes, and other information such as the status of a cluster. These resources can be viewed within web applications such as the Kubernetes dashboard or can be queried via the Docker and Kubernetes APIs. In Docker, logs may leak information about the environment, such as the environment’s configuration, which services are available, and what cloud provider the victim may be utilizing. The discovery of these resources may inform an adversary’s next steps in the environment, such as how to perform lateral movement and which methods to utilize for execution.","detection":"Establish centralized logging for the activity of container and Kubernetes cluster components. This can be done by deploying logging agents on Kubernetes nodes and retrieving logs from sidecar proxies for application pods to detect malicious activity at the cluster level. Monitor logs for actions that could be taken to gather information about container infrastructure, including the use of discovery API calls by new or unexpected users. Monitor account activity logs to see actions performed and activity associated with the Kubernetes dashboard and other web applications.","procedures":["[S0683] Peirates: Peirates can enumerate Kubernetes pods in a given namespace.","[G0139] TeamTNT: TeamTNT has checked for running containers with docker ps and for specific container names with docker inspect. TeamTNT has also searched for Kubernetes pods running in a local network.","[S0601] Hildegard: Hildegard has used masscan to search for kubelets and the kubelet API for additional running containers."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1614.001","technique_name":"System Location Discovery: System Language Discovery","description":"Adversaries may attempt to gather information about the system language of a victim in order to infer the geographical location of that host. This information may be used to shape follow-on behaviors, including whether the adversary infects the target and/or attempts specific actions. This decision may be employed by malware developers and operators to reduce their risk of attracting the attention of specific law enforcement agencies or prosecution/scrutiny from other entities. There are various sources of data an adversary could use to infer system language, such as system defaults and keyboard layouts. Specific checks will vary based on the target and/or adversary, but may involve behaviors such as Query Registry and calls to Native API functions. For example, on a Windows system adversaries may attempt to infer the language of a system by querying the registry key HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Nls\\Language or parsing the outputs of Windows API functions GetUserDefaultUILanguage, GetSystemDefaultUILanguage, GetKeyboardLayoutList and GetUserDefaultLangID. On a macOS or Linux system, adversaries may query locale to retrieve the value of the $LANG environment variable.","detection":"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities based on the information obtained. Monitor processes and command-line arguments for actions that could be taken to gather system language information. This may include calls to various API functions and interaction with system configuration settings such as the Windows Registry.","procedures":["[C0022] Operation Dream Job: During Operation Dream Job, Lazarus Group deployed malware designed not to run on computers set to Korean, Japanese, or Chinese in Windows language preferences.","[S1153] Cuckoo Stealer: Cuckoo Stealer can check the systems `LANG` environmental variable to prevent infecting devices from Armenia (`hy_AM`), Belarus (`be_BY`), Kazakhstan (`kk_KZ`), Russia (`ru_RU`), and Ukraine (`uk_UA`).","[S0652] MarkiRAT: MarkiRAT can use the GetKeyboardLayout API to check if a compromised host's keyboard is set to Persian.","[S0658] XCSSET: XCSSET uses AppleScript to check the host's language and location with the command user locale of (get system info).","[S0625] Cuba: Cuba can check if Russian language is installed on the infected machine by using the function GetKeyboardLayoutList.","[G0004] Ke3chang: Ke3chang has used implants to collect the system language ID of a compromised machine.","[S0696] Flagpro: Flagpro can check whether the target system is using Japanese, Taiwanese, or English through detection of specific Windows Security and Internet Explorer dialog.","[S0483] IcedID: IcedID used the following command to check the country/language of the active console: ` cmd.exe /c chcp >&2`.","[S0640] Avaddon: Avaddon checks for specific keyboard layouts and OS languages to avoid targeting Commonwealth of Independent States (CIS) entities.","[S0449] Maze: Maze has checked the language of the machine with function GetUserDefaultUILanguage and terminated execution if the language matches with an entry in the predefined list.","[S1122] Mispadu: Mispadu checks and will terminate execution if the compromised system’s language ID is not Spanish or Portuguese.","[S0543] Spark: Spark has checked the results of the GetKeyboardLayoutList and the language name returned by GetLocaleInfoA to make sure they contain the word “Arabic” before executing.","[G1043] BlackByte: BlackByte identified system language settings to determine follow-on execution.","[S0446] Ryuk: Ryuk has been observed to query the registry key HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Nls\\Language and the value InstallLanguage. If the machine has the value 0x419 (Russian), 0x422 (Ukrainian), or 0x423 (Belarusian), it stops execution.","[S1138] Gootloader: Gootloader can determine if a victim's computer is running an operating system with specific language preferences.","[S0085] S-Type: S-Type has attempted to determine if a compromised system was using a Japanese keyboard via the `GetKeyboardType` API call.","[S0534] Bazar: Bazar can perform a check to ensure that the operating system's keyboard and language settings are not set to Russian.","[S0616] DEATHRANSOM: Some versions of DEATHRANSOM have performed language ID and keyboard layout checks; if either of these matched Russian, Kazakh, Belarusian, Ukrainian or Tatar DEATHRANSOM would exit.","[S0691] Neoichor: Neoichor can identify the system language on a compromised host.","[S0611] Clop: Clop has checked the keyboard language using the GetKeyboardLayout() function to avoid installation on Russian-language or other Commonwealth of Independent States-language machines; it will also check the GetTextCharset function.","[S0330] Zeus Panda: Zeus Panda queries the system's keyboard mapping to determine the language used on the system. It will terminate execution if it detects LANG_RUSSIAN, LANG_BELARUSIAN, LANG_KAZAK, or LANG_UKRAINIAN.","[S0632] GrimAgent: GrimAgent has used Accept-Language to identify hosts in the United Kingdom, United States, France, and Spain.","[S0547] DropBook: DropBook has checked for the presence of Arabic language in the infected machine's settings.","[S1199] LockBit 2.0: LockBit 2.0 can check if a targeted machine is using a set of Eastern European languages and exit without infection if so.","[S0496] REvil: REvil can check the system language using GetUserDefaultUILanguage and GetSystemDefaultUILanguage. If the language is found in the list, the process terminates.","[S1183] StrelaStealer: StrelaStealer variants check system language settings via keyboard layout or similar mechanisms.","[S1200] StealBit: StealBit can determine system location based on the default language setting and will not execute on systems located in former Soviet countries.","[S1202] LockBit 3.0: LockBit 3.0 will not affect machines with language settings matching a defined exlusion list of mainly Eastern European languages.","[S0242] SynAck: SynAck lists all the keyboard layouts installed on the victim’s system using GetKeyboardLayoutList API and checks against a hardcoded language code list. If a match if found, SynAck sleeps for 300 seconds and then exits without encrypting files.","[S0083] Misdat: Misdat has attempted to detect if a compromised host had a Japanese keyboard via the Windows API call `GetKeyboardType`.","[S0546] SharpStage: SharpStage has been used to target Arabic-speaking users and used code that checks if the compromised machine has the Arabic language installed.","[S1180] BlackByte Ransomware: BlackByte Ransomware identifies the language on the victim system.","[G1026] Malteiro: Malteiro will terminate Mispadu's infection process if the language of the victim machine is not Spanish or Portuguese."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1615","technique_name":"Group Policy Discovery","description":"Adversaries may gather information on Group Policy settings to identify paths for privilege escalation, security measures applied within a domain, and to discover patterns in domain objects that can be manipulated or used to blend in the environment. Group Policy allows for centralized management of user and computer settings in Active Directory (AD). Group policy objects (GPOs) are containers for group policy settings made up of files stored within a predictable network path `\\\\SYSVOL\\\\Policies\\`. Adversaries may use commands such as gpresult or various publicly available PowerShell functions, such as Get-DomainGPO and Get-DomainGPOLocalGroup, to gather information on Group Policy settings. Adversaries may use this information to shape follow-on behaviors, including determining potential attack paths within the target network as well as opportunities to manipulate Group Policy settings (i.e. Domain or Tenant Policy Modification) for their benefit.","detection":"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities based on the information obtained. Monitor for suspicious use of gpresult. Monitor for the use of PowerShell functions such as Get-DomainGPO and Get-DomainGPOLocalGroup and processes spawning with command-line arguments containing GPOLocalGroup. Monitor for abnormal LDAP queries with filters for groupPolicyContainer and high volumes of LDAP traffic to domain controllers. Windows Event ID 4661 can also be used to detect when a directory service has been accessed.","procedures":["[S1141] LunarWeb: LunarWeb can capture information on group policy settings","[C0049] Leviathan Australian Intrusions: Leviathan performed extensive Active Directory enumeration of victim environments during Leviathan Australian Intrusions.","[S1159] DUSTTRAP: DUSTTRAP can identify victim environment Group Policy information.","[S0521] BloodHound: BloodHound has the ability to collect local admin information via GPO.","[G0010] Turla: Turla surveys a system upon check-in to discover Group Policy details using the gpresult command.","[S0363] Empire: Empire includes various modules for enumerating Group Policy.","[S0082] Emissary: Emissary has the capability to execute gpresult."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1619","technique_name":"Cloud Storage Object Discovery","description":"Adversaries may enumerate objects in cloud storage infrastructure. Adversaries may use this information during automated discovery to shape follow-on behaviors, including requesting all or specific objects from cloud storage. Similar to File and Directory Discovery on a local host, after identifying available storage services (i.e. Cloud Infrastructure Discovery) adversaries may access the contents/objects stored in cloud infrastructure. Cloud service providers offer APIs allowing users to enumerate objects stored within cloud storage. Examples include ListObjectsV2 in AWS and List Blobs in Azure .","detection":"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Collection and Exfiltration, based on the information obtained. Monitor cloud logs for API calls used for file or object enumeration for unusual activity.","procedures":["[S1091] Pacu: Pacu can enumerate AWS storage services, such as S3 buckets and Elastic Block Store volumes.","[S0683] Peirates: Peirates can list AWS S3 buckets."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1622","technique_name":"Debugger Evasion","description":"Adversaries may employ various means to detect and avoid debuggers. Debuggers are typically used by defenders to trace and/or analyze the execution of potential malware payloads. Debugger evasion may include changing behaviors based on the results of the checks for the presence of artifacts indicative of a debugged environment. Similar to Virtualization/Sandbox Evasion, if the adversary detects a debugger, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for debugger artifacts before dropping secondary or additional payloads. Specific checks will vary based on the target and/or adversary. On Windows, this may involve Native API function calls such as IsDebuggerPresent() and NtQueryInformationProcess(), or manually checking the BeingDebugged flag of the Process Environment Block (PEB). On Linux, this may involve querying `/proc/self/status` for the `TracerPID` field, which indicates whether or not the process is being traced by dynamic analysis tools. Other checks for debugging artifacts may also seek to enumerate hardware breakpoints, interrupt assembly opcodes, time checks, or measurements if exceptions are raised in the current process (assuming a present debugger would “swallow” or handle the potential error). Malware may also leverage Structured Exception Handling (SEH) to detect debuggers by throwing an exception and detecting whether the process is suspended. SEH handles both hardware and software expectations, providing control over the exceptions including support for debugging. If a debugger is present, the program’s control will be transferred to the debugger, and the execution of the code will be suspended. If the debugger is not present, control will be transferred to the SEH handler, which will automatically handle the exception and allow the program’s execution to continue. Adversaries may use the information learned from these debugger checks during automated discovery to shape follow-on behaviors. Debuggers can also be evaded by detaching the process or flooding debug logs with meaningless data via messages produced by looping Native API function calls such as OutputDebugStringW().","detection":"Debugger related system checks will likely occur in the first steps of an operation but may also occur throughout as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as lateral movement, based on the information obtained. Detecting actions related to debugger identification may be difficult depending on the adversary's implementation and monitoring required. Monitoring for suspicious Native API function calls as well as processes being spawned that gather a variety of system information or perform other forms of Discovery, especially in a short period of time, may aid in detection. Monitor debugger logs for signs of abnormal and potentially malicious activity.","procedures":["[S1213] Lumma Stealer: Lumma Stealer has checked for debugger strings by invoking `GetForegroundWindow` and looks for strings containing “x32dbg”, “x64dbg”, “windbg”, “ollydbg”, “dnspy”, “immunity debugger”, “hyperdbg”, “debug”, “debugger”, “cheat engine”, “cheatengine” and “ida”.","[S1087] AsyncRAT: AsyncRAT can use the `CheckRemoteDebuggerPresent` function to detect the presence of a debugger.","[S1200] StealBit: StealBit can detect it is being run in the context of a debugger.","[S1183] StrelaStealer: StrelaStealer variants include functionality to identify and evade debuggers.","[S1111] DarkGate: DarkGate checks the BeingDebugged flag in the PEB structure during execution to identify if the malware is being debugged.","[S1145] Pikabot: Pikabot features several methods to evade debugging by analysts, including checks for active debuggers, the use of breakpoints during execution, and checking various system information items such as system memory and the number of processors.","[S0240] ROKRAT: ROKRAT can check for debugging tools.","[S0694] DRATzarus: DRATzarus can use `IsDebuggerPresent` to detect whether a debugger is present on a victim.","[S1070] Black Basta: The Black Basta dropper can check system flags, CPU registers, CPU instructions, process timing, system libraries, and APIs to determine if a debugger is present.","[S1018] Saint Bot: Saint Bot has used `is_debugger_present` as part of its environmental checks.","[S1207] XLoader: XLoader uses anti-debugging mechanisms such as calling `NtQueryInformationProcess` with `InfoClass=7`, referencing `ProcessDebugPort`, to determine if it is being analyzed.","[S1130] Raspberry Robin: Raspberry Robin leverages anti-debugging mechanisms through the use of ThreadHideFromDebugger.","[S1202] LockBit 3.0: LockBit 3.0 can check heap memory parameters for indications of a debugger and stop the flow of events to the attached debugger in order to hinder dynamic analysis.","[C0022] Operation Dream Job: During Operation Dream Job, Lazarus Group used tools that used the `IsDebuggerPresent` call to detect debuggers.","[S1066] DarkTortilla: DarkTortilla can detect debuggers by using functions such as `DebuggerIsAttached` and `DebuggerIsLogging`. DarkTortilla can also detect profilers by verifying the `COR_ENABLE_PROFILING` environment variable is present and active.","[S1060] Mafalda: Mafalda can search for debugging tools on a compromised host.","[S0595] ThiefQuest: ThiefQuest uses a function named is_debugging to perform anti-debugging logic. The function invokes sysctl checking the returned value of P_TRACED. ThiefQuest also calls ptrace with the PTRACE_DENY_ATTACH flag to prevent debugging.","[S1160] Latrodectus: Latrodectus has the ability to check for the presence of debuggers.","[S1039] Bumblebee: Bumblebee can search for tools used in static analysis."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1652","technique_name":"Device Driver Discovery","description":"Adversaries may attempt to enumerate local device drivers on a victim host. Information about device drivers may highlight various insights that shape follow-on behaviors, such as the function/purpose of the host, present security tools (i.e. Security Software Discovery) or other defenses (e.g., Virtualization/Sandbox Evasion), as well as potential exploitable vulnerabilities (e.g., Exploitation for Privilege Escalation). Many OS utilities may provide information about local device drivers, such as `driverquery.exe` and the `EnumDeviceDrivers()` API function on Windows. Information about device drivers (as well as associated services, i.e., System Service Discovery) may also be available in the Registry. On Linux/macOS, device drivers (in the form of kernel modules) may be visible within `/dev` or using utilities such as `lsmod` and `modinfo`.","detection":null,"procedures":["[S0376] HOPLIGHT: HOPLIGHT can enumerate device drivers located in the registry at `HKLM\\Software\\WBEM\\WDM`.","[S1139] INC Ransomware: INC Ransomware can verify the presence of specific drivers on compromised hosts including Microsoft Print to PDF and Microsoft XPS Document Writer.","[S0125] Remsec: Remsec has a plugin to detect active drivers of some security products."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1654","technique_name":"Log Enumeration","description":"Adversaries may enumerate system and service logs to find useful data. These logs may highlight various types of valuable insights for an adversary, such as user authentication records (Account Discovery), security or vulnerable software (Software Discovery), or hosts within a compromised network (Remote System Discovery). Host binaries may be leveraged to collect system logs. Examples include using `wevtutil.exe` or PowerShell on Windows to access and/or export security event information. In cloud environments, adversaries may leverage utilities such as the Azure VM Agent’s `CollectGuestLogs.exe` to collect security logs from cloud hosted infrastructure. Adversaries may also target centralized logging infrastructure such as SIEMs. Logs may also be bulk exported and sent to adversary-controlled infrastructure for offline analysis. In addition to gaining a better understanding of the environment, adversaries may also monitor logs in real time to track incident response procedures. This may allow them to adjust their techniques in order to maintain persistence or evade defenses.","detection":null,"procedures":["[G1023] APT5: APT5 has used the BLOODMINE utility to parse and extract information from Pulse Secure Connect logs.","[G1003] Ember Bear: Ember Bear has enumerated SECURITY and SYSTEM log files during intrusions.","[G1017] Volt Typhoon: Volt Typhoon has used `wevtutil.exe` and the PowerShell command `Get-EventLog security` to enumerate Windows logs to search for successful logons.","[G0143] Aquatic Panda: Aquatic Panda enumerated logs related to authentication in Linux environments prior to deleting selective entries for defense evasion purposes.","[S1091] Pacu: Pacu can collect CloudTrail event histories and CloudWatch logs.","[S1191] Megazord: Megazord has the ability to print the trace, debug, error, info, and warning logs.","[S1194] Akira _v2: Akira _v2 can enumerate the trace, debug, error, info, and warning logs on targeted systems.","[S1159] DUSTTRAP: DUSTTRAP can identify infected system log information."],"tactics":"TA0007 - Discovery"}
{"technique_id":"T1673","technique_name":"Virtual Machine Discovery","description":"An adversary may attempt to enumerate running virtual machines (VMs) after gaining access to a host or hypervisor. For example, adversaries may enumerate a list of VMs on an ESXi hypervisor using a Hypervisor CLI such as `esxcli` or `vim-cmd` (e.g. `esxcli vm process list or vim-cmd vmsvc/getallvms`). Adversaries may also directly leverage a graphical user interface, such as VMware vCenter, in order to view virtual machines on a host. Adversaries may use the information from Virtual Machine Discovery during discovery to shape follow-on behaviors. Subsequently discovered VMs may be leveraged for follow-on activities such as Service Stop or Data Encrypted for Impact.","detection":null,"procedures":["[S1096] Cheerscrypt: Cheerscrypt has leveraged `esxcli vm process list` in order to gather a list of running virtual machines to terminate them."],"tactics":"TA0007 - Discovery"}