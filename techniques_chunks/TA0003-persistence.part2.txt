{"technique_id":"T1098.007","technique_name":"Account Manipulation: Additional Local or Domain Groups","description":"An adversary may add additional local or domain groups to an adversary-controlled account to maintain persistent access to a system or domain. On Windows, accounts may use the `net localgroup` and `net group` commands to add existing users to local and domain groups. On Linux, adversaries may use the `usermod` command for the same purpose. For example, accounts may be added to the local administrators group on Windows devices to maintain elevated privileges. They may also be added to the Remote Desktop Users group, which allows them to leverage Remote Desktop Protocol to log into the endpoints in the future. On Linux, accounts may be added to the sudoers group, allowing them to persistently leverage Sudo and Sudo Caching for elevated privileges. In Windows environments, machine accounts may also be added to domain groups. This allows the local SYSTEM account to gain privileges on the domain.","detection":null,"procedures":["[S0649] SMOKEDHAM: SMOKEDHAM has added user accounts to local Admin groups.","[G0096] APT41: APT41 has added user accounts to the User and Admin groups.","[G0022] APT3: APT3 has been known to add created accounts to local admin groups to maintain elevated access.","[S0039] Net: The `net localgroup` and `net group` commands in Net can be used to add existing users to local and domain groups.","[G0059] Magic Hound: Magic Hound has added a user named DefaultAccount to the Administrators and Remote Desktop Users groups.","[G1023] APT5: APT5 has created their own accounts with Local Administrator privileges to maintain access to systems with short-cycle credential rotation.","[G0035] Dragonfly: Dragonfly has added newly created accounts to the administrators group to maintain elevated access.","[G1016] FIN13: FIN13 has assigned newly created accounts the sysadmin role to maintain persistence.","[S1111] DarkGate: DarkGate elevates accounts created through the malware to the local administration group during execution.","[S0382] ServHelper: ServHelper has added a user named \"supportaccount\" to the Remote Desktop Users and Administrators groups.","[G0094] Kimsuky: Kimsuky has added accounts to specific groups with net localgroup."],"tactics":"TA0003 - Persistence"}
{"technique_id":"T1112","technique_name":"Modify Registry","description":"Adversaries may interact with the Windows Registry as part of a variety of other techniques to aid in defense evasion, persistence, and execution. Access to specific areas of the Registry depends on account permissions, with some keys requiring administrator-level access. The built-in Windows command-line utility Reg may be used for local or remote Registry modification. Other tools, such as remote access tools, may also contain functionality to interact with the Registry through the Windows API. The Registry may be modified in order to hide configuration information or malicious payloads via Obfuscated Files or Information. The Registry may also be modified to Impair Defenses, such as by enabling macros for all Microsoft Office products, allowing privilege escalation without alerting the user, increasing the maximum number of allowed outbound requests, and/or modifying systems to store plaintext credentials in memory. The Registry of a remote system may be modified to aid in execution of files as part of lateral movement. It requires the remote Registry service to be running on the target system. Often Valid Accounts are required, along with access to the remote system's SMB/Windows Admin Shares for RPC communication. Finally, Registry modifications may also include actions to hide keys, such as prepending key names with a null character, which will cause an error and/or be ignored when read via Reg or other utilities using the Win32 API. Adversaries may abuse these pseudo-hidden keys to conceal payloads/commands used to maintain persistence.","detection":"Modifications to the Registry are normal and occur throughout typical use of the Windows operating system. Consider enabling Registry Auditing on specific keys to produce an alertable event (Event ID 4657) whenever a value is changed (though this may not trigger when values are created with Reghide or other evasive methods). Changes to Registry entries that load software on Windows startup that do not correlate with known software, patch cycles, etc., are suspicious, as are additions or changes to files within the startup folder. Changes could also include new services and modification of existing binary paths to point to malicious files. If a change to a service-related entry occurs, then it will likely be followed by a local or remote service start or restart to execute the file. Monitor processes and command-line arguments for actions that could be taken to change or delete information in the Registry. Remote access tools with built-in features may interact directly with the Windows API to gather information. The Registry may also be modified through Windows system management tools such as Windows Management Instrumentation and PowerShell, which may require additional logging features to be configured in the operating system to collect necessary information for analysis. Monitor for processes, command-line arguments, and API calls associated with concealing Registry keys, such as Reghide. Inspect and cleanup malicious hidden Registry entries using Native Windows API calls and/or tools such as Autoruns and RegDelNull .","procedures":["[S0674] CharmPower: CharmPower can remove persistence-related artifacts from the Registry.","[C0028] 2015 Ukraine Electric Power Attack: During the 2015 Ukraine Electric Power Attack, Sandworm Team modified in-registry Internet settings to lower internet security before launching `rundll32.exe`, which in-turn launches the malware and communicates with C2 servers over the Internet. .","[G0010] Turla: Turla has modified Registry values to store payloads.","[S0013] PlugX: PlugX has a module to create, delete, or modify Registry keys.","[S0596] ShadowPad: ShadowPad can modify the Registry to store and maintain a configuration block and virtual file system.","[S0457] Netwalker: Netwalker can add the following registry entry: HKEY_CURRENT_USER\\SOFTWARE\\{8 random characters}.","[S0476] Valak: Valak has the ability to modify the Registry key HKCU\\Software\\ApplicationContainer\\Appsw64 to store information regarding the C2 server and downloads.","[S0240] ROKRAT: ROKRAT can modify the `HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\` registry key so it can bypass the VB object model (VBOM) on a compromised host.","[G0082] APT38: APT38 uses a tool called CLEANTOAD that has the capability to modify Registry keys.","[S0376] HOPLIGHT: HOPLIGHT has modified Managed Object Format (MOF) files within the Registry to run specific commands and create persistence on the system.","[S0261] Catchamas: Catchamas creates three Registry keys to establish persistence by adding a Windows Service.","[S0032] gh0st RAT: gh0st RAT has altered the InstallTime subkey.","[S0242] SynAck: SynAck can manipulate Registry keys.","[S0533] SLOTHFULMEDIA: SLOTHFULMEDIA can add, modify, and/or delete registry keys. It has changed the proxy configuration of a victim system by modifying the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap registry.","[S0608] Conficker: Conficker adds keys to the Registry at HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services and various other Registry locations.","[S1033] DCSrv: DCSrv has created Registry keys for persistence.","[S0559] SUNBURST: SUNBURST had commands that allow an attacker to write or delete registry keys, and was observed stopping services by setting their HKLM\\SYSTEM\\CurrentControlSet\\services\\\\[service_name]\\\\Start registry entries to value 4. It also deleted previously-created Image File Execution Options (IFEO) Debugger registry values and registry keys related to HTTP proxy to clean up traces of its activity.","[G0040] Patchwork: A Patchwork payload deletes Resiliency Registry keys created by Microsoft Office applications in an apparent effort to trick users into thinking there were no issues during application runs.","[S0569] Explosive: Explosive has a function to write itself to Registry values.","[S0518] PolyglotDuke: PolyglotDuke can write encrypted JSON configuration files to the Registry.","[S0012] PoisonIvy: PoisonIvy creates a Registry subkey that registers a new system device.","[S0669] KOCTOPUS: KOCTOPUS has added and deleted keys from the Registry.","[S1202] LockBit 3.0: LockBit 3.0 can change the Registry values for Group Policy refresh time, to disable SmartScreen, and to disable Windows Defender.","[G0119] Indrik Spider: Indrik Spider has modified registry keys to prepare for ransomware execution and to disable common administrative utilities.","[S0397] LoJax: LoJax has modified the Registry key ‘HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\BootExecute’ from ‘autocheck autochk *’ to ‘autocheck autoche *’.","[S0158] PHOREAL: PHOREAL is capable of manipulating the Registry.","[S0428] PoetRAT: PoetRAT has made registry modifications to alter its behavior upon execution.","[S0496] REvil: REvil can modify the Registry to save encryption parameters and system information.","[S0031] BACKSPACE: BACKSPACE is capable of deleting Registry keys, sub-keys, and values on a victim system.","[S0673] DarkWatchman: DarkWatchman can modify Registry values to store configuration strings, keylogger, and output of components.","[S0531] Grandoreiro: Grandoreiro can modify the Registry to store its configuration at `HKCU\\Software\\` under frequently changing names including %USERNAME% and ToolTech-RM.","[S0011] Taidoor: Taidoor has the ability to modify the Registry on compromised hosts using RegDeleteValueA and RegCreateKeyExA.","[S0603] Stuxnet: Stuxnet can create registry keys to load driver files.","[S0668] TinyTurla: TinyTurla can set its configuration parameters in the Registry.","[S0267] FELIXROOT: FELIXROOT deletes the Registry key HKCU\\Software\\Classes\\Applications\\rundll32.exe\\shell\\open.","[S0649] SMOKEDHAM: SMOKEDHAM has modified registry keys for persistence, to enable credential caching for credential access, and to facilitate lateral movement via RDP.","[S0517] Pillowmint: Pillowmint has modified the Registry key HKLM\\SOFTWARE\\Microsoft\\DRM to store a malicious payload.","[S0501] PipeMon: PipeMon has modified the Registry to store its encrypted payload.","[S1060] Mafalda: Mafalda can manipulate the system registry on a compromised host.","[G0091] Silence: Silence can create, delete, or modify a specified Registry key or value.","[G0092] TA505: TA505 has used malware to disable Windows Defender through modification of the Registry.","[S0023] CHOPSTICK: CHOPSTICK may modify Registry keys to store RC4 encrypted configuration information.","[S1181] BlackByte 2.0 Ransomware: BlackByte 2.0 Ransomware modifies the victim Registry to allow for elevated execution.","[S0697] HermeticWiper: HermeticWiper has the ability to modify Registry keys to disable crash dumps, colors for compressed files, and pop-up information about folders and desktop items.","[S0670] WarzoneRAT: WarzoneRAT can create `HKCU\\Software\\Classes\\Folder\\shell\\open\\command` as a new registry key during privilege escalation.","[S0154] Cobalt Strike: Cobalt Strike can modify Registry values within HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\\\Excel\\Security\\AccessVBOM\\ to enable the execution of additional code.","[G0073] APT19: APT19 uses a Port 22 malware variant to modify several Registry keys.","[S1201] TRANSLATEXT: TRANSLATEXT has modified the following registry key to install itself as the value, granting permission to install specified extensions: ` HKCU\\Software\\Policies\\Google\\Chrome\\ExtensionInstallForcelist`.","[S0527] CSPY Downloader: CSPY Downloader can write to the Registry under the %windir% variable to execute tasks.","[S0666] Gelsemium: Gelsemium can modify the Registry to store its components.","[S0612] WastedLocker: WastedLocker can modify registry values within the Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap registry key.","[S1059] metaMain: metaMain can write the process ID of a target process into the `HKEY_LOCAL_MACHINE\\SOFTWARE\\DDE\\tpid` Registry value as part of its reflective loading activity.","[S1178] ShrinkLocker: ShrinkLocker modifies various registry keys associated with system logon and BitLocker functionality to effectively lock-out users following disk encryption.","[S0262] QuasarRAT: QuasarRAT has a command to edit the Registry on the victim’s machine.","[S0203] Hydraq: Hydraq creates a Registry subkey to register its created service, and can also uninstall itself later by deleting this value. Hydraq's backdoor also enables remote attackers to modify and delete subkeys.","[S1068] BlackCat: BlackCat has the ability to add the following registry key on compromised networks to maintain persistence: `HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services \\LanmanServer\\Paramenters`","[G1043] BlackByte: BlackByte performed Registry modifications to escalate privileges and disable security tools.","[S1131] NPPSPY: NPPSPY modifies the Registry to record the malicious listener for output from the Winlogon process.","[S1070] Black Basta: Black Basta has modified the Registry to enable itself to run in safe mode, to change the icons and file extensions for encrypted files, and to add the malware path for persistence.","[S0254] PLAINTEE: PLAINTEE uses reg add to add a Registry Run key for persistence.","[G0030] Lotus Blossom: Lotus Blossom has installed tools such as Sagerunex by writing them to the Windows registry.","[S1199] LockBit 2.0: LockBit 2.0 can create Registry keys to bypass UAC and for persistence.","[G0047] Gamaredon Group: Gamaredon Group has removed security settings for VBA macro execution by changing registry values HKCU\\Software\\Microsoft\\Office\\&lt;version&gt;\\&lt;product&gt;\\Security\\VBAWarnings and HKCU\\Software\\Microsoft\\Office\\&lt;version&gt;\\&lt;product&gt;\\Security\\AccessVBOM.","[S0692] SILENTTRINITY: SILENTTRINITY can modify registry keys, including to enable or disable Remote Desktop Protocol (RDP).","[S1190] Kapeka: Kapeka writes persistent configuration information to the victim host registry.","[S0022] Uroburos: Uroburos can store configuration information in the Registry including the initialization vector and AES key needed to find and decrypt other Uroburos components.","[S0579] Waterbear: Waterbear has deleted certain values from the Registry to load a malicious DLL.","[S0157] SOUNDBITE: SOUNDBITE is capable of modifying the Registry.","[C0002] Night Dragon: During Night Dragon, threat actors used zwShell to establish full remote control of the connected machine and manipulate the Registry.","[S0332] Remcos: Remcos has full control of the Registry, including the ability to modify it.","[S0260] InvisiMole: InvisiMole has a command to create, set, copy, or delete a specified Registry key or value.","[S0455] Metamorfo: Metamorfo has written process names to the Registry, disabled IE browser features, deleted Registry keys, and changed the ExtendedUIHoverTime key.","[S0256] Mosquito: Mosquito can modify Registry keys under HKCU\\Software\\Microsoft\\[dllname] to store configuration values. Mosquito also modifies Registry keys under HKCR\\CLSID\\...\\InprocServer32 with a path to the launcher.","[S0560] TEARDROP: TEARDROP modified the Registry to create a Windows service for itself on a compromised host.","[S0142] StreamEx: StreamEx has the ability to modify the Registry.","[S0438] Attor: Attor's dispatcher can modify the Run registry key.","[S1132] IPsec Helper: IPsec Helper can make arbitrary changes to registry keys based on provided input.","[S0447] Lokibot: Lokibot has modified the Registry as part of its UAC bypass process.","[S0412] ZxShell: ZxShell can create Registry entries to enable services to run.","[S0356] KONNI: KONNI has modified registry keys of ComSysApp, Svchost, and xmlProv on the machine to gain persistence.","[G0102] Wizard Spider: Wizard Spider has modified the Registry key HKLM\\System\\CurrentControlSet\\Control\\SecurityProviders\\WDigest by setting the UseLogonCredential registry value to 1 in order to force credentials to be stored in clear text in memory. Wizard Spider has also modified the WDigest registry key to allow plaintext credentials to be cached in memory.","[G0050] APT32: APT32's backdoor has modified the Windows Registry to store the backdoor's configuration.","[G0143] Aquatic Panda: Aquatic Panda modified the victim registry to enable the `RestrictedAdmin` mode feature, allowing for pass the hash behaviors to function via RDP.","[S0583] Pysa: Pysa has modified the registry key “SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System” and added the ransom note.","[C0006] Operation Honeybee: During Operation Honeybee, the threat actors used batch files that modified registry keys.","[S0245] BADCALL: BADCALL modifies the firewall Registry key SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfileGloballyOpenPorts\\\\List.","[G1006] Earth Lusca: Earth Lusca modified the registry using the command reg add “HKEY_CURRENT_USER\\Environment” /v UserInitMprLogonScript /t REG_SZ /d “[file path]” for persistence.","[S0576] MegaCortex: MegaCortex has added entries to the Registry for ransom contact information.","[S1058] Prestige: Prestige has the ability to register new registry keys for a new extension handler via `HKCR\\.enc` and `HKCR\\enc\\shell\\open\\command`.","[S0511] RegDuke: RegDuke can create seemingly legitimate Registry key to store its encryption key.","[G0108] Blue Mockingbird: Blue Mockingbird has used Windows Registry modifications to specify a DLL payload.","[S0691] Neoichor: Neoichor has the ability to configure browser settings by modifying Registry entries under `HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer`.","[G0049] OilRig: OilRig has used reg.exe to modify system configuration.","[S1011] Tarrask: Tarrask is able to delete the Security Descriptor (`SD`) registry subkey in order to “hide” scheduled tasks.","[S0572] Caterpillar WebShell: Caterpillar WebShell has a command to modify a Registry key.","[S0268] Bisonal: Bisonal has deleted Registry keys to clean up its prior activity.","[S0467] TajMahal: TajMahal can set the KeepPrintedJobs attribute for configured printers in SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Print\\\\Printers to enable document stealing.","[S0537] HyperStack: HyperStack can add the name of its communication pipe to HKLM\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\lanmanserver\\\\parameters\\NullSessionPipes.","[S0115] Crimson: Crimson can set a Registry key to determine how long it has been installed and possibly to indicate the version number.","[G1003] Ember Bear: Ember Bear modifies registry values for anti-forensics and defense evasion purposes.","[S0229] Orz: Orz can perform Registry operations.","[S0148] RTM: RTM can delete all Registry entries created during its execution.","[G1017] Volt Typhoon: Volt Typhoon has used `netsh` to create a PortProxy Registry modification on a compromised server running the Paessler Router Traffic Grapher (PRTG).","[S1099] Samurai: The Samurai loader component can create multiple Registry keys to force the svchost.exe process to load the final backdoor.","[C0014] Operation Wocao: During Operation Wocao, the threat actors enabled Wdigest by changing the `HKLM\\SYSTEM\\\\ControlSet001\\\\Control\\\\SecurityProviders\\\\WDigest` registry value from 0 (disabled) to 1 (enabled).","[G0035] Dragonfly: Dragonfly has modified the Registry to perform multiple techniques through the use of Reg.","[S0488] CrackMapExec: CrackMapExec can create a registry key using wdigest.","[G0078] Gorgon Group: Gorgon Group malware can deactivate security mechanisms in Microsoft Office by editing several keys and values under HKCU\\Software\\Microsoft\\Office\\.","[S0350] zwShell: zwShell can modify the Registry.","[S0631] Chaes: Chaes can modify Registry values to stored information and establish persistence.","[S0336] NanoCore: NanoCore has the capability to edit the Registry.","[S0611] Clop: Clop can make modifications to Registry keys.","[S0665] ThreatNeedle: ThreatNeedle can modify the Registry to save its configuration data as the following RC4-encrypted Registry key: `HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\GameCon`.","[S0386] Ursnif: Ursnif has used Registry modifications as part of its installation routine.","[S0441] PowerShower: PowerShower has added a registry key so future powershell.exe instances are spawned off-screen by default, and has removed all registry entries that are left behind during the dropper process.","[S0045] ADVSTORESHELL: ADVSTORESHELL is capable of setting and deleting Registry values.","[S0568] EVILNUM: EVILNUM can make modifications to the Regsitry for persistence.","[S0330] Zeus Panda: Zeus Panda modifies several Registry keys under HKCU\\Software\\Microsoft\\Internet Explorer\\ PhishingFilter\\ to disable phishing filters.","[S0343] Exaramel for Windows: Exaramel for Windows adds the configuration to the Registry in XML format.","[S0205] Naid: Naid creates Registry entries that store information about a created service and point to a malicious DLL dropped to disk.","[S0140] Shamoon: Once Shamoon has access to a network share, it enables the RemoteRegistry service on the target system. It will then connect to the system with RegConnectRegistryW and modify the Registry to disable UAC remote restrictions by setting SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy to 1.","[S0663] SysUpdate: SysUpdate can write its configuration file to Software\\Classes\\scConfig in either HKEY_LOCAL_MACHINE or HKEY_CURRENT_USER.","[G1014] LuminousMoth: LuminousMoth has used malware that adds Registry keys for persistence.","[S0385] njRAT: njRAT can create, delete, or modify a specified Registry key or value.","[S1047] Mori: Mori can write data to `HKLM\\Software\\NFC\\IPA` and `HKLM\\Software\\NFC\\` and delete Registry values.","[S0342] GreyEnergy: GreyEnergy modifies conditions in the Registry and adds keys.","[S0075] Reg: Reg may be used to interact with and modify the Windows Registry of a local or remote system at the command-line interface.","[S0090] Rover: Rover has functionality to remove Registry Run key persistence as a cleanup procedure.","[S0180] Volgmer: Volgmer modifies the Registry to store an encoded configuration file in HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Security.","[S0660] Clambling: Clambling can set and delete Registry keys.","[S0650] QakBot: QakBot can modify the Registry to store its configuration information in a randomly named subkey under HKCU\\Software\\Microsoft.","[S0239] Bankshot: Bankshot writes data into the Registry key HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Pniumj.","[G0094] Kimsuky: Kimsuky has modified Registry settings for default file associations to enable all macros and for persistence.","[S0126] ComRAT: ComRAT has modified Registry values to store encrypted orchestrator code and payloads.","[S0640] Avaddon: Avaddon modifies several registry keys for persistence and UAC bypass.","[S1025] Amadey: Amadey has overwritten registry keys for persistence.","[S1180] BlackByte Ransomware: BlackByte Ransomware modifies the victim Registry to prevent system recovery.","[S0266] TrickBot: TrickBot can modify registry entries.","[G0096] APT41: APT41 used a malware variant called GOODLUCK to modify the registry in order to steal credentials.","[S0334] DarkComet: DarkComet adds a Registry value for its installation routine to the Registry Key HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System Enable LUA=”0” and HKEY_CURRENT_USER\\Software\\DC3_FEXEC.","[G0059] Magic Hound: Magic Hound has modified Registry settings for security tools.","[S0263] TYPEFRAME: TYPEFRAME can install encrypted configuration data under the Registry key HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ShellCompatibility\\Applications\\laxhost.dll and HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\PrintConfigs.","[S1050] PcShare: PcShare can delete its persistence mechanisms from the registry.","[S0271] KEYMARBLE: KEYMARBLE has a command to create Registry entries for storing data under HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\WABE\\DataPath.","[S0679] Ferocious: Ferocious has the ability to add a Class ID in the current user Registry hive to enable persistence mechanisms.","[S1066] DarkTortilla: DarkTortilla has modified registry keys for persistence.","[S0348] Cardinal RAT: Cardinal RAT sets HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\Load to point to its executable.","[S0331] Agent Tesla: Agent Tesla can achieve persistence by modifying Registry key entries.","[S1090] NightClub: NightClub can modify the Registry to set the ServiceDLL for a service created by the malware for persistence.","[S0269] QUADAGENT: QUADAGENT modifies an HKCU Registry key to store a session identifier unique to the compromised system as well as a pre-shared key used for encrypting and decrypting C2 communications.","[S0198] NETWIRE: NETWIRE can modify the Registry to store its configuration information.","[S0589] Sibot: Sibot has modified the Registry to install a second-stage script in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\sibot.","[S0570] BitPaymer: BitPaymer can set values in the Registry to help in execution.","[S1149] CHIMNEYSWEEP: CHIMNEYSWEEP can use the Windows Registry Environment key to change the `%windir%` variable to point to `c:\\Windows` to enable payload execution.","[S0662] RCSession: RCSession can write its configuration file to the Registry.","[G1044] APT42: APT42 has modified Registry keys to maintain persistence.","[G1031] Saint Bear: Saint Bear will leverage malicious Windows batch scripts to modify registry values associated with Windows Defender functionality.","[S0210] Nerex: Nerex creates a Registry subkey that registers a new service.","[S0444] ShimRat: ShimRat has registered two registry keys for shim databases.","[G0027] Threat Group-3390: A Threat Group-3390 tool has created new Registry keys under `HKEY_CURRENT_USER\\Software\\Classes\\` and `HKLM\\SYSTEM\\CurrentControlSet\\services`.","[G0061] FIN8: FIN8 has deleted Registry keys during post compromise cleanup activities.","[S0677] AADInternals: AADInternals can modify registry keys as part of setting a new pass-through authentication agent.","[S0019] Regin: Regin appears to have functionality to modify remote Registry information.","[S0664] Pandora: Pandora can write an encrypted token to the Registry to enable processing of remote commands."],"tactics":"TA0003 - Persistence"}
{"technique_id":"T1133","technique_name":"External Remote Services","description":"Adversaries may leverage external-facing remote services to initially access and/or persist within a network. Remote services such as VPNs, Citrix, and other access mechanisms allow users to connect to internal enterprise network resources from external locations. There are often remote service gateways that manage connections and credential authentication for these services. Services such as Windows Remote Management and VNC can also be used externally. Access to Valid Accounts to use the service is often a requirement, which could be obtained through credential pharming or by obtaining the credentials from users after compromising the enterprise network. Access to remote services may be used as a redundant or persistent access mechanism during an operation. Access may also be gained through an exposed service that doesn’t require authentication. In containerized environments, this may include an exposed Docker API, Kubernetes API server, kubelet, or web application such as the Kubernetes dashboard.","detection":"Follow best practices for detecting adversary use of Valid Accounts for authenticating to remote services. Collect authentication logs and analyze for unusual access patterns, windows of activity, and access outside of normal business hours. When authentication is not required to access an exposed remote service, monitor for follow-on activities such as anomalous external use of the exposed API or application.","procedures":["[G0139] TeamTNT: TeamTNT has used open-source tools such as Weave Scope to target exposed Docker API ports and gain initial access to victim environments. TeamTNT has also targeted exposed kubelets for Kubernetes environments.","[G1016] FIN13: FIN13 has gained access to compromised environments via remote access services such as the corporate virtual private network (VPN).","[C0012] Operation CuckooBees: During Operation CuckooBees, the threat actors enabled WinRM over HTTP/HTTPS as a backup persistence mechanism using the following command: `cscript //nologo \"C:\\Windows\\System32\\winrm.vbs\" set winrm/config/service@{EnableCompatibilityHttpsListener=\"true\"}`.","[S0362] Linux Rabbit: Linux Rabbit attempts to gain access to the server via SSH.","[C0002] Night Dragon: During Night Dragon, threat actors used compromised VPN accounts to gain access to victim systems.","[S1060] Mafalda: Mafalda can establish an SSH connection from a compromised host to a server.","[G1003] Ember Bear: Ember Bear have used VPNs both for initial access to victim environments and for persistence within them following compromise.","[G0026] APT18: APT18 actors leverage legitimate credentials to log into external remote services.","[G0034] Sandworm Team: Sandworm Team has used Dropbear SSH with a hardcoded backdoor password to maintain persistence within the target network. Sandworm Team has also used VPN tunnels established in legitimate software company infrastructure to gain access to internal networks of that software company's users.","[G1017] Volt Typhoon: Volt Typhoon has used VPNs to connect to victim environments and enable post-exploitation actions.","[G1047] Velvet Ant: Velvet Ant has leveraged access to internet-facing remote services to compromise and retain access to victim environments.","[S0601] Hildegard: Hildegard was executed through an unsecure kubelet that allowed anonymous access to the victim environment.","[G1015] Scattered Spider: Scattered Spider has leveraged legitimate remote management tools to maintain persistent access.","[G0096] APT41: APT41 compromised an online billing/payment service using VPN access between a third-party service provider and the targeted payment service.","[G1004] LAPSUS$: LAPSUS$ has gained access to internet-facing systems and applications, including virtual private network (VPN), remote desktop protocol (RDP), and virtual desktop infrastructure (VDI) including Citrix.","[G0049] OilRig: OilRig uses remote services such as VPN, Citrix, or OWA to persist in an environment.","[G0093] GALLIUM: GALLIUM has used VPN services, including SoftEther VPN, to access and maintain persistence in victim environments.","[G0004] Ke3chang: Ke3chang has gained access through VPNs including with compromised accounts and stolen VPN certificates.","[C0028] 2015 Ukraine Electric Power Attack: During the 2015 Ukraine Electric Power Attack, Sandworm Team installed a modified Dropbear SSH client as the backdoor to target systems.","[G0102] Wizard Spider: Wizard Spider has accessed victim networks by using stolen credentials to access the corporate VPN infrastructure.","[G0016] APT29: APT29 has used compromised identities to access networks via VPNs and Citrix.","[C0004] CostaRicto: During CostaRicto, the threat actors set up remote tunneling using an SSH tool to maintain access to a compromised environment.","[G0094] Kimsuky: Kimsuky has used RDP to establish persistence.","[G0053] FIN5: FIN5 has used legitimate VPN, Citrix, or VNC credentials to maintain access to a victim environment.","[C0024] SolarWinds Compromise: For the SolarWinds Compromise, APT29 used compromised identities to access networks via SSH, VPNs, and other remote access tools.","[G0027] Threat Group-3390: Threat Group-3390 actors look for and use VPN profiles during an operation to access the network using external VPN services. Threat Group-3390 has also obtained OWA account credentials during intrusions that it subsequently used to attempt to regain access when evicted from a victim network.","[G1041] Sea Turtle: Sea Turtle has used external-facing SSH to achieve initial access to the IT environments of victim organizations.","[S0599] Kinsing: Kinsing was executed in an Ubuntu container deployed via an open Docker daemon API.","[C0027] C0027: During C0027, Scattered Spider used Citrix and VPNs to persist in compromised environments.","[G0115] GOLD SOUTHFIELD: GOLD SOUTHFIELD has used publicly-accessible RDP and remote management and monitoring (RMM) servers to gain access to victim machines.","[G0114] Chimera: Chimera has used legitimate credentials to login to an external VPN, Citrix, SSH, and other remote services.","[C0032] C0032: During the C0032 campaign, TEMP.Veles used VPN access to persist in the victim environment.","[G0035] Dragonfly: Dragonfly has used VPNs and Outlook Web Access (OWA) to maintain access to victim networks.","[G1024] Akira: Akira uses compromised VPN accounts for initial access to victim networks.","[G0007] APT28: APT28 has used Tor and a variety of commercial VPN services to route brute force authentication attempts.","[G1040] Play: Play has used Remote Desktop Protocol (RDP) and Virtual Private Networks (VPN) for initial access.","[C0014] Operation Wocao: During Operation Wocao, threat actors used stolen credentials to connect to the victim's network via VPN.","[C0046] ArcaneDoor: ArcaneDoor used WebVPN sessions commonly associated with Clientless SSLVPN services to communicate to compromised devices.","[S0600] Doki: Doki was executed through an open Docker daemon API port.","[G0065] Leviathan: Leviathan has used external remote services such as virtual private networks (VPN) to gain initial access."],"tactics":"TA0003 - Persistence"}
{"technique_id":"T1136.001","technique_name":"Create Account: Local Account","description":"Adversaries may create a local account to maintain access to victim systems. Local accounts are those configured by an organization for use by users, remote support, services, or for administration on a single system or service. For example, with a sufficient level of access, the Windows net user /add command can be used to create a local account. In Linux, the `useradd` command can be used, while on macOS systems, the dscl -create command can be used. Local accounts may also be added to network devices, often via common Network Device CLI commands such as username, to ESXi servers via `esxcli system account add`, or to Kubernetes clusters using the `kubectl` utility. Such accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system.","detection":"Monitor for processes and command-line parameters associated with local account creation, such as net user /add , useradd , and dscl -create . Collect data on account creation within a network. Event ID 4720 is generated when a user account is created on a Windows system. Perform regular audits of local system accounts to detect suspicious accounts that may have been created by an adversary. For network infrastructure devices, collect AAA logging to monitor for account creations.","procedures":["[G0102] Wizard Spider: Wizard Spider has created local administrator accounts to maintain persistence in compromised networks.","[G1023] APT5: APT5 has created Local Administrator accounts to maintain access to systems with short-cycle credential rotation.","[S0394] HiddenWasp: HiddenWasp creates a user account as a means to provide initial persistence to the compromised machine.","[S0493] GoldenSpy: GoldenSpy can create new users on an infected system.","[S0363] Empire: Empire has a module for creating a local user if permissions allow.","[G0035] Dragonfly: Dragonfly has created accounts on victims, including administrator accounts, some of which appeared to be tailored to each individual staging target.","[G0139] TeamTNT: TeamTNT has created local privileged users on victim machines.","[G0117] Fox Kitten: Fox Kitten has created a local user account with administrator privileges.","[S0649] SMOKEDHAM: SMOKEDHAM has created user accounts.","[G0096] APT41: APT41 has created user accounts.","[G1016] FIN13: FIN13 has created MS-SQL local accounts in a compromised network.","[S0143] Flame: Flame can create backdoor accounts with login “HelpAssistant” on domain connected systems if appropriate rights are available.","[S0382] ServHelper: ServHelper has created a new user named \"supportaccount\".","[G0094] Kimsuky: Kimsuky has created accounts with net user.","[S0192] Pupy: Pupy can user PowerView to execute “net user” commands and create local system accounts.","[S0085] S-Type: S-Type may create a temporary user on the system named `Lost_{Unique Identifier}` with the password `pond~!@6”{Unique Identifier}`.","[S0039] Net: The net user username \\password commands in Net can be used to create a local account.","[S1111] DarkGate: DarkGate creates a local user account, SafeMode, via net user commands.","[S0084] Mis-Type: Mis-Type may create a temporary user on the system named `Lost_{Unique Identifier}`.","[G0059] Magic Hound: Magic Hound has created local accounts named `help` and `DefaultAccount` on compromised machines.","[S0030] Carbanak: Carbanak can create a Windows account.","[G0119] Indrik Spider: Indrik Spider has created local system accounts and has added the accounts to privileged groups.","[G0077] Leafminer: Leafminer used a tool called Imecab to set up a persistent remote access account on the victim machine.","[G0087] APT39: APT39 has created accounts on multiple compromised hosts to perform actions within the network.","[S0601] Hildegard: Hildegard has created a user named “monerodaemon”.","[S0412] ZxShell: ZxShell has a feature to create local user accounts.","[G1034] Daggerfly: Daggerfly created a local account on victim machines to maintain access.","[G0022] APT3: APT3 has been known to create or enable accounts, such as support_388945a0.","[S0274] Calisto: Calisto has the capability to add its own account to the victim's machine."],"tactics":"TA0003 - Persistence"}
{"technique_id":"T1136.002","technique_name":"Create Account: Domain Account","description":"Adversaries may create a domain account to maintain access to victim systems. Domain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain. Domain accounts can cover user, administrator, and service accounts. With a sufficient level of access, the net user /add /domain command can be used to create a domain account. Such accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system.","detection":"Monitor for processes and command-line parameters associated with domain account creation, such as net user /add /domain. Collect data on account creation within a network. Event ID 4720 is generated when a user account is created on a Windows domain controller. Perform regular audits of domain accounts to detect suspicious accounts that may have been created by an adversary.","procedures":["[S0192] Pupy: Pupy can user PowerView to execute “net user” commands and create domain accounts.","[G0093] GALLIUM: GALLIUM created high-privileged domain user accounts to maintain access to victim networks.","[G1043] BlackByte: BlackByte created privileged domain accounts during intrusions.","[C0028] 2015 Ukraine Electric Power Attack: During the 2015 Ukraine Electric Power Attack, Sandworm Team created privileged domain accounts to be used for further exploitation and lateral movement.","[G0102] Wizard Spider: Wizard Spider has created and used new accounts within a victim's Active Directory environment to maintain persistence.","[S0029] PsExec: PsExec has the ability to remotely create accounts on target systems.","[S0039] Net: The net user username \\password \\domain commands in Net can be used to create a domain account.","[C0025] 2016 Ukraine Electric Power Attack: During the 2016 Ukraine Electric Power Attack, Sandworm Team created two new accounts, “admin” and “система” (System). The accounts were then assigned to a domain matching local operation and were delegated new privileges.","[G0125] HAFNIUM: HAFNIUM has created domain accounts.","[S0363] Empire: Empire has a module for creating a new domain user if permissions allow."],"tactics":"TA0003 - Persistence"}
{"technique_id":"T1136.003","technique_name":"Create Account: Cloud Account","description":"Adversaries may create a cloud account to maintain access to victim systems. With a sufficient level of access, such accounts may be used to establish secondary credentialed access that does not require persistent remote access tools to be deployed on the system. In addition to user accounts, cloud accounts may be associated with services. Cloud providers handle the concept of service accounts in different ways. In Azure, service accounts include service principals and managed identities, which can be linked to various resources such as OAuth applications, serverless functions, and virtual machines in order to grant those resources permissions to perform various activities in the environment. In GCP, service accounts can also be linked to specific resources, as well as be impersonated by other accounts for Temporary Elevated Cloud Access. While AWS has no specific concept of service accounts, resources can be directly granted permission to assume roles. Adversaries may create accounts that only have access to specific cloud services, which can reduce the chance of detection. Once an adversary has created a cloud account, they can then manipulate that account to ensure persistence and allow access to additional resources - for example, by adding Additional Cloud Credentials or assigning Additional Cloud Roles.","detection":"Collect usage logs from cloud user and administrator accounts to identify unusual activity in the creation of new accounts and assignment of roles to those accounts. Monitor for accounts assigned to admin roles that go over a certain threshold of known admins.","procedures":["[G0016] APT29: APT29 can create new users through Azure AD.","[G1004] LAPSUS$: LAPSUS$ has created global admin accounts in the targeted organization's cloud instances to gain persistence.","[S0677] AADInternals: AADInternals can create new Azure AD users."],"tactics":"TA0003 - Persistence"}
{"technique_id":"T1137.001","technique_name":"Office Application Startup: Office Template Macros","description":"Adversaries may abuse Microsoft Office templates to obtain persistence on a compromised system. Microsoft Office contains templates that are part of common Office applications and are used to customize styles. The base templates within the application are used each time an application starts. Office Visual Basic for Applications (VBA) macros can be inserted into the base template and used to execute code when the respective Office application starts in order to obtain persistence. Examples for both Word and Excel have been discovered and published. By default, Word has a Normal.dotm template created that can be modified to include a malicious macro. Excel does not have a template file created by default, but one can be added that will automatically be loaded. Shared templates may also be stored and pulled from remote locations. Word Normal.dotm location: C:\\Users\\&lt;username&gt;\\AppData\\Roaming\\Microsoft\\Templates\\Normal.dotm Excel Personal.xlsb location: C:\\Users\\&lt;username&gt;\\AppData\\Roaming\\Microsoft\\Excel\\XLSTART\\PERSONAL.XLSB Adversaries may also change the location of the base template to point to their own by hijacking the application's search order, e.g. Word 2016 will first look for Normal.dotm under C:\\Program Files (x86)\\Microsoft Office\\root\\Office16\\, or by modifying the GlobalDotName registry key. By modifying the GlobalDotName registry key an adversary can specify an arbitrary location, file name, and file extension to use for the template that will be loaded on application startup. To abuse GlobalDotName, adversaries may first need to register the template as a trusted document or place it in a trusted location. An adversary may need to enable macros to execute unrestricted depending on the system or enterprise security policy on use of macros.","detection":"Many Office-related persistence mechanisms require changes to the Registry and for binaries, files, or scripts to be written to disk or existing files modified to include malicious scripts. Collect events related to Registry key creation and modification for keys that could be used for Office-based persistence. Modification to base templates, like Normal.dotm, should also be investigated since the base templates should likely not contain VBA macros. Changes to the Office macro security settings should also be investigated.","procedures":["[G0069] MuddyWater: MuddyWater has used a Word Template, Normal.dotm, for persistence.","[S0475] BackConfig: BackConfig has the ability to use hidden columns in Excel spreadsheets to store executable files or commands for VBA macros.","[S0154] Cobalt Strike: Cobalt Strike has the ability to use an Excel Workbook to execute additional code by enabling Office to trust macros and execute code without user permission."],"tactics":"TA0003 - Persistence"}
{"technique_id":"T1137.002","technique_name":"Office Application Startup: Office Test","description":"Adversaries may abuse the Microsoft Office \"Office Test\" Registry key to obtain persistence on a compromised system. An Office Test Registry location exists that allows a user to specify an arbitrary DLL that will be executed every time an Office application is started. This Registry key is thought to be used by Microsoft to load DLLs for testing and debugging purposes while developing Office applications. This Registry key is not created by default during an Office installation. There exist user and global Registry keys for the Office Test feature, such as: * HKEY_CURRENT_USER\\Software\\Microsoft\\Office test\\Special\\Perf * HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Office test\\Special\\Perf Adversaries may add this Registry key and specify a malicious DLL that will be executed whenever an Office application, such as Word or Excel, is started.","detection":"Monitor for the creation of the Office Test Registry key. Many Office-related persistence mechanisms require changes to the Registry and for binaries, files, or scripts to be written to disk or existing files modified to include malicious scripts. Collect events related to Registry key creation and modification for keys that could be used for Office-based persistence. Since v13.52, Autoruns can detect tasks set up using the Office Test Registry key. Consider monitoring Office processes for anomalous DLL loads.","procedures":["[G0007] APT28: APT28 has used the Office Test persistence mechanism within Microsoft Office by adding the Registry key HKCU\\Software\\Microsoft\\Office test\\Special\\Perf to execute code."],"tactics":"TA0003 - Persistence"}
{"technique_id":"T1137.003","technique_name":"Office Application Startup: Outlook Forms","description":"Adversaries may abuse Microsoft Outlook forms to obtain persistence on a compromised system. Outlook forms are used as templates for presentation and functionality in Outlook messages. Custom Outlook forms can be created that will execute code when a specifically crafted email is sent by an adversary utilizing the same custom Outlook form. Once malicious forms have been added to the user’s mailbox, they will be loaded when Outlook is started. Malicious forms will execute when an adversary sends a specifically crafted email to the user.","detection":"Microsoft has released a PowerShell script to safely gather mail forwarding rules and custom forms in your mail environment as well as steps to interpret the output. SensePost, whose tool Ruler can be used to carry out malicious rules, forms, and Home Page attacks, has released a tool to detect Ruler usage. Collect process execution information including process IDs (PID) and parent process IDs (PPID) and look for abnormal chains of activity resulting from Office processes. Non-standard process execution trees may also indicate suspicious or malicious behavior.","procedures":["[S0358] Ruler: Ruler can be used to automate the abuse of Outlook Forms to establish persistence."],"tactics":"TA0003 - Persistence"}
{"technique_id":"T1137.004","technique_name":"Office Application Startup: Outlook Home Page","description":"Adversaries may abuse Microsoft Outlook's Home Page feature to obtain persistence on a compromised system. Outlook Home Page is a legacy feature used to customize the presentation of Outlook folders. This feature allows for an internal or external URL to be loaded and presented whenever a folder is opened. A malicious HTML page can be crafted that will execute code when loaded by Outlook Home Page. Once malicious home pages have been added to the user’s mailbox, they will be loaded when Outlook is started. Malicious Home Pages will execute when the right Outlook folder is loaded/reloaded.","detection":"Microsoft has released a PowerShell script to safely gather mail forwarding rules and custom forms in your mail environment as well as steps to interpret the output. SensePost, whose tool Ruler can be used to carry out malicious rules, forms, and Home Page attacks, has released a tool to detect Ruler usage. Collect process execution information including process IDs (PID) and parent process IDs (PPID) and look for abnormal chains of activity resulting from Office processes. Non-standard process execution trees may also indicate suspicious or malicious behavior.","procedures":["[G0049] OilRig: OilRig has abused the Outlook Home Page feature for persistence. OilRig has also used CVE-2017-11774 to roll back the initial patch designed to protect against Home Page abuse.","[S0358] Ruler: Ruler can be used to automate the abuse of Outlook Home Pages to establish persistence."],"tactics":"TA0003 - Persistence"}
{"technique_id":"T1137.005","technique_name":"Office Application Startup: Outlook Rules","description":"Adversaries may abuse Microsoft Outlook rules to obtain persistence on a compromised system. Outlook rules allow a user to define automated behavior to manage email messages. A benign rule might, for example, automatically move an email to a particular folder in Outlook if it contains specific words from a specific sender. Malicious Outlook rules can be created that can trigger code execution when an adversary sends a specifically crafted email to that user. Once malicious rules have been added to the user’s mailbox, they will be loaded when Outlook is started. Malicious rules will execute when an adversary sends a specifically crafted email to the user.","detection":"Microsoft has released a PowerShell script to safely gather mail forwarding rules and custom forms in your mail environment as well as steps to interpret the output. This PowerShell script is ineffective in gathering rules with modified `PRPR_RULE_MSG_NAME` and `PR_RULE_MSG_PROVIDER` properties caused by adversaries using a Microsoft Exchange Server Messaging API Editor (MAPI Editor), so only examination with the Exchange Administration tool MFCMapi can reveal these mail forwarding rules. SensePost, whose tool Ruler can be used to carry out malicious rules, forms, and Home Page attacks, has released a tool to detect Ruler usage. Collect process execution information including process IDs (PID) and parent process IDs (PPID) and look for abnormal chains of activity resulting from Office processes. Non-standard process execution trees may also indicate suspicious or malicious behavior.","procedures":["[S0358] Ruler: Ruler can be used to automate the abuse of Outlook Rules to establish persistence."],"tactics":"TA0003 - Persistence"}
{"technique_id":"T1137.006","technique_name":"Office Application Startup: Add-ins","description":"Adversaries may abuse Microsoft Office add-ins to obtain persistence on a compromised system. Office add-ins can be used to add functionality to Office programs. There are different types of add-ins that can be used by the various Office products; including Word/Excel add-in Libraries (WLL/XLL), VBA add-ins, Office Component Object Model (COM) add-ins, automation add-ins, VBA Editor (VBE), Visual Studio Tools for Office (VSTO) add-ins, and Outlook add-ins. Add-ins can be used to obtain persistence because they can be set to execute code when an Office application starts.","detection":"Monitor and validate the Office trusted locations on the file system and audit the Registry entries relevant for enabling add-ins. Collect process execution information including process IDs (PID) and parent process IDs (PPID) and look for abnormal chains of activity resulting from Office processes. Non-standard process execution trees may also indicate suspicious or malicious behavior","procedures":["[S0268] Bisonal: Bisonal has been loaded through a `.wll` extension added to the ` %APPDATA%\\microsoft\\word\\startup\\` repository.","[G0019] Naikon: Naikon has used the RoyalRoad exploit builder to drop a second stage loader, intel.wll, into the Word Startup folder on the compromised host.","[S1143] LunarLoader: LunarLoader has the ability to use Microsoft Outlook add-ins to establish persistence.","[S1142] LunarMail: LunarMail has the ability to use Outlook add-ins for persistence."],"tactics":"TA0003 - Persistence"}
{"technique_id":"T1176.001","technique_name":"Software Extensions: Browser Extensions","description":"Adversaries may abuse internet browser extensions to establish persistent access to victim systems. Browser extensions or plugins are small programs that can add functionality to and customize aspects of internet browsers. They can be installed directly via a local file or custom URL or through a browser's app store - an official online platform where users can browse, install, and manage extensions for a specific web browser. Extensions generally inherit the web browser's permissions previously granted. Malicious extensions can be installed into a browser through malicious app store downloads masquerading as legitimate extensions, through social engineering, or by an adversary that has already compromised a system. Security can be limited on browser app stores, so it may not be difficult for malicious extensions to defeat automated scanners. Depending on the browser, adversaries may also manipulate an extension's update url to install updates from an adversary-controlled server or manipulate the mobile configuration file to silently install additional extensions. Previous to macOS 11, adversaries could silently install browser extensions via the command line using the profiles tool to install malicious .mobileconfig files. In macOS 11+, the use of the profiles tool can no longer install configuration profiles; however, .mobileconfig files can be planted and installed with user interaction. Once the extension is installed, it can browse to websites in the background, steal all information that a user enters into a browser (including credentials), and be used as an installer for a RAT for persistence. There have also been instances of botnets using a persistent backdoor through malicious Chrome extensions for Command and Control. Adversaries may also use browser extensions to modify browser permissions and components, privacy settings, and other security controls for Defense Evasion.","detection":null,"procedures":["[S1122] Mispadu: Mispadu utilizes malicious Google Chrome browser extensions to steal financial data.","[G0094] Kimsuky: Kimsuky has used Google Chrome browser extensions to infect victims and to steal passwords and cookies.","[S0402] OSX/Shlayer: OSX/Shlayer can install malicious Safari browser extensions to serve ads.","[S1213] Lumma Stealer: Lumma Stealer has installed a malicious browser extension to target Google Chrome, Microsoft Edge, Opera and Brave browsers for the purpose of stealing data.","[S1201] TRANSLATEXT: TRANSLATEXT has the ability to capture credentials, cookies, browser screenshots, etc. and to exfiltrate data.","[S0531] Grandoreiro: Grandoreiro can use malicious browser extensions to steal cookies and other user information.","[S0482] Bundlore: Bundlore can install malicious browser extensions that are used to hijack user searches."],"tactics":"TA0003 - Persistence"}
{"technique_id":"T1176.002","technique_name":"Software Extensions: IDE Extensions","description":"Adversaries may abuse an integrated development environment (IDE) extension to establish persistent access to victim systems. IDEs such as Visual Studio Code, IntelliJ IDEA, and Eclipse support extensions - software components that add features like code linting, auto-completion, task automation, or integration with tools like Git and Docker. A malicious extension can be installed through an extension marketplace (i.e., Compromise Software Dependencies and Development Tools) or side-loaded directly into the IDE. In addition to installing malicious extensions, adversaries may also leverage benign ones. For example, adversaries may establish persistent SSH tunnels via the use of the VSCode Remote SSH extension (i.e., IDE Tunneling). Trust is typically established through the installation process; once installed, the malicious extension is run every time that the IDE is launched. The extension can then be used to execute arbitrary code, establish a backdoor, mine cryptocurrency, or exfiltrate data.","detection":null,"procedures":null,"tactics":"TA0003 - Persistence"}
{"technique_id":"T1197","technique_name":"BITS Jobs","description":"Adversaries may abuse BITS jobs to persistently execute code and perform various background tasks. Windows Background Intelligent Transfer Service (BITS) is a low-bandwidth, asynchronous file transfer mechanism exposed through Component Object Model (COM). BITS is commonly used by updaters, messengers, and other applications preferred to operate in the background (using available idle bandwidth) without interrupting other networked applications. File transfer tasks are implemented as BITS jobs, which contain a queue of one or more file operations. The interface to create and manage BITS jobs is accessible through PowerShell and the BITSAdmin tool. Adversaries may abuse BITS to download (e.g. Ingress Tool Transfer), execute, and even clean up after running malicious code (e.g. Indicator Removal). BITS tasks are self-contained in the BITS job database, without new files or registry modifications, and often permitted by host firewalls. BITS enabled execution may also enable persistence by creating long-standing jobs (the default maximum lifetime is 90 days and extendable) or invoking an arbitrary program when a job completes or errors (including after system reboots). BITS upload functionalities can also be used to perform Exfiltration Over Alternative Protocol.","detection":"BITS runs as a service and its status can be checked with the Sc query utility (sc query bits). Active BITS tasks can be enumerated using the BITSAdmin tool (bitsadmin /list /allusers /verbose). Monitor usage of the BITSAdmin tool (especially the ‘Transfer’, 'Create', 'AddFile', 'SetNotifyFlags', 'SetNotifyCmdLine', 'SetMinRetryDelay', 'SetCustomHeaders', and 'Resume' command options) Admin logs, PowerShell logs, and the Windows Event log for BITS activity. Also consider investigating more detailed information about jobs by parsing the BITS job database. Monitor and analyze network activity generated by BITS. BITS jobs use HTTP(S) and SMB for remote connections and are tethered to the creating user and will only function when that user is logged on (this rule applies even if a user attaches the job to a service account).","procedures":["[S0652] MarkiRAT: MarkiRAT can use BITS Utility to connect with the C2 server.","[G0040] Patchwork: Patchwork has used BITS jobs to download malicious payloads.","[S0534] Bazar: Bazar has been downloaded via Windows BITS functionality.","[S0154] Cobalt Strike: Cobalt Strike can download a hosted \"beacon\" payload using BITSAdmin.","[S0554] Egregor: Egregor has used BITSadmin to download and execute malicious DLLs.","[S0201] JPIN: A JPIN variant downloads the backdoor payload via the BITS service.","[S0333] UBoatRAT: UBoatRAT takes advantage of the /SetNotifyCmdLine option in BITSAdmin to ensure it stays running on a system to maintain persistence.","[S0654] ProLock: ProLock can use BITS jobs to download its malicious payload.","[G0065] Leviathan: Leviathan has used BITSAdmin to download additional tools.","[G0087] APT39: APT39 has used the BITS protocol to exfiltrate stolen data from a compromised host.","[S0190] BITSAdmin: BITSAdmin can be used to create BITS Jobs to launch a malicious process.","[G0096] APT41: APT41 used BITSAdmin to download and install payloads.","[G0102] Wizard Spider: Wizard Spider has used batch scripts that utilizes WMIC to execute a BITSAdmin transfer of a ransomware payload to each compromised machine."],"tactics":"TA0003 - Persistence"}
{"technique_id":"T1205.001","technique_name":"Traffic Signaling: Port Knocking","description":"Adversaries may use port knocking to hide open ports used for persistence or command and control. To enable a port, an adversary sends a series of attempted connections to a predefined sequence of closed ports. After the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software. This technique has been observed both for the dynamic opening of a listening port as well as the initiating of a connection to a listening server on a different system. The observation of the signal packets to trigger the communication can be conducted through different methods. One means, originally implemented by Cd00r , is to use the libpcap libraries to sniff for the packets in question. Another method leverages raw sockets, which enables the malware to use ports that are already open for use by other programs.","detection":"Record network packets sent to and from the system, looking for extraneous packets that do not belong to established flows.","procedures":["[S1060] Mafalda: Mafalda can use port-knocking to authenticate itself to another implant called Cryshell to establish an indirect connection to the C2 server.","[G0056] PROMETHIUM: PROMETHIUM has used a script that configures the knockd service and firewall to only accept C2 connections from systems that use a specified sequence of knock ports.","[S1204] cd00r: cd00r can monitor for a single TCP-SYN packet to be sent in series to a configurable set of ports (200, 80, 22, 53 and 3 in the original code) before opening a port for communication.","[S1059] metaMain: metaMain has authenticated itself to a different implant, Cryshell, through a port knocking and handshake procedure."],"tactics":"TA0003 - Persistence"}
{"technique_id":"T1205.002","technique_name":"Traffic Signaling: Socket Filters","description":"Adversaries may attach filters to a network socket to monitor then activate backdoors used for persistence or command and control. With elevated permissions, adversaries can use features such as the `libpcap` library to open sockets and install filters to allow or disallow certain types of data to come through the socket. The filter may apply to all traffic passing through the specified network interface (or every interface if not specified). When the network interface receives a packet matching the filter criteria, additional actions can be triggered on the host, such as activation of a reverse shell. To establish a connection, an adversary sends a crafted packet to the targeted host that matches the installed filter criteria. Adversaries have used these socket filters to trigger the installation of implants, conduct ping backs, and to invoke command shells. Communication with these socket filters may also be used in conjunction with Protocol Tunneling. Filters can be installed on any Unix-like platform with `libpcap` installed or on Windows hosts using `Winpcap`. Adversaries may use either `libpcap` with `pcap_setfilter` or the standard library function `setsockopt` with `SO_ATTACH_FILTER` options. Since the socket connection is not active until the packet is received, this behavior may be difficult to detect due to the lack of activity on a host, low CPU overhead, and limited visibility into raw socket usage.","detection":"Identify running processes with raw sockets. Ensure processes listed have a need for an open raw socket and are in accordance with enterprise policy.","procedures":["[S1161] BPFDoor: BPFDoor uses BPF bytecode to attach a filter to a network socket to view ICMP, UDP, or TCP packets coming through ports 22 (ssh), 80 (http), and 443 (https). When BPFDoor finds a packet containing its “magic” bytes, it parses out two fields and forks itself. The parent process continues to monitor filtered traffic while the child process executes the instructions from the parsed fields.","[S1123] PITSTOP: PITSTOP can listen and evaluate incoming commands on the domain socket, created by PITHOOK malware, located at `/data/runtime/cockpit/wd.fd` for a predefined magic byte sequence. PITSTOP can then duplicate the socket for further communication over TLS.","[S0587] Penquin: Penquin installs a `TCP` and `UDP` filter on the `eth0` interface."],"tactics":"TA0003 - Persistence"}
{"technique_id":"T1505.001","technique_name":"Server Software Component: SQL Stored Procedures","description":"Adversaries may abuse SQL stored procedures to establish persistent access to systems. SQL Stored Procedures are code that can be saved and reused so that database users do not waste time rewriting frequently used SQL queries. Stored procedures can be invoked via SQL statements to the database using the procedure name or via defined events (e.g. when a SQL server application is started/restarted). Adversaries may craft malicious stored procedures that can provide a persistence mechanism in SQL database servers. To execute operating system commands through SQL syntax the adversary may have to enable additional functionality, such as xp_cmdshell for MSSQL Server. Microsoft SQL Server can enable common language runtime (CLR) integration. With CLR integration enabled, application developers can write stored procedures using any .NET framework language (e.g. VB .NET, C#, etc.). Adversaries may craft or modify CLR assemblies that are linked to stored procedures since these CLR assemblies can be made to execute arbitrary commands.","detection":"On a MSSQL Server, consider monitoring for xp_cmdshell usage. Consider enabling audit features that can log malicious startup activities.","procedures":["[C0025] 2016 Ukraine Electric Power Attack: During the 2016 Ukraine Electric Power Attack, Sandworm Team used various MS-SQL stored procedures.","[S0603] Stuxnet: Stuxnet used xp_cmdshell to store and execute SQL code."],"tactics":"TA0003 - Persistence"}
{"technique_id":"T1505.002","technique_name":"Server Software Component: Transport Agent","description":"Adversaries may abuse Microsoft transport agents to establish persistent access to systems. Microsoft Exchange transport agents can operate on email messages passing through the transport pipeline to perform various tasks such as filtering spam, filtering malicious attachments, journaling, or adding a corporate signature to the end of all outgoing emails. Transport agents can be written by application developers and then compiled to .NET assemblies that are subsequently registered with the Exchange server. Transport agents will be invoked during a specified stage of email processing and carry out developer defined tasks. Adversaries may register a malicious transport agent to provide a persistence mechanism in Exchange Server that can be triggered by adversary-specified email events. Though a malicious transport agent may be invoked for all emails passing through the Exchange transport pipeline, the agent can be configured to only carry out specific tasks in response to adversary defined criteria. For example, the transport agent may only carry out an action like copying in-transit attachments and saving them for later exfiltration if the recipient email address matches an entry on a list provided by the adversary.","detection":"Consider monitoring application logs for abnormal behavior that may indicate suspicious installation of application software components. Consider monitoring file locations associated with the installation of new application software components such as paths from which applications typically load such extensible components.","procedures":["[S0395] LightNeuron: LightNeuron has used a malicious Microsoft Exchange transport agent for persistence."],"tactics":"TA0003 - Persistence"}
{"technique_id":"T1505.003","technique_name":"Server Software Component: Web Shell","description":"Adversaries may backdoor web servers with web shells to establish persistent access to systems. A Web shell is a Web script that is placed on an openly accessible Web server to allow an adversary to access the Web server as a gateway into a network. A Web shell may provide a set of functions to execute or a command-line interface on the system that hosts the Web server. In addition to a server-side script, a Web shell may have a client interface program that is used to talk to the Web server (e.g. China Chopper Web shell client).","detection":"Web shells can be difficult to detect. Unlike other forms of persistent remote access, they do not initiate connections. The portion of the Web shell that is on the server may be small and innocuous looking. The PHP version of the China Chopper Web shell, for example, is the following short payload: &lt;?php @eval($_POST['password']);&gt; Nevertheless, detection mechanisms exist. Process monitoring may be used to detect Web servers that perform suspicious actions such as spawning cmd.exe or accessing files that are not in the Web directory. File monitoring may be used to detect changes to files in the Web directory of a Web server that do not match with updates to the Web server's content and may indicate implantation of a Web shell script. Log authentication attempts to the server and any unusual traffic patterns to or from the server and internal network.","procedures":["[G1012] CURIUM: CURIUM has been linked to web shells following likely server compromise as an initial access vector into victim networks.","[S0598] P.A.S. Webshell: P.A.S. Webshell can gain remote access and execution on target web servers.","[S0072] OwaAuth: OwaAuth is a Web shell that appears to be exclusively used by Threat Group-3390. It is installed as an ISAPI filter on Exchange servers and shares characteristics with the China Chopper Web shell.","[G0035] Dragonfly: Dragonfly has commonly created Web shells on victims' publicly accessible email and web servers, which they used to maintain access to a victim network and download additional malicious files.","[G0007] APT28: APT28 has used a modified and obfuscated version of the reGeorg web shell to maintain persistence on a target's Outlook Web Access (OWA) server.","[S1115] WIREFIRE: WIREFIRE is a web shell that can download files to and execute arbitrary commands from compromised Ivanti Connect Secure VPNs.","[G0049] OilRig: OilRig has used web shells, often to maintain access to a victim network.","[G1016] FIN13: FIN13 has utilized obfuscated and open-source web shells such as JspSpy, reGeorg, MiniWebCmdShell, and Vonloesch Jsp File Browser 1.2 to enable remote code execution and to execute commands on compromised web server.","[G0135] BackdoorDiplomacy: BackdoorDiplomacy has used web shells to establish an initial foothold and for lateral movement within a victim's system.","[S1118] BUSHWALK: BUSHWALK is a web shell that has the ability to execute arbitrary commands or write files.","[G1030] Agrius: Agrius typically deploys a variant of the ASPXSpy web shell following initial access via exploitation.","[S1110] SLIGHTPULSE: SLIGHTPULSE is a web shell that can read, write, and execute files on compromised servers.","[S1119] LIGHTWIRE: LIGHTWIRE is a web shell capable of command execution and establishing persistence on compromised Ivanti Secure Connect VPNs.","[G0009] Deep Panda: Deep Panda uses Web shells on publicly accessible Web servers to access victim networks.","[C0017] C0017: During C0017, APT41 deployed JScript web shells through the creation of malicious ViewState objects.","[C0034] 2022 Ukraine Electric Power Attack: During the 2022 Ukraine Electric Power Attack, Sandworm Team deployed the Neo-REGEORG webshell on an internet-facing server.","[C0041] FrostyGoop Incident: FrostyGoop Incident deployed a ReGeorg variant web shell to impacted systems following initial access for persistence.","[C0032] C0032: During the C0032 campaign, TEMP.Veles planted Web shells on Outlook Exchange servers.","[G0087] APT39: APT39 has installed ANTAK and ASPXSPY web shells.","[G0123] Volatile Cedar: Volatile Cedar can inject web shell code into a server.","[G0093] GALLIUM: GALLIUM used Web shells to persist in victim environments and assist in execution and exfiltration.","[C0029] Cutting Edge: During Cutting Edge, threat actors used multiple web shells to maintain presence on compromised Connect Secure appliances such as WIREFIRE, GLASSTOKEN, BUSHWALK, LIGHTWIRE, and FRAMESTING.","[S1112] STEADYPULSE: STEADYPULSE is a web shell that can enable the execution of arbitrary commands on compromised web servers.","[G0027] Threat Group-3390: Threat Group-3390 has used a variety of Web shells.","[C0040] APT41 DUST: APT41 DUST involved use of web shells such as ANTSWORD and BLUEBEAM for persistence.","[S0073] ASPXSpy: ASPXSpy is a Web shell. The ASPXTool version used by Threat Group-3390 has been deployed to accessible servers running Internet Information Services (IIS).","[G0081] Tropic Trooper: Tropic Trooper has started a web service in the target host and wait for the adversary to connect, acting as a web shell.","[G1003] Ember Bear: Ember Bear deploys web shells following initial access for either follow-on command execution or protocol tunneling. Example web shells used by Ember Bear include P0wnyshell, reGeorg, P.A.S. Webshell, and custom variants of publicly-available web shell examples.","[G0125] HAFNIUM: HAFNIUM has deployed multiple web shells on compromised servers including SIMPLESEESHARP, SPORTSBALL, China Chopper, and ASPXSpy.","[S1108] PULSECHECK: PULSECHECK is a web shell that can enable command execution on compromised servers.","[S1189] Neo-reGeorg: Neo-reGeorg can be installed on compromised web servers to tunnel C2 connections.","[G1009] Moses Staff: Moses Staff has dropped a web shell onto a compromised system.","[G0034] Sandworm Team: Sandworm Team has used webshells including P.A.S. Webshell to maintain access to victim networks.","[S1120] FRAMESTING: FRAMESTING is a web shell capable of enabling arbitrary command execution on compromised Ivanti Connect Secure VPNs.","[S1113] RAPIDPULSE: RAPIDPULSE is a web shell that is capable of arbitrary file read on targeted web servers to exfiltrate items of interest on the victim device.","[G0117] Fox Kitten: Fox Kitten has installed web shells on compromised hosts to maintain access.","[G0131] Tonto Team: Tonto Team has used a first stage web shell after compromising a vulnerable Exchange server.","[G1017] Volt Typhoon: Volt Typhoon has used webshells, including ones named AuditReport.jspx and iisstart.aspx, in compromised environments.","[C0038] HomeLand Justice: For HomeLand Justice, threat actors used .aspx webshells named pickers.aspx, error4.aspx, and ClientBin.aspx, to maintain persistence.","[S1188] Line Runner: Line Runner is a persistent Lua-based web shell.","[G0082] APT38: APT38 has used web shells for persistence or to ensure redundant access.","[C0049] Leviathan Australian Intrusions: Leviathan relied extensively on web shell use following initial access for persistence and command execution purposes in victim environments during Leviathan Australian Intrusions.","[G0016] APT29: APT29 has installed web shells on exploited Microsoft Exchange servers.","[C0012] Operation CuckooBees: During Operation CuckooBees, the threat actors generated a web shell within a vulnerable Enterprise Resource Planning Web Application Server as a persistence mechanism.","[S0578] SUPERNOVA: SUPERNOVA is a Web shell.","[S1163] SnappyTCP: SnappyTCP is a reverse TCP shell with command and control capabilities used for persistence purposes.","[G0059] Magic Hound: Magic Hound has used multiple web shells to gain execution.","[G1043] BlackByte: BlackByte has used ASPX web shells following exploitation of vulnerabilities in services such as Microsoft Exchange.","[S0185] SEASHARPEE: SEASHARPEE is a Web shell.","[S0020] China Chopper: China Chopper's server component is a Web Shell payload.","[S1117] GLASSTOKEN: GLASSTOKEN is a web shell capable of tunneling C2 connections and code execution on compromised Ivanti Secure Connect VPNs.","[G1023] APT5: APT5 has installed multiple web shells on compromised servers including on Pulse Secure VPN appliances.","[G0050] APT32: APT32 has used Web shells to maintain access to victim websites.","[G0065] Leviathan: Leviathan relies on web shells for an initial foothold as well as persistence into the victim's systems.","[S1187] reGeorg: reGeorg is a web shell that has been installed on exposed web servers for access to victim environments.","[G1041] Sea Turtle: Sea Turtle deployed the SnappyTCP web shell during intrusion operations.","[C0014] Operation Wocao: During Operation Wocao, threat actors used their own web shells, as well as those previously placed on target systems by other threat actors, for reconnaissance and lateral movement.","[C0039] Versa Director Zero Day Exploitation: Versa Director Zero Day Exploitation resulted in the deployment of the VersaMem web shell for follow-on activity.","[G0094] Kimsuky: Kimsuky has used modified versions of open source PHP web shells to maintain access, often adding \"Dinosaur\" references within the code."],"tactics":"TA0003 - Persistence"}