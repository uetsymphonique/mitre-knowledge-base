{"technique_id":"T1047","technique_name":"Windows Management Instrumentation","description":"Adversaries may abuse Windows Management Instrumentation (WMI) to execute malicious commands and payloads. WMI is designed for programmers and is the infrastructure for management data and operations on Windows systems. WMI is an administration feature that provides a uniform environment to access Windows system components. The WMI service enables both local and remote access, though the latter is facilitated by Remote Services such as Distributed Component Object Model and Windows Remote Management. Remote WMI over DCOM operates using port 135, whereas WMI over WinRM operates over port 5985 when using HTTP and 5986 for HTTPS. An adversary can use WMI to interact with local and remote systems and use it as a means to execute various behaviors, such as gathering information for Discovery as well as Execution of commands and payloads. For example, `wmic.exe` can be abused by an adversary to delete shadow copies with the command `wmic.exe Shadowcopy Delete` (i.e., Inhibit System Recovery). **Note:** `wmic.exe` is deprecated as of January of 2024, with the WMIC feature being “disabled by default” on Windows 11+. WMIC will be removed from subsequent Windows releases and replaced by PowerShell as the primary WMI interface. In addition to PowerShell and tools like `wbemtool.exe`, COM APIs can also be used to programmatically interact with WMI via C++, .NET, VBScript, etc.","detection":"Monitor network traffic for WMI connections; the use of WMI in environments that do not typically use WMI may be suspect. Perform process monitoring to capture command-line arguments of \"wmic\" and detect commands that are used to perform remote behavior.","procedures":["[S1085] Sardonic: Sardonic can use WMI to execute PowerShell commands on a compromised machine.","[S0688] Meteor: Meteor can use `wmic.exe` as part of its effort to delete shadow copies.","[G1021] Cinnamon Tempest: Cinnamon Tempest has used Impacket for lateral movement via WMI.","[S0270] RogueRobin: RogueRobin uses various WMI queries to check if the sample is running in a sandbox.","[G0045] menuPass: menuPass has used a modified version of pentesting script wmiexec.vbs, which logs into a remote machine using WMI.","[S0559] SUNBURST: SUNBURST used the WMI query Select * From Win32_SystemDriver to retrieve a driver listing.","[C0015] C0015: During C0015, the threat actors used `wmic` and `rundll32` to load Cobalt Strike onto a target host.","[G1032] INC Ransom: INC Ransom has used WMIC to deploy ransomware.","[S0089] BlackEnergy: A BlackEnergy 2 plug-in uses WMI to gather victim host details.","[S1044] FunnyDream: FunnyDream can use WMI to open a Windows command shell on a remote machine.","[S0283] jRAT: jRAT uses WMIC to identify anti-virus products installed on the victim’s machine and to obtain firewall details.","[S0367] Emotet: Emotet has used WMI to execute powershell.exe.","[G0047] Gamaredon Group: Gamaredon Group has used WMI to execute scripts used for discovery and for determining the C2 IP address.","[S0618] FIVEHANDS: FIVEHANDS can use WMI to delete files on a target machine.","[S0251] Zebrocy: One variant of Zebrocy uses WMI queries to gather information.","[G0050] APT32: APT32 used WMI to deploy their tools on remote machines and to gather information about the Outlook process.","[S0256] Mosquito: Mosquito's installer uses WMI to search for antivirus display names.","[G0129] Mustang Panda: Mustang Panda has executed PowerShell scripts via WMI.","[G0069] MuddyWater: MuddyWater has used malware that leveraged WMI for execution and querying host information.","[S0331] Agent Tesla: Agent Tesla has used wmi queries to gather information from the system.","[S0378] PoshC2: PoshC2 has a number of modules that use WMI to execute tasks.","[S1039] Bumblebee: Bumblebee can use WMI to gather system information and to spawn processes for code injection.","[G0102] Wizard Spider: Wizard Spider has used WMI and LDAP queries for network discovery and to move laterally. Wizard Spider has also used batch scripts to leverage WMIC to deploy ransomware.","[G0065] Leviathan: Leviathan has used WMI for execution.","[S1028] Action RAT: Action RAT can use WMI to gather AV products installed on an infected host.","[S1155] Covenant: Covenant can utilize WMI to install new Grunt listeners through XSL files or command one-liners.","[S0396] EvilBunny: EvilBunny has used WMI to gather information about the system.","[S0603] Stuxnet: Stuxnet used WMI with an explorer.exe token to execute on a remote share.","[S0194] PowerSploit: PowerSploit's Invoke-WmiCommand CodeExecution module uses WMI to execute and retrieve the output from a PowerShell payload.","[G1047] Velvet Ant: Velvet Ant used the `wmiexec.py` tool within Impacket for remote process execution via WMI.","[S1152] IMAPLoader: IMAPLoader uses WMI queries to query system information on victim hosts.","[S0184] POWRUNER: POWRUNER may use WMI when collecting information about a victim.","[S1124] SocGholish: SocGholish has used WMI calls for script execution and system profiling.","[S0381] FlawedAmmyy: FlawedAmmyy leverages WMI to enumerate anti-virus on the victim.","[G0046] FIN7: FIN7 has used WMI to install malware on targeted systems.","[G0093] GALLIUM: GALLIUM used WMI for execution to assist in lateral movement as well as for installing tools across multiple assets.","[G1017] Volt Typhoon: Volt Typhoon has leveraged WMIC for execution, remote system discovery, and to create and use temporary directories.","[S0654] ProLock: ProLock can use WMIC to execute scripts on targeted hosts.","[S0223] POWERSTATS: POWERSTATS can use WMI queries to retrieve data from compromised hosts.","[S1129] Akira: Akira will leverage COM objects accessed through WMI during execution to evade detection.","[G0108] Blue Mockingbird: Blue Mockingbird has used wmic.exe to set environment variables.","[S0692] SILENTTRINITY: SILENTTRINITY can use WMI for lateral movement.","[S0264] OopsIE: OopsIE uses WMI to perform discovery techniques.","[S1193] TAMECAT: TAMECAT has used Windows Management Instrumentation (WMI) to query anti-virus products.","[G0019] Naikon: Naikon has used WMIC.exe for lateral movement.","[S1063] Brute Ratel C4: Brute Ratel C4 can use WMI to move laterally.","[S0250] Koadic: Koadic can use WMI to execute commands.","[S1139] INC Ransomware: INC Ransomware has the ability to use wmic.exe to spread to multiple endpoints within a compromised environment.","[S1111] DarkGate: DarkGate has used WMI to execute files over the network and to obtain information about the domain.","[G0032] Lazarus Group: Lazarus Group has used WMIC for discovery as well as to execute payloads for persistence and lateral movement.","[S1178] ShrinkLocker: ShrinkLocker uses WMI to query information about the victim operating system.","[S0589] Sibot: Sibot has used WMI to discover network connections and configurations. Sibot has also used the Win32_Process class to execute a malicious DLL.","[S0062] DustySky: The DustySky dropper uses Windows Management Instrumentation to extract information about the operating system and whether an anti-virus is active.","[S0366] WannaCry: WannaCry utilizes wmic to delete shadow copies.","[S0605] EKANS: EKANS can use Windows Mangement Instrumentation (WMI) calls to execute operations.","[G0030] Lotus Blossom: Lotus Blossom has used WMI to enable lateral movement.","[S0241] RATANKBA: RATANKBA uses WMI to perform process monitoring.","[S0553] MoleNet: MoleNet can perform WMI commands on the system.","[S1068] BlackCat: BlackCat can use `wmic.exe` to delete shadow copies on compromised networks.","[S0368] NotPetya: NotPetya can use wmic to help propagate itself across a network.","[S0151] HALFBAKED: HALFBAKED can use WMI queries to gather system information.","[G0034] Sandworm Team: Sandworm Team has used Impacket’s WMIexec module for remote code execution and VBScript to run WMI queries.","[S0380] StoneDrill: StoneDrill has used the WMI command-line (WMIC) utility to run tasks.","[S0375] Remexi: Remexi executes received commands with wmic.exe (for WMI commands).","[G1006] Earth Lusca: Earth Lusca used a VBA script to execute WMI.","[S0363] Empire: Empire can use WMI to deliver a payload to a remote host.","[S0488] CrackMapExec: CrackMapExec can execute remote commands using Windows Management Instrumentation.","[S0357] Impacket: Impacket's `wmiexec` module can be used to execute commands through WMI.","[G0119] Indrik Spider: Indrik Spider has used WMIC to execute commands on remote computers.","[S1086] Snip3: Snip3 can query the WMI class `Win32_ComputerSystem` to gather information.","[S0267] FELIXROOT: FELIXROOT uses WMI to query the Windows Registry.","[S0365] Olympic Destroyer: Olympic Destroyer uses WMI to help propagate itself across a network.","[G1018] TA2541: TA2541 has used WMI to query targeted systems for security products.","[S1130] Raspberry Robin: Raspberry Robin can execute via LNK containing a command to run a legitimate executable, such as wmic.exe, to download a malicious Windows Installer (MSI) package.","[S0698] HermeticWizard: HermeticWizard can use WMI to create a new process on a remote machine via `C:\\windows\\system32\\cmd.exe /c start C:\\windows\\system32\\\\regsvr32.exe /s /iC:\\windows\\.dll`.","[S0617] HELLOKITTY: HELLOKITTY can use WMI to delete volume shadow copies.","[G0038] Stealth Falcon: Stealth Falcon malware gathers system information via Windows Management Instrumentation (WMI).","[S0483] IcedID: IcedID has used WMI to execute binaries.","[G0143] Aquatic Panda: Aquatic Panda used WMI for lateral movement in victim environments.","[S0496] REvil: REvil can use WMI to monitor for and kill specific processes listed in its configuration file.","[C0001] Frankenstein: During Frankenstein, the threat actors used WMI queries to check if various security applications were running as well as to determine the operating system version.","[S1141] LunarWeb: LunarWeb can use WMI queries for discovery on the victim host.","[S1199] LockBit 2.0: LockBit 2.0 can use wmic.exe to delete volume shadow copies.","[S0373] Astaroth: Astaroth uses WMIC to execute payloads.","[S1066] DarkTortilla: DarkTortilla can use WMI queries to obtain system information.","[S1064] SVCReady: SVCReady can use `WMI` queries to detect the presence of a virtual machine environment.","[S0673] DarkWatchman: DarkWatchman can use WMI to execute commands.","[C0027] C0027: During C0027, Scattered Spider used Windows Management Instrumentation (WMI) to move laterally via Impacket.","[G0016] APT29: APT29 used WMI to steal credentials and execute backdoors at a future time.","[S1070] Black Basta: Black Basta has used WMI to execute files over the network.","[C0022] Operation Dream Job: During Operation Dream Job, Lazarus Group used WMIC to executed a remote XSL script.","[S0640] Avaddon: Avaddon uses wmic.exe to delete shadow copies.","[S0340] Octopus: Octopus has used wmic.exe for local discovery information.","[S0376] HOPLIGHT: HOPLIGHT has used WMI to recompile the Managed Object Format (MOF) files in the WMI repository.","[C0025] 2016 Ukraine Electric Power Attack: During the 2016 Ukraine Electric Power Attack, WMI in scripts were used for remote execution and system surveys.","[S1032] PyDCrypt: PyDCrypt has attempted to execute with WMIC.","[S0449] Maze: Maze has used WMI to attempt to delete the shadow volumes on a machine, and to connect a virtual machine to the network domain of the victim organization's network.","[G0049] OilRig: OilRig has used WMI for execution.","[C0014] Operation Wocao: During Operation Wocao, threat actors has used WMI to execute commands.","[G0112] Windshift: Windshift has used WMI to collect information about target machines.","[C0038] HomeLand Justice: During HomeLand Justice, threat actors used WMI to modify Windows Defender settings.","[G0037] FIN6: FIN6 has used WMI to automate the remote execution of PowerShell scripts.","[S0616] DEATHRANSOM: DEATHRANSOM has the ability to use WMI to delete volume shadow copies.","[G1022] ToddyCat: ToddyCat has used WMI to execute scripts for post exploit document collection.","[G0009] Deep Panda: The Deep Panda group is known to utilize WMI for lateral movement.","[S1081] BADHATCH: BADHATCH can utilize WMI to collect system information, create new processes, and run malicious PowerShell scripts on a compromised machine.","[G0027] Threat Group-3390: A Threat Group-3390 tool can use WMI to execute a binary.","[S0386] Ursnif: Ursnif droppers have used WMI classes to execute PowerShell commands.","[C0024] SolarWinds Compromise: During the SolarWinds Compromise, APT29 used WMI for the remote execution of files for lateral movement.","[S0154] Cobalt Strike: Cobalt Strike can use WMI to deliver a payload to a remote host.","[S0546] SharpStage: SharpStage can use WMI for execution.","[S0650] QakBot: QakBot can execute WMI queries to gather information.","[S0339] Micropsia: Micropsia searches for anti-virus software and firewall products installed on the victim’s machine using WMI.","[G1044] APT42: APT42 has used Windows Management Instrumentation (WMI) to query anti-virus products.","[G1003] Ember Bear: Ember Bear has used WMI execution with password hashes for command execution and lateral movement.","[S0534] Bazar: Bazar can execute a WMI query to gather information about the installed antivirus engine.","[G0114] Chimera: Chimera has used WMIC to execute remote commands.","[S0457] Netwalker: Netwalker can use WMI to delete Shadow Volumes.","[C0007] FunnyDream: During FunnyDream, the threat actors used `wmiexec.vbs` to run remote commands.","[G1043] BlackByte: BlackByte used WMI to delete Volume Shadow Copies on victim machines.","[G1016] FIN13: FIN13 has utilized `WMI` to execute commands and move laterally on compromised Windows machines.","[S1160] Latrodectus: Latrodectus has used WMI in malicious email infection chains to facilitate the installation of remotely-hosted files.","[S0156] KOMPROGO: KOMPROGO is capable of running WMI queries.","[S0476] Valak: Valak can use wmic process call create in a scheduled task to launch plugins and for execution.","[S0568] EVILNUM: EVILNUM has used the Windows Management Instrumentation (WMI) tool to enumerate infected machines.","[G0059] Magic Hound: Magic Hound has used a tool to run `cmd /c wmic computersystem get domain` for discovery.","[S0663] SysUpdate: SysUpdate can use WMI for execution on a compromised host.","[S0674] CharmPower: CharmPower can use `wmic` to gather information from a system.","[S0265] Kazuar: Kazuar obtains a list of running processes through WMI querying.","[G0096] APT41: APT41 used WMI in several ways, including for execution of commands via WMIEXEC as well as for persistence via PowerSploit. APT41 has executed files through Windows Management Instrumentation (WMI).","[C0018] C0018: During C0018, the threat actors used WMIC to modify administrative settings on both a local and a remote host, likely as part of the first stages for their lateral movement; they also used WMI Provider Host (`wmiprvse.exe`) to execute a variety of encoded PowerShell scripts using the `DownloadString` method.","[S0532] Lucifer: Lucifer can use WMI to log into remote machines for propagation.","[G0061] FIN8: FIN8's malicious spearphishing payloads use WMI to launch malware and spawn `cmd.exe` execution. FIN8 has also used WMIC and the Impacket suite for lateral movement, as well as during and post compromise cleanup activities.","[S0237] GravityRAT: GravityRAT collects various information via WMI requests, including CPU information in the Win32_Processor entry (Processor ID, Name, Manufacturer and the clock speed)."],"tactics":"TA0002 - Execution"}
{"technique_id":"T1053.002","technique_name":"Scheduled Task/Job: At","description":"Adversaries may abuse the at utility to perform task scheduling for initial or recurring execution of malicious code. The at utility exists as an executable within Windows, Linux, and macOS for scheduling tasks at a specified time and date. Although deprecated in favor of Scheduled Task's schtasks in Windows environments, using at requires that the Task Scheduler service be running, and the user to be logged on as a member of the local Administrators group. In addition to explicitly running the `at` command, adversaries may also schedule a task with at by directly leveraging the Windows Management Instrumentation `Win32_ScheduledJob` WMI class. On Linux and macOS, at may be invoked by the superuser as well as any users added to the at.allow file. If the at.allow file does not exist, the at.deny file is checked. Every username not listed in at.deny is allowed to invoke at. If the at.deny exists and is empty, global use of at is permitted. If neither file exists (which is often the baseline) only the superuser is allowed to use at. Adversaries may use at to execute programs at system startup or on a scheduled basis for Persistence. at can also be abused to conduct remote Execution as part of Lateral Movement and/or to run a process under the context of a specified account (such as SYSTEM). In Linux environments, adversaries may also abuse at to break out of restricted environments by using a task to spawn an interactive system shell or to run system commands. Similarly, at may also be used for Privilege Escalation if the binary is allowed to run as superuser via sudo.","detection":"Monitor process execution from the svchost.exe in Windows 10 and the Windows Task Scheduler taskeng.exe for older versions of Windows. If scheduled tasks are not used for persistence, then the adversary is likely to remove the task when the action is complete. Monitor Windows Task Scheduler stores in %systemroot%\\System32\\Tasks for change entries related to scheduled tasks that do not correlate with known software, patch cycles, etc. Configure event logging for scheduled task creation and changes by enabling the \"Microsoft-Windows-TaskScheduler/Operational\" setting within the event logging service. Several events will then be logged on scheduled task activity, including: * Event ID 106 on Windows 7, Server 2008 R2 - Scheduled task registered * Event ID 140 on Windows 7, Server 2008 R2 / 4702 on Windows 10, Server 2016 - Scheduled task updated * Event ID 141 on Windows 7, Server 2008 R2 / 4699 on Windows 10, Server 2016 - Scheduled task deleted * Event ID 4698 on Windows 10, Server 2016 - Scheduled task created * Event ID 4700 on Windows 10, Server 2016 - Scheduled task enabled * Event ID 4701 on Windows 10, Server 2016 - Scheduled task disabled Tools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including listing current scheduled tasks. Remote access tools with built-in features may interact directly with the Windows API to perform these functions outside of typical system utilities. Tasks may also be created through Windows system management tools such as Windows Management Instrumentation and PowerShell, so additional logging may need to be configured to gather the appropriate data. In Linux and macOS environments, monitor scheduled task creation using command-line invocation. Legitimate scheduled tasks may be created during installation of new software or through system administration functions. Look for changes to tasks that do not correlate with known software, patch cycles, etc. Review all jobs using the atq command and ensure IP addresses stored in the SSH_CONNECTION and SSH_CLIENT variables, machines that created the jobs, are trusted hosts. All at jobs are stored in /var/spool/cron/atjobs/. Suspicious program execution through scheduled tasks may show up as outlier processes that have not been seen before when compared against historical data. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as network connections made for Command and Control, learning details about the environment through Discovery, and Lateral Movement.","procedures":["[G0027] Threat Group-3390: Threat Group-3390 actors use at to schedule tasks to run self-extracting RAR archives, which install HTTPBrowser or PlugX on other victims on a network.","[S0488] CrackMapExec: CrackMapExec can set a scheduled task on the target system to execute commands remotely using at.","[G0026] APT18: APT18 actors used the native at Windows task scheduler tool to use scheduled tasks for execution on a victim network.","[G0060] BRONZE BUTLER: BRONZE BUTLER has used at to register a scheduled task to execute malware during lateral movement.","[S0233] MURKYTOP: MURKYTOP has the capability to schedule remote AT jobs.","[S0110] at: at can be used to schedule a task on a system to be executed at a specific date or time."],"tactics":"TA0002 - Execution"}
{"technique_id":"T1053.003","technique_name":"Scheduled Task/Job: Cron","description":"Adversaries may abuse the cron utility to perform task scheduling for initial or recurring execution of malicious code. The cron utility is a time-based job scheduler for Unix-like operating systems. The crontab file contains the schedule of cron entries to be run and the specified times for execution. Any crontab files are stored in operating system-specific file paths. An adversary may use cron in Linux or Unix environments to execute programs at system startup or on a scheduled basis for Persistence. In ESXi environments, cron jobs must be created directly via the crontab file (e.g., `/var/spool/cron/crontabs/root`).","detection":"Monitor scheduled task creation from common utilities using command-line invocation. Legitimate scheduled tasks may be created during installation of new software or through system administration functions. Look for changes to tasks that do not correlate with known software, patch cycles, etc. Suspicious program execution through scheduled tasks may show up as outlier processes that have not been seen before when compared against historical data. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as network connections made for Command and Control, learning details about the environment through Discovery, and Lateral Movement.","procedures":["[S0374] SpeakUp: SpeakUp uses cron tasks to ensure persistence.","[S0504] Anchor: Anchor can install itself as a cron job.","[S0163] Janicab: Janicab used a cron job for persistence on Mac devices.","[S0468] Skidmap: Skidmap has installed itself via crontab.","[G0106] Rocke: Rocke installed a cron job that downloaded and executed files from the C2.","[S0341] Xbash: Xbash can create a cronjob for persistence if it determines it is on a Linux system.","[S0198] NETWIRE: NETWIRE can use crontabs to establish persistence.","[S0588] GoldMax: The GoldMax Linux variant has used a crontab entry with a @reboot line to gain persistence.","[S1198] Gomir: Gomir will configure a crontab for process execution to start the backdoor on reboot if it is not initially running under group 0 privileges.","[S0587] Penquin: Penquin can use Cron to create periodic and pre-scheduled background jobs.","[C0048] Operation MidnightEclipse: During Operation MidnightEclipse, threat actors configured cron jobs to retrieve payloads from actor-controlled infrastructure.","[G1023] APT5: APT5 has made modifications to the crontab file including in `/var/cron/tabs/`.","[S0599] Kinsing: Kinsing has used crontab to download and run shell scripts every minute to ensure persistence.","[G0082] APT38: APT38 has used cron to create pre-scheduled and periodic background jobs on a Linux system.","[S0401] Exaramel for Linux: Exaramel for Linux uses crontab for persistence if it does not have root privileges.","[S1107] NKAbuse: NKAbuse uses a Cron job to establish persistence when infecting Linux hosts."],"tactics":"TA0002 - Execution"}
{"technique_id":"T1053.005","technique_name":"Scheduled Task/Job: Scheduled Task","description":"Adversaries may abuse the Windows Task Scheduler to perform task scheduling for initial or recurring execution of malicious code. There are multiple ways to access the Task Scheduler in Windows. The schtasks utility can be run directly on the command line, or the Task Scheduler can be opened through the GUI within the Administrator Tools section of the Control Panel. In some cases, adversaries have used a .NET wrapper for the Windows Task Scheduler, and alternatively, adversaries have used the Windows netapi32 library and Windows Management Instrumentation (WMI) to create a scheduled task. Adversaries may also utilize the Powershell Cmdlet `Invoke-CimMethod`, which leverages WMI class `PS_ScheduledTask` to create a scheduled task via an XML path. An adversary may use Windows Task Scheduler to execute programs at system startup or on a scheduled basis for persistence. The Windows Task Scheduler can also be abused to conduct remote Execution as part of Lateral Movement and/or to run a process under the context of a specified account (such as SYSTEM). Similar to System Binary Proxy Execution, adversaries have also abused the Windows Task Scheduler to potentially mask one-time execution under signed/trusted system processes. Adversaries may also create \"hidden\" scheduled tasks (i.e. Hide Artifacts) that may not be visible to defender tools and manual queries used to enumerate tasks. Specifically, an adversary may hide a task from `schtasks /query` and the Task Scheduler by deleting the associated Security Descriptor (SD) registry value (where deletion of this value must be completed using SYSTEM permissions). Adversaries may also employ alternate methods to hide tasks, such as altering the metadata (e.g., `Index` value) within associated registry keys.","detection":"Monitor process execution from the svchost.exe in Windows 10 and the Windows Task Scheduler taskeng.exe for older versions of Windows. If scheduled tasks are not used for persistence, then the adversary is likely to remove the task when the action is complete. Monitor Windows Task Scheduler stores in %systemroot%\\System32\\Tasks for change entries related to scheduled tasks that do not correlate with known software, patch cycles, etc. Configure event logging for scheduled task creation and changes by enabling the \"Microsoft-Windows-TaskScheduler/Operational\" setting within the event logging service. Several events will then be logged on scheduled task activity, including: * Event ID 106 on Windows 7, Server 2008 R2 - Scheduled task registered * Event ID 140 on Windows 7, Server 2008 R2 / 4702 on Windows 10, Server 2016 - Scheduled task updated * Event ID 141 on Windows 7, Server 2008 R2 / 4699 on Windows 10, Server 2016 - Scheduled task deleted * Event ID 4698 on Windows 10, Server 2016 - Scheduled task created * Event ID 4700 on Windows 10, Server 2016 - Scheduled task enabled * Event ID 4701 on Windows 10, Server 2016 - Scheduled task disabled Tools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including listing current scheduled tasks. Remote access tools with built-in features may interact directly with the Windows API to perform these functions outside of typical system utilities. Tasks may also be created through Windows system management tools such as Windows Management Instrumentation and PowerShell, so additional logging may need to be configured to gather the appropriate data.","procedures":["[S0588] GoldMax: GoldMax has used scheduled tasks to maintain persistence.","[S0648] JSS Loader: JSS Loader has the ability to launch scheduled tasks to establish persistence.","[S0414] BabyShark: BabyShark has used scheduled tasks to maintain persistence.","[C0024] SolarWinds Compromise: During the SolarWinds Compromise, APT29 used `scheduler` and `schtasks` to create new tasks on remote host as part of their lateral movement. They manipulated scheduled tasks by updating an existing legitimate task to execute their tools and then returned the scheduled task to its original configuration. APT29 also created a scheduled task to maintain SUNSPOT persistence when the host booted.","[S1014] DanBot: DanBot can use a scheduled task for installation.","[S0170] Helminth: Helminth has used a scheduled task for persistence.","[G0022] APT3: An APT3 downloader creates persistence by creating the following scheduled task: schtasks /create /tn \"mysc\" /tr C:\\Users\\Public\\test.exe /sc ONLOGON /ru \"System\".","[S1015] Milan: Milan can establish persistence on a targeted host with scheduled tasks.","[S0697] HermeticWiper: HermeticWiper has the ability to use scheduled tasks for execution.","[S1166] Solar: Solar can create scheduled tasks named Earth and Venus, which run every 30 and 40 seconds respectively, to support C2 and exfiltration.","[S0266] TrickBot: TrickBot creates a scheduled task on the system that provides persistence.","[S0335] Carbon: Carbon creates several tasks for later execution to continue persistence on the victim’s machine.","[S0126] ComRAT: ComRAT has used a scheduled task to launch its PowerShell loader.","[S0044] JHUHUGIT: JHUHUGIT has registered itself as a scheduled task to run each time the current user logs in.","[G0080] Cobalt Group: Cobalt Group has created Windows tasks to establish persistence.","[G0091] Silence: Silence has used scheduled tasks to stage its operation.","[G0114] Chimera: Chimera has used scheduled tasks to invoke Cobalt Strike including through batch script schtasks /create /ru \"SYSTEM\" /tn \"update\" /tr \"cmd /c c:\\windows\\temp\\update.bat\" /sc once /f /st and to maintain persistence.","[S1199] LockBit 2.0: LockBit 2.0 can be executed via scheduled task.","[G0040] Patchwork: A Patchwork file stealer can run a TaskScheduler DLL to add persistence.","[G1034] Daggerfly: Daggerfly has attempted to use scheduled tasks for persistence in victim environments.","[S0248] yty: yty establishes persistence by creating a scheduled task with the command SchTasks /Create /SC DAILY /TN BigData /TR “ + path_file + “/ST 09:30“.","[G0046] FIN7: FIN7 malware has created scheduled tasks to establish persistence.","[S0589] Sibot: Sibot has been executed via a scheduled task.","[S0504] Anchor: Anchor can create a scheduled task for persistence.","[S0632] GrimAgent: GrimAgent has the ability to set persistence using the Task Scheduler.","[G1018] TA2541: TA2541 has used scheduled tasks to establish persistence for installed tools.","[G0093] GALLIUM: GALLIUM established persistence for PoisonIvy by created a scheduled task.","[G0034] Sandworm Team: Sandworm Team leveraged SHARPIVORY, a .NET dropper that writes embedded payload to disk and uses scheduled tasks to persist on victim machines.","[S1064] SVCReady: SVCReady can create a scheduled task named `RecoveryExTask` to gain persistence.","[G1043] BlackByte: BlackByte created scheduled tasks for payload execution.","[S0409] Machete: The different components of Machete are executed by Windows Task Scheduler.","[G1001] HEXANE: HEXANE has used a scheduled task to establish persistence for a keylogger.","[G0129] Mustang Panda: Mustang Panda has created a scheduled task to execute additional malicious software, as well as maintain persistence.","[S0546] SharpStage: SharpStage has a persistence component to write a scheduled task for the payload.","[S0368] NotPetya: NotPetya creates a task to reboot the system one hour after infection.","[G0059] Magic Hound: Magic Hound has used scheduled tasks to establish persistence and execution.","[C0034] 2022 Ukraine Electric Power Attack: During the 2022 Ukraine Electric Power Attack, Sandworm Team leveraged Scheduled Tasks through a Group Policy Object (GPO) to execute CaddyWiper at a predetermined time.","[S1160] Latrodectus: Latrodectus can create scheduled tasks for persistence.","[S1147] Nightdoor: Nightdoor uses scheduled tasks for persistence to load the final malware payload into memory.","[S0350] zwShell: zwShell has used SchTasks for execution.","[S0375] Remexi: Remexi utilizes scheduled tasks as a persistence mechanism.","[S1058] Prestige: Prestige has been executed on a target system through a scheduled task created by Sandworm Team using Impacket.","[C0017] C0017: During C0017, APT41 used the following Windows scheduled tasks for DEADEYE dropper persistence on US state government networks: `\\Microsoft\\Windows\\PLA\\Server Manager Performance Monitor`, `\\Microsoft\\Windows\\Ras\\ManagerMobility`, `\\Microsoft\\Windows\\WDI\\SrvSetupResults`, and `\\Microsoft\\Windows\\WDI\\USOShared`.","[G1016] FIN13: FIN13 has created scheduled tasks in the `C:\\Windows` directory of the compromised network.","[C0001] Frankenstein: During Frankenstein, the threat actors established persistence through a scheduled task using the command: `/Create /F /SC DAILY /ST 09:00 /TN WinUpdate /TR`, named \"WinUpdate\"","[S1081] BADHATCH: BADHATCH can use `schtasks.exe` to gain persistence.","[S0384] Dridex: Dridex can maintain persistence via the creation of scheduled tasks within system directories such as `windows\\system32\\`, `windows\\syswow64,` `winnt\\system32`, and `winnt\\syswow64`.","[G1022] ToddyCat: ToddyCat has used scheduled tasks to execute discovery commands and scripts for collection.","[G0108] Blue Mockingbird: Blue Mockingbird has used Windows Scheduled Tasks to establish persistence on local and remote hosts.","[G0021] Molerats: Molerats has created scheduled tasks to persistently run VBScripts.","[S0439] Okrum: Okrum's installer can attempt to achieve persistence by creating a scheduled task.","[S0458] Ramsay: Ramsay can schedule tasks via the Windows COM API to maintain persistence.","[S0538] Crutch: Crutch has the ability to persist using scheduled tasks.","[S0671] Tomiris: Tomiris has used `SCHTASKS /CREATE /SC DAILY /TN StartDVL /TR \"[path to self]\" /ST 10:00` to establish persistence.","[C0044] Juicy Mix: During Juicy Mix, OilRig used VBS droppers to schedule tasks for persistence.","[S0606] Bad Rabbit: Bad Rabbit’s infpub.dat file creates a scheduled task to launch a malicious executable.","[S0483] IcedID: IcedID has created a scheduled task to establish persistence.","[G0016] APT29: APT29 has used named and hijacked scheduled tasks to establish persistence.","[S1207] XLoader: XLoader can create scheduled tasks for persistence.","[S1089] SharpDisco: SharpDisco can create scheduled tasks to execute reverse shells that read and write data to and from specified SMB shares.","[S0527] CSPY Downloader: CSPY Downloader can use the schtasks utility to bypass UAC.","[S0128] BADNEWS: BADNEWS creates a scheduled task to establish by executing a malicious payload every subsequent minute.","[G0087] APT39: APT39 has created scheduled tasks for persistence.","[G0061] FIN8: FIN8 has used scheduled tasks to maintain RDP backdoors.","[S0024] Dyre: Dyre has the ability to achieve persistence by adding a new task in the task scheduler to run every minute.","[G0102] Wizard Spider: Wizard Spider has used scheduled tasks to establish persistence for TrickBot and other malware.","[S1013] ZxxZ: ZxxZ has used scheduled tasks for persistence and execution.","[C0030] Triton Safety Instrumented System Attack: In the Triton Safety Instrumented System Attack, TEMP.Veles installed scheduled tasks defined in XML files.","[S0532] Lucifer: Lucifer has established persistence by creating the following scheduled task schtasks /create /sc minute /mo 1 /tn QQMusic ^ /tr C:Users\\%USERPROFILE%\\Downloads\\spread.exe /F.","[S1018] Saint Bot: Saint Bot has created a scheduled task named \"Maintenance\" to establish persistence.","[G0126] Higaisa: Higaisa dropped and added officeupdate.exe to scheduled tasks.","[S0237] GravityRAT: GravityRAT creates a scheduled task to ensure it is re-executed everyday.","[S1182] MagicRAT: MagicRAT can persist via scheduled tasks.","[S1140] Spica: Spica has created a scheduled task named `CalendarChecker` to establish persistence.","[S1190] Kapeka: Kapeka persists via scheduled tasks.","[G0096] APT41: APT41 used a compromised account to create a scheduled task on a system.","[S1149] CHIMNEYSWEEP: CHIMNEYSWEEP can use the Windows `SilentCleanup` scheduled task to enable payload execution.","[S0516] SoreFang: SoreFang can gain persistence through use of scheduled tasks.","[G0075] Rancor: Rancor launched a scheduled task to gain persistence using the schtasks /create /sc command.","[S0360] BONDUPDATER: BONDUPDATER persists using a scheduled task that executes every minute.","[S0447] Lokibot: Lokibot embedded the commands schtasks /Run /TN \\Microsoft\\Windows\\DiskCleanup\\SilentCleanup /I inside a batch script.","[G1003] Ember Bear: Ember Bear uses remotely scheduled tasks to facilitate remote command execution on victim machines.","[S0367] Emotet: Emotet has maintained persistence through a scheduled task, e.g. though a .dll file in the Registry.","[S0688] Meteor: Meteor execution begins from a scheduled task named `Microsoft\\Windows\\Power Efficiency Diagnostics\\AnalyzeAll` and it creates a separate scheduled task called `mstask` to run the wiper only once at 23:55:00.","[C0004] CostaRicto: During CostaRicto, the threat actors used scheduled tasks to download backdoor tools.","[C0022] Operation Dream Job: During Operation Dream Job, Lazarus Group created scheduled tasks to set a periodic execution of a remote XSL script.","[S1011] Tarrask: Tarrask is able to create “hidden” scheduled tasks for persistence.","[C0012] Operation CuckooBees: During Operation CuckooBees, the threat actors used scheduled tasks to execute batch scripts for lateral movement with the following command: `SCHTASKS /Create /S /U /p /SC ONCE /TN test /TR /ST /RU SYSTEM.`","[G0095] Machete: Machete has created scheduled tasks to maintain Machete's persistence.","[S1180] BlackByte Ransomware: BlackByte Ransomware creates a schedule task to execute remotely deployed ransomware payloads.","[G1044] APT42: APT42 has used scheduled tasks for persistence.","[S0148] RTM: RTM tries to add a scheduled task to establish persistence.","[S1042] SUGARDUMP: SUGARDUMP has created scheduled tasks called `MicrosoftInternetExplorerCrashRepoeterTaskMachineUA` and `MicrosoftEdgeCrashRepoeterTaskMachineUA`, which were configured to execute `CrashReporter.exe` during user logon.","[G0051] FIN10: FIN10 has established persistence by using S4U tasks as well as the Scheduled Task option in PowerShell Empire.","[G0019] Naikon: Naikon has used schtasks.exe for lateral movement in compromised networks.","[S0140] Shamoon: Shamoon copies an executable payload to the target system by using SMB/Windows Admin Shares and then scheduling an unnamed task to execute the malware.","[S0581] IronNetInjector: IronNetInjector has used a task XML file named mssch.xml to run an IronPython script when a user logs in or when specific system events are created.","[G1039] RedCurl: RedCurl has created scheduled tasks for persistence.","[S0194] PowerSploit: PowerSploit's New-UserPersistenceOption Persistence argument can be used to establish via a Scheduled Task/Job.","[S0331] Agent Tesla: Agent Tesla has achieved persistence via scheduled tasks.","[G1036] Moonstone Sleet: Moonstone Sleet used scheduled tasks for program execution during initial access to victim machines.","[G0050] APT32: APT32 has used scheduled tasks to persist on victim systems.","[S0438] Attor: Attor's installer plugin can schedule a new task that loads the dispatcher on boot/logon.","[G0117] Fox Kitten: Fox Kitten has used Scheduled Tasks for persistence and to load and execute a reverse proxy binary.","[G0064] APT33: APT33 has created a scheduled task to execute a .vbe file multiple times a day.","[S0446] Ryuk: Ryuk can remotely create a scheduled task to execute itself on a system.","[S0396] EvilBunny: EvilBunny has executed commands via scheduled tasks.","[G0049] OilRig: OilRig has created scheduled tasks that run a VBScript to execute a payload on victim machines.","[G0082] APT38: APT38 has used Task Scheduler to run programs at system startup or on a scheduled basis for persistence. Additionally, APT38 has used living-off-the-land scripts to execute a malicious script via a scheduled task.","[S0449] Maze: Maze has created scheduled tasks using name variants such as \"Windows Update Security\", \"Windows Update Security Patches\", and \"Google Chrome Security Update\", to launch Maze at a specific time.","[G0045] menuPass: menuPass has used a script (atexec.py) to execute a command on a target machine via Task Scheduler.","[G0099] APT-C-36: APT-C-36 has used a macro function to set scheduled tasks, disguised as those used by Google.","[S0166] RemoteCMD: RemoteCMD can execute commands remotely by creating a new schedule task on the remote system","[S0584] AppleJeus: AppleJeus has created a scheduled SYSTEM task that runs when a user logs in.","[S0046] CozyCar: One persistence mechanism used by CozyCar is to register itself as a scheduled task.","[G0037] FIN6: FIN6 has used scheduled tasks to establish persistence for various malware it uses, including downloaders known as HARDTACK and SHIPBREAD and FrameworkPOS.","[S0629] RainyDay: RainyDay can use scheduled tasks to achieve persistence.","[G1014] LuminousMoth: LuminousMoth has created scheduled tasks to establish persistence for their tools.","[S1043] ccf32: ccf32 can run on a daily basis using a scheduled task.","[C0014] Operation Wocao: During Operation Wocao, threat actors used scheduled tasks to execute malicious PowerShell code on remote systems.","[S0223] POWERSTATS: POWERSTATS has established persistence through a scheduled task using the command ”C:\\Windows\\system32\\schtasks.exe” /Create /F /SC DAILY /ST 12:00 /TN MicrosoftEdge /TR “c:\\Windows\\system32\\wscript.exe C:\\Windows\\temp\\Windows.vbe”.","[S0476] Valak: Valak has used scheduled tasks to execute additional payloads and to gain persistence on a compromised host.","[G0032] Lazarus Group: Lazarus Group has used schtasks for persistence including through the periodic execution of a remote XSL script or a dropped VBS payload.","[G0060] BRONZE BUTLER: BRONZE BUTLER has used schtasks to register a scheduled task to execute malware during lateral movement.","[S0500] MCMD: MCMD can use scheduled tasks for persistence.","[G1035] Winter Vivern: Winter Vivern executed PowerShell scripts that would subsequently attempt to establish persistence by creating scheduled tasks objects to periodically retrieve and execute remotely-hosted payloads.","[S0038] Duqu: Adversaries can instruct Duqu to spread laterally by copying itself to shares it has enumerated and for which it has obtained legitimate credentials (via keylogging or other means). The remote host is then infected by using the compromised credentials to schedule a task on remote machines that executes the malware.","[G0035] Dragonfly: Dragonfly has used scheduled tasks to automatically log out of created accounts every 8 hours as well as to execute malicious files.","[S0475] BackConfig: BackConfig has the ability to use scheduled tasks to repeatedly execute malicious payloads on a compromised host.","[S0198] NETWIRE: NETWIRE can create a scheduled task to establish persistence.","[S1133] Apostle: Apostle achieves persistence by creating a scheduled task, such as MicrosoftCrashHandlerUAC.","[S0363] Empire: Empire has modules to interact with the Windows task scheduler.","[C0032] C0032: During the C0032 campaign, TEMP.Veles used scheduled task XML triggers.","[G0069] MuddyWater: MuddyWater has used scheduled tasks to establish persistence.","[S0390] SQLRat: SQLRat has created scheduled tasks in %appdata%\\Roaming\\Microsoft\\Templates\\.","[S0264] OopsIE: OopsIE creates a scheduled task to run itself every three minutes.","[S1039] Bumblebee: Bumblebee can achieve persistence by copying its DLL to a subdirectory of %APPDATA% and creating a Visual Basic Script that will load the DLL via a scheduled task.","[S0534] Bazar: Bazar can create a scheduled task for persistence.","[S0167] Matryoshka: Matryoshka can establish persistence by adding a Scheduled Task named \"Microsoft Boost Kernel Optimization\".","[S0417] GRIFFON: GRIFFON has used sctasks for persistence.","[S1135] MultiLayer Wiper: MultiLayer Wiper creates a malicious scheduled task that launches a batch file to remove Windows Event Logs.","[S0382] ServHelper: ServHelper contains modules that will use schtasks to carry out malicious operations.","[S1088] Disco: Disco can create a scheduled task to run every minute for persistence.","[G0047] Gamaredon Group: Gamaredon Group has created scheduled tasks to launch executables after a designated number of minutes have passed.","[S0673] DarkWatchman: DarkWatchman has created a scheduled task for persistence.","[G0094] Kimsuky: Kimsuky has downloaded additional malware with scheduled tasks.","[S0147] Pteranodon: Pteranodon schedules tasks to invoke its components in order to establish persistence.","[S0603] Stuxnet: Stuxnet schedules a network job to execute two minutes after host infection.","[S0260] InvisiMole: InvisiMole has used scheduled tasks named MSST and \\Microsoft\\Windows\\Autochk\\Scheduled to establish persistence.","[S0050] CosmicDuke: CosmicDuke uses scheduled tasks typically named \"Watchmon Service\" for persistence.","[G0038] Stealth Falcon: Stealth Falcon malware creates a scheduled task entitled “IE Web Cache” to execute a malicious file hourly.","[G1002] BITTER: BITTER has used scheduled tasks for persistence and execution.","[S0650] QakBot: QakBot has the ability to create scheduled tasks for persistence.","[S0184] POWRUNER: POWRUNER persists through a scheduled task that executes it every minute.","[S0379] Revenge RAT: Revenge RAT schedules tasks to run malicious scripts at different intervals.","[S0168] Gazer: Gazer can establish persistence by creating a scheduled task.","[G0142] Confucius: Confucius has created scheduled tasks to maintain persistence on a compromised host.","[S0189] ISMInjector: ISMInjector creates scheduled tasks to establish persistence.","[S0111] schtasks: schtasks is used to schedule tasks on a Windows system to run at a specific date and time.","[S0262] QuasarRAT: QuasarRAT contains a .NET wrapper DLL for creating and managing scheduled tasks for maintaining persistence upon reboot.","[S0477] Goopy: Goopy has the ability to maintain persistence by creating scheduled tasks set to run every hour.","[S0680] LitePower: LitePower can create a scheduled task to enable persistence mechanisms.","[S0226] Smoke Loader: Smoke Loader launches a scheduled task.","[S1152] IMAPLoader: IMAPLoader creates scheduled tasks for persistence based on the operating system version of the victim machine.","[G0067] APT37: APT37 has created scheduled tasks to run malicious scripts on a compromised host.","[S0250] Koadic: Koadic has used scheduled tasks to add persistence.","[S0251] Zebrocy: Zebrocy has a command to create a scheduled task for persistence.","[S1087] AsyncRAT: AsyncRAT can create a scheduled task to maintain persistence on system start-up.","[S0431] HotCroissant: HotCroissant has attempted to install a scheduled task named “Java Maintenance64” on startup to establish persistence.","[S0269] QUADAGENT: QUADAGENT creates a scheduled task to maintain persistence on the victim’s machine.","[S1169] Mango: Mango can create a scheduled task to run every 32 seconds to communicate with C2 and execute received commands."],"tactics":"TA0002 - Execution"}
{"technique_id":"T1053.006","technique_name":"Scheduled Task/Job: Systemd Timers","description":"Adversaries may abuse systemd timers to perform task scheduling for initial or recurring execution of malicious code. Systemd timers are unit files with file extension .timer that control services. Timers can be set to run on a calendar event or after a time span relative to a starting point. They can be used as an alternative to Cron in Linux environments. Systemd timers may be activated remotely via the systemctl command line utility, which operates over SSH. Each .timer file must have a corresponding .service file with the same name, e.g., example.timer and example.service. .service files are Systemd Service unit files that are managed by the systemd system and service manager. Privileged timers are written to /etc/systemd/system/ and /usr/lib/systemd/system while user level are written to ~/.config/systemd/user/. An adversary may use systemd timers to execute malicious code at system startup or on a scheduled basis for persistence. Timers installed using privileged paths may be used to maintain root level persistence. Adversaries may also install user level timers to achieve user level persistence.","detection":"Systemd timer unit files may be detected by auditing file creation and modification events within the /etc/systemd/system, /usr/lib/systemd/system/, and ~/.config/systemd/user/ directories, as well as associated symbolic links. Suspicious processes or scripts spawned in this manner will have a parent process of ‘systemd’, a parent process ID of 1, and will usually execute as the ‘root’ user. Suspicious systemd timers can also be identified by comparing results against a trusted system baseline. Malicious systemd timers may be detected by using the systemctl utility to examine system wide timers: systemctl list-timers –all. Analyze the contents of corresponding .service files present on the file system and ensure that they refer to legitimate, expected executables. Audit the execution and command-line arguments of the 'systemd-run' utility as it may be used to create timers.","procedures":null,"tactics":"TA0002 - Execution"}
{"technique_id":"T1053.007","technique_name":"Scheduled Task/Job: Container Orchestration Job","description":"Adversaries may abuse task scheduling functionality provided by container orchestration tools such as Kubernetes to schedule deployment of containers configured to execute malicious code. Container orchestration jobs run these automated tasks at a specific date and time, similar to cron jobs on a Linux system. Deployments of this type can also be configured to maintain a quantity of containers over time, automating the process of maintaining persistence within a cluster. In Kubernetes, a CronJob may be used to schedule a Job that runs one or more containers to perform specific tasks. An adversary therefore may utilize a CronJob to schedule deployment of a Job that executes malicious code in various nodes within a cluster.","detection":"Monitor for the anomalous creation of scheduled jobs in container orchestration environments. Use logging agents on Kubernetes nodes and retrieve logs from sidecar proxies for application and resource pods to monitor malicious container orchestration job deployments.","procedures":null,"tactics":"TA0002 - Execution"}
{"technique_id":"T1059.001","technique_name":"Command and Scripting Interpreter: PowerShell","description":"Adversaries may abuse PowerShell commands and scripts for execution. PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code. Examples include the Start-Process cmdlet which can be used to run an executable and the Invoke-Command cmdlet which runs a command locally or on a remote computer (though administrator permissions are required to use PowerShell to connect to remote systems). PowerShell may also be used to download and run executables from the Internet, which can be executed from disk or in memory without touching disk. A number of PowerShell-based offensive testing tools are available, including Empire, PowerSploit, PoshC2, and PSAttack. PowerShell commands/scripts can also be executed without directly invoking the powershell.exe binary through interfaces to PowerShell's underlying System.Management.Automation assembly DLL exposed through the .NET framework and Windows Common Language Interface (CLI).","detection":"If proper execution policy is set, adversaries will likely be able to define their own execution policy if they obtain administrator or system access, either through the Registry or at the command line. This change in policy on a system may be a way to detect malicious use of PowerShell. If PowerShell is not used in an environment, then simply looking for PowerShell execution may detect malicious activity. Monitor for loading and/or execution of artifacts associated with PowerShell specific assemblies, such as System.Management.Automation.dll (especially to unusual process names/locations). It is also beneficial to turn on PowerShell logging to gain increased fidelity in what occurs during execution (which is applied to .NET invocations). PowerShell 5.0 introduced enhanced logging capabilities, and some of those features have since been added to PowerShell 4.0. Earlier versions of PowerShell do not have many logging features. An organization can gather PowerShell execution details in a data analytic platform to supplement it with other data. Consider monitoring for Windows event ID (EID) 400, which shows the version of PowerShell executing in the EngineVersion field (which may also be relevant to detecting a potential Downgrade Attack) as well as if PowerShell is running locally or remotely in the HostName field. Furthermore, EID 400 may indicate the start time and EID 403 indicates the end time of a PowerShell session.","procedures":["[G0090] WIRTE: WIRTE has used PowerShell for script execution.","[S1212] RansomHub: RansomHub can use PowerShell to delete volume shadow copies.","[G1044] APT42: APT42 has downloaded and executed PowerShell payloads.","[G1023] APT5: APT5 has used PowerShell to accomplish tasks within targeted environments.","[C0047] RedDelta Modified PlugX Infection Chain Operations: Mustang Panda used LNK files to execute PowerShell commands leading to eventual PlugX installation during RedDelta Modified PlugX Infection Chain Operations.","[C0025] 2016 Ukraine Electric Power Attack: During the 2016 Ukraine Electric Power Attack, Sandworm Team used PowerShell scripts to run a credential harvesting tool in memory to evade defenses.","[G0108] Blue Mockingbird: Blue Mockingbird has used PowerShell reverse TCP shells to issue interactive commands over a network connection.","[S1081] BADHATCH: BADHATCH can utilize `powershell.exe` to execute commands on a compromised host.","[S0363] Empire: Empire leverages PowerShell for the majority of its client-side agent tasks. Empire also contains the ability to conduct PowerShell remoting with the Invoke-PSRemoting module.","[S0330] Zeus Panda: Zeus Panda uses PowerShell to download and execute the payload.","[G0087] APT39: APT39 has used PowerShell to execute malicious code.","[G0059] Magic Hound: Magic Hound has used PowerShell for execution and privilege escalation.","[S0650] QakBot: QakBot can use PowerShell to download and execute payloads.","[G0073] APT19: APT19 used PowerShell commands to execute payloads.","[S0622] AppleSeed: AppleSeed has the ability to execute its payload via PowerShell.","[G0007] APT28: APT28 downloads and executes PowerShell scripts and performs PowerShell commands.","[S1141] LunarWeb: LunarWeb has the ability to run shell commands via PowerShell.","[G0096] APT41: APT41 leveraged PowerShell to deploy malware families in victims’ environments.","[S1202] LockBit 3.0: LockBit 3.0 can use PowerShell to apply Group Policy changes.","[S1140] Spica: Spica can use an obfuscated PowerShell command to create a scheduled task for persistence.","[G0034] Sandworm Team: Sandworm Team has used PowerShell scripts to run a credential harvesting tool in memory to evade defenses.","[S1155] Covenant: Covenant can create PowerShell-based launchers for Grunt installation.","[C0051] APT28 Nearest Neighbor Campaign: During APT28 Nearest Neighbor Campaign, APT28 used PowerShell cmdlet Get-ChildItem to access credentials, among other PowerShell functions deployed.","[S0496] REvil: REvil has used PowerShell to delete volume shadow copies and download files.","[G1019] MoustachedBouncer: MoustachedBouncer has used plugins to execute PowerShell scripts.","[S0534] Bazar: Bazar can execute a PowerShell script received from C2.","[C0034] 2022 Ukraine Electric Power Attack: During the 2022 Ukraine Electric Power Attack, Sandworm Team utilized a PowerShell utility called TANKTRAP to spread and launch a wiper using Windows Group Policy.","[G0052] CopyKittens: CopyKittens has used PowerShell Empire.","[S1201] TRANSLATEXT: TRANSLATEXT has used PowerShell to collect system information and to upload the collected data to a Github repository.","[S1065] Woody RAT: Woody RAT can execute PowerShell commands and scripts with the use of .NET DLL, `WoodyPowerSession`.","[S0192] Pupy: Pupy has a module for loading and executing PowerShell scripts.","[S0514] WellMess: WellMess can execute PowerShell scripts received from C2.","[G0076] Thrip: Thrip leveraged PowerShell to run commands to download payloads, traverse the compromised networks, and carry out reconnaissance.","[S0689] WhisperGate: WhisperGate can use PowerShell to support multiple actions including execution and defense evasion.","[S0393] PowerStallion: PowerStallion uses PowerShell loops to iteratively check for available commands in its OneDrive C2 server.","[S0389] JCry: JCry has used PowerShell to execute payloads.","[S0266] TrickBot: TrickBot has been known to use PowerShell to download new payloads, open documents, and upload data to command and control servers.","[G1046] Storm-1811: Storm-1811 has used PowerShell for multiple purposes, such as using PowerShell scripts executing in an infinite loop to create an SSH connection to a command and control server.","[G1016] FIN13: FIN13 has used PowerShell commands to obtain DNS data from a compromised network.","[G0078] Gorgon Group: Gorgon Group malware can use PowerShell commands to download and execute a payload and open a decoy document on the victim’s machine.","[S0553] MoleNet: MoleNet can use PowerShell to set persistence.","[G1040] Play: Play has used Base64-encoded PowerShell scripts to disable Microsoft Defender.","[S1129] Akira: Akira will execute PowerShell commands to delete system volume shadow copies.","[C0022] Operation Dream Job: During Operation Dream Job, Lazarus Group used PowerShell commands to explore the environment of compromised victims.","[S0673] DarkWatchman: DarkWatchman can execute PowerShell commands and has used PowerShell to execute a keylogger.","[S1117] GLASSTOKEN: GLASSTOKEN can use PowerShell for command execution.","[S0441] PowerShower: PowerShower is a backdoor written in PowerShell.","[G0046] FIN7: FIN7 used a PowerShell script to launch shellcode that retrieved an additional payload.","[S0680] LitePower: LitePower can use a PowerShell script to execute commands.","[G1039] RedCurl: RedCurl has used PowerShell to execute commands and to download malware.","[S1060] Mafalda: Mafalda can execute PowerShell commands on a compromised machine.","[S1196] Troll Stealer: Troll Stealer creates and executes a PowerShell script to delete itself.","[C0001] Frankenstein: During Frankenstein, the threat actors used PowerShell to run a series of Base64-encoded commands that acted as a stager and enumerated hosts.","[G0139] TeamTNT: TeamTNT has executed PowerShell commands in batch scripts.","[G0049] OilRig: OilRig has used PowerShell scripts for execution, including use of a macro to run a PowerShell command to decode file contents.","[S0198] NETWIRE: The NETWIRE binary has been executed via PowerShell script.","[S1178] ShrinkLocker: ShrinkLocker uses PowerShell to disable protectors used to secure the BitLocker encryption key on victim machines and then delete the key from the system.","[S0685] PowerPunch: PowerPunch has the ability to execute through PowerShell.","[S1138] Gootloader: Gootloader can use an encoded PowerShell stager to write to the Registry for persistence.","[S0371] POWERTON: POWERTON is written in PowerShell.","[S1183] StrelaStealer: StrelaStealer variants have used PowerShell scripts to download or drop payloads, including obfuscated variants to connect to a WebDAV server to download and executed an encrypted DLL for installation.","[S0256] Mosquito: Mosquito can launch PowerShell Scripts.","[S0499] Hancitor: Hancitor has used PowerShell to execute commands.","[G0100] Inception: Inception has used PowerShell to execute malicious commands and payloads.","[S0625] Cuba: Cuba has been dropped onto systems and used for lateral movement via obfuscated PowerShell scripts.","[S0170] Helminth: One version of Helminth uses a PowerShell script.","[S0613] PS1: PS1 can utilize a PowerShell loader.","[S0583] Pysa: Pysa has used Powershell scripts to deploy its ransomware.","[G0032] Lazarus Group: Lazarus Group has used PowerShell to execute commands and malicious code.","[S0546] SharpStage: SharpStage can execute arbitrary commands with PowerShell.","[G0050] APT32: APT32 has used PowerShell-based tools, PowerShell one-liners, and shellcode loaders for execution.","[G0114] Chimera: Chimera has used PowerShell scripts to execute malicious payloads and the DSInternals PowerShell module to make use of Active Directory features.","[S0250] Koadic: Koadic has used PowerShell to establish persistence.","[G1017] Volt Typhoon: Volt Typhoon has used PowerShell including for remote system discovery.","[S0385] njRAT: njRAT has executed PowerShell commands via auto-run registry key persistence.","[S0633] Sliver: Sliver has built-in functionality to launch a Powershell command prompt.","[S0381] FlawedAmmyy: FlawedAmmyy has used PowerShell to execute commands.","[G1031] Saint Bear: Saint Bear relies extensively on PowerShell execution from malicious attachments and related content to retrieve and execute follow-on payloads.","[S1149] CHIMNEYSWEEP: CHIMNEYSWEEP can invoke the PowerShell command `[Reflection.Assembly]::LoadFile(\\\"%s\\\")\\n$i=\\\"\\\"\\n$r=[%s]::%s(\\\"%s\\\",[ref] $i)\\necho $r,$i\\n` to execute secondary payloads.","[G1006] Earth Lusca: Earth Lusca has used PowerShell to execute commands.","[G0027] Threat Group-3390: Threat Group-3390 has used PowerShell for execution.","[G1018] TA2541: TA2541 has used PowerShell to download files and to inject into various Windows processes.","[G0009] Deep Panda: Deep Panda has used PowerShell scripts to download and execute programs in memory, without writing to disk.","[G0119] Indrik Spider: Indrik Spider has used PowerShell Empire for execution of malware.","[G0080] Cobalt Group: Cobalt Group has used powershell.exe to download and execute scripts.","[G0065] Leviathan: Leviathan has used PowerShell for execution.","[S1111] DarkGate: DarkGate has used PowerShell to create a remote shell.","[S0154] Cobalt Strike: Cobalt Strike can execute a payload on a remote host with PowerShell. This technique does not write any data to disk. Cobalt Strike can also use PowerSploit and other scripting frameworks to perform execution.","[G0102] Wizard Spider: Wizard Spider has used macros to execute PowerShell scripts to download malware on victim's machines. It has also used PowerShell to execute commands and move laterally through a victim network.","[S0356] KONNI: KONNI used PowerShell to download and execute a specific 64-bit version of the malware.","[S0273] Socksbot: Socksbot can write and execute PowerShell scripts.","[C0018] C0018: During C0018, the threat actors used encoded PowerShell scripts for execution.","[S1132] IPsec Helper: IPsec Helper can run arbitrary PowerShell commands passed to it.","[C0044] Juicy Mix: During Juicy Mix, OilRig used a PowerShell script to steal credentials.","[S0367] Emotet: Emotet has used Powershell to retrieve the malicious payload and download additional resources like Mimikatz.","[G1024] Akira: Akira has used PowerShell scripts for credential harvesting and privilege escalation.","[G0016] APT29: APT29 has used encoded PowerShell scripts uploaded to CozyCar installations to download and install SeaDuke.","[S1018] Saint Bot: Saint Bot has used PowerShell for execution.","[S0670] WarzoneRAT: WarzoneRAT can use PowerShell to download files and execute commands.","[S0511] RegDuke: RegDuke can extract and execute PowerShell scripts from C2 communications.","[G0093] GALLIUM: GALLIUM used PowerShell for execution to assist in lateral movement as well as for dumping credentials stored on compromised machines.","[S0674] CharmPower: CharmPower can use PowerShell for payload execution and C2 communication.","[S0688] Meteor: Meteor can use PowerShell commands to disable the network adapters on a victim machines.","[S0692] SILENTTRINITY: SILENTTRINITY can use PowerShell to execute commands.","[S0145] POWERSOURCE: POWERSOURCE is a PowerShell backdoor.","[S0382] ServHelper: ServHelper has the ability to execute a PowerShell script to get information from the infected host.","[S0341] Xbash: Xbash can use scripts to invoke PowerShell to download a malicious PE executable or PE DLL for execution.","[S0386] Ursnif: Ursnif droppers have used PowerShell in download cradles to download and execute the malware's full executable payload.","[G1003] Ember Bear: Ember Bear has used PowerShell commands to gather information from compromised systems, such as email servers.","[S0150] POSHSPY: POSHSPY uses PowerShell to execute various commands, one to execute its payload.","[G1034] Daggerfly: Daggerfly used PowerShell to download and execute remote-hosted files on victim systems.","[S0196] PUNCHBUGGY: PUNCHBUGGY has used PowerShell scripts.","[S0450] SHARPSTATS: SHARPSTATS has the ability to employ a custom PowerShell script.","[S0591] ConnectWise: ConnectWise can be used to execute PowerShell commands on target machines.","[S0223] POWERSTATS: POWERSTATS uses PowerShell for obfuscation and execution.","[S1070] Black Basta: Black Basta has used PowerShell scripts for discovery and to execute files over the network.","[S0491] StrongPity: StrongPity can use PowerShell to add files to the Windows Defender exclusions list.","[C0024] SolarWinds Compromise: During the SolarWinds Compromise, APT29 used PowerShell to create new tasks on remote machines, identify configuration settings, exfiltrate data, and execute other commands.","[G0037] FIN6: FIN6 has used PowerShell to gain access to merchant's networks, and a Metasploit PowerShell module to download and execute shellcode and to set up a local listener.","[S0457] Netwalker: Netwalker has been written in PowerShell and executed directly in memory, avoiding detection.","[S0681] Lizar: Lizar has used PowerShell scripts.","[G1001] HEXANE: HEXANE has used PowerShell-based tools and scripts for discovery and collection on compromised hosts.","[G0140] LazyScripter: LazyScripter has used PowerShell scripts to execute malicious code.","[S1151] ZeroCleare: ZeroCleare can use a malicious PowerShell script to bypass Windows controls.","[G1043] BlackByte: BlackByte used encoded PowerShell commands during operations. BlackByte has used remote PowerShell commands in victim networks.","[S0679] Ferocious: Ferocious can use PowerShell scripts for execution.","[G0125] HAFNIUM: HAFNIUM has used the Exchange Power Shell module Set-OabVirtualDirectoryPowerShell to export mailbox data.","[S0037] HAMMERTOSS: HAMMERTOSS is known to use PowerShell.","[G0121] Sidewinder: Sidewinder has used PowerShell to drop and execute malware loaders.","[G0051] FIN10: FIN10 uses PowerShell for execution as well as PowerShell Empire to establish persistence.","[S0521] BloodHound: BloodHound can use PowerShell to pull Active Directory information from the target environment.","[S1046] PowGoop: PowGoop has the ability to use PowerShell scripts to execute commands.","[S0517] Pillowmint: Pillowmint has used a PowerShell script to install a shim database.","[S1058] Prestige: Prestige can use PowerShell for payload execution on targeted systems.","[S1213] Lumma Stealer: Lumma Stealer has used PowerShell for initial user execution and other fuctions.","[G0084] Gallmaker: Gallmaker used PowerShell to download additional payloads and for execution.","[S0354] Denis: Denis has a version written in PowerShell.","[G0010] Turla: Turla has used PowerShell to execute commands/scripts, in some cases via a custom executable or code from Empire's PSInject. Turla has also used PowerShell scripts to load and execute malware in memory.","[S1023] CreepyDrive: CreepyDrive can use Powershell for execution, including the cmdlets `Invoke-WebRequest` and `Invoke-Expression`.","[G0091] Silence: Silence has used PowerShell to download and execute payloads.","[S0379] Revenge RAT: Revenge RAT uses the PowerShell command Reflection.Assembly to load itself into memory to aid in execution.","[S1032] PyDCrypt: PyDCrypt has attempted to execute with PowerShell.","[G0021] Molerats: Molerats used PowerShell implants on target machines.","[S0234] Bandook: Bandook has used PowerShell loaders as part of execution.","[G1022] ToddyCat: ToddyCat has used Powershell scripts to perform post exploit collection.","[C0030] Triton Safety Instrumented System Attack: In the Triton Safety Instrumented System Attack, TEMP.Veles used a publicly available PowerShell-based tool, WMImplant.","[S0184] POWRUNER: POWRUNER is written in PowerShell.","[C0032] C0032: During the C0032 campaign, TEMP.Veles used PowerShell to perform timestomping.","[S0387] KeyBoy: KeyBoy uses PowerShell commands to download and execute payloads.","[G0022] APT3: APT3 has used PowerShell on victim systems to download and run payloads after exploitation.","[S1024] CreepySnail: CreepySnail can use PowerShell for execution, including the cmdlets `Invoke-WebRequst` and `Invoke-Expression`.","[S0126] ComRAT: ComRAT has used PowerShell to load itself every time a user logs in to the system. ComRAT can execute PowerShell scripts loaded into memory or from the file system.","[S0695] Donut: Donut can generate shellcode outputs that execute via PowerShell.","[S0151] HALFBAKED: HALFBAKED can execute PowerShell scripts.","[G0105] DarkVishnya: DarkVishnya used PowerShell to create shellcode loaders.","[S1012] PowerLess: PowerLess is written in and executed via PowerShell without using powershell.exe.","[G0062] TA459: TA459 has used PowerShell for execution of a payload.","[G0047] Gamaredon Group: Gamaredon Group has used obfuscated PowerShell scripts for staging.","[G0094] Kimsuky: Kimsuky has executed a variety of PowerShell scripts including Invoke-Mimikatz.","[C0014] Operation Wocao: During Operation Wocao, threat actors used PowerShell on compromised systems.","[S0669] KOCTOPUS: KOCTOPUS has used PowerShell commands to download additional files.","[C0021] C0021: During C0021, the threat actors used obfuscated PowerShell to extract an encoded payload from within an .LNK file.","[G0092] TA505: TA505 has used PowerShell to download and execute malware and reconnaissance scripts.","[S0447] Lokibot: Lokibot has used PowerShell commands embedded inside batch scripts.","[S0512] FatDuke: FatDuke has the ability to execute PowerShell scripts.","[G0061] FIN8: FIN8's malicious spearphishing payloads are executed as PowerShell. FIN8 has also used PowerShell for lateral movement and credential access.","[G0064] APT33: APT33 has utilized PowerShell to download files from the C2 server and run various scripts.","[S0526] KGH_SPY: KGH_SPY can execute PowerShell commands on the victim's machine.","[G0060] BRONZE BUTLER: BRONZE BUTLER has used PowerShell for execution.","[G0129] Mustang Panda: Mustang Panda has used malicious PowerShell scripts to enable execution.","[S0269] QUADAGENT: QUADAGENT uses PowerShell scripts for execution.","[S0649] SMOKEDHAM: SMOKEDHAM can execute Powershell commands sent from its C2 server.","[S1039] Bumblebee: Bumblebee can use PowerShell for execution.","[C0038] HomeLand Justice: During HomeLand Justice, threat actors used PowerShell cmdlets New-MailboxSearch and Get-Recipient for discovery.","[G0040] Patchwork: Patchwork used PowerSploit to download payloads, run a reverse shell, and execute malware on the victim's machine.","[G0131] Tonto Team: Tonto Team has used PowerShell to download additional payloads.","[S0488] CrackMapExec: CrackMapExec can execute PowerShell commands via WMI.","[G0082] APT38: APT38 has used PowerShell to execute commands and other operational tasks.","[G0079] DarkHydrus: DarkHydrus leveraged PowerShell to download and execute additional scripts for execution.","[C0036] Pikabot Distribution February 2024: Pikabot Distribution February 2024 passed execution from obfuscated JavaScript files to PowerShell scripts to download and install Pikabot.","[G1012] CURIUM: CURIUM has leveraged PowerShell scripts for initial process execution and data gathering in victim environments.","[G0115] GOLD SOUTHFIELD: GOLD SOUTHFIELD has staged and executed PowerShell scripts on compromised hosts.","[S0660] Clambling: The Clambling dropper can use PowerShell to download the malware.","[G0045] menuPass: menuPass uses PowerSploit to inject shellcode into PowerShell.","[S0476] Valak: Valak has used PowerShell to download additional modules.","[G0033] Poseidon Group: The Poseidon Group's Information Gathering Tool (IGT) includes PowerShell components.","[G0038] Stealth Falcon: Stealth Falcon malware uses PowerShell commands to perform various functions, including gathering system information via WMI and executing commands from its C2 server.","[S1199] LockBit 2.0: LockBit 2.0 can use the PowerShell module `InvokeGPUpdate` to modify Group Policy.","[S1030] Squirrelwaffle: Squirrelwaffle has used PowerShell to execute its payload.","[S0186] DownPaper: DownPaper uses PowerShell for execution.","[S0129] AutoIt backdoor: AutoIt backdoor downloads a PowerShell script that decodes to a typical shellcode loader.","[S0270] RogueRobin: RogueRobin uses a command prompt to run a PowerShell script from Excel. To assist in establishing persistence, RogueRobin creates %APPDATA%\\OneDrive.bat and saves the following string to it:powershell.exe -WindowStyle Hidden -exec bypass -File “%APPDATA%\\OneDrive.ps1”.","[S1193] TAMECAT: TAMECAT has used PowerShell to download and run additional content.","[S0053] SeaDuke: SeaDuke uses a module to execute Mimikatz with PowerShell to perform Pass the Ticket.","[S0194] PowerSploit: PowerSploit modules are written in and executed via PowerShell.","[G0069] MuddyWater: MuddyWater has used PowerShell for execution.","[G0117] Fox Kitten: Fox Kitten has used PowerShell scripts to access credential data.","[G1021] Cinnamon Tempest: Cinnamon Tempest has used PowerShell to communicate with C2, download files, and execute reconnaissance commands.","[S0241] RATANKBA: There is a variant of RATANKBA that uses a PowerShell script instead of the traditional PE form.","[S0554] Egregor: Egregor has used an encoded PowerShell command by a service created by Cobalt Strike for lateral movement.","[S0352] OSX_OCEANLOTUS.D: OSX_OCEANLOTUS.D uses PowerShell scripts.","[S0677] AADInternals: AADInternals is written and executed via PowerShell.","[S1085] Sardonic: Sardonic has the ability to execute PowerShell commands on a compromised machine.","[G0035] Dragonfly: Dragonfly has used PowerShell scripts for execution.","[G1035] Winter Vivern: Winter Vivern passed execution from document macros to PowerShell scripts during initial access operations. Winter Vivern used batch scripts that called PowerShell commands as part of initial access and installation operations.","[S0417] GRIFFON: GRIFFON has used PowerShell to execute the Meterpreter downloader TinyMet.","[S1173] PowerExchange: PowerExchange can use PowerShell to execute commands received from C2.","[G0143] Aquatic Panda: Aquatic Panda has downloaded additional scripts and executed Base64 encoded commands in PowerShell.","[S1086] Snip3: Snip3 can use a PowerShell script for second-stage execution.","[S0360] BONDUPDATER: BONDUPDATER is written in PowerShell.","[S0390] SQLRat: SQLRat has used PowerShell to create a Meterpreter session.","[G0142] Confucius: Confucius has used PowerShell to execute malicious files and payloads.","[G0133] Nomadic Octopus: Nomadic Octopus has used PowerShell for execution.","[S0648] JSS Loader: JSS Loader has the ability to download and execute PowerShell scripts."],"tactics":"TA0002 - Execution"}
{"technique_id":"T1059.002","technique_name":"Command and Scripting Interpreter: AppleScript","description":"Adversaries may abuse AppleScript for execution. AppleScript is a macOS scripting language designed to control applications and parts of the OS via inter-application messages called AppleEvents. These AppleEvent messages can be sent independently or easily scripted with AppleScript. These events can locate open windows, send keystrokes, and interact with almost any open application locally or remotely. Scripts can be run from the command-line via osascript /path/to/script or osascript -e \"script here\". Aside from the command line, scripts can be executed in numerous ways including Mail rules, Calendar.app alarms, and Automator workflows. AppleScripts can also be executed as plain text shell scripts by adding #!/usr/bin/osascript to the start of the script file. AppleScripts do not need to call osascript to execute. However, they may be executed from within mach-O binaries by using the macOS Native APIs NSAppleScript or OSAScript, both of which execute code independent of the /usr/bin/osascript command line utility. Adversaries may abuse AppleScript to execute various behaviors, such as interacting with an open SSH connection, moving to remote machines, and even presenting users with fake dialog boxes. These events cannot start applications remotely (they can start them locally), but they can interact with applications if they're already running remotely. On macOS 10.10 Yosemite and higher, AppleScript has the ability to execute Native APIs, which otherwise would require compilation and execution in a mach-O binary file format. Since this is a scripting language, it can be used to launch more common techniques as well such as a reverse shell via Python.","detection":"Monitor for execution of AppleScript through osascript and usage of the NSAppleScript and OSAScript APIs that may be related to other suspicious behavior occurring on the system. Scripts are likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for script execution and subsequent behavior. Actions may be related to network and system information Discovery, Collection, or other scriptable post-compromise behaviors and could be used as indicators of detection leading back to the source script. Understanding standard usage patterns is important to avoid a high number of false positives. If scripting is restricted for normal users, then any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.","procedures":["[S0281] Dok: Dok uses AppleScript to create a login item for persistence.","[S0595] ThiefQuest: ThiefQuest uses AppleScript's osascript -e command to launch ThiefQuest's persistence via Launch Agent and Launch Daemon.","[S0482] Bundlore: Bundlore can use AppleScript to inject malicious JavaScript into a browser.","[S1153] Cuckoo Stealer: Cuckoo Stealer can use osascript to generate a password-stealing prompt, duplicate files and folders, and set environmental variables.","[S1048] macOS.OSAMiner: macOS.OSAMiner has used `osascript` to call itself via the `do shell script` command in the Launch Agent `.plist` file."],"tactics":"TA0002 - Execution"}
{"technique_id":"T1059.003","technique_name":"Command and Scripting Interpreter: Windows Command Shell","description":"Adversaries may abuse the Windows command shell for execution. The Windows command shell (cmd) is the primary command prompt on Windows systems. The Windows command prompt can be used to control almost any aspect of a system, with various permission levels required for different subsets of commands. The command prompt can be invoked remotely via Remote Services such as SSH. Batch files (ex: .bat or .cmd) also provide the shell with a list of sequential commands to run, as well as normal scripting operations such as conditionals and loops. Common uses of batch files include long or repetitive tasks, or the need to run the same set of commands on multiple systems. Adversaries may leverage cmd to execute various commands and payloads. Common uses include cmd to execute a single command, or abusing cmd interactively with input and output forwarded over a command and control channel.","detection":"Usage of the Windows command shell may be common on administrator, developer, or power user systems depending on job function. If scripting is restricted for normal users, then any attempt to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. Scripts are likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for script execution and subsequent behavior. Actions may be related to network and system information Discovery, Collection, or other scriptable post-compromise behaviors and could be used as indicators of detection leading back to the source script.","procedures":["[S0053] SeaDuke: SeaDuke is capable of executing commands.","[G0032] Lazarus Group: Lazarus Group malware uses cmd.exe to execute commands on a compromised host. A Destover-like variant used by Lazarus Group uses a batch file mechanism to delete its binaries from the system.","[S0259] InnaputRAT: InnaputRAT launches a shell to execute commands on the victim’s machine.","[S0187] Daserf: Daserf can execute shell commands.","[S0046] CozyCar: A module in CozyCar allows arbitrary commands to be executed by invoking C:\\Windows\\System32\\cmd.exe.","[S1017] OutSteel: OutSteel has used `cmd.exe` to scan a compromised host for specific file extensions.","[S0229] Orz: Orz can execute shell commands. Orz can execute commands with JavaScript.","[S0475] BackConfig: BackConfig can download and run batch files to execute commands on a compromised host.","[S0381] FlawedAmmyy: FlawedAmmyy has used `cmd` to execute commands on a compromised host.","[S1141] LunarWeb: LunarWeb can run shell commands using a BAT file with a name matching `%TEMP%\\.batfile` or through cmd.exe with the `/c` and `/U` option for Unicode output.","[S0681] Lizar: Lizar has a command to open the command-line on the infected system.","[S0651] BoxCaon: BoxCaon can execute arbitrary commands and utilize the \"ComSpec\" environment variable.","[S0124] Pisloader: Pisloader uses cmd.exe to set the Registry Run key value. It also has a command to spawn a command shell.","[S0346] OceanSalt: OceanSalt can create a reverse shell on the infected endpoint using cmd.exe. OceanSalt has been executed via malicious macros.","[S0639] Seth-Locker: Seth-Locker can execute commands via the command line shell.","[S0504] Anchor: Anchor has used cmd.exe to run its self deletion routine.","[C0014] Operation Wocao: During Operation Wocao, threat actors spawned a new `cmd.exe` process to execute commands.","[S0025] CALENDAR: CALENDAR has a command to run cmd.exe to execute commands.","[S0650] QakBot: QakBot can use cmd.exe to launch itself and to execute multiple C2 commands.","[S0698] HermeticWizard: HermeticWizard can use `cmd.exe` for execution on compromised hosts.","[S0336] NanoCore: NanoCore can open a remote command-line interface and execute commands. NanoCore uses JavaScript files.","[G0039] Suckfly: Several tools used by Suckfly have been command-line driven.","[G0093] GALLIUM: GALLIUM used the Windows command shell to execute commands.","[S0147] Pteranodon: Pteranodon can use `cmd.exe` for execution on victim systems.","[S0520] BLINDINGCAN: BLINDINGCAN has executed commands via cmd.exe.","[S0345] Seasalt: Seasalt uses cmd.exe to create a reverse shell on the infected endpoint.","[G0059] Magic Hound: Magic Hound has used the command-line interface for code execution.","[S0428] PoetRAT: PoetRAT has called cmd through a Word document macro.","[S1191] Megazord: Megazord can execute multiple commands post infection via `cmd.exe`.","[S0436] TSCookie: TSCookie has the ability to execute shell commands on the infected host.","[S0020] China Chopper: China Chopper's server component is capable of opening a command terminal.","[G0128] ZIRCONIUM: ZIRCONIUM has used a tool to open a Windows Command Shell on a remote host.","[S1160] Latrodectus: The Latrodectus command handler can use `cmdexe` to run multiple discovery commands.","[G0070] Dark Caracal: Dark Caracal has used macros in Word documents that would download a second stage if executed.","[S0390] SQLRat: SQLRat has used SQL to execute JavaScript and VB scripts on the host system.","[S1065] Woody RAT: Woody RAT can execute commands using `cmd.exe`.","[S1034] StrifeWater: StrifeWater can execute shell commands using `cmd.exe`.","[G0102] Wizard Spider: Wizard Spider has used `cmd.exe` to execute commands on a victim's machine.","[S0148] RTM: RTM uses the command line and rundll32.exe to execute.","[S0496] REvil: REvil can use the Windows command line to delete volume shadow copies and disable recovery.","[S0201] JPIN: JPIN can use the command-line utility cacls.exe to change file permissions.","[S0382] ServHelper: ServHelper can execute shell commands against cmd.","[S1193] TAMECAT: TAMECAT has used `cmd.exe` to run the `curl` command.","[S0439] Okrum: Okrum's backdoor has used cmd.exe to execute arbitrary commands as well as batch scripts to update itself to a newer version.","[S1039] Bumblebee: Bumblebee can use `cmd.exe` to drop and run files.","[S1035] Small Sieve: Small Sieve can use `cmd.exe` to execute commands on a victim's system.","[S0348] Cardinal RAT: Cardinal RAT can execute commands.","[S0564] BlackMould: BlackMould can run cmd.exe with parameters.","[S0011] Taidoor: Taidoor can copy cmd.exe into the system temp folder.","[S0435] PLEAD: PLEAD has the ability to execute shell commands on the compromised host.","[S0547] DropBook: DropBook can execute arbitrary shell commands on the victims' machines.","[S1145] Pikabot: Pikabot can execute Windows shell commands via cmd.exe.","[C0051] APT28 Nearest Neighbor Campaign: During APT28 Nearest Neighbor Campaign, APT28 used cmd.exe for execution.","[S0632] GrimAgent: GrimAgent can use the Windows Command Shell to execute commands, including its own removal.","[G1017] Volt Typhoon: Volt Typhoon has used the Windows command line to perform hands-on-keyboard activities in targeted environments including for discovery.","[S0244] Comnie: Comnie executes BAT scripts.","[G0049] OilRig: OilRig has used macros to deliver malware such as QUADAGENT and OopsIE. OilRig has used batch scripts.","[G0027] Threat Group-3390: Threat Group-3390 has used command-line interfaces for execution.","[S0534] Bazar: Bazar can launch cmd.exe to perform reconnaissance commands.","[S1063] Brute Ratel C4: Brute Ratel C4 can use cmd.exe for execution.","[S0271] KEYMARBLE: KEYMARBLE can execute shell commands using cmd.exe.","[G0028] Threat Group-1314: Threat Group-1314 actors spawned shells on remote systems on a victim network to execute commands.","[S1199] LockBit 2.0: LockBit 2.0 can use the Windows command shell for multiple post-compromise actions on objective.","[S0283] jRAT: jRAT has command line access.","[S0082] Emissary: Emissary has the capability to create a remote shell and execute specified commands.","[S1212] RansomHub: RansomHub can use `cmd.exe` to execute multiple commands on infected hosts.","[S0258] RGDoor: RGDoor uses cmd.exe to execute commands on the victim’s machine.","[C0037] Water Curupira Pikabot Distribution: Water Curupira Pikabot Distribution installation via JavaScript will launch follow-on commands via cmd.exe.","[S0594] Out1: Out1 can use native command line for execution.","[G1031] Saint Bear: Saint Bear initial loaders will also drop a malicious Windows batch file, available via open source GitHub repositories, that disables Microsoft Defender functionality.","[S0221] Umbreon: Umbreon provides access using both standard facilities like SSH and additional access using its backdoor Espeon, providing a reverse shell upon receipt of a special packet","[S1043] ccf32: ccf32 has used `cmd.exe` for archiving data and deleting files.","[S0275] UPPERCUT: UPPERCUT uses cmd.exe to execute commands on the victim’s machine.","[S0088] Kasidet: Kasidet can execute commands using cmd.exe.","[S0360] BONDUPDATER: BONDUPDATER can read batch commands in a file sent from its C2 server and execute them with cmd.exe.","[S0546] SharpStage: SharpStage can execute arbitrary commands with the command line.","[S0462] CARROTBAT: CARROTBAT has the ability to execute command line arguments on a compromised host.","[S1060] Mafalda: Mafalda can execute shell commands using `cmd.exe`.","[G1040] Play: Play has used a batch script to remove indicators of its presence on compromised hosts.","[S0117] XTunnel: XTunnel has been used to execute remote commands.","[S0582] LookBack: LookBack executes the cmd.exe command.","[S0234] Bandook: Bandook is capable of spawning a Windows command shell.","[S0241] RATANKBA: RATANKBA uses cmd.exe to execute commands.","[S0370] SamSam: SamSam uses custom batch scripts to execute some of its components.","[S1019] Shark: Shark has the ability to use `CMD` to execute commands.","[S0495] RDAT: RDAT has executed commands using cmd.exe /c.","[S1170] ODAgent: ODAgent can execute a specified command line passed via API.","[S0284] More_eggs: More_eggs has used cmd.exe for execution.","[G0133] Nomadic Octopus: Nomadic Octopus used cmd.exe /c within a malicious macro.","[G0139] TeamTNT: TeamTNT has used batch scripts to download tools and executing cryptocurrency miners.","[S1032] PyDCrypt: PyDCrypt has used `cmd.exe` for execution.","[S0070] HTTPBrowser: HTTPBrowser is capable of spawning a reverse shell on a victim.","[S0567] Dtrack: Dtrack has used cmd.exe to add a persistent service.","[G1032] INC Ransom: INC Ransom has used `cmd.exe` to launch malicious payloads.","[G0095] Machete: Machete has used batch files to initiate additional downloads of malicious files.","[S0481] Ragnar Locker: Ragnar Locker has used cmd.exe and batch scripts to execute commands.","[C0002] Night Dragon: During Night Dragon, threat actors used zwShell to establish full remote control of the connected machine and run command-line shells.","[G0082] APT38: APT38 has used a command-line tunneler, NACHOCHEESE, to give them shell access to a victim’s machine. Additionally, APT38 has used batch scripts.","[G0069] MuddyWater: MuddyWater has used a custom tool for creating reverse shells.","[S0071] hcdLoader: hcdLoader provides command-line access to the compromised system.","[S0333] UBoatRAT: UBoatRAT can start a command shell.","[S0553] MoleNet: MoleNet can execute commands via the command line utility.","[S1190] Kapeka: Kapeka allows for arbitrary Windows command execution.","[S1011] Tarrask: Tarrask may abuse the Windows schtasks command-line tool to create \"hidden\" scheduled tasks.","[S0031] BACKSPACE: Adversaries can direct BACKSPACE to execute from the command line on infected hosts, or have BACKSPACE create a reverse shell.","[S1066] DarkTortilla: DarkTortilla can use `cmd.exe` to add registry keys for persistence.","[G0125] HAFNIUM: HAFNIUM has used `cmd.exe` to execute commands on the victim's machine.","[S1182] MagicRAT: MagicRAT allows for the execution of arbitrary commands on the victim system.","[S0453] Pony: Pony has used batch scripts to delete itself after execution.","[S1029] AuTo Stealer: AuTo Stealer can use `cmd.exe` to execute a created batch file.","[S0084] Mis-Type: Mis-Type has used `cmd.exe` to run commands on a compromised host.","[S0069] BLACKCOFFEE: BLACKCOFFEE has the capability to create a reverse shell.","[G0022] APT3: An APT3 downloader uses the Windows command \"cmd.exe\" /C whoami. The group also uses a tool to execute commands on remote computers.","[S0339] Micropsia: Micropsia creates a command-line shell using cmd.exe.","[S0065] 4H RAT: 4H RAT has the capability to create a remote shell.","[S0464] SYSCON: SYSCON has the ability to execute commands through cmd on a compromised host.","[S1050] PcShare: PcShare can execute `cmd` commands on a compromised host.","[G1046] Storm-1811: Storm-1811 has used multiple batch scripts during initial access and subsequent actions on victim machines.","[S0533] SLOTHFULMEDIA: SLOTHFULMEDIA can open a command line to execute commands.","[G0050] APT32: APT32 has used cmd.exe for execution.","[S0375] Remexi: Remexi silently executes received commands with cmd.exe.","[S0253] RunningRAT: RunningRAT uses a batch file to kill a security program task and then attempts to remove itself.","[S0132] H1N1: H1N1 kills and disables services by using cmd.exe.","[G1039] RedCurl: RedCurl has used the Windows Command Prompt to execute commands.","[G1043] BlackByte: BlackByte executed ransomware using the Windows command shell.","[G0051] FIN10: FIN10 has executed malicious .bat files containing PowerShell commands.","[S0500] MCMD: MCMD can launch a console process (cmd.exe) with redirected standard input and output.","[S0652] MarkiRAT: MarkiRAT can utilize cmd.exe to execute commands in a victim's environment.","[S1196] Troll Stealer: Troll Stealer can create and execute Windows batch scripts.","[S0643] Peppy: Peppy has the ability to execute shell commands.","[S0625] Cuba: Cuba has used cmd.exe /c and batch files for execution.","[G0078] Gorgon Group: Gorgon Group malware can use cmd.exe to download and execute payloads and to execute commands on the system.","[G0037] FIN6: FIN6 has used kill.bat script to disable security tools.","[S1018] Saint Bot: Saint Bot has used `cmd.exe` and `.bat` scripts for execution.","[S0543] Spark: Spark can use cmd.exe to run commands.","[S0022] Uroburos: Uroburos has the ability to use the command line for execution on the targeted system.","[S0338] Cobian RAT: Cobian RAT can launch a remote command shell interface for executing commands.","[S0030] Carbanak: Carbanak has a command to create a reverse shell.","[G0117] Fox Kitten: Fox Kitten has used cmd.exe likely as a password changing mechanism.","[G0108] Blue Mockingbird: Blue Mockingbird has used batch script files to automate execution and deployment of payloads.","[S0347] AuditCred: AuditCred can open a reverse shell on the system to execute commands.","[S0610] SideTwist: SideTwist can execute shell commands on a compromised host.","[G0007] APT28: An APT28 loader Trojan uses a cmd.exe and batch script to run its payload. The group has also used macros to execute payloads.","[S0446] Ryuk: Ryuk has used cmd.exe to create a Registry entry to establish persistence.","[S0668] TinyTurla: TinyTurla has been installed using a .bat file.","[S0526] KGH_SPY: KGH_SPY has the ability to set a Registry key to run a cmd.exe command.","[S0233] MURKYTOP: MURKYTOP uses the command-line interface.","[S0085] S-Type: S-Type has provided the ability to execute shell commands on a compromised host.","[S0206] Wiarp: Wiarp creates a backdoor through which remote attackers can open a command line interface.","[G0094] Kimsuky: Kimsuky has executed Windows commands by using `cmd` and running batch scripts.","[S0457] Netwalker: Operators deploying Netwalker have used batch scripts to retrieve the Netwalker payload.","[G1013] Metador: Metador has used the Windows command line to execute commands.","[S1156] Manjusaka: Manjusaka can execute arbitrary commands passed to it from the C2 controller via `cmd.exe /c`.","[S0572] Caterpillar WebShell: Caterpillar WebShell can run commands on the compromised asset with CMD functions.","[S0669] KOCTOPUS: KOCTOPUS has used `cmd.exe` and batch files for execution.","[S0696] Flagpro: Flagpro can use `cmd.exe` to execute commands received from C2.","[S0447] Lokibot: Lokibot has used cmd /c commands embedded within batch scripts.","[S1129] Akira: Akira executes from the Windows command line and can take various arguments for execution.","[S0009] Hikit: Hikit has the ability to create a remote shell and run given commands.","[S0149] MoonWind: MoonWind can execute commands via an interactive command shell. MoonWind uses batch scripts for various purposes, including to restart and uninstall itself.","[G0129] Mustang Panda: Mustang Panda has executed HTA files via cmd.exe, and used batch scripts for collection.","[S0200] Dipsind: Dipsind can spawn remote shells.","[C0025] 2016 Ukraine Electric Power Attack: During the 2016 Ukraine Electric Power Attack, Sandworm Team used the `xp_cmdshell` command in MS-SQL.","[S1168] SampleCheck5000: SampleCheck5000 can call cmd.exe to execute C2 command line strings.","[S0593] ECCENTRICBANDWAGON: ECCENTRICBANDWAGON can use cmd to execute commands on a victim’s machine.","[S0376] HOPLIGHT: HOPLIGHT can launch cmd.exe to execute commands on the system.","[S1172] OilBooster: OilBooster has the ability to execute shell commands and exfiltrate the results.","[S1183] StrelaStealer: StrelaStealer has included BAT files in some instances for installation.","[S1155] Covenant: Covenant provides access to a Command Shell in Windows environments for follow-on command execution and tasking.","[S0045] ADVSTORESHELL: ADVSTORESHELL can create a remote shell and run a given command.","[G0081] Tropic Trooper: Tropic Trooper has used Windows command scripts.","[S1147] Nightdoor: Nightdoor creates a cmd.exe shell to send and receive commands from the command and control server via open pipes.","[S0185] SEASHARPEE: SEASHARPEE can execute commands on victims.","[S0612] WastedLocker: WastedLocker has used cmd to execute commands on the system.","[S0199] TURNEDUP: TURNEDUP is capable of creating a reverse shell.","[S0211] Linfo: Linfo creates a backdoor through which remote attackers can start a remote shell.","[S0013] PlugX: PlugX allows actors to spawn a reverse shell on a victim.","[S1021] DnsSystem: DnsSystem can use `cmd.exe` for execution.","[S0470] BBK: BBK has the ability to use cmd to run a Portable Executable (PE) on the compromised host.","[S0493] GoldenSpy: GoldenSpy can execute remote commands via the command-line interface.","[S0477] Goopy: Goopy has the ability to use cmd.exe to execute commands passed from an Outlook C2 channel.","[S0264] OopsIE: OopsIE uses the command prompt to execute commands on the victim's machine.","[S0459] MechaFlounder: MechaFlounder has the ability to run commands on a compromised host.","[S0269] QUADAGENT: QUADAGENT uses cmd.exe to execute scripts and commands on the victim’s machine.","[G0096] APT41: APT41 used cmd.exe /c to execute commands on remote machines. APT41 used a batch file to install persistence for the Cobalt Strike BEACON loader.","[S0638] Babuk: Babuk has the ability to use the command line to control execution on compromised hosts.","[C0006] Operation Honeybee: During Operation Honeybee, various implants used batch scripting and `cmd.exe` for execution.","[S0444] ShimRat: ShimRat can be issued a command shell function from the C2.","[S0034] NETEAGLE: NETEAGLE allows adversaries to execute shell commands on the infected host.","[S1085] Sardonic: Sardonic has the ability to run `cmd.exe` or other interactive processes on a compromised computer.","[S1070] Black Basta: Black Basta can use `cmd.exe` to enable shadow copy deletion.","[S0246] HARDRAIN: HARDRAIN uses cmd.exe to execute netshcommands.","[S0250] Koadic: Koadic can open an interactive command-shell to perform command line functions on victim machines. Koadic performs most of its operations using Windows Script Host (Jscript) and to run arbitrary shellcode.","[S0586] TAINTEDSCRIBE: TAINTEDSCRIBE can enable Windows CLI access and execute files.","[S0697] HermeticWiper: HermeticWiper can use `cmd.exe /Q/c move CSIDL_SYSTEM_DRIVE\\temp\\sys.tmp1 CSIDL_WINDOWS\\policydefinitions\\postgresql.exe 1> \\\\127.0.0.1\\ADMIN$\\_1636727589.6007507 2>&1` to deploy on an infected system.","[C0007] FunnyDream: During FunnyDream, the threat actors used `cmd.exe` to execute the wmiexec.vbs script.","[S0660] Clambling: Clambling can use cmd.exe for command execution.","[C0001] Frankenstein: During Frankenstein, the threat actors ran a command script to set up persistence as a scheduled task named \"WinUpdate\", as well as other encoded commands from the command-line","[G0119] Indrik Spider: Indrik Spider has used batch scripts on victim's machines.","[S0270] RogueRobin: RogueRobin uses Windows Script Components.","[S0673] DarkWatchman: DarkWatchman can use `cmd.exe` to execute commands.","[G0143] Aquatic Panda: Aquatic Panda has attempted and failed to run Bash commands on a Windows host by passing them to cmd /C.","[S0396] EvilBunny: EvilBunny has an integrated scripting engine to download and execute Lua scripts.","[G1016] FIN13: FIN13 has leveraged `xp_cmdshell` and Windows Command Shell to execute commands on a compromised machine. FIN13 has also attempted to leverage the ‘xp_cmdshell’ SQL procedure to execute remote commands on internal MS-SQL servers.","[S0634] EnvyScout: EnvyScout can use cmd.exe to execute malicious files on compromised hosts.","[S0044] JHUHUGIT: JHUHUGIT uses a .bat file to execute a .dll.","[S0452] USBferry: USBferry can execute various Windows commands.","[S0332] Remcos: Remcos can launch a remote command line to execute commands on the victim’s machine.","[S0514] WellMess: WellMess can execute command line scripts received from C2.","[S0153] RedLeaves: RedLeaves can receive and execute commands with cmd.exe. It can also provide a reverse shell.","[S0395] LightNeuron: LightNeuron is capable of executing commands via cmd.exe.","[S1130] Raspberry Robin: Raspberry Robin uses cmd.exe to read and execute a file stored on an infected USB device as part of initial installation.","[S0260] InvisiMole: InvisiMole can launch a remote shell to execute commands.","[S1015] Milan: Milan can use `cmd.exe` for discovery actions on a targeted system.","[S1132] IPsec Helper: IPsec Helper can run arbitrary commands passed to it through cmd.exe.","[S0334] DarkComet: DarkComet can launch a remote shell to execute commands on the victim’s machine.","[S0012] PoisonIvy: PoisonIvy creates a backdoor through which remote attackers can open a command-line interface.","[S0629] RainyDay: RainyDay can use the Windows Command Shell for execution.","[S0126] ComRAT: ComRAT has used cmd.exe to execute commands.","[S0588] GoldMax: GoldMax can spawn a command shell, and execute native commands.","[G0010] Turla: Turla RPC backdoors have used cmd.exe to execute commands.","[S0086] ZLib: ZLib has the ability to execute shell commands.","[G1030] Agrius: Agrius uses ASPXSpy web shells to enable follow-on command execution via cmd.exe.","[S0431] HotCroissant: HotCroissant can remotely open applications on the infected host with the ShellExecuteA command.","[S0576] MegaCortex: MegaCortex has used .cmd scripts on the victim's system.","[S0623] Siloscape: Siloscape can run cmd through an IRC channel.","[S1052] DEADEYE: DEADEYE can run `cmd /c copy /y /b C:\\Users\\public\\syslog_6-*.dat C:\\Users\\public\\syslog.dll` to combine separated sections of code into a single DLL prior to execution.","[G0114] Chimera: Chimera has used the Windows Command Shell and batch scripts for execution on compromised hosts.","[S0342] GreyEnergy: GreyEnergy uses cmd.exe to execute itself in-memory.","[S0180] Volgmer: Volgmer can execute commands on the victim's machine.","[G0054] Sowbug: Sowbug has used command line during its intrusions.","[C0038] HomeLand Justice: During HomeLand Justice, threat actors used Windows batch files for persistence and execution.","[S0266] TrickBot: TrickBot has used macros in Excel documents to download and deploy the malware on the user’s machine.","[S1135] MultiLayer Wiper: MultiLayer Wiper uses a batch script launched via a scheduled task to delete Windows Event Logs.","[G0080] Cobalt Group: Cobalt Group has used a JavaScript backdoor that is capable of launching cmd.exe to execute shell commands. The group has used an exploit toolkit known as Threadkit that launches .bat files.","[S0611] Clop: Clop can use cmd.exe to help execute commands on the system.","[G1037] TA577: TA577 has used BAT files in malware execution chains.","[S0247] NavRAT: NavRAT leverages cmd.exe to perform discovery techniques. NavRAT loads malicious shellcode and executes it in memory.","[G1022] ToddyCat: ToddyCat has used .bat scripts and `cmd` for execution on compromised hosts.","[S0128] BADNEWS: BADNEWS is capable of executing commands via cmd.exe.","[S0394] HiddenWasp: HiddenWasp uses a script to automate tasks on the victim's machine and to assist in execution.","[S0412] ZxShell: ZxShell can launch a reverse command shell.","[S1020] Kevin: Kevin can use a renamed image of `cmd.exe` for execution.","[S0074] Sakula: Sakula calls cmd.exe to run various DLL files via rundll32 and also to perform file cleanup. Sakula also has the capability to invoke a reverse shell.","[C0024] SolarWinds Compromise: During the SolarWinds Compromise, APT29 used `cmd.exe` to execute commands on remote machines.","[S0243] DealersChoice: DealersChoice makes modifications to open-source scripts from GitHub and executes them on the victim’s machine.","[S1049] SUGARUSH: SUGARUSH has used `cmd` for execution on an infected host.","[C0017] C0017: During C0017, APT41 used `cmd.exe` to execute reconnaissance commands.","[S0449] Maze: The Maze encryption process has used batch scripts with various commands.","[S1014] DanBot: DanBot has the ability to execute arbitrary commands via `cmd.exe`.","[S0184] POWRUNER: POWRUNER can execute commands from its C2 server.","[S0087] Hi-Zor: Hi-Zor has the ability to create a reverse shell.","[S0689] WhisperGate: WhisperGate can use `cmd.exe` to execute commands.","[S0363] Empire: Empire has modules for executing scripts.","[S0674] CharmPower: The C# implementation of the CharmPower command execution module can use cmd.","[S1159] DUSTTRAP: DUSTTRAP can execute commands via `cmd.exe`.","[S0170] Helminth: Helminth can provide a remote shell. One version of Helminth uses batch scripting.","[S0198] NETWIRE: NETWIRE can issue commands using cmd.exe.","[S0068] httpclient: httpclient opens cmd.exe on the victim.","[S1211] Hannotog: Hannotog can execute various `cmd.exe /c %s` commands.","[S0356] KONNI: KONNI has used cmd.exe to execute arbitrary commands on the infected host across different stages of the infection chain.","[S0379] Revenge RAT: Revenge RAT uses cmd.exe to execute commands and run scripts on the victim's machine.","[S0262] QuasarRAT: QuasarRAT can launch a remote shell to execute commands on the victim’s machine.","[S0389] JCry: JCry has used cmd.exe to launch PowerShell.","[C0012] Operation CuckooBees: During Operation CuckooBees, the threat actors used batch scripts to perform reconnaissance.","[S0391] HAWKBALL: HAWKBALL has created a cmd.exe reverse shell, executed commands, and uploaded output via the command line.","[S0109] WEBC2: WEBC2 can open an interactive command shell.","[S0083] Misdat: Misdat is capable of providing shell functionality to the attacker to execute commands.","[S0237] GravityRAT: GravityRAT executes commands remotely on the infected host.","[C0015] C0015: During C0015, the threat actors used `cmd.exe` to execute commands and run malicious binaries.","[S0251] Zebrocy: Zebrocy uses cmd.exe to execute commands on the system.","[S0343] Exaramel for Windows: Exaramel for Windows has a command to launch a remote shell and executes commands on the victim’s machine.","[G0035] Dragonfly: Dragonfly has used various types of scripting to perform operations, including batch scripts.","[S0146] TEXTMATE: TEXTMATE executes cmd.exe to provide a reverse shell to adversaries.","[G0140] LazyScripter: LazyScripter has used batch files to deploy open-source and multi-stage RATs.","[S0653] xCaon: xCaon has a command to start an interactive shell.","[S0249] Gold Dragon: Gold Dragon uses cmd.exe to execute commands for discovery.","[G1023] APT5: APT5 has used cmd.exe for execution on compromised systems.","[S0532] Lucifer: Lucifer can issue shell commands to download and execute additional payloads.","[S0630] Nebulae: Nebulae can use CMD to execute a process.","[S0448] Rising Sun: Rising Sun has executed commands using `cmd.exe /c “ > \\AM. tmp” 2>&1`.","[S0631] Chaes: Chaes has used cmd to execute tasks on the system.","[S0369] CoinTicker: CoinTicker executes a bash script to establish a reverse shell.","[G0012] Darkhotel: Darkhotel has dropped an mspaint.lnk shortcut to disk which launches a shell script that downloads and executes a file.","[S0256] Mosquito: Mosquito executes cmd.exe and uses a pipe to read the results and send back the output to the C2 server.","[G0040] Patchwork: Patchwork ran a reverse shell with Meterpreter. Patchwork used JavaScript code and .SCT files on victim machines.","[S0280] MirageFox: MirageFox has the capability to execute commands using cmd.exe.","[S0455] Metamorfo: Metamorfo has used cmd.exe /c to execute files.","[S0688] Meteor: Meteor can run `set.bat`, `update.bat`, `cache.bat`, `bcd.bat`, `msrun.bat`, and similar scripts.","[S0239] Bankshot: Bankshot uses the command-line interface to execute arbitrary commands.","[S0367] Emotet: Emotet has used cmd.exe to run a PowerShell script.","[S0268] Bisonal: Bisonal has launched cmd.exe and used the ShellExecuteW() API function to execute commands on the system.","[S1081] BADHATCH: BADHATCH can use `cmd.exe` to execute commands on a compromised host.","[G0067] APT37: APT37 has used the command-line interface.","[S0115] Crimson: Crimson has the ability to execute commands with the COMSPEC environment variable.","[S0330] Zeus Panda: Zeus Panda can launch an interface where it can execute several commands on the victim’s PC.","[G0046] FIN7: FIN7 used the command prompt to launch commands on the victim’s machine.","[S1031] PingPull: PingPull can use `cmd.exe` to run various commands as a reverse shell.","[S0670] WarzoneRAT: WarzoneRAT can use `cmd.exe` to execute malicious code.","[G0004] Ke3chang: Ke3chang has used batch scripts in its malware to install persistence mechanisms.","[S0164] TDTESS: TDTESS provides a reverse shell on the victim.","[S0692] SILENTTRINITY: SILENTTRINITY can use `cmd.exe` to enable lateral movement using DCOM.","[G1035] Winter Vivern: Winter Vivern distributed Windows batch scripts disguised as virus scanners to prompt download of malicious payloads using built-in system tools.","[S1037] STARWHALE: STARWHALE has the ability to execute commands via `cmd.exe`.","[S0666] Gelsemium: Gelsemium can use a batch script to delete itself.","[G0060] BRONZE BUTLER: BRONZE BUTLER has used batch scripts and the command-line interface for execution.","[S0647] Turian: Turian can create a remote shell and execute commands using cmd.","[S0202] adbupd: adbupd can run a copy of cmd.exe.","[S1099] Samurai: Samurai can use a remote command module for execution via the Windows command line.","[G0126] Higaisa: Higaisa used cmd.exe for execution.","[S0350] zwShell: zwShell can launch command-line shells.","[S0263] TYPEFRAME: TYPEFRAME can uninstall malware components using a batch script. TYPEFRAME can execute commands using a shell.","[G0045] menuPass: menuPass executes commands using a command-line interface and reverse shell. The group has used a modified version of pentesting script wmiexec.vbs to execute commands. menuPass has used malicious macros embedded inside Office documents to execute files.","[S0094] Trojan.Karagany: Trojan.Karagany can perform reconnaissance commands on a victim machine via a cmd.exe process.","[S0238] Proxysvc: Proxysvc executes a binary on the system and logs the results into a temp file by using: cmd.exe /c \" > %temp%\\PM* .tmp 2>&1\".","[G0061] FIN8: FIN8 has used a Batch file to automate frequently executed post compromise cleanup activities. FIN8 has also executed commands remotely via `cmd.exe`.","[S1089] SharpDisco: SharpDisco can use `cmd.exe` to execute plugins and to send command output to specified SMB shares.","[S0159] SNUGRIDE: SNUGRIDE is capable of executing commands and spawning a reverse shell.","[C0022] Operation Dream Job: During Operation Dream Job, Lazarus Group launched malicious DLL files, created new folders, and renamed folders with the use of the Windows command shell.","[S1030] Squirrelwaffle: Squirrelwaffle has used `cmd.exe` for execution.","[S0451] LoudMiner: LoudMiner used a batch script to run the Linux virtual machine as a service.","[G0026] APT18: APT18 uses cmd.exe to execute commands on the victim’s machine.","[S0139] PowerDuke: PowerDuke runs cmd.exe /c and sends the output to its C2.","[S0387] KeyBoy: KeyBoy can launch interactive shells for communicating with the victim machine.","[S0554] Egregor: Egregor has used batch files for execution and can launch Internet Explorer from cmd.exe.","[G0127] TA551: TA551 has used cmd.exe to execute commands.","[S0400] RobbinHood: RobbinHood uses cmd.exe on the victim's computer.","[S1068] BlackCat: BlackCat can execute commands on a compromised network with the use of `cmd.exe`.","[S0575] Conti: Conti can utilize command line options to allow an attacker control over how it scans and encrypts files.","[S0267] FELIXROOT: FELIXROOT executes batch scripts on the victim’s machine, and can launch a reverse shell for command execution.","[G0075] Rancor: Rancor has used cmd.exe to execute commmands.","[G0006] APT1: APT1 has used the Windows command shell to execute commands, and batch scripting to automate execution.","[S0254] PLAINTEE: PLAINTEE uses cmd.exe to execute commands on the victim’s machine.","[S1044] FunnyDream: FunnyDream can use `cmd.exe` for execution on remote hosts.","[S0015] Ixeshe: Ixeshe is capable of executing commands via cmd.","[S0158] PHOREAL: PHOREAL is capable of creating reverse shell.","[S0469] ABK: ABK has the ability to use cmd to run a Portable Executable (PE) on the compromised host.","[S0186] DownPaper: DownPaper uses the command line.","[S0461] SDBbot: SDBbot has the ability to use the command shell to execute commands on a compromised host.","[S0373] Astaroth: Astaroth spawns a CMD process to execute commands.","[G0091] Silence: Silence has used Windows command-line to run commands.","[S0156] KOMPROGO: KOMPROGO is capable of creating a reverse shell.","[S0017] BISCUIT: BISCUIT has a command to launch a command shell on the system.","[G0047] Gamaredon Group: Gamaredon Group has used various batch scripts to establish C2 and download additional files. Gamaredon Group's backdoor malware has also been written to a batch file.","[G1021] Cinnamon Tempest: Cinnamon Tempest has executed ransomware using batch scripts deployed via GPO.","[S0080] Mivast: Mivast has the capability to open a remote shell and run basic commands.","[S0354] Denis: Denis can launch a remote shell to execute arbitrary commands on the victim’s machine.","[S0142] StreamEx: StreamEx has the ability to remotely execute commands.","[S1150] ROADSWEEP: ROADSWEEP can open cmd.exe to enable command execution.","[S0385] njRAT: njRAT can launch a command shell interface for executing commands.","[S0106] cmd: cmd is used to execute programs and other actions at the command-line interface.","[S0662] RCSession: RCSession can use `cmd.exe` for execution on compromised hosts.","[G0018] admin@338: Following exploitation with LOWBALL malware, admin@338 actors created a file containing a list of commands to be executed on the compromised computer.","[S0232] HOMEFRY: HOMEFRY uses a command-line interface.","[S0154] Cobalt Strike: Cobalt Strike uses a command-line interface to interact with systems.","[S0414] BabyShark: BabyShark has used cmd.exe to execute commands.","[S0265] Kazuar: Kazuar uses cmd.exe to execute commands on the victim’s machine.","[S0004] TinyZBot: TinyZBot supports execution from the command-line.","[S0171] Felismus: Felismus uses command line for execution.","[S1028] Action RAT: Action RAT can use `cmd.exe` to execute commands on an infected host.","[G0092] TA505: TA505 has executed commands using cmd.exe.","[S1111] DarkGate: DarkGate uses a malicious Windows Batch script to run the Windows code utility to retrieve follow-on script payloads. DarkGate has also used `cmd.exe` to create a remote shell."],"tactics":"TA0002 - Execution"}
{"technique_id":"T1059.004","technique_name":"Command and Scripting Interpreter: Unix Shell","description":"Adversaries may abuse Unix shell commands and scripts for execution. Unix shells are the primary command prompt on Linux, macOS, and ESXi systems, though many variations of the Unix shell exist (e.g. sh, ash, bash, zsh, etc.) depending on the specific OS or distribution. Unix shells can control every aspect of a system, with certain commands requiring elevated privileges. Unix shells also support scripts that enable sequential execution of commands as well as other typical programming operations such as conditionals and loops. Common uses of shell scripts include long or repetitive tasks, or the need to run the same set of commands on multiple systems. Adversaries may abuse Unix shells to execute various commands or payloads. Interactive shells may be accessed through command and control channels or during lateral movement such as with SSH. Adversaries may also leverage shell scripts to deliver and execute multiple commands on victims or as part of payloads used for persistence. Some systems, such as embedded devices, lightweight Linux distributions, and ESXi servers, may leverage stripped-down Unix shells via Busybox, a small executable that contains a variety of tools, including a simple shell.","detection":"Unix shell usage may be common on administrator, developer, or power user systems, depending on job function. If scripting is restricted for normal users, then any attempt to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. Scripts are likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for script execution and subsequent behavior. Actions may be related to network and system information discovery, collection, or other scriptable post-compromise behaviors and could be used as indicators of detection leading back to the source script.","procedures":["[S1184] BOLDMOVE: BOLDMOVE is capable of spawning a remote command shell.","[G0143] Aquatic Panda: Aquatic Panda used malicious shell scripts in Linux environments following access via SSH to install Linux versions of Winnti malware.","[S0377] Ebury: Ebury can use the commands `Xcsh` or `Xcls` to open a shell with Ebury level permissions and `Xxsh` to open a shell with root level.","[S1107] NKAbuse: NKAbuse is initially installed and executed through an initial shell script.","[S1163] SnappyTCP: SnappyTCP creates the reverse shell using a pthread spawning a bash shell.","[S0647] Turian: Turian has the ability to use /bin/sh to execute commands.","[G0139] TeamTNT: TeamTNT has used shell scripts for execution.","[C0048] Operation MidnightEclipse: During Operation MidnightEclipse, threat actors piped output from stdout to bash for execution.","[S0482] Bundlore: Bundlore has leveraged /bin/sh and /bin/bash to execute commands on the victim machine.","[S0587] Penquin: Penquin can execute remote commands using bash scripts.","[S0599] Kinsing: Kinsing has used Unix shell scripts to execute commands in the victim environment.","[S0641] Kobalos: Kobalos can spawn a new pseudo-terminal and execute arbitrary commands at the command prompt.","[G0106] Rocke: Rocke used shell scripts to run commands which would obtain persistence and execute the cryptocurrency mining malware.","[S0021] Derusbi: Derusbi is capable of creating a remote Bash shell and executing commands.","[G1047] Velvet Ant: Velvet Ant used a custom tool, VELVETSTING, to parse encoded inbound commands to compromised F5 BIG-IP devices and then execute them via the Unix shell.","[S1108] PULSECHECK: PULSECHECK can use Unix shell script for command execution.","[S0220] Chaos: Chaos provides a reverse shell connection on 8338/TCP, encrypted via AES.","[S1105] COATHANGER: COATHANGER provides a BusyBox reverse shell for command and control.","[S0502] Drovorub: Drovorub can execute arbitrary commands as root on a compromised system.","[C0053] FLORAHOX Activity: FLORAHOX Activity has executed multiple Bash controller scripts to provide command line inputs for FLORAHOX traversal configurations.","[S0352] OSX_OCEANLOTUS.D: OSX_OCEANLOTUS.D uses a shell script as the main executable inside an app bundle and drops an embedded base64-encoded payload to the /tmp folder.","[S0504] Anchor: Anchor can execute payloads via shell scripting.","[S0451] LoudMiner: LoudMiner used shell scripts to launch various services and to start/stop the QEMU virtualization.","[S0584] AppleJeus: AppleJeus has used shell scripts to execute commands after installation and set persistence mechanisms.","[S0466] WindTail: WindTail can use the open command to execute an application.","[S0402] OSX/Shlayer: OSX/Shlayer can use bash scripts to check the macOS version, download payloads, and extract bytes from files. OSX/Shlayer uses the command sh -c tail -c +1381... to extract bytes at an offset from a specified file. OSX/Shlayer uses the curl -fsL \"$url\" >$tmp_path command to download malicious payloads into a temporary directory.","[S0198] NETWIRE: NETWIRE has the ability to use /bin/bash and /bin/sh to execute commands.","[S0265] Kazuar: Kazuar uses /bin/bash to execute commands on the victim’s machine.","[S0600] Doki: Doki has executed shell scripts with /bin/sh.","[S0369] CoinTicker: CoinTicker executes a bash script to establish a reverse shell.","[S1198] Gomir: Gomir reads command line arguments and parses them for functionality when executed from a Linux shell, and can execute arbitrary strings passed to it as shell commands.","[S1153] Cuckoo Stealer: Cuckoo Stealer can spawn a bash shell to enable execution on compromised hosts.","[C0035] KV Botnet Activity: KV Botnet Activity utilizes multiple Bash scripts during botnet installation stages, and the final botnet payload allows for running commands in the Bash shell.","[S1114] ZIPLINE: ZIPLINE can use `/bin/sh` to create a reverse shell and execute commands.","[S1123] PITSTOP: PITSTOP has the ability to receive shell commands over a Unix domain socket.","[G1017] Volt Typhoon: Volt Typhoon has used Brightmetricagent.exe which contains a command- line interface (CLI) library that can leverage command shells including Z Shell (zsh).","[G0096] APT41: APT41 used Linux shell commands for system survey and information gathering prior to exploitation of vulnerabilities such as CVE-2019-19871.","[S1161] BPFDoor: BPFDoor can create a reverse shell and supports vt100 emulator formatting.","[S1109] PACEMAKER: PACEMAKER can use a simple bash script for execution.","[S0690] Green Lambert: Green Lambert can use shell scripts for execution, such as /bin/sh -c.","[S0468] Skidmap: Skidmap has used pm.sh to download and install its main payload.","[S1016] MacMa: MacMa can execute supplied shell commands and uses bash scripts to perform additional actions.","[S0077] CallMe: CallMe has the capability to create a reverse shell on victims.","[G1041] Sea Turtle: Sea Turtle used shell scripts for post-exploitation execution in victim environments.","[S0401] Exaramel for Linux: Exaramel for Linux has a command to execute a shell command on the system.","[S0492] CookieMiner: CookieMiner has used a Unix shell script to run a series of commands targeting macOS.","[S0658] XCSSET: XCSSET uses a shell script to execute Mach-o files and osacompile commands such as, osacompile -x -o xcode.app main.applescript.","[S1203] J-magic: The J-magic agent is executed through a command line argument which specifies an interface and listening port.","[S0279] Proton: Proton uses macOS' .command file type to script actions.","[S0601] Hildegard: Hildegard has used shell scripts for execution.","[S0410] Fysbis: Fysbis has the ability to create and execute commands in a remote shell for CLI."],"tactics":"TA0002 - Execution"}
{"technique_id":"T1059.005","technique_name":"Command and Scripting Interpreter: Visual Basic","description":"Adversaries may abuse Visual Basic (VB) for execution. VB is a programming language created by Microsoft with interoperability with many Windows technologies such as Component Object Model and the Native API through the Windows API. Although tagged as legacy with no planned future evolutions, VB is integrated and supported in the .NET Framework and cross-platform .NET Core. Derivative languages based on VB have also been created, such as Visual Basic for Applications (VBA) and VBScript. VBA is an event-driven programming language built into Microsoft Office, as well as several third-party applications. VBA enables documents to contain macros used to automate the execution of tasks and other functionality on the host. VBScript is a default scripting language on Windows hosts and can also be used in place of JavaScript on HTML Application (HTA) webpages served to Internet Explorer (though most modern browsers do not come with VBScript support). Adversaries may use VB payloads to execute malicious commands. Common malicious usage includes automating execution of behaviors with VBScript or embedding VBA content into Spearphishing Attachment payloads (which may also involve Mark-of-the-Web Bypass to enable execution).","detection":"Monitor for events associated with VB execution, such as Office applications spawning processes, usage of the Windows Script Host (typically cscript.exe or wscript.exe), file activity involving VB payloads or scripts, or loading of modules associated with VB languages (ex: vbscript.dll). VB execution is likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for execution and subsequent behavior. Actions may be related to network and system information Discovery, Collection, or other programable post-compromise behaviors and could be used as indicators of detection leading back to the source. Understanding standard usage patterns is important to avoid a high number of false positives. If VB execution is restricted for normal users, then any attempts to enable related components running on a system would be considered suspicious. If VB execution is not commonly used on a system, but enabled, execution running out of cycle from patching or other administrator functions is suspicious. Payloads and scripts should be captured from the file system when possible to determine their actions and intent.","procedures":["[S0447] Lokibot: Lokibot has used VBS scripts and XLS macros for execution.","[G0040] Patchwork: Patchwork used Visual Basic Scripts (VBS) on victim machines.","[C0025] 2016 Ukraine Electric Power Attack: During the 2016 Ukraine Electric Power Attack, Sandworm Team created VBScripts to run on an SSH server.","[S0531] Grandoreiro: Grandoreiro can use VBScript to execute malicious code.","[S0475] BackConfig: BackConfig has used VBS to install its downloader component and malicious documents with VBA macro code.","[S1030] Squirrelwaffle: Squirrelwaffle has used malicious VBA macros in Microsoft Word documents and Excel spreadsheets that execute an `AutoOpen` subroutine.","[S0250] Koadic: Koadic performs most of its operations using Windows Script Host (VBScript) and runs arbitrary shellcode .","[G0126] Higaisa: Higaisa has used VBScript code on the victim's machine.","[S0585] Kerrdown: Kerrdown can use a VBS base64 decoder function published by Motobit.","[S0477] Goopy: Goopy has the ability to use a Microsoft Outlook backdoor macro to communicate with its C2.","[S1149] CHIMNEYSWEEP: CHIMNEYSWEEP has executed a script named cln.vbs on compromised hosts.","[G0085] FIN4: FIN4 has used VBA macros to display a dialog box and collect victim credentials.","[G0090] WIRTE: WIRTE has used VBScript in its operations.","[G0112] Windshift: Windshift has used Visual Basic 6 (VB6) payloads.","[G0010] Turla: Turla has used VBS scripts throughout its operations.","[S0283] jRAT: jRAT has been distributed as HTA files with VBScript.","[S1064] SVCReady: SVCReady has used VBA macros to execute shellcode.","[C0022] Operation Dream Job: During Operation Dream Job, Lazarus Group executed a VBA written malicious macro after victims download malicious DOTM files; Lazarus Group also used Visual Basic macro code to extract a double Base64 encoded DLL implant.","[S1086] Snip3: Snip3 can use visual basic scripts for first-stage execution.","[S0341] Xbash: Xbash can execute malicious VBScript payloads on the victim’s machine.","[G1006] Earth Lusca: Earth Lusca used VBA scripts.","[G0075] Rancor: Rancor has used VBS scripts as well as embedded macros for execution.","[C0007] FunnyDream: During FunnyDream, the threat actors used a Visual Basic script to run remote commands.","[G0129] Mustang Panda: Mustang Panda has embedded VBScript components in LNK files to download additional files and automate collection.","[G0134] Transparent Tribe: Transparent Tribe has crafted VBS-based malicious documents.","[S0442] VBShower: VBShower has the ability to execute VBScript files.","[S0343] Exaramel for Windows: Exaramel for Windows has a command to execute VBS scripts on the victim’s machine.","[S0373] Astaroth: Astaroth has used malicious VBS e-mail attachments for execution.","[G0091] Silence: Silence has used VBS scripts.","[S0228] NanHaiShu: NanHaiShu executes additional VBScript code on the victim's machine.","[G0047] Gamaredon Group: Gamaredon Group has embedded malicious macros in document templates, which executed VBScript. Gamaredon Group has also delivered Microsoft Outlook VBA projects with embedded macros.","[S0582] LookBack: LookBack has used VBA macros in Microsoft Word attachments to drop additional files to the host.","[G0046] FIN7: FIN7 used VBS scripts to help perform tasks on the victim's machine.","[S1193] TAMECAT: TAMECAT has used VBScript to query anti-virus products.","[S0631] Chaes: Chaes has used VBscript to execute malicious code.","[S0695] Donut: Donut can generate shellcode outputs that execute via VBScript.","[S1178] ShrinkLocker: ShrinkLocker is a VisualBasic script (VBS) object that calls multiple other operating system functions during execution.","[S0226] Smoke Loader: Smoke Loader adds a Visual Basic script in the Startup folder to deploy the payload.","[G0082] APT38: APT38 has used VBScript to execute commands and other operational tasks.","[S0198] NETWIRE: NETWIRE has been executed through use of VBScripts.","[G0095] Machete: Machete has embedded malicious macros within spearphishing attachments to download additional files.","[S0268] Bisonal: Bisonal's dropper creates VBS scripts on the victim’s machine.","[S0496] REvil: REvil has used obfuscated VBA macros for execution.","[G0069] MuddyWater: MuddyWater has used VBScript files to execute its POWERSTATS payload, as well as macros.","[S0696] Flagpro: Flagpro can execute malicious VBA macros embedded in .xlsm files.","[G1044] APT42: APT42 has used a VBScript to query anti-virus products.","[G0060] BRONZE BUTLER: BRONZE BUTLER has used VBS and VBE scripts for execution.","[S0414] BabyShark: BabyShark can execute additional VisualBasic content.","[G0142] Confucius: Confucius has used VBScript to execute malicious code.","[C0001] Frankenstein: During Frankenstein, the threat actors used Word documents that prompted the victim to enable macros and run a Visual Basic script.","[C0024] SolarWinds Compromise: For the SolarWinds Compromise, APT29 wrote malware such as Sibot in Visual Basic.","[S0154] Cobalt Strike: Cobalt Strike can use VBA to perform execution.","[G0092] TA505: TA505 has used VBS for code execution.","[S1039] Bumblebee: Bumblebee can create a Visual Basic script to enable persistence.","[S0352] OSX_OCEANLOTUS.D: OSX_OCEANLOTUS.D uses Word macros for execution.","[S0170] Helminth: One version of Helminth consists of VBScript scripts.","[G0059] Magic Hound: Magic Hound malware has used VBS scripts for execution.","[G1039] RedCurl: RedCurl has used VBScript to run malicious files.","[S0240] ROKRAT: ROKRAT has used Visual Basic for execution.","[S0679] Ferocious: Ferocious has the ability to use Visual Basic scripts for execution.","[S0269] QUADAGENT: QUADAGENT uses VBScripts.","[G0140] LazyScripter: LazyScripter has used VBScript to execute malicious code.","[S0648] JSS Loader: JSS Loader can download and execute VBScript files.","[G1026] Malteiro: Malteiro has utilized a dropper containing malicious VBS scripts.","[G0032] Lazarus Group: Lazarus Group has used VBA and embedded macros in Word documents to execute malicious code.","[G0080] Cobalt Group: Cobalt Group has sent Word OLE compound documents with malicious obfuscated VBA macros that will run upon user execution.","[C0015] C0015: During C0015, the threat actors used a malicious HTA file that contained a mix of HTML and JavaScript/VBScript code.","[S1018] Saint Bot: Saint Bot has used `.vbs` scripts for execution.","[G0049] OilRig: OilRig has used VBScript macros for execution on compromised hosts.","[S1132] IPsec Helper: IPsec Helper can run arbitrary Visual Basic scripts and commands passed to it.","[G1008] SideCopy: SideCopy has sent Microsoft Office Publisher documents to victims that have embedded malicious macros that execute an hta file via calling `mshta.exe`.","[C0014] Operation Wocao: During Operation Wocao, threat actors used VBScript to conduct reconnaissance on targeted systems.","[S0244] Comnie: Comnie executes VBS scripts.","[S0367] Emotet: Emotet has sent Microsoft Word documents with embedded macros that will invoke scripts to download additional payloads.","[G0065] Leviathan: Leviathan has used VBScript.","[S0389] JCry: JCry has used VBS scripts.","[S1037] STARWHALE: STARWHALE can use the VBScript function `GetRef` as part of its persistence mechanism.","[G0062] TA459: TA459 has a VBScript for execution.","[S1014] DanBot: DanBot can use a VBA macro embedded in an Excel file to drop the payload.","[S0147] Pteranodon: Pteranodon can use a malicious VBS file for execution.","[S0483] IcedID: IcedID has used obfuscated VBA string expressions.","[S0387] KeyBoy: KeyBoy uses VBS scripts for installing files and performing execution.","[S0530] Melcoz: Melcoz can use VBS scripts to execute malicious DLLs.","[S1142] LunarMail: LunarMail has been installed using a VBA macro.","[S0336] NanoCore: NanoCore uses VBS files.","[G1016] FIN13: FIN13 has used VBS scripts for code execution on comrpomised machines.","[S0589] Sibot: Sibot executes commands using VBScript.","[S0264] OopsIE: OopsIE creates and uses a VBScript as part of its persistent execution.","[C0013] Operation Sharpshooter: During Operation Sharpshooter, the threat actors used a VBA macro to execute a simple downloader that installed Rising Sun.","[S0689] WhisperGate: WhisperGate can use a Visual Basic script to exclude the `C:\\` drive from Windows Defender.","[G0121] Sidewinder: Sidewinder has used VBScript to drop and execute malware loaders.","[G0050] APT32: APT32 has used macros, COM scriptlets, and VBS scripts.","[S0428] PoetRAT: PoetRAT has used Word documents with VBScripts to execute malicious activities.","[C0011] C0011: For C0011, Transparent Tribe used malicious VBA macros within a lure document as part of the Crimson malware installation process onto a compromised host.","[C0028] 2015 Ukraine Electric Power Attack: During the 2015 Ukraine Electric Power Attack, Sandworm Team installed a VBA script called `vba_macro.exe`. This macro dropped `FONTCACHE.DAT`, the primary BlackEnergy implant; `rundll32.exe`, for executing the malware; `NTUSER.log`, an empty file; and desktop.ini, the default file used to determine folder displays on Windows machines.","[S0559] SUNBURST: SUNBURST used VBScripts to initiate the execution of payloads.","[G0021] Molerats: Molerats used various implants, including those built with VBScript, on target machines.","[G1018] TA2541: TA2541 has used VBS files to execute or establish persistence for additional payloads, often using file names consistent with email themes or mimicking system functionality.","[S0386] Ursnif: Ursnif droppers have used VBA macros to download and execute the malware's full executable payload.","[C0016] Operation Dust Storm: During Operation Dust Storm, the threat actors used Visual Basic scripts.","[C0012] Operation CuckooBees: During Operation CuckooBees, the threat actors executed an encoded VBScript file using `wscript` and wrote the decoded output to a text file.","[C0044] Juicy Mix: During Juicy Mix, OilRig used VBS droppers to deliver and establish persistence for the Mango backdoor.","[S0234] Bandook: Bandook has used malicious VBA code against the target system.","[G0100] Inception: Inception has used VBScript to execute malicious commands and payloads.","[S0223] POWERSTATS: POWERSTATS can use VBScript (VBE) code for execution.","[S1111] DarkGate: DarkGate initial infection mechanisms include masquerading as pirated media that launches malicious VBScript on the victim.","[S0263] TYPEFRAME: TYPEFRAME has used a malicious Word document for delivery with VBA macros for execution.","[S0375] Remexi: Remexi uses AutoIt and VBS scripts throughout its execution process.","[C0006] Operation Honeybee: For Operation Honeybee, the threat actors used a Visual Basic script embedded within a Word document to download an implant.","[G0099] APT-C-36: APT-C-36 has embedded a VBScript within a malicious Word document which is executed upon the document opening.","[S0650] QakBot: QakBot can use VBS to download and execute malicious files.","[G1001] HEXANE: HEXANE has used a VisualBasic script named `MicrosoftUpdator.vbs` for execution of a PowerShell keylogger.","[S0458] Ramsay: Ramsay has included embedded Visual Basic scripts in malicious documents.","[S0669] KOCTOPUS: KOCTOPUS has used VBScript to call wscript to execute a PowerShell command.","[G0064] APT33: APT33 has used VBScript to initiate the delivery of payloads.","[C0042] Outer Space: During Outer Space, OilRig used VBS droppers to deploy malware.","[G0067] APT37: APT37 executes shellcode and a VBA script to decode Base64 strings.","[G0034] Sandworm Team: Sandworm Team has created VBScripts to run an SSH server.","[G0094] Kimsuky: Kimsuky has used Visual Basic to download malicious payloads. Kimsuky has also used malicious VBA macros within maldocs disguised as forms that trigger when a victim types any content into the lure.","[S0455] Metamorfo: Metamorfo has used VBS code on victims’ systems.","[S0380] StoneDrill: StoneDrill has several VBS scripts used throughout the malware's lifecycle.","[S1122] Mispadu: Mispadu’s dropper uses VBS files to install payloads and perform execution.","[S0441] PowerShower: PowerShower has the ability to save and execute VBScript.","[G0078] Gorgon Group: Gorgon Group has used macros in Spearphishing Attachments as well as executed VBScripts on victim machines.","[S0528] Javali: Javali has used embedded VBScript to download malicious payloads from C2.","[G0087] APT39: APT39 has utilized malicious VBS scripts in malware."],"tactics":"TA0002 - Execution"}
{"technique_id":"T1059.006","technique_name":"Command and Scripting Interpreter: Python","description":"Adversaries may abuse Python commands and scripts for execution. Python is a very popular scripting/programming language, with capabilities to perform many functions. Python can be executed interactively from the command-line (via the python.exe interpreter) or via scripts (.py) that can be written and distributed to different systems. Python code can also be compiled into binary executables. Python comes with many built-in packages to interact with the underlying system, such as file operations and device I/O. Adversaries can use these libraries to download and execute commands or other scripts as well as perform various malicious behaviors.","detection":"Monitor systems for abnormal Python usage and python.exe behavior, which could be an indicator of malicious activity. Understanding standard usage patterns is important to avoid a high number of false positives. If scripting is restricted for normal users, then any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. Scripts are likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for script execution and subsequent behavior. Actions may be related to network and system information Discovery, Collection, or other scriptable post-compromise behaviors and could be used as indicators of detection leading back to the source script.","procedures":["[S0581] IronNetInjector: IronNetInjector can use IronPython scripts to load payloads with the help of a .NET injector.","[S0547] DropBook: DropBook is a Python-based backdoor compiled with PyInstaller.","[S0196] PUNCHBUGGY: PUNCHBUGGY has used python scripts.","[G0067] APT37: APT37 has used Python scripts to execute payloads.","[G0060] BRONZE BUTLER: BRONZE BUTLER has made use of Python-based remote access tools.","[S0695] Donut: Donut can generate shellcode outputs that execute via Python.","[S0374] SpeakUp: SpeakUp uses Python scripts.","[G0131] Tonto Team: Tonto Team has used Python-based tools for execution.","[S1187] reGeorg: reGeorg is a Python-based web shell.","[S1032] PyDCrypt: PyDCrypt, along with its functions, is written in Python.","[G0128] ZIRCONIUM: ZIRCONIUM has used Python-based implants to interact with compromised hosts.","[S0583] Pysa: Pysa has used Python scripts to deploy ransomware.","[S0387] KeyBoy: KeyBoy uses Python scripts for installing files and performing execution.","[G0106] Rocke: Rocke has used Python-based malware to install and spread their coinminer.","[G0095] Machete: Machete used multiple compiled Python scripts on the victim’s system. Machete's main backdoor Machete is also written in Python.","[S0332] Remcos: Remcos uses Python scripts.","[S1189] Neo-reGeorg: Neo-reGeorg is a Python-based web shell.","[S0482] Bundlore: Bundlore has used Python scripts to execute payloads.","[G1006] Earth Lusca: Earth Lusca used Python scripts for port scanning or building reverse shells.","[S1035] Small Sieve: Small Sieve can use Python scripts to execute commands.","[S0692] SILENTTRINITY: SILENTTRINITY is written in Python and can use multiple Python scripts for execution on targeted systems.","[S0631] Chaes: Chaes has used Python scripts for execution and the installation of additional files.","[G0069] MuddyWater: MuddyWater has developed tools in Python including Out1.","[C0014] Operation Wocao: During Operation Wocao, threat actors' backdoors were written in Python and compiled with py2exe.","[S0459] MechaFlounder: MechaFlounder uses a python-based payload.","[G1021] Cinnamon Tempest: Cinnamon Tempest has used a customized version of the Impacket wmiexec.py module to create renamed output files.","[C0029] Cutting Edge: During Cutting Edge, threat actors used a Python reverse shell and the PySoxy SOCKS5 proxy tool.","[S0647] Turian: Turian has the ability to use Python to spawn a Unix shell.","[G0010] Turla: Turla has used IronPython scripts as part of the IronNetInjector toolchain to drop payloads.","[G0016] APT29: APT29 has developed malware variants written in Python.","[S0369] CoinTicker: CoinTicker executes a Python script to download its second stage.","[S0192] Pupy: Pupy can use an add on feature when creating payloads that allows you to create custom Python scripts (“scriptlets”) to perform tasks offline (without requiring a session) such as sandbox detection, adding persistence, etc.","[S0377] Ebury: Ebury has used Python to implement its DGA.","[C0045] ShadowRay: During ShadowRay, threat actors used the Python `pty` module to open reverse shells.","[G0087] APT39: APT39 has used a command line utility and a network scanner written in python.","[S0234] Bandook: Bandook can support commands to execute Python-based payloads.","[S0409] Machete: Machete is written in Python and is used in conjunction with additional Python scripts.","[S1120] FRAMESTING: FRAMESTING is a Python web shell that can embed in the Ivanti Connect Secure CAV Python package.","[S0428] PoetRAT: PoetRAT was executed with a Python script and worked in conjunction with additional Python-based post-exploitation tools.","[S0154] Cobalt Strike: Cobalt Strike can use Python to perform execution.","[S1164] UPSTYLE: UPSTYLE is a Python-based application.","[S0492] CookieMiner: CookieMiner has used python scripts on the user’s system, as well as the Python variant of the Empire agent, EmPyre.","[S0276] Keydnap: Keydnap uses Python for scripting to execute additional commands.","[G1039] RedCurl: RedCurl has used a Python script to establish outbound communication and to execute commands using SMB port 445.","[S1213] Lumma Stealer: Lumma Stealer has used malicious Python scripts to execute payloads.","[G0035] Dragonfly: Dragonfly has used various types of scripting to perform operations, including Python scripts. The group was observed installing Python 2.7 on a victim.","[G0094] Kimsuky: Kimsuky has used a macOS Python implant to gather data as well as MailFetcher.py code to automatically collect email data."],"tactics":"TA0002 - Execution"}
{"technique_id":"T1059.007","technique_name":"Command and Scripting Interpreter: JavaScript","description":"Adversaries may abuse various implementations of JavaScript for execution. JavaScript (JS) is a platform-independent scripting language (compiled just-in-time at runtime) commonly associated with scripts in webpages, though JS can be executed in runtime environments outside the browser. JScript is the Microsoft implementation of the same scripting standard. JScript is interpreted via the Windows Script engine and thus integrated with many components of Windows such as the Component Object Model and Internet Explorer HTML Application (HTA) pages. JavaScript for Automation (JXA) is a macOS scripting language based on JavaScript, included as part of Apple’s Open Scripting Architecture (OSA), that was introduced in OSX 10.10. Apple’s OSA provides scripting capabilities to control applications, interface with the operating system, and bridge access into the rest of Apple’s internal APIs. As of OSX 10.10, OSA only supports two languages, JXA and AppleScript. Scripts can be executed via the command line utility osascript, they can be compiled into applications or script files via osacompile, and they can be compiled and executed in memory of other programs by leveraging the OSAKit Framework. Adversaries may abuse various implementations of JavaScript to execute various behaviors. Common uses include hosting malicious scripts on websites as part of a Drive-by Compromise or downloading and executing these script files as secondary payloads. Since these payloads are text-based, it is also very common for adversaries to obfuscate their content as part of Obfuscated Files or Information.","detection":"Monitor for events associated with scripting execution, such as process activity, usage of the Windows Script Host (typically cscript.exe or wscript.exe), file activity involving scripts, or loading of modules associated with scripting languages (ex: JScript.dll). Scripting execution is likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for execution and subsequent behavior. Actions may be related to network and system information Discovery, Collection, or other programmable post-compromise behaviors and could be used as indicators of detection leading back to the source. Monitor for execution of JXA through osascript and usage of OSAScript API that may be related to other suspicious behavior occurring on the system. Understanding standard usage patterns is important to avoid a high number of false positives. If scripting is restricted for normal users, then any attempts to enable related components running on a system would be considered suspicious. If scripting is not commonly used on a system, but enabled, execution running out of cycle from patching or other administrator functions is suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.","procedures":["[S0622] AppleSeed: AppleSeed has the ability to use JavaScript to execute PowerShell.","[S0154] Cobalt Strike: The Cobalt Strike System Profiler can use JavaScript to perform reconnaissance actions.","[S0455] Metamorfo: Metamorfo includes payloads written in JavaScript.","[G0010] Turla: Turla has used various JavaScript-based backdoors.","[S1144] FRP: FRP can support the use of a JSON configuration file.","[G0050] APT32: APT32 has used JavaScript for drive-by downloads and C2 communications.","[G1031] Saint Bear: Saint Bear has delivered malicious Microsoft Office files containing an embedded JavaScript object that would, on execution, download and execute OutSteel and Saint Bot.","[S0228] NanHaiShu: NanHaiShu executes additional Jscript code on the victim's machine.","[G0037] FIN6: FIN6 has used malicious JavaScript to steal payment card data from e-commerce sites.","[G0121] Sidewinder: Sidewinder has used JavaScript to drop and execute malware loaders.","[S0650] QakBot: The QakBot web inject module can inject Java Script into web banking pages visited by the victim.","[S1180] BlackByte Ransomware: BlackByte Ransomware is distributed as a JavaScript launcher file.","[G1019] MoustachedBouncer: MoustachedBouncer has used JavaScript to deliver malware hosted on HTML pages.","[S0640] Avaddon: Avaddon has been executed through a malicious JScript downloader.","[G0069] MuddyWater: MuddyWater has used JavaScript files to execute its POWERSTATS payload.","[G1006] Earth Lusca: Earth Lusca has manipulated legitimate websites to inject malicious JavaScript code as part of their watering hole operations.","[S1183] StrelaStealer: StrelaStealer has been distributed as a malicious JavaScript object.","[S0417] GRIFFON: GRIFFON is written in and executed as JavaScript.","[G1037] TA577: TA577 has used JavaScript to execute additional malicious payloads.","[G1035] Winter Vivern: Winter Vivern delivered malicious JavaScript to exploit targets when exploiting Roundcube Webmail servers.","[G0091] Silence: Silence has used JS scripts.","[G0140] LazyScripter: LazyScripter has used JavaScript in its attacks.","[S1124] SocGholish: The SocGholish payload is executed as JavaScript.","[S0634] EnvyScout: EnvyScout can write files to disk with JavaScript using a modified version of the open-source tool FileSaver.","[S0476] Valak: Valak can execute JavaScript containing configuration data for establishing persistence.","[S1160] Latrodectus: Latrodectus has used JavaScript files as part its infection chain during malicious spam email campaigns.","[G0092] TA505: TA505 has used JavaScript for code execution.","[S0260] InvisiMole: InvisiMole can use a JavaScript file as part of its execution chain.","[S0373] Astaroth: Astaroth uses JavaScript to perform its core functionalities.","[G0046] FIN7: FIN7 used JavaScript scripts to help perform tasks on the victim's machine.","[S0648] JSS Loader: JSS Loader can download and execute JavaScript files.","[C0017] C0017: During C0017, APT41 deployed JScript web shells on compromised systems.","[S1116] WARPWIRE: WARPWIRE is a credential harvester written in JavaScript.","[S0695] Donut: Donut can generate shellcode outputs that execute via JavaScript or JScript.","[S0341] Xbash: Xbash can execute malicious JavaScript payloads on the victim’s machine.","[G0080] Cobalt Group: Cobalt Group has executed JavaScript scriptlets on the victim's machine.","[G0126] Higaisa: Higaisa used JavaScript to execute additional files.","[G0094] Kimsuky: Kimsuky has used JScript for logging and downloading additional tools. Kimsuky has used TRANSLATEXT, which contained four Javascript files for bypassing defenses, collecting sensitive information and screenshots, and exfiltrating data.","[S0283] jRAT: jRAT has been distributed as HTA files with JScript.","[S1138] Gootloader: Gootloader can execute a Javascript file for initial infection.","[S0646] SpicyOmelette: SpicyOmelette has the ability to execute arbitrary JavaScript code on a compromised host.","[C0037] Water Curupira Pikabot Distribution: Water Curupira Pikabot Distribution initial delivery included obfuscated JavaScript objects stored in password-protected ZIP archives.","[G0119] Indrik Spider: Indrik Spider has used malicious JavaScript files for several components of their attack.","[C0036] Pikabot Distribution February 2024: Pikabot Distribution February 2024 utilized obfuscated JavaScript files for initial Pikabot payload download.","[S0223] POWERSTATS: POWERSTATS can use JavaScript code for execution.","[G0021] Molerats: Molerats used various implants, including those built with JS, on target machines.","[S0631] Chaes: Chaes has used JavaScript and Node.Js information stealer script that exfiltrates data using the node process.","[G0077] Leafminer: Leafminer infected victims using JavaScript code.","[C0016] Operation Dust Storm: During Operation Dust Storm, the threat actors used JavaScript code.","[S0482] Bundlore: Bundlore can execute JavaScript by injecting it into the victim's browser.","[G1038] TA578: TA578 has used JavaScript files in malware execution chains.","[G0120] Evilnum: Evilnum has used malicious JavaScript files on the victim's machine.","[S0356] KONNI: KONNI has executed malicious JavaScript code.","[C0015] C0015: During C0015, the threat actors used a malicious HTA file that contained a mix of encoded HTML and JavaScript/VBScript code.","[G1033] Star Blizzard: Star Blizzard has used JavaScript to redirect victim traffic from an adversary controlled server to a server hosting the Evilginx phishing framework.","[S1075] KOPILUWAK: KOPILUWAK had used Javascript to perform its core functions.","[S0673] DarkWatchman: DarkWatchman uses JavaScript to perform its core functionalities."],"tactics":"TA0002 - Execution"}
{"technique_id":"T1059.008","technique_name":"Command and Scripting Interpreter: Network Device CLI","description":"Adversaries may abuse scripting or built-in command line interpreters (CLI) on network devices to execute malicious command and payloads. The CLI is the primary means through which users and administrators interact with the device in order to view system information, modify device operations, or perform diagnostic and administrative functions. CLIs typically contain various permission levels required for different commands. Scripting interpreters automate tasks and extend functionality beyond the command set included in the network OS. The CLI and scripting interpreter are accessible through a direct console connection, or through remote means, such as telnet or SSH. Adversaries can use the network CLI to change how network devices behave and operate. The CLI may be used to manipulate traffic flows to intercept or manipulate data, modify startup configuration parameters to load malicious system software, or to disable security features or logging to avoid detection.","detection":"Consider reviewing command history in either the console or as part of the running memory to determine if unauthorized or suspicious commands were used to modify device configuration. Consider comparing a copy of the network device configuration against a known-good version to discover unauthorized changes to the command interpreter. The same process can be accomplished through a comparison of the run-time memory, though this is non-trivial and may require assistance from the vendor.","procedures":["[S1186] Line Dancer: Line Dancer can execute native commands in networking device command line interfaces."],"tactics":"TA0002 - Execution"}
{"technique_id":"T1059.009","technique_name":"Command and Scripting Interpreter: Cloud API","description":"Adversaries may abuse cloud APIs to execute malicious commands. APIs available in cloud environments provide various functionalities and are a feature-rich method for programmatic access to nearly all aspects of a tenant. These APIs may be utilized through various methods such as command line interpreters (CLIs), in-browser Cloud Shells, PowerShell modules like Azure for PowerShell, or software developer kits (SDKs) available for languages such as Python. Cloud API functionality may allow for administrative access across all major services in a tenant such as compute, storage, identity and access management (IAM), networking, and security policies. With proper permissions (often via use of credentials such as Application Access Token and Web Session Cookie), adversaries may abuse cloud APIs to invoke various functions that execute malicious actions. For example, CLI and PowerShell functionality may be accessed through binaries installed on cloud-hosted or on-premises hosts or accessed through a browser-based cloud shell offered by many cloud platforms (such as AWS, Azure, and GCP). These cloud shells are often a packaged unified environment to use CLI and/or scripting modules hosted as a container in the cloud environment.","detection":null,"procedures":["[S1091] Pacu: Pacu leverages the AWS CLI for its operations.","[G0139] TeamTNT: TeamTNT has leveraged AWS CLI to enumerate cloud environments with compromised credentials.","[G0016] APT29: APT29 has leveraged the Microsoft Graph API to perform various actions across Azure and M365 environments. They have also utilized AADInternals PowerShell Modules to access the API"],"tactics":"TA0002 - Execution"}
{"technique_id":"T1059.010","technique_name":"Command and Scripting Interpreter: AutoHotKey & AutoIT","description":"Adversaries may execute commands and perform malicious tasks using AutoIT and AutoHotKey automation scripts. AutoIT and AutoHotkey (AHK) are scripting languages that enable users to automate Windows tasks. These automation scripts can be used to perform a wide variety of actions, such as clicking on buttons, entering text, and opening and closing programs. Adversaries may use AHK (`.ahk`) and AutoIT (`.au3`) scripts to execute malicious code on a victim's system. For example, adversaries have used for AHK to execute payloads and other modular malware such as keyloggers. Adversaries have also used custom AHK files containing embedded malware as Phishing payloads. These scripts may also be compiled into self-contained executable payloads (`.exe`).","detection":null,"procedures":["[S1213] Lumma Stealer: Lumma Stealer has utilized AutoIt malware scripts and AutoIt executables.","[S0530] Melcoz: Melcoz has been distributed through an AutoIt loader script.","[S1207] XLoader: XLoader can use an AutoIT script to decrypt a payload file, load it into victim memory, then execute it on the victim machine.","[S1017] OutSteel: OutSteel was developed using the AutoIT scripting language.","[G0087] APT39: APT39 has utilized AutoIt malware scripts embedded in Microsoft Office documents or malicious links.","[S1111] DarkGate: DarkGate uses AutoIt scripts dropped to a hidden directory during initial installation phases, such as `test.au3`."],"tactics":"TA0002 - Execution"}
{"technique_id":"T1059.011","technique_name":"Command and Scripting Interpreter: Lua","description":"Adversaries may abuse Lua commands and scripts for execution. Lua is a cross-platform scripting and programming language primarily designed for embedded use in applications. Lua can be executed on the command-line (through the stand-alone lua interpreter), via scripts (.lua), or from Lua-embedded programs (through the struct lua_State). Lua scripts may be executed by adversaries for malicious purposes. Adversaries may incorporate, abuse, or replace existing Lua interpreters to allow for malicious Lua command execution at runtime.","detection":null,"procedures":["[S0396] EvilBunny: EvilBunny has used Lua scripts to execute payloads.","[S0125] Remsec: Remsec can use modules written in Lua for execution.","[S1188] Line Runner: Line Runner utilizes Lua scripts for command execution.","[S0428] PoetRAT: PoetRAT has executed a Lua script through a Lua interpreter for Windows."],"tactics":"TA0002 - Execution"}
{"technique_id":"T1059.012","technique_name":"Command and Scripting Interpreter: Hypervisor CLI","description":"Adversaries may abuse hypervisor command line interpreters (CLIs) to execute malicious commands. Hypervisor CLIs typically enable a wide variety of functionality for managing both the hypervisor itself and the guest virtual machines it hosts. For example, on ESXi systems, tools such as `esxcli` and `vim-cmd` allow administrators to configure firewall rules and log forwarding on the hypervisor, list virtual machines, start and stop virtual machines, and more. Adversaries may be able to leverage these tools in order to support further actions, such as File and Directory Discovery or Data Encrypted for Impact.","detection":null,"procedures":["[S1096] Cheerscrypt: Cheerscrypt has leveraged `esxcli` in order to terminate running virtual machines.","[S1073] Royal: Royal ransomware uses `esxcli` to gather a list of running VMs and terminate them."],"tactics":"TA0002 - Execution"}
{"technique_id":"T1072","technique_name":"Software Deployment Tools","description":"Adversaries may gain access to and use centralized software suites installed within an enterprise to execute commands and move laterally through the network. Configuration management and software deployment applications may be used in an enterprise network or cloud environment for routine administration purposes. These systems may also be integrated into CI/CD pipelines. Examples of such solutions include: SCCM, HBSS, Altiris, AWS Systems Manager, Microsoft Intune, Azure Arc, and GCP Deployment Manager. Access to network-wide or enterprise-wide endpoint management software may enable an adversary to achieve remote code execution on all connected systems. The access may be used to laterally move to other systems, gather information, or cause a specific effect, such as wiping the hard drives on all endpoints. SaaS-based configuration management services may allow for broad Cloud Administration Command on cloud-hosted instances, as well as the execution of arbitrary commands on on-premises endpoints. For example, Microsoft Configuration Manager allows Global or Intune Administrators to run scripts as SYSTEM on on-premises devices joined to Entra ID. Such services may also utilize Web Protocols to communicate back to adversary owned infrastructure. Network infrastructure devices may also have configuration management tools that can be similarly abused by adversaries. The permissions required for this action vary by system configuration; local credentials may be sufficient with direct access to the third-party system, or specific domain credentials may be required. However, the system may require an administrative account to log in or to access specific functionality.","detection":"Detection methods will vary depending on the type of third-party software or system and how it is typically used. The same investigation process can be applied here as with other potentially malicious activities where the distribution vector is initially unknown but the resulting activity follows a discernible pattern. Analyze the process execution trees, historical activities from the third-party application (such as what types of files are usually pushed), and the resulting activities or events from the file/binary/script pushed to systems. Often these third-party applications will have logs of their own that can be collected and correlated with other data from the environment. Ensure that third-party application logs are on-boarded to the enterprise logging system and the logs are regularly reviewed. Audit software deployment logs and look for suspicious or unauthorized activity. A system not typically used to push software to clients that suddenly is used for such a task outside of a known admin function may be suspicious. Monitor account login activity on these applications to detect suspicious/abnormal usage. Perform application deployment at regular times so that irregular deployment activity stands out. Monitor process activity that does not correlate to known good software. Monitor account login activity on the deployment system.","procedures":["[G0050] APT32: APT32 compromised McAfee ePO to move laterally by distributing malware as a software deployment task.","[G0034] Sandworm Team: Sandworm Team has used the commercially available tool RemoteExec for agentless remote code execution.","[G0091] Silence: Silence has used RAdmin, a remote software tool used to remotely control workstations and ATMs.","[S0041] Wiper: It is believed that a patch management system for an anti-virus product commonly installed among targeted companies was used to distribute the Wiper malware.","[G0028] Threat Group-1314: Threat Group-1314 actors used a victim's endpoint management platform, Altiris, for lateral movement.","[C0018] C0018: During C0018, the threat actors used PDQ Deploy to move AvosLocker and tools across the network."],"tactics":"TA0002 - Execution"}
{"technique_id":"T1106","technique_name":"Native API","description":"Adversaries may interact with the native OS application programming interface (API) to execute behaviors. Native APIs provide a controlled means of calling low-level OS services within the kernel, such as those involving hardware/devices, memory, and processes. These native APIs are leveraged by the OS during system boot (when other system components are not yet initialized) as well as carrying out tasks and requests during routine operations. Adversaries may abuse these OS API functions as a means of executing behaviors. Similar to Command and Scripting Interpreter, the native API and its hierarchy of interfaces provide mechanisms to interact with and utilize various components of a victimized system. Native API functions (such as NtCreateProcess) may be directed invoked via system calls / syscalls, but these features are also often exposed to user-mode applications via interfaces and libraries. For example, functions such as the Windows API CreateProcess() or GNU fork() will allow programs and scripts to start other processes. This may allow API callers to execute a binary, run a CLI command, load modules, etc. as thousands of similar API functions exist for various system operations. Higher level software frameworks, such as Microsoft .NET and macOS Cocoa, are also available to interact with native APIs. These frameworks typically provide language wrappers/abstractions to API functionalities and are designed for ease-of-use/portability of code. Adversaries may use assembly to directly or in-directly invoke syscalls in an attempt to subvert defensive sensors and detection signatures such as user mode API-hooks. Adversaries may also attempt to tamper with sensors and defensive tools associated with API monitoring, such as unhooking monitored functions via Disable or Modify Tools.","detection":"Monitoring API calls may generate a significant amount of data and may not be useful for defense unless collected under specific circumstances, since benign use of API functions are common and may be difficult to distinguish from malicious behavior. Correlation of other events with behavior surrounding API function calls using API monitoring will provide additional context to an event that may assist in determining if it is due to malicious behavior. Correlation of activity by process lineage by process ID may be sufficient. Utilization of the Windows APIs may involve processes loading/accessing system DLLs associated with providing called functions (ex: ntdll.dll, kernel32.dll, advapi32.dll, user32.dll, and gdi32.dll). Monitoring for DLL loads, especially to abnormal/unusual or potentially malicious processes, may indicate abuse of the Windows API. Though noisy, this data can be combined with other indicators to identify adversary activity.","procedures":["[S0396] EvilBunny: EvilBunny has used various API calls as part of its checks to see if the malware is running in a sandbox.","[S1179] Exbyte: Exbyte calls `ShellExecuteW` with the `IpOperation` parameter `RunAs` to launch `explorer.exe` with elevated privileges.","[S0141] Winnti for Windows: Winnti for Windows can use Native API to create a new process and to start services.","[S0453] Pony: Pony has used several Windows functions for various purposes.","[S0687] Cyclops Blink: Cyclops Blink can use various Linux API functions including those for execution and discovery.","[S0268] Bisonal: Bisonal has used the Windows API to communicate with the Service Control Manager to execute a thread.","[S0084] Mis-Type: Mis-Type has used Windows API calls, including `NetUserAdd` and `NetUserDel`.","[S0678] Torisma: Torisma has used various Windows API calls.","[S0627] SodaMaster: SodaMaster can use RegOpenKeyW to access the Registry.","[S0629] RainyDay: The file collection tool used by RainyDay can utilize native API including ReadDirectoryChangeW for folder monitoring.","[S0154] Cobalt Strike: Cobalt Strike's Beacon payload is capable of running shell commands without cmd.exe and PowerShell commands without powershell.exe","[S1013] ZxxZ: ZxxZ has used API functions such as `Process32First`, `Process32Next`, and `ShellExecuteA`.","[S0610] SideTwist: SideTwist can use GetUserNameW, GetComputerNameW, and GetComputerNameExW to gather information.","[C0022] Operation Dream Job: During Operation Dream Job, Lazarus Group used Windows API `ObtainUserAgentString` to obtain the victim's User-Agent and used the value to connect to their C2 server.","[S1087] AsyncRAT: AsyncRAT has the ability to use OS APIs including `CheckRemoteDebuggerPresent`.","[S0434] Imminent Monitor: Imminent Monitor has leveraged CreateProcessW() call to execute the debugger.","[S0638] Babuk: Babuk can use multiple Windows API calls for actions on compromised hosts including discovery and execution.","[S0625] Cuba: Cuba has used several built-in API functions for discovery like GetIpNetTable and NetShareEnum.","[S0022] Uroburos: Uroburos can use native Windows APIs including `GetHostByName`.","[G0126] Higaisa: Higaisa has called various native OS APIs.","[S0650] QakBot: QakBot can use GetProcAddress to help delete malicious strings from memory.","[S0611] Clop: Clop has used built-in API functions such as WNetOpenEnumW(), WNetEnumResourceW(), WNetCloseEnum(), GetProcAddress(), and VirtualAlloc().","[S0456] Aria-body: Aria-body has the ability to launch files using ShellExecute.","[S0446] Ryuk: Ryuk has used multiple native APIs including ShellExecuteW to run executables,GetWindowsDirectoryW to create folders, and VirtualAlloc, WriteProcessMemory, and CreateRemoteThread for process injection.","[S0384] Dridex: Dridex has used the OutputDebugStringW function to avoid malware analysis as part of its anti-debugging technique.","[S0668] TinyTurla: TinyTurla has used `WinHTTP`, `CreateProcess`, and other APIs for C2 communications and other functions.","[S1053] AvosLocker: AvosLocker has used a variety of Windows API calls, including `NtCurrentPeb` and `GetLogicalDrives`.","[S0475] BackConfig: BackConfig can leverage API functions such as ShellExecuteA and HttpOpenRequestA in the process of downloading and executing files.","[S0607] KillDisk: KillDisk has called the Windows API to retrieve the hard disk handle and shut down the machine.","[S0466] WindTail: WindTail can invoke Apple APIs contentsOfDirectoryAtPath, pathExtension, and (string) compare.","[S0386] Ursnif: Ursnif has used CreateProcessW to create child processes.","[S0147] Pteranodon: Pteranodon has used various API calls.","[S1034] StrifeWater: StrifeWater can use a variety of APIs for execution.","[S0458] Ramsay: Ramsay can use Windows API functions such as WriteFile, CloseHandle, and GetCurrentHwProfile during its collection and file storage operations. Ramsay can execute its embedded components via CreateProcessA and ShellExecute.","[S0631] Chaes: Chaes used the CreateFileW() API function with read permissions to access downloaded payloads.","[S1025] Amadey: Amadey has used a variety of Windows API calls, including `GetComputerNameA`, `GetUserNameA`, and `CreateProcessA`.","[C0006] Operation Honeybee: During Operation Honeybee, the threat actors deployed malware that used API calls, including `CreateProcessAsUser`.","[S0266] TrickBot: TrickBot uses the Windows API call, CreateProcessW(), to manage execution flow. TrickBot has also used Nt* API functions to perform Process Injection.","[S1090] NightClub: NightClub can use multiple native APIs including `GetKeyState`, `GetForegroundWindow`, `GetWindowThreadProcessId`, and `GetKeyboardLayout`.","[G0032] Lazarus Group: Lazarus Group has used the Windows API ObtainUserAgentString to obtain the User-Agent from a compromised host to connect to a C2 server. Lazarus Group has also used various, often lesser known, functions to perform various types of Discovery and Process Injection.","[S0652] MarkiRAT: MarkiRAT can run the ShellExecuteW API via the Windows Command Shell.","[G0078] Gorgon Group: Gorgon Group malware can leverage the Windows API call, CreateProcessA(), for execution.","[S1139] INC Ransomware: INC Ransomware can use the API `DeviceIoControl` to resize the allocated space for and cause the deletion of volume shadow copy snapshots.","[S1152] IMAPLoader: IMAPLoader imports native Windows APIs such as `GetConsoleWindow` and `ShowWindow`.","[S0651] BoxCaon: BoxCaon has used Windows API calls to obtain information about the compromised host.","[G0010] Turla: Turla and its RPC backdoors have used APIs calls for various tasks related to subverting AMSI and accessing then executing commands through RPC and/or named pipes.","[S0011] Taidoor: Taidoor has the ability to use native APIs for execution including GetProcessHeap, GetProcAddress, and LoadLibrary.","[S1149] CHIMNEYSWEEP: CHIMNEYSWEEP can use Windows APIs including `LoadLibrary` and `GetProcAddress`.","[S0455] Metamorfo: Metamorfo has used native WINAPI calls.","[G0114] Chimera: Chimera has used direct Windows system calls by leveraging Dumpert.","[S1078] RotaJakiro: When executing with non-root permissions, RotaJakiro uses the the `shmget` API to create shared memory between other known RotaJakiro processes. RotaJakiro also uses the `execvp` API to help its dead process \"resurrect\".","[S0615] SombRAT: SombRAT has the ability to respawn itself using ShellExecuteW and CreateProcessW.","[S0471] build_downer: build_downer has the ability to use the WinExec API to execute malware on a compromised host.","[S0681] Lizar: Lizar has used various Windows API functions on a victim's machine.","[S0240] ROKRAT: ROKRAT can use a variety of API calls to execute shellcode.","[S1210] Sagerunex: Sagerunex calls the `WaitForSingleObject` API function as part of time-check logic.","[S0385] njRAT: njRAT has used the ShellExecute() function within a script.","[S1202] LockBit 3.0: LockBit 3.0 has the ability to directly call native Windows API items during execution.","[S0180] Volgmer: Volgmer executes payloads using the Windows API call CreateProcessW().","[S0499] Hancitor: Hancitor has used CallWindowProc and EnumResourceTypesA to interpret and execute shellcode.","[S0640] Avaddon: Avaddon has used the Windows Crypto API to generate an AES key.","[S0689] WhisperGate: WhisperGate has used the `ExitWindowsEx` to flush file buffers to disk and stop running processes and other API calls.","[S1170] ODAgent: ODAgent can pass commands using native APIs.","[S1122] Mispadu: Mispadu has used a variety of Windows API calls, including ShellExecute and WriteProcessMemory.","[G0098] BlackTech: BlackTech has used built-in API functions.","[S0561] GuLoader: GuLoader can use a number of different APIs for discovery and execution.","[G0034] Sandworm Team: Sandworm Team uses Prestige to disable and restore file system redirection by using the following functions: `Wow64DisableWow64FsRedirection()` and `Wow64RevertWow64FsRedirection()`.","[S0554] Egregor: Egregor has used the Windows API to make detection more difficult.","[S1100] Ninja: The Ninja loader can call Windows APIs for discovery, process injection, and payload decryption.","[S1018] Saint Bot: Saint Bot has used different API calls, including `GetProcAddress`, `VirtualAllocEx`, `WriteProcessMemory`, `CreateProcessA`, and `SetThreadContext`.","[G1008] SideCopy: SideCopy has executed malware by calling the API function `CreateProcessW`.","[S0518] PolyglotDuke: PolyglotDuke can use LoadLibraryW and CreateProcess to load and execute code.","[S0496] REvil: REvil can use Native API for execution and to retrieve active services.","[S1052] DEADEYE: DEADEYE can execute the `GetComputerNameA` and `GetComputerNameExA` WinAPI functions.","[C0014] Operation Wocao: During Operation Wocao, threat actors used the `CreateProcessA` and `ShellExecute` API functions to launch commands after being injected into a selected process.","[S0512] FatDuke: FatDuke can call ShellExecuteW to open the default browser on the URL localhost.","[S0242] SynAck: SynAck parses the export tables of system DLLs to locate and call various Windows API functions.","[S0632] GrimAgent: GrimAgent can use Native API including GetProcAddress and ShellExecuteW.","[S1033] DCSrv: DCSrv has used various Windows API functions, including `DeviceIoControl`, as part of its encryption process.","[S0537] HyperStack: HyperStack can use Windows API's ConnectNamedPipe and WNetAddConnection2 to detect incoming connections and connect to remote shares.","[S1081] BADHATCH: BADHATCH can utilize Native API functions such as, `ToolHelp32` and `Rt1AdjustPrivilege` to enable `SeDebugPrivilege` on a compromised machine.","[S0449] Maze: Maze has used several Windows API functions throughout the encryption process including IsDebuggerPresent, TerminateProcess, Process32FirstW, among others.","[S1145] Pikabot: Pikabot uses native Windows APIs to determine if the process is being debugged and analyzed, such as `CheckRemoteDebuggerPresent`, `NtQueryInformationProcess`, `ProcessDebugPort`, and `ProcessDebugFlags`. Other Pikabot variants populate a global list of Windows API addresses from the `NTDLL` and `KERNEL32` libraries, and references these items instead of calling the API items to obfuscate execution.","[S1151] ZeroCleare: ZeroCleare can call the `GetSystemDirectoryW` API to locate the system directory.","[S0239] Bankshot: Bankshot creates processes using the Windows API calls: CreateProcessA() and CreateProcessAsUserA().","[S0431] HotCroissant: HotCroissant can perform dynamic DLL importing and API lookups using LoadLibrary and GetProcAddress on obfuscated strings.","[S0688] Meteor: Meteor can use `WinAPI` to remove a victim machine from an Active Directory domain.","[G0081] Tropic Trooper: Tropic Trooper has used multiple Windows APIs including HttpInitialize, HttpCreateHttpHandle, and HttpAddUrl.","[S1059] metaMain: metaMain can execute an operator-provided Windows command by leveraging functions such as `WinExec`, `WriteFile`, and `ReadFile`.","[S0630] Nebulae: Nebulae has the ability to use CreateProcess to execute a process.","[S1016] MacMa: MacMa has used macOS API functions to perform tasks.","[G1022] ToddyCat: ToddyCat has used `WinExec` to execute commands received from C2 on compromised hosts.","[S0662] RCSession: RCSession can use WinSock API for communication including WSASend and WSARecv.","[S0259] InnaputRAT: InnaputRAT uses the API call ShellExecuteW for execution.","[G0045] menuPass: menuPass has used native APIs including GetModuleFileName, lstrcat, CreateFile, and ReadFile.","[S0493] GoldenSpy: GoldenSpy can execute remote commands in the Windows command shell using the WinExec() API.","[S0126] ComRAT: ComRAT can load a PE file from memory or the file system and execute it with CreateProcessW.","[G0067] APT37: APT37 leverages the Windows API calls: VirtualAlloc(), WriteProcessMemory(), and CreateRemoteThread() for process injection.","[S0363] Empire: Empire contains a variety of enumeration modules that have an option to use API calls to carry out tasks.","[S1200] StealBit: StealBit can use native APIs including `LoadLibraryExA` for execution and `NtSetInformationProcess` for defense evasion purposes.","[S0661] FoggyWeb: FoggyWeb's loader can use API functions to load the FoggyWeb backdoor into the same Application Domain within which the legitimate AD FS managed code is executed.","[S1207] XLoader: XLoader uses the native Windows API for functionality, including defense evasion.","[S0680] LitePower: LitePower can use various API calls.","[C0013] Operation Sharpshooter: During Operation Sharpshooter, the first stage downloader resolved various Windows libraries and APIs, including `LoadLibraryA()`, `GetProcAddress()`, and `CreateProcessA()`.","[S0483] IcedID: IcedID has called ZwWriteVirtualMemory, ZwProtectVirtualMemory, ZwQueueApcThread, and NtResumeThread to inject itself into a remote process.","[S1039] Bumblebee: Bumblebee can use multiple Native APIs.","[S0521] BloodHound: BloodHound can use .NET API calls in the SharpHound ingestor component to pull Active Directory data.","[S0698] HermeticWizard: HermeticWizard can connect to remote shares using `WNetAddConnection2W`.","[S0692] SILENTTRINITY: SILENTTRINITY has the ability to leverage API including `GetProcAddress` and `LoadLibrary`.","[S0622] AppleSeed: AppleSeed has the ability to use multiple dynamically resolved API calls.","[S0697] HermeticWiper: HermeticWiper can call multiple Windows API functions used for privilege escalation, service execution, and to overwrite random bites of data.","[S0356] KONNI: KONNI has hardcoded API calls within its functions to use on the victim's machine.","[S1160] Latrodectus: Latrodectus has used multiple Windows API post exploitation including `GetAdaptersInfo`, `CreateToolhelp32Snapshot`, and `CreateProcessW`.","[S1020] Kevin: Kevin can use the `ShowWindow` API to avoid detection.","[S0694] DRATzarus: DRATzarus can use various API calls to see if it is running in a sandbox.","[S1058] Prestige: Prestige has used the `Wow64DisableWow64FsRedirection()` and `Wow64RevertWow64FsRedirection()` functions to disable and restore file system redirection.","[S1064] SVCReady: SVCReady can use Windows API calls to gather information from an infected host.","[S0032] gh0st RAT: gh0st RAT has used the `InterlockedExchange`, `SeShutdownPrivilege`, and `ExitWindowsEx` Windows API functions.","[S0517] Pillowmint: Pillowmint has used multiple native Windows APIs to execute and conduct process injections.","[S0148] RTM: RTM can use the FindNextUrlCacheEntryA and FindFirstUrlCacheEntryA functions to search for specific strings within browser history.","[S1015] Milan: Milan can use the API `DnsQuery_A` for DNS resolution.","[S0562] SUNSPOT: SUNSPOT used Windows API functions such as MoveFileEx and NtQueryInformationProcess as part of the SUNBURST injection process.","[G0047] Gamaredon Group: Gamaredon Group malware has used CreateProcess to launch additional malicious components.","[S0670] WarzoneRAT: WarzoneRAT can use a variety of API calls on a compromised host.","[S0695] Donut: Donut code modules use various API functions to load and inject code.","[S0574] BendyBear: BendyBear can load and execute modules and Windows Application Programming (API) calls using standard shellcode API hashing.","[S0667] Chrommme: Chrommme can use Windows API including `WinExec` for execution.","[S1129] Akira: Akira executes native Windows functions such as GetFileAttributesW and `GetSystemInfo`.","[S0354] Denis: Denis used the IsDebuggerPresent, OutputDebugString, and SetLastError APIs to avoid debugging. Denis used GetProcAddress and LoadLibrary to dynamically resolve APIs. Denis also used the Wow64SetThreadContext API as part of a process hollowing process.","[S1111] DarkGate: DarkGate uses the native Windows API CallWindowProc() to decode and launch encoded shellcode payloads during execution. DarkGate can call kernel mode functions directly to hide the use of process hollowing methods during execution. DarkGate has also used the `CreateToolhelp32Snapshot`, `GetFileAttributesA` and `CreateProcessA` functions to obtain a list of running processes, to check for security products and to execute its malware.","[S0457] Netwalker: Netwalker can use Windows API functions to inject the ransomware DLL.","[S0447] Lokibot: Lokibot has used LoadLibrary(), GetProcAddress() and CreateRemoteThread() API functions to execute its shellcode.","[S0612] WastedLocker: WastedLocker's custom crypter, CryptOne, leveraged the VirtualAlloc() API function to help execute the payload.","[S0395] LightNeuron: LightNeuron is capable of starting a process using CreateProcess.","[S1085] Sardonic: Sardonic has the ability to call Win32 API functions to determine if `powershell.exe` is running.","[S0569] Explosive: Explosive has a function to call the OpenClipboard wrapper.","[S1066] DarkTortilla: DarkTortilla can use a variety of API calls for persistence and defense evasion.","[S1065] Woody RAT: Woody RAT can use multiple native APIs, including `WriteProcessMemory`, `CreateProcess`, and `CreateRemoteThread` for process injection.","[S0606] Bad Rabbit: Bad Rabbit has used various Windows API calls.","[S1063] Brute Ratel C4: Brute Ratel C4 can call multiple Windows APIs for execution, to share memory, and defense evasion.","[S0659] Diavol: Diavol has used several API calls like `GetLogicalDriveStrings`, `SleepEx`, `SystemParametersInfoAPI`, `CryptEncrypt`, and others to execute parts of its attack.","[S1044] FunnyDream: FunnyDream can use Native API for defense evasion, discovery, and collection.","[S0398] HyperBro: HyperBro has the ability to run an application (CreateProcessW) or script/file (ShellExecuteW) via API.","[S0416] RDFSNIFFER: RDFSNIFFER has used several Win32 API functions to interact with the victim machine.","[S0234] Bandook: Bandook has used the ShellExecuteW() function call.","[S0444] ShimRat: ShimRat has used Windows API functions to install the service and shim.","[S0669] KOCTOPUS: KOCTOPUS can use the `LoadResource` and `CreateProcessW` APIs for execution.","[S0576] MegaCortex: After escalating privileges, MegaCortex calls TerminateProcess(), CreateRemoteThread, and other Win32 APIs.","[S1076] QUIETCANARY: QUIETCANARY can call `System.Net.HttpWebRequest` to identify the default proxy configured on the victim computer.","[S0198] NETWIRE: NETWIRE can use Native API including CreateProcess GetProcessById, and WriteProcessMemory.","[S1180] BlackByte Ransomware: BlackByte Ransomware uses the `SetThreadExecutionState` API to prevent the victim system from entering sleep.","[S0435] PLEAD: PLEAD can use `ShellExecute` to execute applications.","[S0477] Goopy: Goopy has the ability to enumerate the infected system's user name via GetUserNameW.","[S0085] S-Type: S-Type has used Windows APIs, including `GetKeyboardType`, `NetUserAdd`, and `NetUserDel`.","[S0653] xCaon: xCaon has leveraged native OS function calls to retrieve victim's network adapter's information using GetAdapterInfo() API.","[S0484] Carberp: Carberp has used the NtQueryDirectoryFile and ZwQueryDirectoryFile functions to hide files and directories.","[G0082] APT38: APT38 has used the Windows API to execute code within a victim's system.","[S1060] Mafalda: Mafalda can use a variety of API calls.","[S0045] ADVSTORESHELL: ADVSTORESHELL is capable of starting a process using CreateProcess.","[S0666] Gelsemium: Gelsemium has the ability to use various Windows API functions to perform tasks.","[S1073] Royal: Royal can use multiple APIs for discovery, communication, and execution.","[S0531] Grandoreiro: Grandoreiro can execute through the WinExec API.","[S0696] Flagpro: Flagpro can use Native API to enable obfuscation including `GetLastError` and `GetTickCount`.","[S1070] Black Basta: Black Basta has the ability to use native APIs for numerous functions including discovery and defense evasion.","[S0128] BADNEWS: BADNEWS has a command to download an .exe and execute it via CreateProcess API. It can also run with ShellExecute.","[S0603] Stuxnet: Stuxnet uses the SetSecurityDescriptorDacl API to reduce object integrity levels.","[G0092] TA505: TA505 has deployed payloads that use Windows API calls on a compromised host.","[S1190] Kapeka: Kapeka utilizes WinAPI calls to gather victim system information.","[S1169] Mango: Mango has the ability to use Native APIs.","[S1050] PcShare: PcShare has used a variety of Windows API functions.","[S0595] ThiefQuest: ThiefQuest uses various API to perform behaviors such as executing payloads and performing local enumeration.","[S0013] PlugX: PlugX can use the Windows API functions `GetProcAddress`, `LoadLibrary`, and `CreateProcess` to execute another process.","[S0579] Waterbear: Waterbear can leverage API functions for execution.","[S0501] PipeMon: PipeMon's first stage has been executed by a call to CreateProcess with the decryption password in an argument. PipeMon has used a call to LoadLibrary to load its installer.","[S0663] SysUpdate: SysUpdate can call the `GetNetworkParams` API as part of its C2 establishment process.","[S1089] SharpDisco: SharpDisco can leverage Native APIs through plugins including `GetLogicalDrives`.","[S0534] Bazar: Bazar can use various APIs to allocate memory and facilitate code execution/injection.","[S0693] CaddyWiper: CaddyWiper has the ability to dynamically resolve and use APIs, including `SeTakeOwnershipPrivilege`.","[S0412] ZxShell: ZxShell can leverage native API including RegisterServiceCtrlHandler to register a service.RegisterServiceCtrlHandler","[S0391] HAWKBALL: HAWKBALL has leveraged several Windows API calls to create processes, gather disk information, and detect debugger activity.","[S0448] Rising Sun: Rising Sun used dynamic API resolutions to various Windows APIs by leveraging `LoadLibrary()` and `GetProcAddress()`.","[S0256] Mosquito: Mosquito leverages the CreateProcess() and LoadLibrary() calls to execute files with the .dll and .exe extensions.","[S0438] Attor: Attor's dispatcher has used CreateProcessW API for execution.","[S0614] CostaBricks: CostaBricks has used a number of API calls, including `VirtualAlloc`, `VirtualFree`, `LoadLibraryA`, `GetProcAddress`, and `ExitProcess`.","[S0445] ShimRatReporter: ShimRatReporter used several Windows API functions to gather information from the infected system.","[S0570] BitPaymer: BitPaymer has used dynamic API resolution to avoid identifiable strings within the binary, including RegEnumKeyW.","[S0623] Siloscape: Siloscape makes various native API calls.","[S0470] BBK: BBK has the ability to use the CreatePipe API to add a sub-process for execution via cmd.","[S0575] Conti: Conti has used API calls during execution.","[S0367] Emotet: Emotet has used `CreateProcess` to create a new process to run its executable and `WNetEnumResourceW` to enumerate non-hidden shares.","[S0161] XAgentOSX: XAgentOSX contains the execFile function to execute a specified file on the system using the NSTask:launch method.","[S1099] Samurai: Samurai has the ability to call Windows APIs.","[S1172] OilBooster: OilBooster has used the `ShowWindow` and `CreateProcessW` APIs.","[S0260] InvisiMole: InvisiMole can use winapiexec tool for indirect execution of ShellExecuteW and CreateProcessA.","[S0083] Misdat: Misdat has used Windows APIs, including `ExitWindowsEx` and `GetKeyboardType`.","[G0091] Silence: Silence has leveraged the Windows API, including using CreateProcess() or ShellExecute(), to perform a variety of tasks."],"tactics":"TA0002 - Execution"}