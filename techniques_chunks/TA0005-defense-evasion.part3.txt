{"technique_id":"T1055.014","technique_name":"Process Injection: VDSO Hijacking","description":"Adversaries may inject malicious code into processes via VDSO hijacking in order to evade process-based defenses as well as possibly elevate privileges. Virtual dynamic shared object (vdso) hijacking is a method of executing arbitrary code in the address space of a separate live process. VDSO hijacking involves redirecting calls to dynamically linked shared libraries. Memory protections may prevent writing executable code to a process via Ptrace System Calls. However, an adversary may hijack the syscall interface code stubs mapped into a process from the vdso shared object to execute syscalls to open and map a malicious shared object. This code can then be invoked by redirecting the execution flow of the process via patched memory address references stored in a process' global offset table (which store absolute addresses of mapped library functions). Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via VDSO hijacking may also evade detection from security products since the execution is masked under a legitimate process.","detection":"Monitor for malicious usage of system calls, such as ptrace and mmap, that can be used to attach to, manipulate memory, then redirect a processes' execution path. Monitoring for Linux specific calls such as the ptrace system call should not generate large amounts of data due to their specialized nature, and can be a very effective method to detect some of the common process injection methods. Analyze process behavior to determine if a process is performing actions it usually does not, such as opening network connections, reading files, or other suspicious actions that could relate to post-compromise behavior.","procedures":null,"tactics":"TA0005 - Defense Evasion"}
{"technique_id":"T1055.015","technique_name":"Process Injection: ListPlanting","description":"Adversaries may abuse list-view controls to inject malicious code into hijacked processes in order to evade process-based defenses as well as possibly elevate privileges. ListPlanting is a method of executing arbitrary code in the address space of a separate live process. Code executed via ListPlanting may also evade detection from security products since the execution is masked under a legitimate process. List-view controls are user interface windows used to display collections of items. Information about an application's list-view settings are stored within the process' memory in a SysListView32 control. ListPlanting (a form of message-passing \"shatter attack\") may be performed by copying code into the virtual address space of a process that uses a list-view control then using that code as a custom callback for sorting the listed items. Adversaries must first copy code into the target process’ memory space, which can be performed various ways including by directly obtaining a handle to the SysListView32 child of the victim process window (via Windows API calls such as FindWindow and/or EnumWindows) or other Process Injection methods. Some variations of ListPlanting may allocate memory in the target process but then use window messages to copy the payload, to avoid the use of the highly monitored WriteProcessMemory function. For example, an adversary can use the PostMessage and/or SendMessage API functions to send LVM_SETITEMPOSITION and LVM_GETITEMPOSITION messages, effectively copying a payload 2 bytes at a time to the allocated memory. Finally, the payload is triggered by sending the LVM_SORTITEMS message to the SysListView32 child of the process window, with the payload within the newly allocated buffer passed and executed as the ListView_SortItems callback.","detection":"Monitoring Windows API calls indicative of the various types of code injection may generate a significant amount of data and may not be directly useful for defense unless collected under specific circumstances for known bad sequences of calls, since benign use of API functions may be common and difficult to distinguish from malicious behavior. Windows API calls such as FindWindow, FindWindowEx, EnumWindows, EnumChildWindows, and those that can be used to modify memory within another process, such as VirtualAllocEx/WriteProcessMemory, may be abused for this technique. Consider monitoring for excessive use of SendMessage and/or PostMessage API functions with LVM_SETITEMPOSITION and/or LVM_GETITEMPOSITION arguments. Analyze process behavior to determine if a process is performing unusual actions, such as opening network connections, reading files, or other suspicious actions that could relate to post-compromise behavior.","procedures":["[S0260] InvisiMole: InvisiMole has used ListPlanting to inject code into a trusted process."],"tactics":"TA0005 - Defense Evasion"}
{"technique_id":"T1070.001","technique_name":"Indicator Removal: Clear Windows Event Logs","description":"Adversaries may clear Windows Event Logs to hide the activity of an intrusion. Windows Event Logs are a record of a computer's alerts and notifications. There are three system-defined sources of events: System, Application, and Security, with five event types: Error, Warning, Information, Success Audit, and Failure Audit. With administrator privileges, the event logs can be cleared with the following utility commands: * wevtutil cl system * wevtutil cl application * wevtutil cl security These logs may also be cleared through other mechanisms, such as the event viewer GUI or PowerShell. For example, adversaries may use the PowerShell command Remove-EventLog -LogName Security to delete the Security EventLog and after reboot, disable future logging. Note: events may still be generated and logged in the .evtx file between the time the command is run and the reboot. Adversaries may also attempt to clear logs by directly deleting the stored log files within `C:\\Windows\\System32\\winevt\\logs\\`.","detection":"Deleting Windows event logs (via native binaries , API functions , or PowerShell ) may also generate an alterable event (Event ID 1102: \"The audit log was cleared\").","procedures":["[S1202] LockBit 3.0: LockBit 3.0 can delete log files on targeted systems.","[S0688] Meteor: Meteor can use Wevtutil to remove Security, System and Application Event Viewer logs.","[G0061] FIN8: FIN8 has cleared logs during post compromise cleanup activities.","[S0242] SynAck: SynAck clears event logs.","[S0368] NotPetya: NotPetya uses wevtutil to clear the Windows event logs.","[S1212] RansomHub: RansomHub can delete events from the Security, System, and Application logs.","[S1178] ShrinkLocker: ShrinkLocker calls Wevtutil to clear the Windows PowerShell and Microsoft-Windows-Powershell/Operational logs.","[S1060] Mafalda: Mafalda can delete Windows Event logs by invoking the `OpenEventLogW` and `ClearEventLogW` functions.","[G1017] Volt Typhoon: Volt Typhoon has selectively cleared Windows Event Logs, system logs, and other technical artifacts to remove evidence of intrusion activity.","[S0645] Wevtutil: Wevtutil can be used to clear system and security event logs from the system.","[G0114] Chimera: Chimera has cleared event logs on compromised hosts.","[G0143] Aquatic Panda: Aquatic Panda clears Windows Event Logs following activity to evade defenses.","[G0007] APT28: APT28 has cleared event logs, including by using the commands wevtutil cl System and wevtutil cl Security.","[G0096] APT41: APT41 attempted to remove evidence of some of its activity by clearing Windows security and system events.","[S0532] Lucifer: Lucifer can clear and remove event logs.","[S0365] Olympic Destroyer: Olympic Destroyer will attempt to clear the System and Security event logs using wevtutil.","[G0119] Indrik Spider: Indrik Spider has used Cobalt Strike to empty log files. Additionally, Indrik Spider has cleared all event logs using `wevutil`.","[G0082] APT38: APT38 clears Window Event logs and Sysmon logs from the system.","[G0035] Dragonfly: Dragonfly has cleared Windows event logs and other logs produced by tools they used, including system, security, terminal services, remote services, and audit logs. The actors also deleted specific Registry keys.","[S0182] FinFisher: FinFisher clears the system event logs using OpenEventLog/ClearEventLog APIs .","[S1068] BlackCat: BlackCat can clear Windows event logs using `wevtutil.exe`.","[S0412] ZxShell: ZxShell has a command to clear system event logs.","[S0698] HermeticWizard: HermeticWizard has the ability to use `wevtutil cl system` to clear event logs.","[G0050] APT32: APT32 has cleared select event log entries.","[S1199] LockBit 2.0: LockBit 2.0 can delete log files through the use of wevtutil.","[S0607] KillDisk: KillDisk deletes Application, Security, Setup, and System Windows Event Logs.","[G0053] FIN5: FIN5 has cleared event logs from victims.","[G0125] HAFNIUM: HAFNIUM has cleared actor-performed actions from logs.","[S0032] gh0st RAT: gh0st RAT is able to wipe event logs.","[S0203] Hydraq: Hydraq creates a backdoor through which remote attackers can clear all system event logs.","[S1135] MultiLayer Wiper: MultiLayer Wiper removes Windows event logs during execution.","[S1159] DUSTTRAP: DUSTTRAP can delete infected system log information.","[S1133] Apostle: Apostle will attempt to delete all event logs on a victim machine following file wipe activity.","[S0192] Pupy: Pupy has a module to clear event logs with PowerShell.","[S0253] RunningRAT: RunningRAT contains code to clear event logs.","[S0089] BlackEnergy: The BlackEnergy component KillDisk is capable of deleting Windows Event Logs.","[C0014] Operation Wocao: During Operation Wocao, the threat actors deleted all Windows system and security event logs using `/Q /c wevtutil cl system` and `/Q /c wevtutil cl security`.","[S0697] HermeticWiper: HermeticWiper can overwrite the `C:\\Windows\\System32\\winevt\\Logs` file on a targeted system.","[G1040] Play: Play has used tools to remove log files on targeted systems."],"tactics":"TA0005 - Defense Evasion"}
{"technique_id":"T1070.002","technique_name":"Indicator Removal: Clear Linux or Mac System Logs","description":"Adversaries may clear system logs to hide evidence of an intrusion. macOS and Linux both keep track of system or user-initiated actions via system logs. The majority of native system logging is stored under the /var/log/ directory. Subfolders in this directory categorize logs by their related functions, such as: * /var/log/messages:: General and system-related messages * /var/log/secure or /var/log/auth.log: Authentication logs * /var/log/utmp or /var/log/wtmp: Login records * /var/log/kern.log: Kernel logs * /var/log/cron.log: Crond logs * /var/log/maillog: Mail server logs * /var/log/httpd/: Web server access and error logs","detection":"File system monitoring may be used to detect improper deletion or modification of indicator files. Also monitor for suspicious processes interacting with log files.","procedures":["[S1164] UPSTYLE: UPSTYLE clears error logs after reading embedded commands for execution.","[S1206] JumbledPath: JumbledPath can clear logs on all devices used along its connection path to compromised network infrastructure.","[G1041] Sea Turtle: Sea Turtle has overwritten Linux system logs and unsets the Bash history file (effectively removing logging) during intrusions.","[S1016] MacMa: MacMa can clear possible malware traces such as application logs.","[G0139] TeamTNT: TeamTNT has removed system logs from /var/log/syslog.","[G1045] Salt Typhoon: Salt Typhoon has cleared logs including .bash_history, auth.log, lastlog, wtmp, and btmp.","[G0106] Rocke: Rocke has cleared log files within the /var/log/ folder.","[S0279] Proton: Proton removes logs from /var/logs and /Library/logs."],"tactics":"TA0005 - Defense Evasion"}
{"technique_id":"T1070.003","technique_name":"Indicator Removal: Clear Command History","description":"In addition to clearing system logs, an adversary may clear the command history of a compromised account to conceal the actions undertaken during an intrusion. Various command interpreters keep track of the commands users type in their terminal so that users can retrace what they've done. On Linux and macOS, these command histories can be accessed in a few different ways. While logged in, this command history is tracked in a file pointed to by the environment variable HISTFILE. When a user logs off a system, this information is flushed to a file in the user's home directory called ~/.bash_history. The benefit of this is that it allows users to go back to commands they've used before in different sessions. Adversaries may delete their commands from these logs by manually clearing the history (history -c) or deleting the bash history file rm ~/.bash_history. Adversaries may also leverage a Network Device CLI on network devices to clear command history data (clear logging and/or clear history). On ESXi servers, command history may be manually removed from the `/var/log/shell.log` file. On Windows hosts, PowerShell has two different command history providers: the built-in history and the command history managed by the PSReadLine module. The built-in history only tracks the commands used in the current session. This command history is not available to other sessions and is deleted when the session ends. The PSReadLine command history tracks the commands used in all PowerShell sessions and writes them to a file ($env:APPDATA\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt by default). This history file is available to all sessions and contains all past history since the file is not deleted when the session ends. Adversaries may run the PowerShell command Clear-History to flush the entire command history from a current PowerShell session. This, however, will not delete/flush the ConsoleHost_history.txt file. Adversaries may also delete the ConsoleHost_history.txt file or edit its contents to hide PowerShell commands they have run.","detection":"User authentication, especially via remote terminal services like SSH, without new entries in that user's ~/.bash_history is suspicious. Additionally, the removal/clearing of the ~/.bash_history file can be an indicator of suspicious activity. Monitor for suspicious modifications or deletion of ConsoleHost_history.txt and use of the Clear-History command.","procedures":["[G0143] Aquatic Panda: Aquatic Panda cleared command history in Linux environments to remove traces of activity after operations.","[S1203] J-magic: J-magic can overwrite previously executed command line arguments.","[G0139] TeamTNT: TeamTNT has cleared command history with history -c.","[S0641] Kobalos: Kobalos can remove all command history on compromised hosts.","[S0601] Hildegard: Hildegard has used history -c to clear script shell logs.","[G0045] menuPass: menuPass has used Wevtutil to remove PowerShell execution logs.","[G0059] Magic Hound: Magic Hound has removed mailbox export requests from compromised Exchange servers.","[G0032] Lazarus Group: Lazarus Group has routinely deleted log files on a compromised router, including automatic log deletion through the use of the logrotate utility.","[G1023] APT5: APT5 has cleared the command history on targeted ESXi servers.","[G0096] APT41: APT41 attempted to remove evidence of some of its activity by deleting Bash histories."],"tactics":"TA0005 - Defense Evasion"}
{"technique_id":"T1070.004","technique_name":"Indicator Removal: File Deletion","description":"Adversaries may delete files left behind by the actions of their intrusion activity. Malware, tools, or other non-native files dropped or created on a system by an adversary (ex: Ingress Tool Transfer) may leave traces to indicate to what was done within a network and how. Removal of these files can occur during an intrusion, or as part of a post-intrusion process to minimize the adversary's footprint. There are tools available from the host operating system to perform cleanup, but adversaries may use other tools as well. Examples of built-in Command and Scripting Interpreter functions include del on Windows, rm or unlink on Linux and macOS, and `rm` on ESXi.","detection":"It may be uncommon for events related to benign command-line functions such as DEL or third-party utilities or tools to be found in an environment, depending on the user base and how systems are typically used. Monitoring for command-line deletion functions to correlate with binaries or other files that an adversary may drop and remove may lead to detection of malicious activity. Another good practice is monitoring for known deletion and secure deletion tools that are not already on systems within an enterprise network that an adversary could introduce. Some monitoring tools may collect command-line arguments, but may not capture DEL commands since DEL is a native function within cmd.exe.","procedures":["[S0164] TDTESS: TDTESS creates then deletes log files during installation of itself as a service.","[S0395] LightNeuron: LightNeuron has a function to delete files.","[S1150] ROADSWEEP: ROADSWEEP can use embedded scripts to remove itself from the infected host.","[S0654] ProLock: ProLock can remove files containing its payload after they are executed.","[G0143] Aquatic Panda: Aquatic Panda has deleted malicious executables from compromised machines.","[S1212] RansomHub: RansomHub has the ability to self-delete.","[S0354] Denis: Denis has a command to delete files from the victim’s machine.","[S0448] Rising Sun: Rising Sun can delete files and artifacts it creates.","[G0051] FIN10: FIN10 has used batch scripts and scheduled tasks to delete critical system files.","[S0593] ECCENTRICBANDWAGON: ECCENTRICBANDWAGON can delete log files generated from the malware stored at C:\\windows\\temp\\tmp0207.","[S0370] SamSam: SamSam has been seen deleting its own files and payloads to make analysis of the attack more difficult.","[S0390] SQLRat: SQLRat has used been observed deleting scripts once used.","[G0045] menuPass: A menuPass macro deletes files after it has decoded and decompressed them.","[S1027] Heyoka Backdoor: Heyoka Backdoor has the ability to delete folders and files from a targeted system.","[G0060] BRONZE BUTLER: The BRONZE BUTLER uploader or malware the uploader uses command to delete the RAR archives after they have been exfiltrated.","[S0282] MacSpy: MacSpy deletes any temporary files it creates","[G0081] Tropic Trooper: Tropic Trooper has deleted dropper files on an infected system using command scripts.","[S0584] AppleJeus: AppleJeus has deleted the MSI file after installation.","[S0437] Kivars: Kivars has the ability to uninstall malware from the infected host.","[G0139] TeamTNT: TeamTNT has used a payload that removes itself after running. TeamTNT also has deleted locally staged files for collecting credentials or scan results for local IP addresses after exfiltrating them.","[S1105] COATHANGER: COATHANGER removes files from victim environments following use in multiple instances.","[S0527] CSPY Downloader: CSPY Downloader has the ability to self delete.","[S0344] Azorult: Azorult can delete files from victim machines.","[S0673] DarkWatchman: DarkWatchman has been observed deleting its original launcher after installation.","[S1182] MagicRAT: MagicRAT can delete files on victim systems, including itself.","[S0268] Bisonal: Bisonal will delete its dropper and VBS scripts from the victim’s machine.","[C0022] Operation Dream Job: During Operation Dream Job, Lazarus Group removed all previously delivered files from a compromised computer.","[G0082] APT38: APT38 has used a utility called CLOSESHAVE that can securely delete a file from the system. They have also removed malware, tools, or other non-native files used during the intrusion to reduce their footprint or as part of the post-intrusion cleanup process.","[S0629] RainyDay: RainyDay has the ability to uninstall itself by deleting its service and files.","[S0107] Cherry Picker: Recent versions of Cherry Picker delete files and registry keys created by the malware.","[S0239] Bankshot: Bankshot marks files to be deleted upon the next system reboot and uninstalls and removes itself from the system.","[G0053] FIN5: FIN5 uses SDelete to clean up the environment and attempt to prevent detection.","[S0342] GreyEnergy: GreyEnergy can securely delete a file by hooking into the DeleteFileA and DeleteFileW functions in the Windows API.","[S0380] StoneDrill: StoneDrill has been observed deleting the temporary files once they fulfill their task.","[S0093] Backdoor.Oldrea: Backdoor.Oldrea contains a cleanup module that removes traces of itself from the victim.","[S0443] MESSAGETAP: Once loaded into memory, MESSAGETAP deletes the keyword_parm.txt and parm.txt configuration files from disk.","[S0260] InvisiMole: InvisiMole has deleted files and directories including XML and files successfully uploaded to C2 servers.","[S0279] Proton: Proton removes all files in the /tmp directory.","[S0352] OSX_OCEANLOTUS.D: OSX_OCEANLOTUS.D has a command to delete a file from the system. OSX_OCEANLOTUS.D deletes the app bundle and dropper after execution.","[S0372] LockerGoga: LockerGoga has been observed deleting its original launcher after execution.","[S0409] Machete: Once a file is uploaded, Machete will delete it from the machine.","[S0233] MURKYTOP: MURKYTOP has the capability to delete local files.","[S0502] Drovorub: Drovorub can delete specific files from a compromised host.","[S0666] Gelsemium: Gelsemium can delete its dropper component from the targeted system.","[S0347] AuditCred: AuditCred can delete files from the system.","[S0249] Gold Dragon: Gold Dragon deletes one of its files, 2.hwp, from the endpoint after establishing persistence.","[S0125] Remsec: Remsec is capable of deleting files on the victim. It also securely removes itself after collecting and exfiltrating data.","[S1200] StealBit: StealBit can self-delete its executable file from the compromised system.","[S0176] Wingbird: Wingbird deletes its payload along with the payload's parent process after it finishes copying files.","[S0434] Imminent Monitor: Imminent Monitor has deleted files related to its dynamic debugger feature.","[S0256] Mosquito: Mosquito deletes files using DeleteFileW API call.","[S0257] VERMIN: VERMIN can delete files on the victim’s machine.","[S0556] Pay2Key: Pay2Key can remove its log file from disk.","[G1040] Play: Play has used tools including Wevtutil to remove malicious files from compromised hosts.","[S0201] JPIN: JPIN's installer/uninstaller component deletes itself if it encounters a version of Windows earlier than Windows XP or identifies security-related processes running.","[G1043] BlackByte: BlackByte deleted ransomware executables post-encryption.","[C0029] Cutting Edge: During Cutting Edge, threat actors deleted `/tmp/test1.txt` on compromised Ivanti Connect Secure VPNs which was used to hold stolen configuration and cache files.","[S0062] DustySky: DustySky can delete files it creates from the infected system.","[S0601] Hildegard: Hildegard has deleted scripts after execution.","[S0091] Epic: Epic has a command to delete a file from the machine.","[S0195] SDelete: SDelete deletes data in a way that makes it unrecoverable.","[S1111] DarkGate: DarkGate has deleted its staging directories.","[S0265] Kazuar: Kazuar can delete files.","[S0441] PowerShower: PowerShower has the ability to remove all files created during the dropper process.","[S0011] Taidoor: Taidoor can use DeleteFileA to remove files from infected hosts.","[S0562] SUNSPOT: Following the successful injection of SUNBURST, SUNSPOT deleted a temporary file it created named InventoryManager.bk after restoring the original SolarWinds Orion source code to the software library.","[S0162] Komplex: The Komplex trojan supports file deletion.","[S0181] FALLCHILL: FALLCHILL can delete malware and associated artifacts from the victim.","[C0006] Operation Honeybee: During Operation Honeybee, the threat actors used batch files that reduced their fingerprint on a compromised system by deleting malware-related files.","[S0172] Reaver: Reaver deletes the original dropped file from the victim.","[S0238] Proxysvc: Proxysvc can delete files indicated by the attacker and remove itself from disk using a batch file.","[S0264] OopsIE: OopsIE has the capability to delete files and scripts from the victim's machine.","[G1003] Ember Bear: Ember Bear deletes files related to lateral movement to avoid detection.","[S0603] Stuxnet: Stuxnet uses an RPC server that contains a routine for file deletion and also removes itself from the system through a DLL export by deleting specific files.","[S0283] jRAT: jRAT has a function to delete files from the victim’s machine.","[S0356] KONNI: KONNI can delete files.","[S0567] Dtrack: Dtrack can remove its persistence and delete itself.","[S0015] Ixeshe: Ixeshe has a command to delete a file from the machine.","[S1014] DanBot: DanBot can delete its configuration file after installation.","[S0431] HotCroissant: HotCroissant has the ability to clean up installed files, delete files, and delete itself from the victim’s machine.","[C0040] APT41 DUST: APT41 DUST deleted various artifacts from victim systems following use.","[S0115] Crimson: Crimson has the ability to delete files from a compromised host.","[S0350] zwShell: zwShell has deleted itself after creating a service as well as deleted a temporary file when the system reboots.","[S0385] njRAT: njRAT is capable of deleting files.","[G0094] Kimsuky: Kimsuky has deleted the exfiltrated data on disk after transmission. Kimsuky has also used an instrumentor script to terminate browser processes running on an infected system and then delete the cookie files on disk.","[C0028] 2015 Ukraine Electric Power Attack: During the 2015 Ukraine Electric Power Attack, vba_macro.exe deletes itself after `FONTCACHE.DAT`, `rundll32.exe`, and the associated .lnk file is delivered.","[S1022] IceApple: IceApple can delete files and directories from targeted systems.","[S0615] SombRAT: SombRAT has the ability to run cancel or closeanddeletestorage to remove all files from storage and delete the storage temp file on a compromised host.","[G0049] OilRig: OilRig has deleted files associated with their payload after execution.","[S0240] ROKRAT: ROKRAT can request to delete files.","[S0045] ADVSTORESHELL: ADVSTORESHELL can delete files and directories.","[S0625] Cuba: Cuba can use the command cmd.exe /c del to delete its artifacts from the system.","[S0259] InnaputRAT: InnaputRAT has a command to delete files.","[G0037] FIN6: FIN6 has removed files from victim machines.","[G0096] APT41: APT41 deleted files from the system.","[S1202] LockBit 3.0: LockBit 3.0 can delete itself from disk.","[G0087] APT39: APT39 has used malware to delete files after they are deployed on a compromised host.","[S1160] Latrodectus: Latrodectus has the ability to delete itself.","[G0016] APT29: APT29 has used SDelete to remove artifacts from victim networks.","[G0102] Wizard Spider: Wizard Spider has used file deletion to remove some modules and configurations from an infected host after use.","[S1207] XLoader: XLoader can delete malicious executables from compromised machines.","[G0007] APT28: APT28 has intentionally deleted computer files to cover their tracks, including with use of the program CCleaner.","[G0026] APT18: APT18 actors deleted tools and batch files from victim systems.","[S0456] Aria-body: Aria-body has the ability to delete files and directories on compromised hosts.","[S1043] ccf32: ccf32 can delete files and folders from compromised machines.","[S0211] Linfo: Linfo creates a backdoor through which remote attackers can delete files.","[S0657] BLUELIGHT: BLUELIGHT can uninstall itself.","[G0120] Evilnum: Evilnum has deleted files used during infection.","[S0094] Trojan.Karagany: Trojan.Karagany has used plugins with a self-delete capability.","[S0455] Metamorfo: Metamorfo has deleted itself from the system after execution.","[S0277] FruitFly: FruitFly will delete files on the system.","[S0087] Hi-Zor: Hi-Zor deletes its RAT installer file as it executes its DLL payload file.","[S0498] Cryptoistic: Cryptoistic has the ability delete files from a compromised host.","[S0228] NanHaiShu: NanHaiShu launches a script to delete their original decoy file to cover tracks.","[S0689] WhisperGate: WhisperGate can delete tools from a compromised host after execution.","[S0153] RedLeaves: RedLeaves can delete specified files.","[S0346] OceanSalt: OceanSalt can delete files from the system.","[S0053] SeaDuke: SeaDuke can securely delete files, including deleting itself from the victim.","[S1141] LunarWeb: LunarWeb can self-delete from a compromised host if safety checks of C2 connectivity fail.","[S0083] Misdat: Misdat is capable of deleting the backdoor file.","[S0520] BLINDINGCAN: BLINDINGCAN has deleted itself and associated artifacts from victim machines.","[G0035] Dragonfly: Dragonfly has deleted many of its files used during operations as part of cleanup, including removing applications and deleting screenshots.","[S0444] ShimRat: ShimRat can uninstall itself from compromised hosts, as well create and modify directories, delete, move, copy, and rename files.","[S0475] BackConfig: BackConfig has the ability to remove files and folders related to previous infections.","[S0513] LiteDuke: LiteDuke can securely delete files by first writing random data to the file.","[S0149] MoonWind: MoonWind can delete itself or specified files.","[S1192] NICECURL: NICECURL has a function to remove artifacts.","[G0129] Mustang Panda: Mustang Panda will delete their tools and files, and kill processes after their objectives are reached.","[G0034] Sandworm Team: Sandworm Team has used backdoors that can delete files used in an attack from an infected system.","[S0284] More_eggs: More_eggs can remove itself from a system.","[S0139] PowerDuke: PowerDuke has a command to write random data across a file and delete it.","[S0067] pngdowner: pngdowner deletes content from C2 communications that was saved to the user's temporary directory.","[S0410] Fysbis: Fysbis has the ability to delete files.","[S0085] S-Type: S-Type has deleted files it has created on a compromised host.","[S1151] ZeroCleare: ZeroCleare has the ability to uninstall the RawDisk driver and delete the `rwdsk` file on disk.","[S0491] StrongPity: StrongPity can delete previously exfiltrated files from the compromised host.","[C0014] Operation Wocao: During Operation Wocao, the threat actors consistently removed traces of their activity by first overwriting a file using `/c cd /d c:\\windows\\temp\\ & copy \\\\\\c$\\windows\\system32\\devmgr.dll \\\\\\c$\\windows\\temp\\LMAKSW.ps1 /y` and then deleting the overwritten file using `/c cd /d c:\\windows\\temp\\ & del \\\\\\c$\\windows\\temp\\LMAKSW.ps1`.","[S0412] ZxShell: ZxShell can delete files from the system.","[G0059] Magic Hound: Magic Hound has deleted and overwrote files to cover tracks.","[G0050] APT32: APT32's macOS backdoor can receive a “delete” command.","[S0416] RDFSNIFFER: RDFSNIFFER has the capability of deleting local files.","[S0253] RunningRAT: RunningRAT contains code to delete files from the victim’s machine.","[S0442] VBShower: VBShower has attempted to complicate forensic analysis by deleting all the files contained in %APPDATA%\\..\\Local\\Temporary Internet Files\\Content.Word and %APPDATA%\\..\\Local Settings\\Temporary Internet Files\\Content.Word\\.","[S0561] GuLoader: GuLoader can delete its executable from the AppData\\Local\\Temp directory on the compromised host.","[S0531] Grandoreiro: Grandoreiro can delete .LNK files created in the Startup folder.","[S0692] SILENTTRINITY: SILENTTRINITY can remove files from the compromised host.","[S0168] Gazer: Gazer has commands to delete files and persistence mechanisms from the victim.","[S0512] FatDuke: FatDuke can secure delete its DLL.","[S0374] SpeakUp: SpeakUp deletes files to remove evidence on the machine.","[G0080] Cobalt Group: Cobalt Group deleted the DLL dropper from the victim’s machine to cover their tracks.","[S0630] Nebulae: Nebulae has the ability to delete files and directories.","[S1065] Woody RAT: Woody RAT has the ability to delete itself from disk by creating a suspended notepad process and writing shellcode to delete a file into the suspended process using `NtWriteVirtualMemory`.","[S0493] GoldenSpy: GoldenSpy's uninstaller can delete registry entries, files and folders, and finally itself once these tasks have been completed.","[S1020] Kevin: Kevin can delete files created on the victim's machine.","[S1154] VersaMem: VersaMem deleted files related to initial installation such as temporary files related to the PID of the main web process.","[S0674] CharmPower: CharmPower can delete created files from a compromised system.","[G0061] FIN8: FIN8 has deleted tmp and prefetch files during post compromise cleanup activities. FIN8 has also deleted PowerShell scripts to evade detection on compromised machines.","[S0127] BBSRAT: BBSRAT can delete files and directories.","[S1135] MultiLayer Wiper: MultiLayer Wiper uses a batch file, remover.bat to delete malware artifacts and the batch file itself during execution.","[G1023] APT5: APT5 has deleted scripts and web shells to evade detection.","[S0435] PLEAD: PLEAD has the ability to delete files on the compromised host.","[C0024] SolarWinds Compromise: During the SolarWinds Compromise, APT29 routinely removed their tools, including custom backdoors, once remote access was achieved.","[S0451] LoudMiner: LoudMiner deleted installation files after completion.","[S0414] BabyShark: BabyShark has cleaned up all files associated with the secondary payload execution.","[S0353] NOKKI: NOKKI can delete files to cover tracks.","[S1161] BPFDoor: After initial setup, BPFDoor's original execution process deletes the dropped binary and exits.","[G0032] Lazarus Group: Lazarus Group malware has deleted files in various ways, including \"suicide scripts\" to delete malware binaries from the victim. Lazarus Group also uses secure file deletion to delete files from the victim.","[S0690] Green Lambert: Green Lambert can delete the original executable after initial installation in addition to unused functions.","[S0533] SLOTHFULMEDIA: SLOTHFULMEDIA has deleted itself and the 'index.dat' file on a compromised machine to remove recent Internet history from the system.","[C0035] KV Botnet Activity: KV Botnet Activity removes on-disk copies of tools and other artifacts after it the primary botnet payload has been loaded into memory on the victim device.","[S0386] Ursnif: Ursnif has deleted data staged in tmp files after exfiltration.","[G0022] APT3: APT3 has a tool that can delete files.","[S0203] Hydraq: Hydraq creates a backdoor through which remote attackers can delete files.","[S1164] UPSTYLE: UPSTYLE removes `bootstrap.min.css` after parsing command and control instructions, restoring the file to its original state.","[S0598] P.A.S. Webshell: P.A.S. Webshell can delete scripts from a subdirectory of /tmp after they are run.","[S0401] Exaramel for Linux: Exaramel for Linux can uninstall its persistence mechanism and delete its configuration file.","[G0089] The White Company: The White Company has the ability to delete its malware entirely from the target system.","[S1081] BADHATCH: BADHATCH has the ability to delete PowerShell scripts from a compromised machine.","[S0589] Sibot: Sibot will delete itself if a certain server response is received.","[S0069] BLACKCOFFEE: BLACKCOFFEE has the capability to delete files.","[S1166] Solar: Solar has the ability to delete staged files after they are uploaded to C2.","[S0348] Cardinal RAT: Cardinal RAT can uninstall itself, including deleting its executable.","[S0663] SysUpdate: SysUpdate can delete its configuration file from the targeted system.","[S0021] Derusbi: Derusbi is capable of deleting files. It has been observed loading a Linux Kernel Module (LKM) and then deleting it from the hard disk as well as overwriting the data with null bytes.","[S0662] RCSession: RCSession can remove files from a targeted system.","[G0114] Chimera: Chimera has performed file deletion to evade detection.","[S1142] LunarMail: LunarMail can delete the previously used staging directory and files on subsequent rounds of exfiltration and replace it with a new one.","[S0582] LookBack: LookBack removes itself after execution and can delete files on the system.","[G0040] Patchwork: Patchwork removed certain files and replaced them so they could not be retrieved.","[C0032] C0032: During the C0032 campaign, TEMP.Veles routinely deleted tools, logs, and other files after they were finished with them.","[G0043] Group5: Malware used by Group5 is capable of remotely deleting files from victims.","[S0274] Calisto: Calisto has the capability to use rm -rf to remove folders and files from the victim's machine.","[S1050] PcShare: PcShare has deleted its files and components from a compromised host.","[S0345] Seasalt: Seasalt has a command to delete a specified file.","[S0396] EvilBunny: EvilBunny has deleted the initial dropper after running through the environment checks.","[S0081] Elise: Elise is capable of launching a remote shell on the host to delete itself.","[S1019] Shark: Shark can delete files downloaded to the compromised host.","[S0032] gh0st RAT: gh0st RAT has the capability to to delete files.","[C0046] ArcaneDoor: ArcaneDoor included multiple instances of file deletion or removal during execution and other adversary actions.","[S0070] HTTPBrowser: HTTPBrowser deletes its original installer file once installation is complete.","[S0141] Winnti for Windows: Winnti for Windows can delete the DLLs for its various components from a compromised host.","[S0495] RDAT: RDAT can issue SOAP requests to delete already processed C2 emails. RDAT can also delete itself from the infected system.","[S0155] WINDSHIELD: WINDSHIELD is capable of file deletion along with other file system interaction.","[S0382] ServHelper: ServHelper has a module to delete itself from the infected machine.","[S1148] Raccoon Stealer: Raccoon Stealer can remove files related to use and installation.","[S0269] QUADAGENT: QUADAGENT has a command to delete its Registry key and scheduled task.","[S0330] Zeus Panda: Zeus Panda has a command to delete a file. It also can uninstall scripts and delete files to cover its track.","[G1013] Metador: Metador has quickly deleted `cbd.exe` from a compromised host following the successful deployment of their malware.","[S1184] BOLDMOVE: BOLDMOVE can remove files on victim systems.","[S1047] Mori: Mori can delete its DLL file and related files by Registry value.","[G0047] Gamaredon Group: Gamaredon Group tools can delete files used during an operation.","[S0113] Prikormka: After encrypting its own log files, the log encryption module in Prikormka deletes the original, unencrypted files from the host.","[S1199] LockBit 2.0: LockBit 2.0 can delete itself from disk after execution.","[S0559] SUNBURST: SUNBURST had a command to delete files.","[S0439] Okrum: Okrum's backdoor deletes files after they have been successfully uploaded to C2 servers.","[S0534] Bazar: Bazar can delete its loader using a batch file in the Windows temporary folder.","[S1170] ODAgent: ODAgent can delete payloads and files used to pass C2 commands from remotely hosted cloud accounts.","[S0223] POWERSTATS: POWERSTATS can delete all files on the C:\\, D:\\, E:\\ and, F:\\ drives using PowerShell Remove-Item commands.","[S1059] metaMain: metaMain has deleted collected items after uploading the content to its C2 server.","[G1017] Volt Typhoon: Volt Typhoon has run `rd /S` to delete their working directories and deleted systeminfo.dat from `C:\\Users\\Public\\Documentsfiles`.","[S0251] Zebrocy: Zebrocy has a command to delete files and directories.","[S1130] Raspberry Robin: Raspberry Robin can delete its initial delivery script from disk during execution.","[S1181] BlackByte 2.0 Ransomware: BlackByte 2.0 Ransomware deletes itself following device encryption.","[S1017] OutSteel: OutSteel can delete itself following the successful execution of a follow-on payload.","[S0208] Pasam: Pasam creates a backdoor through which remote attackers can delete files.","[S0607] KillDisk: KillDisk has the ability to quit and delete itself.","[S0147] Pteranodon: Pteranodon can delete files that may interfere with it executing. It also can delete temporary files and itself after the initial script executes.","[S0196] PUNCHBUGGY: PUNCHBUGGY can delete files written to disk.","[S1179] Exbyte: Exbyte will self-delete if a hard-coded configuration file is not found.","[G1032] INC Ransom: INC Ransom has uninstalled tools from compromised endpoints after use.","[S0679] Ferocious: Ferocious can delete files from a compromised host.","[G0091] Silence: Silence has deleted artifacts, including scheduled tasks, communicates files from the C2 and other logs.","[S0234] Bandook: Bandook has a command to delete a file.","[S0622] AppleSeed: AppleSeed can delete files from a compromised host after they are exfiltrated.","[S0151] HALFBAKED: HALFBAKED can delete a specified file.","[S0697] HermeticWiper: HermeticWiper has the ability to overwrite its own file with random bites.","[S0030] Carbanak: Carbanak has a command to delete files.","[S0517] Pillowmint: Pillowmint has deleted the filepath %APPDATA%\\Intel\\devmonsrv.exe.","[S0466] WindTail: WindTail has the ability to receive and execute a self-delete command.","[S1147] Nightdoor: Nightdoor can self-delete.","[S0586] TAINTEDSCRIBE: TAINTEDSCRIBE can delete files from a compromised host.","[S0438] Attor: Attor’s plugin deletes the collected files and log files after exfiltration.","[S0504] Anchor: Anchor can self delete its dropper after the malware is successfully deployed.","[S0447] Lokibot: Lokibot will delete its dropped files after bypassing UAC.","[G1039] RedCurl: RedCurl has deleted files after execution.","[S0106] cmd: cmd can be used to delete files from the file system.","[S1196] Troll Stealer: Troll Stealer creates and can execute a BAT script that will delete the malware.","[S1188] Line Runner: Line Runner removes its initial ZIP delivery archive after processing the enclosed LUA script.","[S0398] HyperBro: HyperBro has the ability to delete a specified file.","[S1015] Milan: Milan can delete files via `C:\\Windows\\system32\\cmd.exe /c ping 1.1.1.1 -n 1 -w 3000 > Nul & rmdir /s /q`.","[G0106] Rocke: Rocke has deleted files on infected machines.","[S0271] KEYMARBLE: KEYMARBLE has the capability to delete files off the victim’s machine.","[S0632] GrimAgent: GrimAgent can delete old binaries on a compromised host.","[S1178] ShrinkLocker: ShrinkLocker can delete itself depending on various checks performed during execution.","[S0074] Sakula: Some Sakula samples use cmd.exe to delete temporary files.","[S1032] PyDCrypt: PyDCrypt will remove all created artifacts such as dropped executables.","[S0136] USBStealer: USBStealer has several commands to delete files associated with the malware from the victim.","[S1132] IPsec Helper: IPsec Helper can delete itself when given the appropriate command.","[S0496] REvil: REvil can mark its binary code for deletion after reboot.","[S0391] HAWKBALL: HAWKBALL has the ability to delete files.","[G0027] Threat Group-3390: Threat Group-3390 has deleted existing logs and exfiltrated file archives from a victim.","[S1167] AcidPour: AcidPour includes a self-delete function where the malware deletes itself from disk after execution and program load into memory.","[S0462] CARROTBAT: CARROTBAT has the ability to delete downloaded files from a compromised host.","[S0044] JHUHUGIT: The JHUHUGIT dropper can delete itself from the victim. Another JHUHUGIT variant has the capability to delete specified files.","[S0688] Meteor: Meteor will delete the folder containing malicious scripts if it detects the hostname as `PIS-APP`, `PIS-MOB`, `WSUSPROXY`, or `PIS-DB`.","[S0428] PoetRAT: PoetRAT has the ability to overwrite scripts and delete itself if a sandbox environment is detected.","[S0022] Uroburos: Uroburos can run a `Clear Agents Track` command on an infected machine to delete Uroburos-related logs.","[S1039] Bumblebee: Bumblebee can uninstall its loader through the use of a `Sdl` command.","[S0453] Pony: Pony has used scripts to delete itself after execution.","[S0381] FlawedAmmyy: FlawedAmmyy can execute batch scripts to delete files.","[S1198] Gomir: Gomir deletes its original executable and terminates its original process after creating a systemd service.","[S1034] StrifeWater: StrifeWater can self delete to cover its tracks.","[S1133] Apostle: Apostle writes batch scripts to disk, such as system.bat and remover.bat, that perform various anti-analysis and anti-forensic tasks, before finally deleting themselves at the end of execution. Apostle attempts to delete itself after encryption or wiping operations are complete and before shutting down the victim machine.","[S0587] Penquin: Penquin can delete downloaded executables after running them.","[S0499] Hancitor: Hancitor has deleted files using the VBA kill function.","[S0161] XAgentOSX: XAgentOSX contains the deletFileFromPath function to delete a specified file using the NSFileManager:removeFileAtPath method.","[S0263] TYPEFRAME: TYPEFRAME can delete files off the system.","[S1018] Saint Bot: Saint Bot can run a batch script named `del.bat` to remove any Saint Bot payload-linked files from a compromise system if anti-analysis or locale checks fail.","[S1016] MacMa: MacMa can delete itself from the compromised computer.","[S0461] SDBbot: SDBbot has the ability to delete files from a compromised host.","[S0180] Volgmer: Volgmer can delete files and itself after infection to avoid analysis.","[S0267] FELIXROOT: FELIXROOT deletes the .LNK file from the startup directory as well as the dropper components.","[S1044] FunnyDream: FunnyDream can delete files including its dropper component.","[S0583] Pysa: Pysa has deleted batch files after execution.","[S0148] RTM: RTM can delete all files created during its execution.","[S0650] QakBot: QakBot can delete folders and files including overwriting its executable with legitimate programs."],"tactics":"TA0005 - Defense Evasion"}
{"technique_id":"T1070.005","technique_name":"Indicator Removal: Network Share Connection Removal","description":"Adversaries may remove share connections that are no longer useful in order to clean up traces of their operation. Windows shared drive and SMB/Windows Admin Shares connections can be removed when no longer needed. Net is an example utility that can be used to remove network share connections with the net use \\\\system\\share /delete command.","detection":"Network share connections may be common depending on how an network environment is used. Monitor command-line invocation of net use commands associated with establishing and removing remote shares over SMB, including following best practices for detection of Windows Admin Shares. SMB traffic between systems may also be captured and decoded to look for related network share session and file transfer activity. Windows authentication logs are also useful in determining when authenticated network shares are established and by which account, and can be used to correlate network share activity to other events to investigate potentially malicious activity.","procedures":["[S0039] Net: The net use \\\\system\\share /delete command can be used in Net to remove an established connection to a network share.","[S0400] RobbinHood: RobbinHood disconnects all network shares from the computer with the command net use * /DELETE /Y.","[S1159] DUSTTRAP: DUSTTRAP can remove network shares from infected systems.","[S0260] InvisiMole: InvisiMole can disconnect previously connected remote drives.","[G0027] Threat Group-3390: Threat Group-3390 has detached network shares after exfiltrating files, likely to evade detection."],"tactics":"TA0005 - Defense Evasion"}
{"technique_id":"T1070.006","technique_name":"Indicator Removal: Timestomp","description":"Adversaries may modify file time attributes to hide new files or changes to existing files. Timestomping is a technique that modifies the timestamps of a file (the modify, access, create, and change times), often to mimic files that are in the same folder and blend malicious files with legitimate files. In Windows systems, both the `$STANDARD_INFORMATION` (`$SI`) and `$FILE_NAME` (`$FN`) attributes record times in a Master File Table (MFT) file. `$SI` (dates/time stamps) is displayed to the end user, including in the File System view, while `$FN` is dealt with by the kernel. Modifying the `$SI` attribute is the most common method of timestomping because it can be modified at the user level using API calls. `$FN` timestomping, however, typically requires interacting with the system kernel or moving or renaming a file. Adversaries modify timestamps on files so that they do not appear conspicuous to forensic investigators or file analysis tools. In order to evade detections that rely on identifying discrepancies between the `$SI` and `$FN` attributes, adversaries may also engage in “double timestomping” by modifying times on both attributes simultaneously. In Linux systems and on ESXi servers, threat actors may attempt to perform timestomping using commands such as `touch -a -m -t ` (which sets access and modification times to a specific value) or `touch -r ` (which sets access and modification times to match those of another file). Timestomping may be used along with file name Masquerading to hide malware and tools.","detection":"Forensic techniques exist to detect aspects of files that have had their timestamps modified. It may be possible to detect timestomping using file modification monitoring that collects information on file handle opens and can compare timestamp values.","procedures":["[S0586] TAINTEDSCRIBE: TAINTEDSCRIBE can change the timestamp of specified filenames.","[G0007] APT28: APT28 has performed timestomping on victim files.","[S0687] Cyclops Blink: Cyclops Blink has the ability to use the Linux API function `utime` to change the timestamps of modified firmware update images.","[G1023] APT5: APT5 has modified file timestamps.","[S0168] Gazer: For early Gazer versions, the compilation timestamp was faked.","[S0603] Stuxnet: Stuxnet extracts and writes driver files that match the times of other legitimate files.","[S0239] Bankshot: Bankshot modifies the time of a file as specified by the control server.","[S0181] FALLCHILL: FALLCHILL can modify file or directory timestamps.","[S1181] BlackByte 2.0 Ransomware: BlackByte 2.0 Ransomware can timestomp files for defense evasion and anti-forensics purposes.","[S0072] OwaAuth: OwaAuth has a command to timestop a file or directory.","[C0029] Cutting Edge: During Cutting Edge, threat actors changed timestamps of multiple files on compromised Ivanti Secure Connect VPNs to conceal malicious activity.","[S1090] NightClub: NightClub can modify the Creation, Access, and Write timestamps for malicious DLLs to match those of the genuine Windows DLL user32.dll.","[S0136] USBStealer: USBStealer sets the timestamps of its dropper files to the last-access and last-write timestamps of a standard Windows library chosen on the system.","[S0570] BitPaymer: BitPaymer can modify the timestamp of an executable so that it can be identified and restored by the decryption tool.","[S0021] Derusbi: The Derusbi malware supports timestomping.","[S0154] Cobalt Strike: Cobalt Strike can timestomp any files or payloads placed on a target machine to help them blend in.","[S0352] OSX_OCEANLOTUS.D: OSX_OCEANLOTUS.D can use the touch -t command to change timestamps.","[S0393] PowerStallion: PowerStallion modifies the MAC times of its local log files to match that of the victim's desktop.ini file.","[S0185] SEASHARPEE: SEASHARPEE can timestomp files on victims using a Web shell.","[S0081] Elise: Elise performs timestomping of a CAB file it creates.","[G0082] APT38: APT38 has modified data timestamps to mimic files that are in the same folder on a compromised host.","[G0050] APT32: APT32 has used scheduled task raw XML with a backdated timestamp of June 2, 2016. The group has also set the creation time of the files dropped by the second stage of the exploit to match the creation time of kernel32.dll. Additionally, APT32 has used a random value to modify the timestamp of the file storing the clientID.","[G0094] Kimsuky: Kimsuky has manipulated timestamps for creation or compilation dates to defeat anti-forensics.","[S0387] KeyBoy: KeyBoy time-stomped its DLL in order to evade detection.","[S0568] EVILNUM: EVILNUM has changed the creation date of files.","[S0520] BLINDINGCAN: BLINDINGCAN has modified file and directory timestamps.","[S1016] MacMa: MacMa has the capability to create and modify file timestamps.","[S1161] BPFDoor: BPFDoor uses the `utimes()` function to change the executable's timestamp.","[S0641] Kobalos: Kobalos can modify timestamps of replaced files, such as ssh with the added credential stealer or sshd used to deploy Kobalos.","[S1031] PingPull: PingPull has the ability to timestomp a file.","[G0016] APT29: APT29 has used timestomping to alter the Standard Information timestamps on their web shells to match other files in the same directory.","[S0438] Attor: Attor has manipulated the time of last access to files and registry keys after they have been created or modified.","[C0024] SolarWinds Compromise: During the SolarWinds Compromise, APT29 modified timestamps of backdoors to match legitimate Windows files.","[S0020] China Chopper: China Chopper's server component can change the timestamp of files.","[S1164] UPSTYLE: UPSTYLE restores timestamps to original values following modification.","[S0260] InvisiMole: InvisiMole samples were timestomped by the authors by setting the PE timestamps to all zero values. InvisiMole also has a built-in command to modify file times.","[S0666] Gelsemium: Gelsemium has the ability to perform timestomping of files on targeted systems.","[S0141] Winnti for Windows: Winnti for Windows can set the timestamps for its worker and service components to match that of cmd.exe.","[C0032] C0032: During the C0032 campaign, TEMP.Veles used timestomping to modify the $STANDARD_INFORMATION attribute on tools.","[G0114] Chimera: Chimera has used a Windows version of the Linux touch command to modify the date and time stamp on DLLs.","[S0164] TDTESS: After creating a new service for persistence, TDTESS sets the file creation time for the service to the creation time of the victim's legitimate svchost.exe file.","[G0032] Lazarus Group: Several Lazarus Group malware families use timestomping, including modifying the last write timestamp of a specified Registry key to a random date, as well as copying the timestamp for legitimate .exe files (such as calc.exe or mspaint.exe) to its dropped files.","[S0066] 3PARA RAT: 3PARA RAT has a command to set certain attributes such as creation/modification timestamps on files.","[S0150] POSHSPY: POSHSPY modifies timestamps of all downloaded executables to match a randomly selected file created prior to 2013.","[S0078] Psylo: Psylo has a command to conduct timestomping by setting a specified file’s timestamps to match those of a system file in the System32 directory.","[S1135] MultiLayer Wiper: MultiLayer Wiper changes timestamps of overwritten files to either 1601.1.1 for NTFS filesystems, or 1980.1.1 for all other filesystems.","[S1149] CHIMNEYSWEEP: CHIMNEYSWEEP can time stomp its executable, previously dating it between 2010 to 2021.","[S1100] Ninja: Ninja can change or create the last access or write times.","[S0083] Misdat: Many Misdat samples were programmed using Borland Delphi, which will mangle the default PE compile timestamp of a file.","[S0140] Shamoon: Shamoon can change the modified time for files to evade forensic detection.","[S1059] metaMain: metaMain can change the `CreationTime`, `LastAccessTime`, and `LastWriteTime` file time attributes when executed with `SYSTEM` privileges.","[S0363] Empire: Empire can timestomp any files or payloads placed on a target machine to help them blend in.","[G0106] Rocke: Rocke has changed the time stamp of certain files."],"tactics":"TA0005 - Defense Evasion"}
{"technique_id":"T1070.007","technique_name":"Indicator Removal: Clear Network Connection History and Configurations","description":"Adversaries may clear or remove evidence of malicious network connections in order to clean up traces of their operations. Configuration settings as well as various artifacts that highlight connection history may be created on a system and/or in application logs from behaviors that require network connections, such as Remote Services or External Remote Services. Defenders may use these artifacts to monitor or otherwise analyze network connections created by adversaries. Network connection history may be stored in various locations. For example, RDP connection history may be stored in Windows Registry values under : * HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default * HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Servers Windows may also store information about recent RDP connections in files such as C:\\Users\\\\%username%\\Documents\\Default.rdp and `C:\\Users\\%username%\\AppData\\Local\\Microsoft\\Terminal Server Client\\Cache\\`. Similarly, macOS and Linux hosts may store information highlighting connection history in system logs (such as those stored in `/Library/Logs` and/or `/var/log/`). Malicious network connections may also require changes to third-party applications or network configuration settings, such as Disable or Modify System Firewall or tampering to enable Proxy. Adversaries may delete or modify this data to conceal indicators and/or impede defensive analysis.","detection":null,"procedures":["[S0559] SUNBURST: SUNBURST also removed the firewall rules it created during execution.","[G1017] Volt Typhoon: Volt Typhoon has inspected server logs to remove their IPs."],"tactics":"TA0005 - Defense Evasion"}
{"technique_id":"T1070.008","technique_name":"Indicator Removal: Clear Mailbox Data","description":"Adversaries may modify mail and mail application data to remove evidence of their activity. Email applications allow users and other programs to export and delete mailbox data via command line tools or use of APIs. Mail application data can be emails, email metadata, or logs generated by the application or operating system, such as export requests. Adversaries may manipulate emails and mailbox data to remove logs, artifacts, and metadata, such as evidence of Phishing/Internal Spearphishing, Email Collection, Mail Protocols for command and control, or email-based exfiltration such as Exfiltration Over Alternative Protocol. For example, to remove evidence on Exchange servers adversaries have used the ExchangePowerShell PowerShell module, including Remove-MailboxExportRequest to remove evidence of mailbox exports. On Linux and macOS, adversaries may also delete emails through a command line utility called mail or use AppleScript to interact with APIs on macOS. Adversaries may also remove emails and metadata/headers indicative of spam or suspicious activity (for example, through the use of organization-wide transport rules) to reduce the likelihood of malicious emails being detected by security products.","detection":null,"procedures":["[S1142] LunarMail: LunarMail can set the `PR_DELETE_AFTER_SUBMIT` flag to delete messages sent for data exfiltration.","[G1044] APT42: APT42 has deleted login notification emails and has cleared the Sent folder to cover their tracks.","[S0477] Goopy: Goopy has the ability to delete emails used for C2 once the content has been copied.","[C0024] SolarWinds Compromise: During the SolarWinds Compromise, APT29 removed evidence of email export requests using `Remove-MailboxExportRequest`."],"tactics":"TA0005 - Defense Evasion"}
{"technique_id":"T1070.009","technique_name":"Indicator Removal: Clear Persistence","description":"Adversaries may clear artifacts associated with previously established persistence on a host system to remove evidence of their activity. This may involve various actions, such as removing services, deleting executables, Modify Registry, Plist File Modification, or other methods of cleanup to prevent defenders from collecting evidence of their persistent presence. Adversaries may also delete accounts previously created to maintain persistence (i.e. Create Account). In some instances, artifacts of persistence may also be removed once an adversary’s persistence is executed in order to prevent errors with the new instance of the malware.","detection":null,"procedures":["[S0559] SUNBURST: SUNBURST removed IFEO registry values to clean up traces of persistence.","[S0500] MCMD: MCMD has the ability to remove set Registry Keys, including those used for persistence.","[S0534] Bazar: Bazar's loader can delete scheduled tasks created by a previous instance of the malware.","[S1132] IPsec Helper: IPsec Helper can delete various service traces related to persistent execution when commanded.","[S0517] Pillowmint: Pillowmint can uninstall the malicious service from an infected machine.","[S0083] Misdat: Misdat is capable of deleting Registry keys used for persistence.","[S1190] Kapeka: Kapeka will clear registry values used for persistent configuration storage when uninstalled.","[S0085] S-Type: S-Type has deleted accounts it has created.","[S0385] njRAT: njRAT is capable of manipulating and deleting registry keys, including those used for persistence.","[S0669] KOCTOPUS: KOCTOPUS can delete created registry keys used for persistence as part of its cleanup procedure.","[S0632] GrimAgent: GrimAgent can delete previously created tasks on a compromised host.","[S1130] Raspberry Robin: Raspberry Robin uses a RunOnce Registry key for persistence, where the key is removed after its use on reboot then re-added by the malware after it resumes execution.","[S0148] RTM: RTM has the ability to remove Registry entries that it created for persistence."],"tactics":"TA0005 - Defense Evasion"}
{"technique_id":"T1070.010","technique_name":"Indicator Removal: Relocate Malware","description":"Once a payload is delivered, adversaries may reproduce copies of the same malware on the victim system to remove evidence of their presence and/or avoid defenses. Copying malware payloads to new locations may also be combined with File Deletion to cleanup older artifacts. Relocating malware may be a part of many actions intended to evade defenses. For example, adversaries may copy and rename payloads to better blend into the local environment (i.e., Match Legitimate Resource Name or Location). Payloads may also be repositioned to target File/Path Exclusions as well as specific locations associated with establishing Persistence. Relocating malicious payloads may also hinder defensive analysis, especially to separate these payloads from earlier events (such as User Execution and Phishing) that may have generated alerts or otherwise drawn attention from defenders.","detection":null,"procedures":null,"tactics":"TA0005 - Defense Evasion"}
{"technique_id":"T1078.001","technique_name":"Valid Accounts: Default Accounts","description":"Adversaries may obtain and abuse credentials of a default account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Default accounts are those that are built-into an OS, such as the Guest or Administrator accounts on Windows systems. Default accounts also include default factory/provider set accounts on other types of systems, software, or devices, including the root user account in AWS, the root user account in ESXi, and the default service account in Kubernetes. Default accounts are not limited to client machines; rather, they also include accounts that are preset for equipment such as network devices and computer applications, whether they are internal, open source, or commercial. Appliances that come preset with a username and password combination pose a serious threat to organizations that do not change it post installation, as they are easy targets for an adversary. Similarly, adversaries may also utilize publicly disclosed or stolen Private Keys or credential materials to legitimately connect to remote environments via Remote Services. Default accounts may be created on a system after initial setup by connecting or integrating it with another application. For example, when an ESXi server is connected to a vCenter server, a default privileged account called `vpxuser` is created on the ESXi server. If a threat actor is able to compromise this account’s credentials (for example, via Exploitation for Credential Access on the vCenter host), they will then have access to the ESXi server.","detection":"Monitor whether default accounts have been activated or logged into. These audits should also include checks on any appliances and applications for default credentials or SSH keys, and if any are discovered, they should be updated immediately.","procedures":["[G1016] FIN13: FIN13 has leveraged default credentials for authenticating myWebMethods (WMS) and QLogic web management interface to gain initial access.","[S0537] HyperStack: HyperStack can use default credentials to connect to IPC$ shares on remote machines.","[C0038] HomeLand Justice: During HomeLand Justice, threat actors used the built-in administrator account to move laterally using RDP and Impacket.","[G0059] Magic Hound: Magic Hound enabled and used the default system managed account, DefaultAccount, via `\"powershell.exe\" /c net user DefaultAccount /active:yes` to connect to a targeted Exchange server over RDP.","[S0603] Stuxnet: Stuxnet infected WinCC machines via a hardcoded database server password.","[G1003] Ember Bear: Ember Bear has abused default user names and passwords in externally-accessible IP cameras for initial access."],"tactics":"TA0005 - Defense Evasion"}
{"technique_id":"T1078.002","technique_name":"Valid Accounts: Domain Accounts","description":"Adversaries may obtain and abuse credentials of a domain account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Domain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain. Domain accounts can cover users, administrators, and services. Adversaries may compromise domain accounts, some with a high level of privileges, through various means such as OS Credential Dumping or password reuse, allowing access to privileged resources of the domain.","detection":"Configure robust, consistent account activity audit policies across the enterprise and with externally accessible services. Look for suspicious account behavior across systems that share accounts, either user, admin, or service accounts. Examples: one account logged into multiple systems simultaneously; multiple accounts logged into the same machine simultaneously; accounts logged in at odd times or outside of business hours. Activity may be from interactive login sessions or process ownership from accounts being used to execute binaries on a remote system as a particular account. Correlate other security systems with login information (e.g., a user has an active login session but has not entered the building or does not have VPN access). On Linux, check logs and other artifacts created by use of domain authentication services, such as the System Security Services Daemon (sssd). Perform regular audits of domain accounts to detect accounts that may have been created by an adversary for persistence.","procedures":["[S1024] CreepySnail: CreepySnail can use stolen credentials to authenticate on target networks.","[C0002] Night Dragon: During Night Dragon, threat actors used domain accounts to gain further access to victim systems.","[C0023] Operation Ghost: For Operation Ghost, APT29 used stolen administrator credentials for lateral movement on compromised networks.","[C0048] Operation MidnightEclipse: During Operation MidnightEclipse, threat actors used a compromised domain admin account to move laterally.","[S0154] Cobalt Strike: Cobalt Strike can use known credentials to run commands and spawn processes as a domain user account.","[G0019] Naikon: Naikon has used administrator credentials for lateral movement in compromised networks.","[C0049] Leviathan Australian Intrusions: Leviathan compromised domain credentials during Leviathan Australian Intrusions.","[C0012] Operation CuckooBees: During Operation CuckooBees, the threat actors used compromised domain administrator credentials as part of their lateral movement.","[G1030] Agrius: Agrius attempted to acquire valid credentials for victim environments through various means to enable follow-on lateral movement.","[G0102] Wizard Spider: Wizard Spider has used administrative accounts, including Domain Admin, to move laterally within a victim network.","[G0034] Sandworm Team: Sandworm Team has used stolen credentials to access administrative accounts within the domain.","[C0024] SolarWinds Compromise: During the SolarWinds Compromise, APT29 used domain administrators' accounts to help facilitate lateral movement on compromised networks.","[S0446] Ryuk: Ryuk can use stolen domain admin accounts to move laterally within a victim domain.","[G0049] OilRig: OilRig has used an exfiltration tool named STEALHOOK to retreive valid domain credentials.","[S0140] Shamoon: If Shamoon cannot access shares using current privileges, it attempts access using hard coded, domain-specific credentials gathered earlier in the intrusion.","[G1021] Cinnamon Tempest: Cinnamon Tempest has obtained highly privileged credentials such as domain administrator in order to deploy malware.","[G1022] ToddyCat: ToddyCat has used compromised domain admin credentials to mount local network shares.","[G0119] Indrik Spider: Indrik Spider has collected credentials from infected systems, including domain accounts.","[G0022] APT3: APT3 leverages valid accounts after gaining credentials for use within the victim domain.","[G0114] Chimera: Chimera has used compromised domain accounts to gain access to the target environment.","[C0014] Operation Wocao: During Operation Wocao, threat actors used domain credentials, including domain admin, for lateral movement and privilege escalation.","[G1040] Play: Play has used valid domain accounts for access.","[G0092] TA505: TA505 has used stolen domain admin accounts to compromise additional hosts.","[G0028] Threat Group-1314: Threat Group-1314 actors used compromised domain credentials for the victim's endpoint management platform, Altiris, to move laterally.","[G1023] APT5: APT5 has used legitimate account credentials to move laterally through compromised environments.","[G0059] Magic Hound: Magic Hound has used domain administrator accounts after dumping LSASS process memory.","[C0029] Cutting Edge: During Cutting Edge, threat actors used compromised VPN accounts for lateral movement on targeted networks.","[S0603] Stuxnet: Stuxnet attempts to access network resources with a domain account’s credentials.","[G1017] Volt Typhoon: Volt Typhoon has used compromised domain accounts to authenticate to devices on compromised networks.","[G1043] BlackByte: BlackByte captured credentials for or impersonated domain administration users.","[G0143] Aquatic Panda: Aquatic Panda used multiple mechanisms to capture valid user accounts for victim domains to enable lateral movement and access to additional hosts in victim environments."],"tactics":"TA0005 - Defense Evasion"}
{"technique_id":"T1078.003","technique_name":"Valid Accounts: Local Accounts","description":"Adversaries may obtain and abuse credentials of a local account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Local accounts are those configured by an organization for use by users, remote support, services, or for administration on a single system or service. Local Accounts may also be abused to elevate privileges and harvest credentials through OS Credential Dumping. Password reuse may allow the abuse of local accounts across a set of machines on a network for the purposes of Privilege Escalation and Lateral Movement.","detection":"Perform regular audits of local system accounts to detect accounts that may have been created by an adversary for persistence. Look for suspicious account behavior, such as accounts logged in at odd times or outside of business hours.","procedures":["[G0094] Kimsuky: Kimsuky has used a tool called GREASE to add a Windows admin account in order to allow them continued access via RDP.","[S0367] Emotet: Emotet can brute force a local admin password, then use it to facilitate lateral movement.","[S0154] Cobalt Strike: Cobalt Strike can use known credentials to run commands and spawn processes as a local user account.","[G0056] PROMETHIUM: PROMETHIUM has created admin accounts on a compromised host.","[G0051] FIN10: FIN10 has moved laterally using the Local Administrator account.","[G1040] Play: Play has used valid local accounts to gain initial access.","[G0050] APT32: APT32 has used legitimate local admin account credentials.","[G1041] Sea Turtle: Sea Turtle compromised cPanel accounts in victim environments.","[G0081] Tropic Trooper: Tropic Trooper has used known administrator account credentials to execute the backdoor directly.","[G0125] HAFNIUM: HAFNIUM has used the NT AUTHORITY\\SYSTEM account to create files on Exchange servers.","[G0046] FIN7: FIN7 has used compromised credentials for access as SYSTEM on Exchange servers.","[C0024] SolarWinds Compromise: During the SolarWinds Compromise, APT29 used compromised local accounts to access victims' networks.","[C0049] Leviathan Australian Intrusions: Leviathan used captured local account information, such as service accounts, for actions during Leviathan Australian Intrusions.","[G1047] Velvet Ant: Velvet Ant accessed vulnerable Cisco switch devices using accounts with administrator privileges.","[G0016] APT29: APT29 targets dormant or inactive user accounts, accounts belonging to individuals no longer at the organization but whose accounts remain on the system, for access and persistence.","[S0368] NotPetya: NotPetya can use valid credentials with PsExec or wmic to spread itself to remote systems.","[S1202] LockBit 3.0: LockBit 3.0 can use a compromised local account for lateral movement.","[S0221] Umbreon: Umbreon creates valid local users to provide access to the system.","[C0014] Operation Wocao: During Operation Wocao, threat actors used local account credentials found during the intrusion for lateral movement and privilege escalation.","[G0010] Turla: Turla has abused local accounts that have the same password across the victim’s network."],"tactics":"TA0005 - Defense Evasion"}
{"technique_id":"T1078.004","technique_name":"Valid Accounts: Cloud Accounts","description":"Valid accounts in cloud environments may allow adversaries to perform actions to achieve Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Cloud accounts are those created and configured by an organization for use by users, remote support, services, or for administration of resources within a cloud service provider or SaaS application. Cloud Accounts can exist solely in the cloud; alternatively, they may be hybrid-joined between on-premises systems and the cloud through syncing or federation with other identity sources such as Windows Active Directory. Service or user accounts may be targeted by adversaries through Brute Force, Phishing, or various other means to gain access to the environment. Federated or synced accounts may be a pathway for the adversary to affect both on-premises systems and cloud environments - for example, by leveraging shared credentials to log onto Remote Services. High privileged cloud accounts, whether federated, synced, or cloud-only, may also allow pivoting to on-premises environments by leveraging SaaS-based Software Deployment Tools to run commands on hybrid-joined devices. An adversary may create long lasting Additional Cloud Credentials on a compromised cloud account to maintain persistence in the environment. Such credentials may also be used to bypass security controls such as multi-factor authentication. Cloud accounts may also be able to assume Temporary Elevated Cloud Access or other privileges through various means within the environment. Misconfigurations in role assignments or role assumption policies may allow an adversary to use these mechanisms to leverage permissions outside the intended scope of the account. Such over privileged accounts may be used to harvest sensitive data from online storage accounts and databases through Cloud API or other methods. For example, in Azure environments, adversaries may target Azure Managed Identities, which allow associated Azure resources to request access tokens. By compromising a resource with an attached Managed Identity, such as an Azure VM, adversaries may be able to Steal Application Access Tokens to move laterally across the cloud environment.","detection":"Monitor the activity of cloud accounts to detect abnormal or malicious behavior, such as accessing information outside of the normal function of the account or account usage at atypical hours.","procedures":["[C0024] SolarWinds Compromise: During the SolarWinds Compromise, APT29 used a compromised O365 administrator account to create a new Service Principal.","[G0016] APT29: APT29 has gained access to a global administrator account in Azure AD and has used `Service Principal` credentials in Exchange.","[G1023] APT5: APT5 has accessed Microsoft M365 cloud environments using stolen credentials.","[S0684] ROADTools: ROADTools leverages valid cloud credentials to perform enumeration operations using the internal Azure AD Graph API.","[G0007] APT28: APT28 has used compromised Office 365 service accounts with Global Administrator privileges to collect email from user inboxes.","[C0027] C0027: During C0027, Scattered Spider leveraged compromised credentials from victim users to authenticate to Azure tenants.","[S0683] Peirates: Peirates can use stolen service account tokens to perform its operations.","[G0125] HAFNIUM: HAFNIUM has abused service principals in compromised environments to enable data exfiltration.","[S1091] Pacu: Pacu leverages valid cloud accounts to perform most of its operations.","[G0064] APT33: APT33 has used compromised Office 365 accounts in tandem with Ruler in an attempt to gain control of endpoints.","[G1004] LAPSUS$: LAPSUS$ has used compromised credentials to access cloud assets within a target organization.","[G0004] Ke3chang: Ke3chang has used compromised credentials to sign into victims’ Microsoft 365 accounts."],"tactics":"TA0005 - Defense Evasion"}
{"technique_id":"T1112","technique_name":"Modify Registry","description":"Adversaries may interact with the Windows Registry as part of a variety of other techniques to aid in defense evasion, persistence, and execution. Access to specific areas of the Registry depends on account permissions, with some keys requiring administrator-level access. The built-in Windows command-line utility Reg may be used for local or remote Registry modification. Other tools, such as remote access tools, may also contain functionality to interact with the Registry through the Windows API. The Registry may be modified in order to hide configuration information or malicious payloads via Obfuscated Files or Information. The Registry may also be modified to Impair Defenses, such as by enabling macros for all Microsoft Office products, allowing privilege escalation without alerting the user, increasing the maximum number of allowed outbound requests, and/or modifying systems to store plaintext credentials in memory. The Registry of a remote system may be modified to aid in execution of files as part of lateral movement. It requires the remote Registry service to be running on the target system. Often Valid Accounts are required, along with access to the remote system's SMB/Windows Admin Shares for RPC communication. Finally, Registry modifications may also include actions to hide keys, such as prepending key names with a null character, which will cause an error and/or be ignored when read via Reg or other utilities using the Win32 API. Adversaries may abuse these pseudo-hidden keys to conceal payloads/commands used to maintain persistence.","detection":"Modifications to the Registry are normal and occur throughout typical use of the Windows operating system. Consider enabling Registry Auditing on specific keys to produce an alertable event (Event ID 4657) whenever a value is changed (though this may not trigger when values are created with Reghide or other evasive methods). Changes to Registry entries that load software on Windows startup that do not correlate with known software, patch cycles, etc., are suspicious, as are additions or changes to files within the startup folder. Changes could also include new services and modification of existing binary paths to point to malicious files. If a change to a service-related entry occurs, then it will likely be followed by a local or remote service start or restart to execute the file. Monitor processes and command-line arguments for actions that could be taken to change or delete information in the Registry. Remote access tools with built-in features may interact directly with the Windows API to gather information. The Registry may also be modified through Windows system management tools such as Windows Management Instrumentation and PowerShell, which may require additional logging features to be configured in the operating system to collect necessary information for analysis. Monitor for processes, command-line arguments, and API calls associated with concealing Registry keys, such as Reghide. Inspect and cleanup malicious hidden Registry entries using Native Windows API calls and/or tools such as Autoruns and RegDelNull .","procedures":["[S0674] CharmPower: CharmPower can remove persistence-related artifacts from the Registry.","[C0028] 2015 Ukraine Electric Power Attack: During the 2015 Ukraine Electric Power Attack, Sandworm Team modified in-registry Internet settings to lower internet security before launching `rundll32.exe`, which in-turn launches the malware and communicates with C2 servers over the Internet. .","[G0010] Turla: Turla has modified Registry values to store payloads.","[S0013] PlugX: PlugX has a module to create, delete, or modify Registry keys.","[S0596] ShadowPad: ShadowPad can modify the Registry to store and maintain a configuration block and virtual file system.","[S0457] Netwalker: Netwalker can add the following registry entry: HKEY_CURRENT_USER\\SOFTWARE\\{8 random characters}.","[S0476] Valak: Valak has the ability to modify the Registry key HKCU\\Software\\ApplicationContainer\\Appsw64 to store information regarding the C2 server and downloads.","[S0240] ROKRAT: ROKRAT can modify the `HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\` registry key so it can bypass the VB object model (VBOM) on a compromised host.","[G0082] APT38: APT38 uses a tool called CLEANTOAD that has the capability to modify Registry keys.","[S0376] HOPLIGHT: HOPLIGHT has modified Managed Object Format (MOF) files within the Registry to run specific commands and create persistence on the system.","[S0261] Catchamas: Catchamas creates three Registry keys to establish persistence by adding a Windows Service.","[S0032] gh0st RAT: gh0st RAT has altered the InstallTime subkey.","[S0242] SynAck: SynAck can manipulate Registry keys.","[S0533] SLOTHFULMEDIA: SLOTHFULMEDIA can add, modify, and/or delete registry keys. It has changed the proxy configuration of a victim system by modifying the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap registry.","[S0608] Conficker: Conficker adds keys to the Registry at HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services and various other Registry locations.","[S1033] DCSrv: DCSrv has created Registry keys for persistence.","[S0559] SUNBURST: SUNBURST had commands that allow an attacker to write or delete registry keys, and was observed stopping services by setting their HKLM\\SYSTEM\\CurrentControlSet\\services\\\\[service_name]\\\\Start registry entries to value 4. It also deleted previously-created Image File Execution Options (IFEO) Debugger registry values and registry keys related to HTTP proxy to clean up traces of its activity.","[G0040] Patchwork: A Patchwork payload deletes Resiliency Registry keys created by Microsoft Office applications in an apparent effort to trick users into thinking there were no issues during application runs.","[S0569] Explosive: Explosive has a function to write itself to Registry values.","[S0518] PolyglotDuke: PolyglotDuke can write encrypted JSON configuration files to the Registry.","[S0012] PoisonIvy: PoisonIvy creates a Registry subkey that registers a new system device.","[S0669] KOCTOPUS: KOCTOPUS has added and deleted keys from the Registry.","[S1202] LockBit 3.0: LockBit 3.0 can change the Registry values for Group Policy refresh time, to disable SmartScreen, and to disable Windows Defender.","[G0119] Indrik Spider: Indrik Spider has modified registry keys to prepare for ransomware execution and to disable common administrative utilities.","[S0397] LoJax: LoJax has modified the Registry key ‘HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\BootExecute’ from ‘autocheck autochk *’ to ‘autocheck autoche *’.","[S0158] PHOREAL: PHOREAL is capable of manipulating the Registry.","[S0428] PoetRAT: PoetRAT has made registry modifications to alter its behavior upon execution.","[S0496] REvil: REvil can modify the Registry to save encryption parameters and system information.","[S0031] BACKSPACE: BACKSPACE is capable of deleting Registry keys, sub-keys, and values on a victim system.","[S0673] DarkWatchman: DarkWatchman can modify Registry values to store configuration strings, keylogger, and output of components.","[S0531] Grandoreiro: Grandoreiro can modify the Registry to store its configuration at `HKCU\\Software\\` under frequently changing names including %USERNAME% and ToolTech-RM.","[S0011] Taidoor: Taidoor has the ability to modify the Registry on compromised hosts using RegDeleteValueA and RegCreateKeyExA.","[S0603] Stuxnet: Stuxnet can create registry keys to load driver files.","[S0668] TinyTurla: TinyTurla can set its configuration parameters in the Registry.","[S0267] FELIXROOT: FELIXROOT deletes the Registry key HKCU\\Software\\Classes\\Applications\\rundll32.exe\\shell\\open.","[S0649] SMOKEDHAM: SMOKEDHAM has modified registry keys for persistence, to enable credential caching for credential access, and to facilitate lateral movement via RDP.","[S0517] Pillowmint: Pillowmint has modified the Registry key HKLM\\SOFTWARE\\Microsoft\\DRM to store a malicious payload.","[S0501] PipeMon: PipeMon has modified the Registry to store its encrypted payload.","[S1060] Mafalda: Mafalda can manipulate the system registry on a compromised host.","[G0091] Silence: Silence can create, delete, or modify a specified Registry key or value.","[G0092] TA505: TA505 has used malware to disable Windows Defender through modification of the Registry.","[S0023] CHOPSTICK: CHOPSTICK may modify Registry keys to store RC4 encrypted configuration information.","[S1181] BlackByte 2.0 Ransomware: BlackByte 2.0 Ransomware modifies the victim Registry to allow for elevated execution.","[S0697] HermeticWiper: HermeticWiper has the ability to modify Registry keys to disable crash dumps, colors for compressed files, and pop-up information about folders and desktop items.","[S0670] WarzoneRAT: WarzoneRAT can create `HKCU\\Software\\Classes\\Folder\\shell\\open\\command` as a new registry key during privilege escalation.","[S0154] Cobalt Strike: Cobalt Strike can modify Registry values within HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\\\Excel\\Security\\AccessVBOM\\ to enable the execution of additional code.","[G0073] APT19: APT19 uses a Port 22 malware variant to modify several Registry keys.","[S1201] TRANSLATEXT: TRANSLATEXT has modified the following registry key to install itself as the value, granting permission to install specified extensions: ` HKCU\\Software\\Policies\\Google\\Chrome\\ExtensionInstallForcelist`.","[S0527] CSPY Downloader: CSPY Downloader can write to the Registry under the %windir% variable to execute tasks.","[S0666] Gelsemium: Gelsemium can modify the Registry to store its components.","[S0612] WastedLocker: WastedLocker can modify registry values within the Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap registry key.","[S1059] metaMain: metaMain can write the process ID of a target process into the `HKEY_LOCAL_MACHINE\\SOFTWARE\\DDE\\tpid` Registry value as part of its reflective loading activity.","[S1178] ShrinkLocker: ShrinkLocker modifies various registry keys associated with system logon and BitLocker functionality to effectively lock-out users following disk encryption.","[S0262] QuasarRAT: QuasarRAT has a command to edit the Registry on the victim’s machine.","[S0203] Hydraq: Hydraq creates a Registry subkey to register its created service, and can also uninstall itself later by deleting this value. Hydraq's backdoor also enables remote attackers to modify and delete subkeys.","[S1068] BlackCat: BlackCat has the ability to add the following registry key on compromised networks to maintain persistence: `HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services \\LanmanServer\\Paramenters`","[G1043] BlackByte: BlackByte performed Registry modifications to escalate privileges and disable security tools.","[S1131] NPPSPY: NPPSPY modifies the Registry to record the malicious listener for output from the Winlogon process.","[S1070] Black Basta: Black Basta has modified the Registry to enable itself to run in safe mode, to change the icons and file extensions for encrypted files, and to add the malware path for persistence.","[S0254] PLAINTEE: PLAINTEE uses reg add to add a Registry Run key for persistence.","[G0030] Lotus Blossom: Lotus Blossom has installed tools such as Sagerunex by writing them to the Windows registry.","[S1199] LockBit 2.0: LockBit 2.0 can create Registry keys to bypass UAC and for persistence.","[G0047] Gamaredon Group: Gamaredon Group has removed security settings for VBA macro execution by changing registry values HKCU\\Software\\Microsoft\\Office\\&lt;version&gt;\\&lt;product&gt;\\Security\\VBAWarnings and HKCU\\Software\\Microsoft\\Office\\&lt;version&gt;\\&lt;product&gt;\\Security\\AccessVBOM.","[S0692] SILENTTRINITY: SILENTTRINITY can modify registry keys, including to enable or disable Remote Desktop Protocol (RDP).","[S1190] Kapeka: Kapeka writes persistent configuration information to the victim host registry.","[S0022] Uroburos: Uroburos can store configuration information in the Registry including the initialization vector and AES key needed to find and decrypt other Uroburos components.","[S0579] Waterbear: Waterbear has deleted certain values from the Registry to load a malicious DLL.","[S0157] SOUNDBITE: SOUNDBITE is capable of modifying the Registry.","[C0002] Night Dragon: During Night Dragon, threat actors used zwShell to establish full remote control of the connected machine and manipulate the Registry.","[S0332] Remcos: Remcos has full control of the Registry, including the ability to modify it.","[S0260] InvisiMole: InvisiMole has a command to create, set, copy, or delete a specified Registry key or value.","[S0455] Metamorfo: Metamorfo has written process names to the Registry, disabled IE browser features, deleted Registry keys, and changed the ExtendedUIHoverTime key.","[S0256] Mosquito: Mosquito can modify Registry keys under HKCU\\Software\\Microsoft\\[dllname] to store configuration values. Mosquito also modifies Registry keys under HKCR\\CLSID\\...\\InprocServer32 with a path to the launcher.","[S0560] TEARDROP: TEARDROP modified the Registry to create a Windows service for itself on a compromised host.","[S0142] StreamEx: StreamEx has the ability to modify the Registry.","[S0438] Attor: Attor's dispatcher can modify the Run registry key.","[S1132] IPsec Helper: IPsec Helper can make arbitrary changes to registry keys based on provided input.","[S0447] Lokibot: Lokibot has modified the Registry as part of its UAC bypass process.","[S0412] ZxShell: ZxShell can create Registry entries to enable services to run.","[S0356] KONNI: KONNI has modified registry keys of ComSysApp, Svchost, and xmlProv on the machine to gain persistence.","[G0102] Wizard Spider: Wizard Spider has modified the Registry key HKLM\\System\\CurrentControlSet\\Control\\SecurityProviders\\WDigest by setting the UseLogonCredential registry value to 1 in order to force credentials to be stored in clear text in memory. Wizard Spider has also modified the WDigest registry key to allow plaintext credentials to be cached in memory.","[G0050] APT32: APT32's backdoor has modified the Windows Registry to store the backdoor's configuration.","[G0143] Aquatic Panda: Aquatic Panda modified the victim registry to enable the `RestrictedAdmin` mode feature, allowing for pass the hash behaviors to function via RDP.","[S0583] Pysa: Pysa has modified the registry key “SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System” and added the ransom note.","[C0006] Operation Honeybee: During Operation Honeybee, the threat actors used batch files that modified registry keys.","[S0245] BADCALL: BADCALL modifies the firewall Registry key SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfileGloballyOpenPorts\\\\List.","[G1006] Earth Lusca: Earth Lusca modified the registry using the command reg add “HKEY_CURRENT_USER\\Environment” /v UserInitMprLogonScript /t REG_SZ /d “[file path]” for persistence.","[S0576] MegaCortex: MegaCortex has added entries to the Registry for ransom contact information.","[S1058] Prestige: Prestige has the ability to register new registry keys for a new extension handler via `HKCR\\.enc` and `HKCR\\enc\\shell\\open\\command`.","[S0511] RegDuke: RegDuke can create seemingly legitimate Registry key to store its encryption key.","[G0108] Blue Mockingbird: Blue Mockingbird has used Windows Registry modifications to specify a DLL payload.","[S0691] Neoichor: Neoichor has the ability to configure browser settings by modifying Registry entries under `HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer`.","[G0049] OilRig: OilRig has used reg.exe to modify system configuration.","[S1011] Tarrask: Tarrask is able to delete the Security Descriptor (`SD`) registry subkey in order to “hide” scheduled tasks.","[S0572] Caterpillar WebShell: Caterpillar WebShell has a command to modify a Registry key.","[S0268] Bisonal: Bisonal has deleted Registry keys to clean up its prior activity.","[S0467] TajMahal: TajMahal can set the KeepPrintedJobs attribute for configured printers in SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Print\\\\Printers to enable document stealing.","[S0537] HyperStack: HyperStack can add the name of its communication pipe to HKLM\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\lanmanserver\\\\parameters\\NullSessionPipes.","[S0115] Crimson: Crimson can set a Registry key to determine how long it has been installed and possibly to indicate the version number.","[G1003] Ember Bear: Ember Bear modifies registry values for anti-forensics and defense evasion purposes.","[S0229] Orz: Orz can perform Registry operations.","[S0148] RTM: RTM can delete all Registry entries created during its execution.","[G1017] Volt Typhoon: Volt Typhoon has used `netsh` to create a PortProxy Registry modification on a compromised server running the Paessler Router Traffic Grapher (PRTG).","[S1099] Samurai: The Samurai loader component can create multiple Registry keys to force the svchost.exe process to load the final backdoor.","[C0014] Operation Wocao: During Operation Wocao, the threat actors enabled Wdigest by changing the `HKLM\\SYSTEM\\\\ControlSet001\\\\Control\\\\SecurityProviders\\\\WDigest` registry value from 0 (disabled) to 1 (enabled).","[G0035] Dragonfly: Dragonfly has modified the Registry to perform multiple techniques through the use of Reg.","[S0488] CrackMapExec: CrackMapExec can create a registry key using wdigest.","[G0078] Gorgon Group: Gorgon Group malware can deactivate security mechanisms in Microsoft Office by editing several keys and values under HKCU\\Software\\Microsoft\\Office\\.","[S0350] zwShell: zwShell can modify the Registry.","[S0631] Chaes: Chaes can modify Registry values to stored information and establish persistence.","[S0336] NanoCore: NanoCore has the capability to edit the Registry.","[S0611] Clop: Clop can make modifications to Registry keys.","[S0665] ThreatNeedle: ThreatNeedle can modify the Registry to save its configuration data as the following RC4-encrypted Registry key: `HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\GameCon`.","[S0386] Ursnif: Ursnif has used Registry modifications as part of its installation routine.","[S0441] PowerShower: PowerShower has added a registry key so future powershell.exe instances are spawned off-screen by default, and has removed all registry entries that are left behind during the dropper process.","[S0045] ADVSTORESHELL: ADVSTORESHELL is capable of setting and deleting Registry values.","[S0568] EVILNUM: EVILNUM can make modifications to the Regsitry for persistence.","[S0330] Zeus Panda: Zeus Panda modifies several Registry keys under HKCU\\Software\\Microsoft\\Internet Explorer\\ PhishingFilter\\ to disable phishing filters.","[S0343] Exaramel for Windows: Exaramel for Windows adds the configuration to the Registry in XML format.","[S0205] Naid: Naid creates Registry entries that store information about a created service and point to a malicious DLL dropped to disk.","[S0140] Shamoon: Once Shamoon has access to a network share, it enables the RemoteRegistry service on the target system. It will then connect to the system with RegConnectRegistryW and modify the Registry to disable UAC remote restrictions by setting SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy to 1.","[S0663] SysUpdate: SysUpdate can write its configuration file to Software\\Classes\\scConfig in either HKEY_LOCAL_MACHINE or HKEY_CURRENT_USER.","[G1014] LuminousMoth: LuminousMoth has used malware that adds Registry keys for persistence.","[S0385] njRAT: njRAT can create, delete, or modify a specified Registry key or value.","[S1047] Mori: Mori can write data to `HKLM\\Software\\NFC\\IPA` and `HKLM\\Software\\NFC\\` and delete Registry values.","[S0342] GreyEnergy: GreyEnergy modifies conditions in the Registry and adds keys.","[S0075] Reg: Reg may be used to interact with and modify the Windows Registry of a local or remote system at the command-line interface.","[S0090] Rover: Rover has functionality to remove Registry Run key persistence as a cleanup procedure.","[S0180] Volgmer: Volgmer modifies the Registry to store an encoded configuration file in HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Security.","[S0660] Clambling: Clambling can set and delete Registry keys.","[S0650] QakBot: QakBot can modify the Registry to store its configuration information in a randomly named subkey under HKCU\\Software\\Microsoft.","[S0239] Bankshot: Bankshot writes data into the Registry key HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Pniumj.","[G0094] Kimsuky: Kimsuky has modified Registry settings for default file associations to enable all macros and for persistence.","[S0126] ComRAT: ComRAT has modified Registry values to store encrypted orchestrator code and payloads.","[S0640] Avaddon: Avaddon modifies several registry keys for persistence and UAC bypass.","[S1025] Amadey: Amadey has overwritten registry keys for persistence.","[S1180] BlackByte Ransomware: BlackByte Ransomware modifies the victim Registry to prevent system recovery.","[S0266] TrickBot: TrickBot can modify registry entries.","[G0096] APT41: APT41 used a malware variant called GOODLUCK to modify the registry in order to steal credentials.","[S0334] DarkComet: DarkComet adds a Registry value for its installation routine to the Registry Key HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System Enable LUA=”0” and HKEY_CURRENT_USER\\Software\\DC3_FEXEC.","[G0059] Magic Hound: Magic Hound has modified Registry settings for security tools.","[S0263] TYPEFRAME: TYPEFRAME can install encrypted configuration data under the Registry key HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ShellCompatibility\\Applications\\laxhost.dll and HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\PrintConfigs.","[S1050] PcShare: PcShare can delete its persistence mechanisms from the registry.","[S0271] KEYMARBLE: KEYMARBLE has a command to create Registry entries for storing data under HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\WABE\\DataPath.","[S0679] Ferocious: Ferocious has the ability to add a Class ID in the current user Registry hive to enable persistence mechanisms.","[S1066] DarkTortilla: DarkTortilla has modified registry keys for persistence.","[S0348] Cardinal RAT: Cardinal RAT sets HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\Load to point to its executable.","[S0331] Agent Tesla: Agent Tesla can achieve persistence by modifying Registry key entries.","[S1090] NightClub: NightClub can modify the Registry to set the ServiceDLL for a service created by the malware for persistence.","[S0269] QUADAGENT: QUADAGENT modifies an HKCU Registry key to store a session identifier unique to the compromised system as well as a pre-shared key used for encrypting and decrypting C2 communications.","[S0198] NETWIRE: NETWIRE can modify the Registry to store its configuration information.","[S0589] Sibot: Sibot has modified the Registry to install a second-stage script in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\sibot.","[S0570] BitPaymer: BitPaymer can set values in the Registry to help in execution.","[S1149] CHIMNEYSWEEP: CHIMNEYSWEEP can use the Windows Registry Environment key to change the `%windir%` variable to point to `c:\\Windows` to enable payload execution.","[S0662] RCSession: RCSession can write its configuration file to the Registry.","[G1044] APT42: APT42 has modified Registry keys to maintain persistence.","[G1031] Saint Bear: Saint Bear will leverage malicious Windows batch scripts to modify registry values associated with Windows Defender functionality.","[S0210] Nerex: Nerex creates a Registry subkey that registers a new service.","[S0444] ShimRat: ShimRat has registered two registry keys for shim databases.","[G0027] Threat Group-3390: A Threat Group-3390 tool has created new Registry keys under `HKEY_CURRENT_USER\\Software\\Classes\\` and `HKLM\\SYSTEM\\CurrentControlSet\\services`.","[G0061] FIN8: FIN8 has deleted Registry keys during post compromise cleanup activities.","[S0677] AADInternals: AADInternals can modify registry keys as part of setting a new pass-through authentication agent.","[S0019] Regin: Regin appears to have functionality to modify remote Registry information.","[S0664] Pandora: Pandora can write an encrypted token to the Registry to enable processing of remote commands."],"tactics":"TA0005 - Defense Evasion"}
{"technique_id":"T1127.001","technique_name":"Trusted Developer Utilities Proxy Execution: MSBuild","description":"Adversaries may use MSBuild to proxy execution of code through a trusted Windows utility. MSBuild.exe (Microsoft Build Engine) is a software build platform used by Visual Studio. It handles XML formatted project files that define requirements for loading and building various platforms and configurations. Adversaries can abuse MSBuild to proxy execution of malicious code. The inline task capability of MSBuild that was introduced in .NET version 4 allows for C# or Visual Basic code to be inserted into an XML project file. MSBuild will compile and execute the inline task. MSBuild.exe is a signed Microsoft binary, so when it is used this way it can execute arbitrary code and bypass application control defenses that are configured to allow MSBuild.exe execution.","detection":"Use process monitoring to monitor the execution and arguments of MSBuild.exe. Compare recent invocations of those binaries with prior history of known good arguments and executed binaries to determine anomalous and potentially adversarial activity. Command arguments used before and after invocation of the utilities may also be useful in determining the origin and purpose of the binary being executed.","procedures":["[S0013] PlugX: A version of PlugX loads as shellcode within a .NET Framework project using msbuild.exe, presumably to bypass application control techniques.","[S0363] Empire: Empire can use built-in modules to abuse trusted utilities like MSBuild.exe.","[C0001] Frankenstein: During Frankenstein, the threat actors used MSbuild to execute an actor-created file."],"tactics":"TA0005 - Defense Evasion"}
{"technique_id":"T1127.002","technique_name":"Trusted Developer Utilities Proxy Execution: ClickOnce","description":"Adversaries may use ClickOnce applications (.appref-ms and .application files) to proxy execution of code through a trusted Windows utility. ClickOnce is a deployment that enables a user to create self-updating Windows-based .NET applications (i.e, .XBAP, .EXE, or .DLL) that install and run from a file share or web page with minimal user interaction. The application launches as a child process of DFSVC.EXE, which is responsible for installing, launching, and updating the application. Because ClickOnce applications receive only limited permissions, they do not require administrative permissions to install. As such, adversaries may abuse ClickOnce to proxy execution of malicious code without needing to escalate privileges. ClickOnce may be abused in a number of ways. For example, an adversary may rely on User Execution. When a user visits a malicious website, the .NET malware is disguised as legitimate software and a ClickOnce popup is displayed for installation. Adversaries may also abuse ClickOnce to execute malware via a Rundll32 script using the command `rundll32.exe dfshim.dll,ShOpenVerbApplication1`. Additionally, an adversary can move the ClickOnce application file to a remote user’s startup folder for continued malicious code deployment (i.e., Registry Run Keys / Startup Folder).","detection":null,"procedures":null,"tactics":"TA0005 - Defense Evasion"}
{"technique_id":"T1127.003","technique_name":"Trusted Developer Utilities Proxy Execution: JamPlus","description":"Adversaries may use `JamPlus` to proxy the execution of a malicious script. `JamPlus` is a build utility tool for code and data build systems. It works with several popular compilers and can be used for generating workspaces in code editors such as Visual Studio. Adversaries may abuse the `JamPlus` build utility to execute malicious scripts via a `.jam` file, which describes the build process and required dependencies. Because the malicious script is executed from a reputable developer tool, it may subvert application control security systems such as Smart App Control.","detection":null,"procedures":null,"tactics":"TA0005 - Defense Evasion"}