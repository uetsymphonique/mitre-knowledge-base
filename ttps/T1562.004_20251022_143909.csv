Technique,Behavior,Tactics
T1562.004,"Summary: Open any inbound connection with netsh advfirewall. Description: Open any inbound connection with netsh advfirewall. Procedures: netsh advfirewall firewall add rule name=""Allow Health-checking Inbound from Domain Controller"" dir=in action=allow protocol=TCP localport=any.",TA0005
T1562.004,"Summary: Open any outbound connection with netsh advfirewall. Description: Open any outbound connection with netsh advfirewall. Procedures: netsh advfirewall firewall add rule name=""Allow EDR agents outbound"" dir=out action=allow protocol=TCP localport=any.",TA0005
T1562.004,"Summary: Open a local port defined by input arguments to any profile using netsh advfirewall. Description: Allow a specific anomaly inbound connection with netsh. Procedures: netsh advfirewall firewall add rule name=""Open Port to Any"" dir=in protocol=tcp localport=3389 action=allow profile=any.",TA0005
T1562.004,Summary: Using registy key to add a firewall rule to allow RDP connection. Procedures: $guid = '980e5ec9-4db9-4441-8b8e-cd2b893072b9'; $rule = 'v2.29|Action=Allow|Active=TRUE|Dir=In|Protocol=6|LPort=3389|Name=Open Port 3389'; New-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\FirewallRules' -Name $guid -PropertyType String -Value $rule -Force | Out-Null.,TA0005
T1562.004,"Summary: Set a firewall rule using New-NetFirewallRule. Procedures: New-NetFirewallRule -DisplayName ""VESCollector Inbound Connection"" -Direction Inbound -Action Allow -Protocol TCP -LocalPort 3389.",TA0005
T1562.004,"Summary: Edit a firewall rule (Remote Desktop) allow IPs from attacker. Procedures: Set-NetFirewallRule -DisplayName ""Remote Desktop - User Mode (UDP-In)"" -RemoteAddress 192.168.10.0/24.",TA0005
T1562.004,"Summary: Disable Microsoft Defender Firewall via Registry. Description: Disables the Microsoft Defender Firewall for the public profile via registry. Caution if you access remotely the host where the test runs! Especially with the cleanup command which will re-enable firewall for the current profile.... Procedures: reg add ""HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\PublicProfile"" /v ""EnableFirewall"" /t REG_DWORD /d 0 /f.",TA0005
T1562.004,"Summary: LockBit Black - Unusual Windows firewall registry modification -cmd. Description: An adversary tries to modify the windows firewall registry. Procedures: reg add ""HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile"" /v EnableFirewall /t REG_DWORD /d 0 /f && reg add ""HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\StandardProfile"" /v EnableFirewall /t REG_DWORD /d 0 /f.",TA0005
T1562.004,"Summary: LockBit Black - Unusual Windows firewall registry modification -Powershell. Description: An adversary tries to modify the windows firewall registry.. Procedures: New-ItemProperty ""HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile"" -Name EnableFirewall -PropertyType DWORD -Value 0 -Force; New-ItemProperty ""HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\StandardProfile"" -Name EnableFirewall -PropertyType DWORD -Value 0 -Force.",TA0005
T1562.004,"Summary: Allow Executable Through Firewall Located in Non-Standard Location using netsh advfirewall. Description: This test will attempt to allow an executable through the system firewall located in the Users directory. Procedures: Copy-Item ""f7ce09_AtomicTest.exe"" -Destination ""C:\Users\$env:UserName"" -Force; netsh advfirewall firewall add rule name=""Atomic Test"" dir=in action=allow program=""C:\Users\$env:UserName\AtomicTest.exe"" enable=yes.",TA0005
T1562.004,"Summary: Allow SMB and RDP on Microsoft Defender Firewall (advfirewall set rule group). Procedures: netsh advfirewall firewall set rule group=""remote desktop"" new enable=Yes && netsh advfirewall firewall set rule group=""file and printer sharing"" new enable=Yes.",TA0005
T1562.004,Summary: Disable Microsoft Defender Firewall using netsh advfirewall set currentprofile state. Procedures: netsh advfirewall set currentprofile state off.,TA0005
T1562.004,Summary: Disable Windows Firewall using netsh firewall set opmode. Procedures: netsh firewall set opmode mode=disable.,TA0005
